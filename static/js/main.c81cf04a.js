(()=>{var e={36322:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>Ds,navigate:()=>Ls,navigationRef:()=>Ms});var n=o(36665),r=o(73929),a=o(6283),i=o(75675),s=o(8218),l=o(66986),d=o(44370),c=o(26166),u=o(43150),g=o(45010),m=o(6541),h=o(38432),f=o(59742),p=o(64900),y=o(91087),b=o(8179),x=o(77109),v=o(15648),w=o(15009),C=o(26725),S=o(7869),j=o(60397);const T=i.default.create({overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:999},container:{position:"fixed",backgroundColor:m.theme.colors.surface,borderRadius:12,padding:20,width:320,shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.3,shadowRadius:5,elevation:8,zIndex:1e3,borderWidth:2,borderColor:m.theme.colors.primary},pulseBorder:{position:"absolute",top:-4,left:-4,right:-4,bottom:-4,borderRadius:14,opacity:.7},closeButton:{position:"absolute",top:12,right:12,padding:8,zIndex:1},content:{marginTop:12},title:{fontSize:20,fontWeight:"700",color:m.theme.colors.primary,marginBottom:8,fontFamily:m.theme.fonts.header.fontFamily},description:{fontSize:16,color:m.theme.colors.text,marginBottom:20,lineHeight:22,fontFamily:m.theme.fonts.regular.fontFamily},footer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginTop:16},leftButtons:{flex:1},skipButton:{paddingVertical:8,paddingHorizontal:12},skipText:{color:m.theme.colors.secondary,fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily},navigationButton:{flexDirection:"row",alignItems:"center",paddingVertical:8,paddingHorizontal:12},navigationText:{color:m.theme.colors.primary,fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},finishButton:{backgroundColor:m.theme.colors.primary,paddingVertical:8,paddingHorizontal:16,borderRadius:4},finishText:{color:m.theme.colors.surface,fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},stepIndicator:{paddingHorizontal:12},stepText:{color:m.theme.colors.secondary,fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily}}),B=({step:e,totalSteps:t,title:o,description:i,onNext:s,onPrevious:l,onSkip:d,onClose:c,onFinish:u,position:g="bottomRight",userRole:f,is_DEBUG:p=!1})=>{const y=1===e,x=e===t,[B,k]=(0,n.useState)(!0),[A,_]=(0,n.useState)(null),I=(0,b.useNavigation)(),M=(0,n.useRef)(new w.default.Value(0)).current,L=(0,n.useRef)(new w.default.Value(0)).current,R=(0,n.useRef)(new w.default.Value(1)).current,{width:D,height:z}=C.default.get("window");(0,n.useEffect)((()=>{p&&(0,h.debugLog)("MBA54321 TutorialModal mounted/updated",{isVisible:B,currentStep:e,userRole:f,screen:A})}),[B,e,f,A]),(0,n.useEffect)((()=>{if(B){(0,h.debugLog)("MBA54321 Tutorial is visible, ensuring it stays visible on screen change");const e=setTimeout((()=>{k(!0)}),100);return()=>clearTimeout(e)}}),[B]),(0,n.useEffect)((()=>I.addListener("focus",(()=>{B&&((0,h.debugLog)("MBA54321 Screen focused, ensuring tutorial stays visible"),k(!0))}))),[I,B]),(0,n.useEffect)((()=>{w.default.timing(M,{toValue:1,duration:500,useNativeDriver:!0}).start(),w.default.timing(L,{toValue:1,duration:800,useNativeDriver:!0}).start(),w.default.timing(R,{toValue:0,duration:800,useNativeDriver:!0}).start()}),[]);const P={top:(z+60)/2-150,left:(D-15)/2-160},F=(()=>{switch(g){case"bottomRight":default:return{bottom:20,right:20};case"bottomLeft":return{bottom:20,left:20};case"topRight":return{top:20,right:20};case"topLeft":return{top:20,left:20}}})(),E={transform:[{translateX:L.interpolate({inputRange:[0,1],outputRange:[0,F.right?D/2-160:-D/2+160]})},{translateY:L.interpolate({inputRange:[0,1],outputRange:[0,F.bottom?z/2-150:-z/2+150]})}]};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(w.default.View,{style:[T.overlay,{opacity:R}],pointerEvents:"none"}),(0,j.jsxs)(w.default.View,{style:[T.container,P,{opacity:M},E],children:[(0,j.jsx)(r.default,{style:T.pulseBorder}),(0,j.jsx)(v.default,{style:T.closeButton,onPress:()=>{p&&(0,h.debugLog)("MBA54321 TutorialModal handleClose called"),c()},children:(0,j.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.text})}),(0,j.jsxs)(r.default,{style:T.content,children:[(0,j.jsx)(a.default,{style:T.title,children:o}),(0,j.jsx)(a.default,{style:T.description,children:i}),(0,j.jsxs)(r.default,{style:T.footer,children:[(0,j.jsx)(r.default,{style:T.leftButtons,children:y?(0,j.jsx)(v.default,{style:T.skipButton,onPress:()=>{p&&(0,h.debugLog)("MBA54321 TutorialModal handleSkip called"),d()},children:(0,j.jsx)(a.default,{style:T.skipText,children:"Skip Tutorial"})}):(0,j.jsxs)(v.default,{style:T.navigationButton,onPress:()=>{p&&(0,h.debugLog)("MBA54321 TutorialModal handlePrevious called",{step:e,totalSteps:t}),l()},children:[(0,j.jsx)(S.default,{name:"chevron-left",size:20,color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:T.navigationText,children:"Previous"})]})}),(0,j.jsx)(r.default,{style:T.stepIndicator,children:(0,j.jsxs)(a.default,{style:T.stepText,children:[e,"/",t]})}),x?(0,j.jsx)(v.default,{style:T.finishButton,onPress:()=>{p&&(0,h.debugLog)("MBA54321 TutorialModal handleFinish called"),u()},children:(0,j.jsx)(a.default,{style:T.finishText,children:"Finish Tutorial"})}):(0,j.jsxs)(v.default,{style:T.navigationButton,onPress:()=>{p&&(0,h.debugLog)("MBA54321 TutorialModal handleNext called",{step:e,totalSteps:t}),s()},children:[(0,j.jsx)(a.default,{style:T.navigationText,children:"Next"}),(0,j.jsx)(S.default,{name:"chevron-right",size:20,color:m.theme.colors.primary})]})]})]})]})]})};var k=o(78264),A=o(20530);const _=i.default.create({modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:20,width:"90%",maxWidth:400},modalText:{fontSize:m.theme.fontSizes.medium,marginBottom:20,textAlign:"center",color:m.theme.colors.text},buttonContainer:{flexDirection:"row",justifyContent:"space-between",gap:10},button:{flex:1,paddingVertical:12,borderRadius:8,alignItems:"center"},cancelButton:{backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border},confirmButton:{backgroundColor:m.theme.colors.primary},cancelButtonText:{color:m.theme.colors.text,fontWeight:"500"},confirmButtonText:{color:m.theme.colors.surface,fontWeight:"500"},disabledButton:{opacity:.7},disabledText:{opacity:.5}}),I=({visible:e,onClose:t,onConfirm:o,actionText:n,isLoading:i=!1})=>(0,j.jsx)(k.default,{visible:e,transparent:!0,animationType:"fade",onRequestClose:t,children:(0,j.jsx)(r.default,{style:_.modalOverlay,children:(0,j.jsxs)(r.default,{style:_.modalContent,children:[(0,j.jsxs)(a.default,{style:_.modalText,children:["Are you sure you want to ",n,"?"]}),(0,j.jsxs)(r.default,{style:_.buttonContainer,children:[(0,j.jsx)(v.default,{style:[_.button,_.cancelButton],onPress:t,disabled:i,children:(0,j.jsx)(a.default,{style:[_.cancelButtonText,i&&_.disabledText],children:"Cancel"})}),(0,j.jsx)(v.default,{style:[_.button,_.confirmButton,i&&_.disabledButton],onPress:o,disabled:i,children:i?(0,j.jsx)(A.default,{size:"small",color:m.theme.colors.surface}):(0,j.jsx)(a.default,{style:_.confirmButtonText,children:"Confirm"})})]})]})})}),M=(0,n.createContext)(),L={done_client_tutorial:!1,done_pro_tutorial:!1},R={client:[{screen:"MyProfile",tab:"profile_info",title:"Welcome to Your Profile",description:"This is where you can manage your personal information. Start by completing your profile to help professionals understand your needs better.",position:"bottomRight"},{screen:"MyProfile",tab:"pets_preferences",title:"Add Pets & Home Info",description:"Add information about your pets and their care preferences along with your home information. This helps professionals provide the best care possible.",position:"bottomRight"},{screen:"MyProfile",tab:"settings_payments",title:"Payment & Settings",description:"Set up your settings, payment methods, and subscription preferences to easily book services.",position:"bottomRight"},{screen:"Dashboard",title:"Your Dashboard",description:"Here you can view your upcoming bookings, track ongoing services, and manage your account.",position:"bottomRight",onStepEnter:e=>{e&&e.navigate("Dashboard")}},{screen:"SearchProfessionalsListing",title:"Find Professionals",description:"Search for qualified professionals in your area. Filter by service type, availability, and more.",position:"bottomRight"},{screen:"BecomeProfessional",title:"Become a Professional",description:"Want to offer your services? You can apply to become a professional anytime.",position:"bottomRight"}],professional:[{screen:"MyProfile",tab:"profile_info",title:"Welcome to Your Professional Profile",description:"This is where you can manage your professional information. Start by completing your profile to help clients find you.",position:"bottomRight"},{screen:"MyProfile",tab:"services",title:"Your Services",description:"Add and manage the services you offer. Set your rates, availability, and service areas.",position:"bottomRight"},{screen:"MyProfile",tab:"settings_payments",title:"Payment Settings",description:"Set up your payment methods and subscription preferences to receive payments from clients.",position:"bottomRight"},{screen:"Dashboard",title:"Your Dashboard",description:"Here you can view your upcoming bookings, track ongoing services, and manage your account.",position:"bottomRight",onStepEnter:e=>{e&&e.navigate("Dashboard")}},{screen:"SearchClients",title:"Find Clients",description:"Search for potential clients in your area. Filter by service type, pet type, and more.",position:"bottomRight"}],default:[{screen:"Home",title:"Welcome",description:"Welcome to CrittrCove! Let's get started with a quick tour.",position:"bottomRight"}]},D=({children:e})=>{const{isSignedIn:t,userRole:o,is_DEBUG:r}=(0,n.useContext)(h.AuthContext),a=(0,b.useNavigation)(),[i,s]=(0,n.useState)(L),[l,d]=(0,n.useState)(1),[c,u]=(0,n.useState)(!1),[m,f]=(0,n.useState)(!1),[y,v]=(0,n.useState)(""),[w,C]=(0,n.useState)(!0),[S,T]=(0,n.useState)(!1),[k,A]=(0,n.useState)(!1);(0,n.useEffect)((()=>{t&&o?((0,h.debugLog)("MBA54321 Both isSignedIn and userRole are available, fetching tutorial status",{isSignedIn:t,userRole:o}),_()):((0,h.debugLog)("MBA54321 Waiting for auth data",{isSignedIn:t,userRole:o}),C(!1))}),[t,o]);const _=async()=>{try{C(!0);const e=await x.default.get("".concat(p.API_BASE_URL,"/api/users/v1/tutorial-status/current/"));r&&(0,h.debugLog)("MBA54321 Tutorial status:",e.data),s(e.data),f(!1),v(""),"professional"===o&&!e.data.done_pro_tutorial||"petOwner"===o&&!e.data.done_client_tutorial?(u(!0),r&&(0,h.debugLog)("MBA54321 Redirecting new user to MyProfile screen"),(0,g.navigateToFrom)(a,"MyProfile","Dashboard",{screen:"profile_info"}),r&&(0,h.debugLog)("MBA54321 Tutorial should be visible:",{userRole:o,done_client_tutorial:e.data.done_client_tutorial,done_pro_tutorial:e.data.done_pro_tutorial})):(r&&(0,h.debugLog)("MBA54321 Tutorial should NOT be visible"),u(!1))}catch(e){console.error("Error fetching tutorial status:",e),f(!0),v("We had trouble loading your tutorial settings, but you can still proceed with the tutorial."),s(L),u(!0)}finally{C(!1)}},D=()=>{let e="default";"professional"===o?e="professional":"petOwner"!==o&&"client"!==o||(e="client");const t=R[e]||R.default,n=Math.min(Math.max(1,l),t.length),r=t[n-1];return m&&1===n?Object.assign({},r,{description:"".concat(y,"\n\n").concat(r.description)}):r},z=async()=>{(0,h.debugLog)("MBA54321 handleNext called",{currentStep:l,userRole:o});const e=R["professional"===o?"professional":"client"];if(l>=e.length)return void(0,h.debugLog)("MBA54321 At last step, completing tutorial",{currentStep:l,totalSteps:e.length});const t=e[l],n=e[l-1];(0,h.debugLog)("MBA54321 Current step data",n),(0,h.debugLog)("MBA54321 Next step data",t),d((e=>e+1)),(t.screen!==n.screen||t.tab&&t.tab!==n.tab)&&((0,h.debugLog)("MBA54321 Navigating to different screen/tab",{from:n.screen,to:t.screen,fromTab:n.tab,toTab:t.tab}),t.tab?(0,g.navigateToFrom)(a,t.screen,n.screen,{screen:t.tab}):(0,g.navigateToFrom)(a,t.screen,n.screen),setTimeout((()=>{u(!0)}),700))},P=()=>{if((0,h.debugLog)("MBA54321 handlePrevious called",{currentStep:l,userRole:o}),l>1){const e=R["professional"===o?"professional":"client"],t=e[l-2],n=e[l-1];(0,h.debugLog)("MBA54321 Previous step data",t),(0,h.debugLog)("MBA54321 Current step data",n),d((e=>e-1)),(t.screen!==n.screen||t.tab&&t.tab!==n.tab)&&((0,h.debugLog)("MBA54321 Navigating back to different screen/tab",{from:n.screen,to:t.screen,fromTab:n.tab,toTab:t.tab}),t.tab?(0,g.navigateToFrom)(a,t.screen,n.screen,{screen:t.tab}):(0,g.navigateToFrom)(a,t.screen,n.screen),setTimeout((()=>{u(!0)}),700))}},F=()=>{(0,h.debugLog)("MBA54321 handleSkip called through the later"),T(!0)},E=async()=>{(0,h.debugLog)("MBA54321 Completing tutorial",{userRole:o});try{const e={};"professional"===o?e.done_pro_tutorial=!0:"petOwner"!==o&&"client"!==o||(e.done_client_tutorial=!0),await x.default.patch("".concat(p.API_BASE_URL,"/api/users/v1/tutorial-status/update_status/"),e),(0,h.debugLog)("MBA54321 Tutorial status updated in backend"),u(!1),(0,h.debugLog)("MBA54321 Navigating to Dashboard"),(0,g.navigateToFrom)(a,"Dashboard",D().screen)}catch(e){(0,h.debugLog)("MBA54321 Error completing tutorial",{error:e.message}),console.error("Error completing tutorial:",e),(0,g.navigateToFrom)(a,"Dashboard",D().screen)}};return w?(0,j.jsx)(M.Provider,{value:{isVisible:!1,currentStep:1,totalSteps:1,stepData:R.default[0],tutorialStatus:L,hasError:!1,errorMessage:"",handleNext:()=>{},handlePrevious:()=>{},handleSkip:()=>{},completeTutorial:()=>{},setIsVisible:()=>{},isLoading:!0},children:e}):(0,j.jsxs)(M.Provider,{value:{isVisible:c,setIsVisible:u,currentStep:l,setCurrentStep:d,handleNext:z,handlePrevious:P,handleSkip:F,completeTutorial:E,isLoading:w},children:[e,c&&D()&&(0,j.jsx)(B,{step:l,totalSteps:R["professional"===o?"professional":"petOwner"===o||"client"===o?"client":"default"].length,title:D().title,description:D().description,onNext:z,onPrevious:P,onSkip:F,onClose:()=>{(0,h.debugLog)("MBA54321 handleClose called"),A(!0)},onFinish:E,position:D().position,userRole:o,is_DEBUG:r}),(0,j.jsx)(I,{visible:S,onClose:()=>{(0,h.debugLog)("MBA54321 handleSkipCancel called"),T(!1)},onConfirm:()=>{(0,h.debugLog)("MBA54321 handleSkipConfirm called"),T(!1),E()},actionText:"skip the tutorial",isLoading:!1}),(0,j.jsx)(I,{visible:k,onClose:()=>{(0,h.debugLog)("MBA54321 handleCloseCancel called"),A(!1)},onConfirm:()=>{(0,h.debugLog)("MBA54321 handleCloseConfirm called"),A(!1),E()},actionText:"close the tutorial",isLoading:!1})]})},z=i.default.create({container:{position:"fixed",bottom:20,right:0,zIndex:9999,paddingHorizontal:16,width:"100%",alignItems:"flex-end"},toast:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:12,paddingHorizontal:12,borderRadius:8,minWidth:200,maxWidth:300,elevation:6,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},content:{flex:1,flexDirection:"row",alignItems:"center"},icon:{marginRight:8},message:{color:"#fff",fontSize:14,fontFamily:void 0,flex:1},closeButton:{padding:4}}),P=({visible:e,message:t,type:o="success",onDismiss:i,addMarginBottom:s,duration:l=3e3})=>{const d=(0,n.useRef)(new w.default.Value(C.default.get("window").width)).current,c=(0,n.useRef)(new w.default.Value(0)).current,u=(0,n.useRef)(null);(0,n.useEffect)((()=>(e&&(u.current&&clearTimeout(u.current),w.default.parallel([w.default.timing(d,{toValue:0,duration:300,useNativeDriver:!0}),w.default.timing(c,{toValue:1,duration:300,useNativeDriver:!0})]).start(),u.current=setTimeout((()=>{g()}),l)),()=>{u.current&&clearTimeout(u.current)})),[e,l]);const g=()=>{var e;u.current&&clearTimeout(u.current),e=()=>{i&&i()},w.default.parallel([w.default.timing(d,{toValue:C.default.get("window").width,duration:300,useNativeDriver:!0}),w.default.timing(c,{toValue:0,duration:300,useNativeDriver:!0})]).start(e)};return e?(0,j.jsx)(r.default,{style:z.container,pointerEvents:"box-none",children:(0,j.jsxs)(w.default.View,{style:[z.toast,{backgroundColor:(()=>{switch(o){case"error":return m.theme.colors.error;case"warning":return m.theme.colors.warning||"#FFA726";case"info":return m.theme.colors.info||"#29B6F6";default:return m.theme.colors.primary}})(),transform:[{translateX:d}],opacity:c,marginBottom:s}],children:[(0,j.jsxs)(r.default,{style:z.content,children:[(0,j.jsx)(S.default,{name:(()=>{switch(o){case"error":return"alert-circle";case"warning":return"alert";case"info":return"information";default:return"check-circle"}})(),size:24,color:"white",style:z.icon}),(0,j.jsx)(a.default,{style:z.message,numberOfLines:3,ellipsizeMode:"tail",children:t})]}),(0,j.jsx)(v.default,{onPress:g,style:z.closeButton,hitSlop:{top:10,bottom:10,left:10,right:10},children:(0,j.jsx)(S.default,{name:"close",size:18,color:"white"})})]})}):null},F=(0,n.createContext)(),E=()=>{const e=(0,n.useContext)(F);if(!e)throw new Error("useToast must be used within a ToastProvider");return e},W=({children:e})=>{const[t,o]=(0,n.useState)({visible:!1,message:"",type:"success",duration:3e3}),a=(0,n.useCallback)((({message:e,type:t="success",duration:n=3e3})=>{o({visible:!0,message:e,type:t,duration:n})}),[]),i=(0,n.useCallback)((()=>{o((e=>Object.assign({},e,{visible:!1})))}),[]);return(0,j.jsx)(F.Provider,{value:a,children:(0,j.jsxs)(r.default,{style:O.container,children:[e,(0,j.jsx)(P,{visible:t.visible,message:t.message,type:t.type,duration:t.duration,onDismiss:i})]})})},O=i.default.create({container:{flex:1,position:"relative"}});var N=o(43538),H=(o(25882),o(12686)),U=o(94070);const V=()=>window.navigator.userAgent.includes("ReactSnap")||window.navigator.userAgent.includes("Puppeteer")||window.navigator.userAgent.includes("Headless"),q=()=>{if(!window.navigator)return!1;const e=window.navigator.userAgent.toLowerCase();return["googlebot","bingbot","slurp","duckduckbot","baiduspider","yandexbot","facebookexternalhit","twitterbot","rogerbot","linkedinbot","whatsapp","telegrambot","discordbot","slackbot","curl","wget","python","reactsnap","puppeteer","headless"].some((t=>e.includes(t)))},Y=()=>window.location.pathname,G=e=>({"/dog-boarding-colorado-springs":{title:"Dog Boarding Colorado Springs | Trusted Pet Care | CrittrCove",description:"Find reliable dog boarding services in Colorado Springs. Professional pet sitters providing overnight care for your furry friends. Book trusted local dog boarding today.",keywords:"dog boarding colorado springs, pet boarding, overnight dog care, dog sitters, pet care colorado springs"},"/dog-walker-colorado-springs":{title:"Dog Walker Colorado Springs | Professional Pet Walking | CrittrCove",description:"Professional dog walking services in Colorado Springs. Reliable pet walkers for daily exercise and care. Book trusted dog walkers in your neighborhood today.",keywords:"dog walker colorado springs, pet walking, dog exercise, professional dog walkers, pet care services"},"/cat-sitting-colorado-springs":{title:"Cat Sitting Colorado Springs | Professional Cat Care | CrittrCove",description:"Trusted cat sitting services in Colorado Springs. Professional cat sitters providing in-home care for your feline friends. Book reliable cat care today.",keywords:"cat sitting colorado springs, cat sitters, feline care, in-home cat care, pet sitting services"},"/exotic-pet-care-colorado-springs":{title:"Exotic Pet Care Colorado Springs | Specialized Pet Services | CrittrCove",description:"Expert exotic pet care in Colorado Springs. Specialized services for reptiles, birds, ferrets, and unique pets. Professional exotic animal care you can trust.",keywords:"exotic pet care colorado springs, reptile care, bird care, ferret care, unusual pet services, specialized pet care"},"/ferret-sitter-colorado-springs":{title:"Ferret Sitter Colorado Springs | Specialized Ferret Care | CrittrCove",description:"Professional ferret sitting services in Colorado Springs. Experienced ferret sitters providing specialized care for your furry friends. Book trusted ferret care.",keywords:"ferret sitter colorado springs, ferret care, specialized pet care, exotic pet sitting"},"/bird-boarding-colorado-springs":{title:"Bird Boarding Colorado Springs | Avian Care Services | CrittrCove",description:"Professional bird boarding and avian care in Colorado Springs. Experienced bird sitters for parrots, canaries, and all feathered friends. Trusted bird care services.",keywords:"bird boarding colorado springs, avian care, bird sitters, parrot care, bird sitting services"},"/horse-sitting-colorado":{title:"Horse Sitting Colorado | Equine Care Services | CrittrCove",description:"Professional horse sitting and equine care throughout Colorado. Experienced horse sitters providing quality care for your horses. Trusted equine services.",keywords:"horse sitting colorado, equine care, horse sitters, horse boarding, equine services"},"/reptile-sitter-colorado-springs":{title:"Reptile Sitter Colorado Springs | Specialized Reptile Care | CrittrCove",description:"Expert reptile sitting services in Colorado Springs. Professional reptile sitters for snakes, lizards, and all cold-blooded pets. Specialized reptile care.",keywords:"reptile sitter colorado springs, snake care, lizard care, reptile sitting, specialized reptile care"},"/pet-boarding-colorado-springs":{title:"Pet Boarding Colorado Springs | All Pet Types Welcome | CrittrCove",description:"Comprehensive pet boarding services in Colorado Springs. Professional care for dogs, cats, exotic pets, and more. Trusted overnight pet care services.",keywords:"pet boarding colorado springs, all pet types, overnight pet care, professional pet boarding, animal care services"},"/dog-sitting-colorado-springs":{title:"Dog Sitting Colorado Springs | In-Home Dog Care | CrittrCove",description:"Professional dog sitting services in Colorado Springs. Reliable dog sitters providing in-home care and companionship for your dogs. Book trusted dog sitting.",keywords:"dog sitting colorado springs, in-home dog care, dog sitters, pet sitting services, canine care, professional dog care"}}[e]||{title:"CrittrCove - Professional Pet Care Services in Colorado Springs",description:"Find trusted pet care professionals in Colorado Springs. Dog walking, cat sitting, and exotic pet care services.",keywords:"pet care colorado springs, dog walking, cat sitting, exotic pet care, pet sitters"}),J=e=>{if("undefined"===typeof document)return;const t=G(e);document.title!==t.title&&(document.title=t.title);let o=document.querySelector('meta[name="description"]');o||(o=document.createElement("meta"),o.name="description",document.head.appendChild(o)),o.content=t.description;let n=document.querySelector('meta[name="keywords"]');n||(n=document.createElement("meta"),n.name="keywords",document.head.appendChild(n)),n.content=t.keywords,(0,U.debugLog)("MBA9999: Updated document metadata for SEO",{routePath:e,title:t.title,description:t.description})},$=()=>{const e=V(),t=q(),o=Y();return(0,U.debugLog)("MBA9999: Pre-rendering initialization",{isPreRendering:e,isBot:t,currentPath:o,userAgent:window.navigator.userAgent}),(e||t)&&J(o),{isPreRendering:e,isBot:t,currentPath:o}},K=(e,t=null)=>{try{if("function"===typeof window.gtag){const o=t||window.location.pathname;(0,U.debugLog)("MBA9999: Tracking page view",{routeName:e,pagePath:o,hostname:window.location.hostname}),window.gtag("event","page_view",{page_path:o,page_title:e})}else(0,U.debugLog)("MBA9999: gtag not available for page view tracking")}catch(o){(0,U.debugLog)("MBA9999: Error tracking page view",o)}},Z=()=>{{(0,U.debugLog)("MBA9999: Initializing Google Analytics tracking");const e=window.location.pathname,t="/"===e?"Home":e.split("/").pop()||"Home";K(t,e)}};var X=o(2772),Q=o(40484),ee=o(79632),te=o(16773),oe=o(95056),ne=o(16204),re=o(17438),ae=o(92288);const ie=i.default.create({container:{padding:20,width:"100%",maxWidth:1200,marginLeft:"auto",marginRight:"auto"},title:{fontSize:24,fontWeight:"bold",textAlign:"center",marginBottom:40,color:"black",fontFamily:m.theme.fonts.header.fontFamily},mobileContainer:{width:"100%",alignItems:"center",paddingVertical:20},mobileItemContainer:{width:"100%",alignItems:"center",marginBottom:80,position:"relative"},mobileMarker:{alignItems:"center",marginBottom:20},mobileMilestoneTitle:{fontSize:16,fontWeight:"bold",color:"black",marginTop:15,textAlign:"center",marginBottom:30},mobileDashedLine:{position:"absolute",width:2,height:60,bottom:-50,borderStyle:"dashed",borderWidth:1,borderColor:"#333"},webContainer:{position:"relative",marginTop:20,marginBottom:120,width:"100%"},dashedLine:{position:"absolute",height:2,top:30,borderStyle:"dashed",borderWidth:1,borderColor:"#333"},webMarker:{position:"absolute",alignItems:"center",width:120,transform:[{translateX:-60}]},webMilestoneTitle:{marginTop:10,fontSize:16,fontWeight:"bold",color:"black",textAlign:"center"},markerContainer:{width:60,height:60,borderRadius:30,justifyContent:"center",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:4,elevation:5},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",padding:20},modalContent:{backgroundColor:"white",padding:20,borderRadius:15,width:"90%",maxWidth:400,alignItems:"center"},modalIconContainer:{width:80,height:80,borderRadius:40,justifyContent:"center",alignItems:"center",marginBottom:20},modalNumber:{color:"white",fontSize:20,fontWeight:"bold",position:"absolute",top:10},modalTitle:{fontSize:24,fontWeight:"bold",marginBottom:15,color:"black",textAlign:"center",fontFamily:m.theme.fonts.header.fontFamily},modalDescription:{fontSize:18,textAlign:"center",marginBottom:20,color:"black",lineHeight:24,fontFamily:m.theme.fonts.regular.fontFamily},closeButton:{padding:12,borderRadius:8,width:"100%",alignItems:"center"},closeButtonText:{color:"white",fontSize:16,fontWeight:"bold"}}),se=()=>{const[e,t]=(0,n.useState)(null),[o,i]=(0,n.useState)(!1),{screenWidth:s}=(0,n.useContext)(h.AuthContext),l=s<768,d=[{id:1,title:"Prototype Launch",description:"Initial release of CrittrCove webpage and landing page with no signup or app functionality.",icon:"dog",color:m.theme.colors.mainColors.senary},{id:2,title:"Launch of MVP",description:"This is when users will be able to sign up and use the app fully for the first time on the website! For a full feature list, please check our blog or discord.",icon:"dragon",color:m.theme.colors.mainColors.quinary},{id:3,title:"Launch of App",description:"Mobile app release with real-time messaging, notifications, and payment integration. For a full feature list, please check our blog or discord.",icon:"cat",color:m.theme.colors.mainColors.quaternary},{id:4,title:"Community Features",description:"Adding social features, pet communities, and expert advice forums.",icon:"fish",color:m.theme.colors.mainColors.main}],c=e=>{t(e),i(!0)};return(0,j.jsxs)(r.default,{style:ie.container,children:[(0,j.jsx)(a.default,{style:ie.title,children:"Roadmap"}),l?(0,j.jsx)(r.default,{style:ie.mobileContainer,children:d.map(((e,t)=>(0,j.jsxs)(r.default,{style:[ie.mobileItemContainer,t===d.length-1?{marginBottom:0}:null],children:[(0,j.jsx)(v.default,{style:ie.mobileMarker,onPress:()=>c(e),children:(0,j.jsx)(r.default,{style:[ie.markerContainer,{backgroundColor:e.color}],children:(0,j.jsx)(ae.default,{name:e.icon,size:24,color:"white"})})}),(0,j.jsx)(a.default,{style:ie.mobileMilestoneTitle,children:e.title}),t<d.length-1&&(0,j.jsx)(r.default,{style:ie.mobileDashedLine})]},e.id)))}):(0,j.jsxs)(r.default,{style:ie.webContainer,children:[(0,j.jsx)(r.default,{style:[ie.dashedLine,{width:"80%",left:"10%"}]}),d.map(((e,t)=>(0,j.jsxs)(v.default,{style:[ie.webMarker,{left:"".concat(10+t*(80/(d.length-1)),"%")}],onPress:()=>c(e),children:[(0,j.jsx)(r.default,{style:[ie.markerContainer,{backgroundColor:e.color}],children:(0,j.jsx)(ae.default,{name:e.icon,size:24,color:"white"})}),(0,j.jsx)(a.default,{style:ie.webMilestoneTitle,children:e.title})]},e.id)))]}),(0,j.jsx)(k.default,{visible:o,transparent:!0,animationType:"fade",onRequestClose:()=>i(!1),children:(0,j.jsx)(r.default,{style:ie.modalOverlay,children:(0,j.jsx)(r.default,{style:ie.modalContent,children:e&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(r.default,{style:[ie.modalIconContainer,{backgroundColor:e.color}],children:[(0,j.jsx)(a.default,{style:ie.modalNumber,children:e.number}),(0,j.jsx)(ae.default,{name:e.icon,size:40,color:"white"})]}),(0,j.jsx)(a.default,{style:ie.modalTitle,children:e.title}),(0,j.jsx)(a.default,{style:ie.modalDescription,children:e.description}),(0,j.jsx)(v.default,{style:[ie.closeButton,{backgroundColor:e.color}],onPress:()=>i(!1),children:(0,j.jsx)(a.default,{style:ie.closeButtonText,children:"Close"})})]})})})})]})};var le=o(97584),de=o(19149);const ce="Pending Initial Professional Changes",ue="Pending Professional Changes",ge="Pending Owner Approval",me="Confirmed",he="Confirmed Pending Professional Changes",fe="Denied",pe="Cancelled",ye={version:"1.1",lastUpdated:"2025-08-06",terms:[{header:"Welcome to CrittrCove",body:"Welcome to CrittrCove! These Terms of Service ('Terms') create a binding legal agreement between you and CrittrCove LLC, a Colorado-based company ('we,' 'us,' or 'our'). By using our platform, mobile apps, website, or any other CrittrCove services (collectively, the 'Platform'), you're agreeing to these Terms. If you don't agree, please don't use our services. We may update these Terms from time to time, and continued use means you accept any changes. You can find our current Terms at https://www.crittrcove.com/terms-of-service/."},{header:"What CrittrCove Does",subsections:[{subtitle:"Our Platform's Purpose",body:"CrittrCove connects pet owners with professional pet care providers. We're a marketplace platform that facilitates introductions, communications, and service arrangements between pet owners and service providers. Think of us as the digital bridge that helps you find trusted care for your beloved pets."},{subtitle:"We're Not Your Pet Care Provider",body:"Important: CrittrCove doesn't provide pet care services ourselves. We're the platform that connects you with independent professionals who do. Each service provider operates their own business and makes their own decisions about how to care for your pets. While we help facilitate connections and provide support resources, the actual pet care is between you and your chosen provider."},{subtitle:"What We Do Provide",body:"We may offer emergency support, educational resources for providers, safety guidelines, and tools to help you find and communicate with pet care professionals. We also facilitate optional background checks for service providers and provide a platform for reviews and recommendations."},{subtitle:"Your Responsibility for Safety",body:"You're responsible for making smart decisions about pet care. While we provide tools and information to help you choose wisely, you should always use your judgment, ask questions, and ensure your pets' vaccinations and health records are current. We can't guarantee the quality of any specific service provider."}]},{header:"Legal Compliance & User Responsibilities",subsections:[{subtitle:"Age and Legal Requirements",body:"You must be at least 18 years old (or the age of majority in your area) to use CrittrCove. You're responsible for following all applicable laws and regulations related to your activities on our platform."},{subtitle:"Pet Owner Responsibilities",body:"As a pet owner, you must ensure your pets are properly vaccinated, licensed, and identified as required by local laws. You should also maintain appropriate insurance coverage for your pets and disclose any behavioral or health concerns to service providers."},{subtitle:"Service Provider Responsibilities",body:"As a service provider, you must have all necessary business licenses, permits, and insurance required by your jurisdiction. You're responsible for complying with local pet care regulations, leash laws, waste disposal rules, and any other applicable requirements."},{subtitle:"Exotic and Farm Animal Care",body:"CrittrCove welcomes providers who care for exotic animals, farm animals, and livestock, provided they have appropriate experience, facilities, and permits. However, pet owners must disclose if they have animals with dangerous behaviors or species requiring special handling, and service providers should only accept bookings within their expertise and qualifications. CrittrCove strictly prohibits the arrangement of care for illegal species through our platform or those without the proper permiting and licensing. CrittrCove is not liable for any injuries, damages, or losses that occur during pet care services. We're not liable for any actions taken by service providers or pet owners during service provision. CrittrCove is not liable for decisions made by providers during emergency medical care."}]},{header:"User Conduct & Platform Rules",subsections:[{subtitle:"What You Can Do",body:"Use our platform to find and connect with pet care providers, communicate about services, arrange bookings, and share honest reviews. Be respectful, honest, and professional in all your interactions."},{subtitle:"What You Cannot Do",body:"Don't use our platform for illegal activities, harassment, or fraud. Don't post false information, spam, or inappropriate content. Don't try to circumvent our platform for payments (outside of beta) or arrange services outside our system. Don't create multiple accounts or impersonate others."},{subtitle:"Content Standards",body:"Any content you post must be accurate, respectful, and legal. No hate speech, threats, or inappropriate material. We reserve the right to remove content that violates our standards."},{subtitle:"Payment Processing",body:"When we launch payment processing, CrittrCove will be a limited payment agent for the provider (not a principal). We will specify refund handling, dispute channels, and timing of disbursement. We will also reassess risk of chargebacks and integrate Stripe/third-party payment terms. We also reserve the right to change which payment processor we use at any time - whether internally or through a third-party provider."},{subtitle:"Account Security",body:"Keep your account credentials secure and notify us immediately if you suspect unauthorized access. You're responsible for all activity under your account."}]},{header:"Service Arrangements & Bookings",subsections:[{subtitle:"How Bookings Work",body:"When you find a service provider you like, you can request a booking through our platform. The provider will review your request and either accept, decline, or suggest modifications. Once both parties agree, you have a confirmed booking."},{subtitle:"Pricing and Payments",body:"During our beta period, CrittrCove doesn't process payments or charge service fees. All payments are handled directly between you and your service provider using your preferred method (cash, Venmo, etc.). We reserve the right to implement payment processing and service fees in the future."},{subtitle:"Cancellation Policies",body:"Cancellation policies are set by individual service providers and discussed through our messaging system. Make sure you understand the provider's policy before confirming a booking. We encourage open communication about any changes or concerns."},{subtitle:"Service Completion",body:"Service providers mark bookings as complete once the service period ends. This helps maintain accurate records and enables proper review systems."}]},{header:"Emergency Situations & Pet Safety",subsections:[{subtitle:"Emergency Contact Information",body:"Pet owners should provide emergency contact information and ensure service providers can reach them if needed. Service providers should immediately contact pet owners (or if unreachable, their emergency contacts) in emergency situations."},{subtitle:"Veterinary Care Authorization",body:"By using our platform, pet owners authorize service providers to seek emergency veterinary care if the pet owner or emergency contact cannot be reached. Pet owners are responsible for all veterinary costs and authorize service providers to make emergency decisions. If a provider oversteps or delays in any way, CrittrCove is not liable for any damages or losses or any other issues that may arise."},{subtitle:"Abandoned Pets",body:"If a pet owner fails to retrieve their pet after the agreed service period, service providers may take appropriate action including contacting animal control or finding alternative care. Pet owners are responsible for all associated costs."},{subtitle:"Pet Safety and Removal",body:"CrittrCove reserves the right to remove pets from service providers' care if safety concerns arise. We'll attempt to contact pet owners and emergency contacts before taking such action."},{subtitle:"CrittrCove's Responsibility",body:"CrittrCove is not responsible for any injuries, damages, or losses that occur during pet care services. We're not liable for any actions taken by service providers or pet owners during service provision. CrittrCove is not liable for decisions made by providers during emergency medical care. We recomment that service providers procure necessary insurance, and background checks. We also recommend that pet owners ensure their pets are properly vaccinated and licensed, and search for service providers with insurance and background check badges as displayed in the search results."}]},{header:"Background Checks & Verification",subsections:[{subtitle:"Optional Background Checks",body:"CrittrCove offers optional background check services for service providers through third-party vendors. These checks are voluntary but highly recommended for pet owner safety and trust."},{subtitle:"How Background Checks Work",body:"Service providers can request background checks through our contact form. We'll provide a secure link to complete the verification process through our third-party provider. Results are displayed on provider profiles to help pet owners make informed decisions."},{subtitle:"Limitations of Background Checks",body:"Background checks have limitations and may not include all jurisdictions, juvenile records, or foreign convictions. They're not a substitute for your own due diligence and judgment when selecting service providers."},{subtitle:"Your Authorization",body:"By undergoing a background check, you authorize the collection and use of your information by our third-party verification provider. You agree to provide accurate information and understand that CrittrCove may rely on these results for platform decisions."}]},{header:"Reviews & Community Guidelines",subsections:[{subtitle:"Honest Reviews",body:"We encourage honest, constructive reviews based on your actual experiences. Reviews help our community make informed decisions and improve service quality."},{subtitle:"Review Standards",body:"Reviews must be truthful, respectful, and based on personal experience. No false claims, harassment, or inappropriate content. We may remove reviews that violate our standards."},{subtitle:"Review Ownership",body:"You retain ownership of your reviews but grant CrittrCove a license to use, display, and share them as part of our platform. We may remove reviews at our discretion."}]},{header:"Content & Intellectual Property",subsections:[{subtitle:"Your Content",body:"You own the content you create on our platform. By posting content, you grant CrittrCove a license to use it for platform operations and improvements. You're responsible for ensuring you have rights to any content you share."},{subtitle:"Our Platform",body:"CrittrCove owns all rights to our platform, technology, and brand. You may use our services as intended but may not copy, modify, or distribute our proprietary materials without permission."},{subtitle:"Copyright Protection",body:"If you believe your copyrighted work has been infringed on our platform, please contact us with detailed information including your contact details, description of the work, and location of the infringing material. Send notices to: CrittrCove LLC, Attn: Copyright Notice, 2510 Summit Dr, Colorado Springs, CO, 80909."},{subtitle:"CrittrCove's Name, Logo, and Branding",body:"You may not use the CrittrCove name, logo, or branding without our prior written consent."}]},{header:"Privacy & Data Protection",body:"We take your privacy seriously. Our collection and use of your personal information is described in our Privacy Policy at https://www.crittrcove.com/privacy-policy/. By using our platform, you acknowledge that you've read and understand our Privacy Policy."},{header:"Communications & Notifications",subsections:[{subtitle:"Service Communications",body:"You consent to receive communications from CrittrCove about your account, bookings, platform updates, and service-related information. These may include emails, text messages, and in-app notifications."},{subtitle:"Marketing Communications",body:"You may opt out of marketing communications at any time through your account settings or by contacting us. Service-related communications are required for platform functionality."},{subtitle:"Contact Information Updates",body:"Keep your contact information current. If you change your phone number or email, update your account promptly to ensure you receive important communications."}]},{header:"Limitations & Disclaimers",subsections:[{subtitle:"Service Availability",body:"We strive to provide reliable service but can't guarantee uninterrupted access. Our platform is provided 'as is' and may have occasional downtime for maintenance or updates."},{subtitle:"Third-Party Services",body:"We may use third-party services for payments, background checks, mapping, and other features. We're not responsible for these services' availability, accuracy, or content."},{subtitle:"User Interactions",body:"We're not responsible for disputes between users, the quality of pet care services, or any harm that occurs during service provision. Users are responsible for their own safety and decisions."},{subtitle:"Liability Limits",body:"To the maximum extent permitted by law, CrittrCove's liability is limited to $100 USD. We're not liable for indirect, consequential, or punitive damages."}]},{header:"Dispute Resolution",subsections:[{subtitle:"Informal Resolution",body:"We prefer to resolve issues amicably. Before pursuing formal dispute resolution, please contact us with details about your concern. We'll work with you to find a solution."},{subtitle:"Arbitration Agreement",body:"For most disputes, you and CrittrCove agree to resolve them through individual arbitration rather than court proceedings. This means disputes will be heard by a neutral arbitrator, not a judge or jury."},{subtitle:"Class Action Waiver",body:"You agree to bring claims only on an individual basis, not as part of a class action or representative proceeding. This helps keep dispute resolution efficient and fair."},{subtitle:"Opt-Out Rights",body:"You can opt out of arbitration within 30 days of accepting these Terms by mailing a written notice to CrittrCove LLC, Attn: Legal, 2510 Summit Dr, Colorado Springs, CO, 80909."}]},{header:"Legal Framework",subsections:[{subtitle:"Governing Law",body:"These Terms are governed by Colorado law for US users and English law for EEA/UK users. The Federal Arbitration Act governs our arbitration agreement."},{subtitle:"Jurisdiction",body:"For US users, disputes will be resolved in Colorado courts. For EEA users, disputes will be resolved in English courts or your local courts as applicable."},{subtitle:"Severability",body:"If any part of these Terms is found unenforceable, the remaining parts continue in effect. We'll work to replace unenforceable provisions with valid alternatives."},{subtitle:"Entire Agreement",body:"These Terms, along with our Privacy Policy, constitute the complete agreement between you and CrittrCove regarding our platform."}]},{header:"Force Majeure",body:"CrittrCove is not liable for delays or failures caused by events beyond our reasonable control, including natural disasters, war, terrorism, pandemics, strikes, or government actions. During such events, normal cancellation policies may not apply."},{header:"Indemnification",body:"You agree to defend and hold harmless CrittrCove from any claims, damages, or expenses arising from your use of our platform, violation of these Terms, or interactions with other users."},{header:"Account Termination",body:"We may suspend or terminate accounts for violations of these Terms, harmful conduct, or other reasons at our discretion. Termination doesn't affect your obligations under these Terms. We may also suspend or terminate accounts for non-payment of fees or other charges. Repeated violations of review standards, safety rules, or off-platform solicitation may result in permanent bans"},{header:"Changes to Terms",body:"We may update these Terms from time to time. We'll notify you of significant changes, and continued use of our platform constitutes acceptance of updated Terms."},{header:"Account Deletion and Data Management",body:"You have the right to request deletion of your CrittrCove account and associated data at any time. To request account deletion, please hit the delete account button in your profile settings. Please email support@crittrcove.com with your request to remove any other additional information. We will verify your identity and process your deletion request within 60 days of verification. Please note that certain data may be retained for legal compliance and business purposes:",subsections:[{subtitle:"Data Retention After Deletion",body:"Financial records (invoices, payments) may be retained for up to 7 years for tax and legal compliance. Booking records may be retained for 3-5 years for business purposes and dispute resolution. Communication records may be retained for up to 2 years for legal protection. Some data may be anonymized rather than deleted to maintain platform analytics and safety."},{subtitle:"Important Notes",body:"Account deletion is irreversible once processing is complete. You acknowledge that complete data removal may not be technically feasible for all systems and backups. Anonymized data that cannot identify you may remain in our systems indefinitely."}]},{header:"Contact Us",body:"Questions about these Terms? Contact us at support@crittrcove.com or write to CrittrCove LLC, 2510 Summit Dr, Colorado Springs, CO, 80909."}]},be={version:"1.1",title:"CrittrCove Privacy Policy",lastUpdated:"8/6/2025",introduction:'Welcome to CrittrCove! Your privacy matters to us. This Privacy Policy explains how CrittrCove LLC ("CrittrCove," "we," "our," or "us") collects, uses, and protects your personal information when you use our services, including our website, mobile apps, and any platform features related to connecting pet owners with animal care providers (the "Services").',sections:[{title:"What This Policy Covers",content:"This Privacy Policy applies to:",listItems:["Users who visit our website or app","Pet owners and pet care providers or businesses using our Services","Any data collected during interactions with our Services, support tools, or beta features"],additionalInfo:"This policy does not apply to third-party platforms we link to or integrate with. Those sites have their own policies."},{title:"Information We Collect",subsections:[{subtitle:"Information You Provide Directly",items:["Account Info: Information includes, but is NOT limited to: Your name, email, phone, zip code, pet types, availability, photos, and profile descriptions.","Communication Content: Messages between users or with us.","Forms & Feedback: Survey responses, support inquiries, or beta testing feedback."]},{subtitle:"Information We Collect Automatically",items:["Device Info: IP address, browser type, OS, and device ID.","Usage Data: Pages visited, actions on the app, error logs.","Location Info: We may use your location to show local pet service options. You agree that CrittrCove may grab your approximate location for timezones."]},{subtitle:"Data From Others",content:"We may receive limited information about you from:",items:["Social Logins (if enabled)","Referral sources","Background checks (when implemented in the future for professionals)"],additionalInfo:"We do not currently collect sensitive data like social security numbers, government IDs, or health info during beta (except for health info entered in about your pets). After beta, we will be collecting credit card numbers, but using stripe, so only the last 4 digits will be recorded."}]},{title:"How We Use Your Information",content:"We use the data we collect to:",listItems:["Let you create and manage your profile","Match you with other users (clients or professionals)","Improve the app and monitor performance","Send optional updates, news, or promotional content (you can opt out via settings)","Prevent fraud or abuse of the platform"],additionalInfo:"We may analyze trends and usage patterns to enhance functionality but do not sell your personal information."},{title:"Sharing of Information",content:"We may share limited information:",listItems:["Between users for service coordination (examples, but not limited to: pet name, general location, messages)","With service providers that help us run the platform (e.g., email providers, hosting companies)","When legally required, such as to respond to law enforcement or court orders"],additionalInfo:"We may also share aggregated or anonymized data for research or marketing purposes that cannot be traced back to individuals."},{title:"Your Rights & Choices",content:"You can:",listItems:["Edit or delete your profile information at any time","Request deletion of your account by pressing the delete button in profile settings.","Request deletion of specific private messages by contacting support.","Decline location tracking in your device settings or by contacting support.",'Opt out of non-essential emails by clicking "unsubscribe" in messages for the marketing communications.'],additionalInfo:"During beta, some opt-out or privacy tools may not yet be live. We're working to expand these features before full launch. If you are using this app during beta you agree that is ok and you will not have any right to sue for things like that or things we are lacking."},{title:"Security of Your Data",content:"We use reasonable safeguards to protect your data from unauthorized access or misuse. However, no platform is completely secure. Please:",listItems:["Use a strong password","Log out after using shared devices","Contact us immediately if you suspect unauthorized activity"]},{title:"Data Storage & Retention",content:"Data is stored in the U.S. or other regions where our systems are hosted. We retain different types of information for different periods based on legal requirements and business needs:",listItems:["Personal profile information: Retained while your account is active","Financial records: Up to 7 years for tax and legal compliance","Booking and service records: 3-5 years for business purposes and dispute resolution","Communication records: Up to 2 years for legal protection","Analytics and usage data: May be anonymized and retained indefinitely"],additionalInfo:"If you delete your account, your data will be processed according to our deletion procedures outlined below."},{title:"Data Deletion and Your Rights",content:"You have the right to request deletion of your CrittrCove account and associated personal data. To request account deletion:",listItems:["Select delete account button in settings of your profile.","Email support@crittrcove.com with your deletion request.","We will verify your identity for security purposes via email.","Deletion will be processed within 60 days of verification"],subsections:[{subtitle:"What Gets Deleted vs. Retained",content:"While we delete personal identifiers and profile information, certain data may be retained or anonymized:",items:["Retained: Financial records for legal compliance, booking records in messages for business purposes, communication records for legal protection","Anonymized: Usage patterns and platform analytics that cannot identify you. user name and email are anonymized.","Deleted: Personal profile information, contact details"]}],additionalInfo:"Account deletion is irreversible once processing is complete. Some technical limitations may prevent complete removal of some things from all backup systems immediately."},{title:"Children's Privacy",content:"CrittrCove is not intended for users under the age of 18. We do not knowingly collect data from minors. If you believe a child is using our platform, contact us so we can take action."},{title:"Changes to This Policy",content:"We may update this Privacy Policy from time to time. If major changes are made, we'll notify you via email or app notification. Continued use of the Services means you accept any changes."},{title:"Contact Us",content:"If you have questions or requests related to your privacy, contact us at:",contactInfo:{company:"CrittrCove LLC",attention:"Attn: Privacy Team",address:"2510 Summit Dr, Colorado Springs, CO, 80909",email:"support@crittrcove.com"}}]},xe="All Services",ve=["Overnight Sitting - Owner's Home","Overnight Boarding","Drop-In Visits","Dog Walking","Day Care","Pet Boarding","Exotic Pet Care","Daytime Pet Sitting","Ferrier","Grooming","Training","Pet Sitting","Pet Taxi","Pet Sitting"],we={"Per Visit":"Per Visit","Per Day (24 Hours)":"Per Day","Per Night":"Per Night","Every 15 Minutes":"15 Min","Every 30 Minutes":"30 Min","Every 45 Minutes":"45 Min","Per Hour":"1 Hour","Every 2 Hours":"2 Hour","Every 3 Hours":"3 Hour","Every 4 Hours":"4 Hour","Every 5 Hours":"5 Hour","Every 6 Hours":"6 Hour","Every 7 Hours":"7 Hour","Every 8 Hours":"8 Hour","Per Week":"Week"},Ce=Object.entries(we).reduce(((e,[t,o])=>(e[o]=t,e)),{}),Se={"Fish Tank Cleaning":[{title:"Extended Stay (7+ days)",amount:15},{title:"Pickup/Dropoff Service",amount:25},{title:"Special Diet Handling",amount:10},{title:"Medication Administration",amount:15}],Ferrier:[{title:"Extended Hours",amount:20},{title:"Training Session",amount:30},{title:"Grooming",amount:25}],"Dog Walking":[{title:"Extra 15 Minutes",amount:10},{title:"Plant Watering",amount:5},{title:"Photo Updates",amount:5}],"Reptile Boarding & Habitat Maintenance":[{title:"Plant Watering",amount:10},{title:"Mail Collection",amount:5},{title:"Extended Visit (4+ hrs)",amount:30}],"Bird Feeding":[{title:"Extra 15 Minutes",amount:10},{title:"Multiple Route Options",amount:5},{title:"Training During Walk",amount:20}]},je=[{id:1,name:"Fish Tank Cleaning",startingPrice:25,animalTypes:["Fish"],icon:"fish",additionalRates:Se["Fish Tank Cleaning"]},{id:2,name:"Ferrier",startingPrice:30,animalTypes:["Dogs"],icon:"horse",additionalRates:Se.Ferrier},{id:3,name:"Dog Walking",startingPrice:40,animalTypes:["Dogs"],icon:"dog",additionalRates:Se["Dog Walking"]},{id:4,name:"Reptile Boarding & Habitat Maintenance",startingPrice:35,animalTypes:["Reptiles"],icon:"snake",additionalRates:Se["Reptile Boarding & Habitat Maintenance"]},{id:5,name:"Bird Feeding",startingPrice:45,animalTypes:["Birds"],icon:"bird",additionalRates:Se["Bird Feeding"]}],Te=[{id:"1",name:"Max",animal_type:"Dog",breed:"border collie",age:{months:0,years:5},weight:32,sex:"Male",friendlyWithChildren:!0,friendlyWithCats:!1,friendlyWithDogs:!0,spayedNeutered:!0,houseTrained:!0,microchipped:!0,adoptionDate:"2020-01-15",description:"Loves to play fetch and go for walks.",energyLevel:"High",feedingSchedule:"Morning",leftAlone:"1-4 hours",medication:null,additionalInstructions:"Needs daily exercise.",vetName:"Dr. Smith",vetAddress:"123 Vet St.",vetPhone:"555-1234",insuranceProvider:"Pet Insurance Co.",vetDocuments:[],galleryImages:[]},{id:"2",name:"Whiskers",animal_type:"Cat",breed:"tammy ammy",age:{months:3,years:4},weight:16,sex:"Female",friendlyWithChildren:!0,friendlyWithCats:!0,friendlyWithDogs:!1,spayedNeutered:!0,houseTrained:!0,microchipped:!1,adoptionDate:"2019-05-20",description:"Enjoys lounging in the sun.",energyLevel:"Low",feedingSchedule:"Twice a day",leftAlone:"4-8 hours",medication:null,additionalInstructions:"Prefers quiet environments.",vetName:"Dr. Jones",vetAddress:"456 Vet Ave.",vetPhone:"555-5678",insuranceProvider:"Pet Health Insurance",vetDocuments:[],galleryImages:[]},{id:"3",name:"Buddy",animal_type:"snake",breed:"leopard gecko",age:{months:0,years:2},weight:1,sex:"Male",friendlyWithChildren:!1,friendlyWithCats:!1,friendlyWithDogs:!1,spayedNeutered:!1,houseTrained:!1,microchipped:!1,adoptionDate:"2021-08-10",description:"A calm and quiet pet.",energyLevel:"Low",feedingSchedule:["Custom","3 times a day with liquid food."],leftAlone:"Can be left alone indefinitely",medication:null,additionalInstructions:"Keep in a warm environment.",vetName:"Dr. Green",vetAddress:"789 Vet Blvd.",vetPhone:"555-9012",insuranceProvider:"Reptile Insurance Co.",vetDocuments:[],galleryImages:[]}],Be=(o(81029),o(53198),o(52695),o(30552),o(51681),o(10602),o(26163),o(244),o(21373),o(24289),[{id:"1",name:"Alice Johnson",pet_types:["Dog","Cat"],last_booking:"2024-01-15",pets:["1","2"],email:"alice@example.com",phone:"555-0101",address:"123 Pine St, Colorado Springs, CO"},{id:"2",name:"Bob Wilson",pet_types:["Dog"],last_booking:"2024-02-01",pets:["3"],email:"bob@example.com",phone:"555-0102",address:"456 Oak Ave, Colorado Springs, CO"},{id:"3",name:"Carol Martinez",pet_types:["Cat","Exotic"],last_booking:"2024-01-28",pets:["4","5"],email:"carol@example.com",phone:"555-0103",address:"789 Maple Dr, Colorado Springs, CO"},{id:"4",name:"David Brown",pet_types:["Dog"],last_booking:"2024-02-05",pets:["6"],email:"david@example.com",phone:"555-0104",address:"321 Elm St, Colorado Springs, CO"},{id:"5",name:"Eva Garcia",pet_types:["Exotic"],last_booking:"2024-01-20",pets:["7"],email:"eva@example.com",phone:"555-0105",address:"654 Birch Ln, Colorado Springs, CO"}]),ke={booking_id:"bk1",status:"Confirmed",owner_name:"matt aertker",professional_name:"matt2 aertker2",service_details:{service_type:"Ferrier"},pets:[{pet_id:3,name:"Jack",species:"DOG",breed:"Golden"}],occurrences:[{occurrence_id:10,start_date:"2025-02-01",end_date:"2025-02-02",start_time:"15:06",end_time:"16:06",calculated_cost:"61.04",base_total:"$26.04",rates:{base_rate:"25.00",additional_animal_rate:"5.00",additional_animal_rate_applies:!1,applies_after:2,unit_of_time:"PER_DAY",holiday_rate:"35.00",holiday_days:0,additional_rates:[{title:"Extra Travel Time Rate",description:"Far Drive rate for service",amount:"$25.00"},{title:"Dog Poops Inside Rate",description:"Dog Poops Inside rate for service",amount:"$5.00"},{title:"Dog Separation rate",description:"When we need to separate the dog from other animals in the house",amount:"$5.00"}]}},{occurrence_id:9,start_date:"2025-03-13",end_date:"2025-03-14",start_time:"09:00",end_time:"14:00",calculated_cost:"120.08",base_total:"$35.04",rates:{base_rate:"29.00",additional_animal_rate:"8.00",additional_animal_rate_applies:!1,applies_after:1,unit_of_time:"PER_DAY",holiday_rate:"40.00",holiday_days:0,additional_rates:[{title:"Extra Travel Time Rate",description:"Far Drive rate for service",amount:"$25.00"},{title:"Dog Poops Inside Rate",description:"Dog Poops Inside rate for service",amount:"$25.00"},{title:"Dog Separation rate",description:"When we need to separate the dog from other animals in the house",amount:"$35.04"}]}}],cost_summary:{subtotal:181.12,platform_fee:18.11,taxes:15.94,total_owner_cost:215.17,total_sitter_payout:163.01,is_prorated:!0}},Ae={1234:Object.assign({},ke,{id:"1234",ownerName:"John Doe",status:me,startDate:"2024-02-20",startTime:"14:00"}),5678:Object.assign({},ke,{id:"5678",ownerName:"Margarett Laporte",status:pe,startDate:"2024-02-21",startTime:"15:30"}),56782:Object.assign({},ke,{id:"56782",ownerName:"Zoe Aerial",status:fe,startDate:"2024-02-21",startTime:"15:30"}),5673:Object.assign({},ke,{id:"5673",ownerName:"Matt Clark",status:ce,startDate:"2024-02-21",startTime:"15:30"}),5674:Object.assign({},ke,{id:"5674",ownerName:"Mark Smith",status:ge,startDate:"2024-02-21",startTime:"15:30"}),5675:Object.assign({},ke,{id:"5675",ownerName:"Lauren Smith",status:ue,startDate:"2024-02-21",startTime:"15:30"}),5675:Object.assign({},ke,{id:"56712",ownerName:"Matt Smith",status:he,startDate:"2024-02-21",startTime:"15:30"}),56713:Object.assign({},ke,{id:"567123",ownerName:"Albert Einstein",status:ce,startDate:"2025-02-21",startTime:"15:30"}),3749:Object.assign({},ke,{id:"567132",ownerName:"Dr. Mike Johnson",status:ce,startDate:"2025-02-21",startTime:"15:30"}),91011:Object.assign({},ke,{id:"91011",ownerName:"Dr. Bla Johnson",status:ce,startDate:"2025-02-21",startTime:"15:30"}),91012:Object.assign({},ke,{id:"91012",ownerName:"Dr. Blabla Johnson",status:ce,startDate:"2025-02-21",startTime:"15:30"})},_e=(Object.values(Ae).map((e=>({id:e.id,ownerName:e.ownerName,status:e.status,date:e.startDate,time:e.startTime,serviceType:e.serviceType,numberOfPets:e.numberOfPets||1,totalCost:e.costs?.totalOwnerCost||0,professionalPayout:e.costs?.professionalPayout||0}))),101),Ie=[{id:"conv_1",participant1_id:_e,participant2_id:202,name:"Dr. Sarah Smith",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"I'd be happy to help! What kind of pet do you have?",timestamp:"2024-02-21T07:05:00Z",unread:!1},{id:"conv_2",participant1_id:303,participant2_id:_e,name:"Dr. Mike Johnson",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"I'm available! Let's set up a booking",timestamp:"2024-02-21T15:35:00Z",unread:!1},{id:"conv_3",participant1_id:_e,participant2_id:204,name:"Dr. Emily Wilson",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Your cat's checkup is scheduled",timestamp:"2024-02-20T10:15:00Z",unread:!0},{id:"conv_4",participant1_id:_e,participant2_id:205,name:"Dr. James Anderson",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"See you tomorrow at 2 PM",timestamp:"2024-02-19T16:45:00Z",unread:!1},{id:"conv_5",participant1_id:_e,participant2_id:206,name:"Dr. Lisa Brown",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"How is Max doing today?",timestamp:"2024-02-18T09:30:00Z",unread:!1},{id:"conv_6",participant1_id:_e,participant2_id:207,name:"Dr. Robert Taylor",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"The medication has been prescribed",timestamp:"2024-02-17T14:20:00Z",unread:!1},{id:"conv_7",participant1_id:_e,participant2_id:208,name:"Dr. Maria Garcia",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Your appointment is confirmed",timestamp:"2024-02-16T11:25:00Z",unread:!0},{id:"conv_8",participant1_id:_e,participant2_id:209,name:"Dr. David Lee",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Let's schedule a follow-up",timestamp:"2024-02-15T13:40:00Z",unread:!1},{id:"conv_9",participant1_id:_e,participant2_id:210,name:"Dr. Sarah Martinez",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"The test results are ready",timestamp:"2024-02-14T15:55:00Z",unread:!1},{id:"conv_10",participant1_id:_e,participant2_id:211,name:"Dr. John White",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"How's the new diet working?",timestamp:"2024-02-13T08:15:00Z",unread:!1},{id:"conv_11",participant1_id:_e,participant2_id:212,name:"Dr. Anna Clark",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Vaccination reminder",timestamp:"2024-02-12T10:30:00Z",unread:!0},{id:"conv_12",participant1_id:_e,participant2_id:213,name:"Dr. Thomas Wright",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Surgery scheduled for next week",timestamp:"2024-02-11T12:45:00Z",unread:!1},{id:"conv_13",participant1_id:_e,participant2_id:214,name:"Dr. Patricia Moore",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Emergency consultation available",timestamp:"2024-02-10T17:20:00Z",unread:!1},{id:"conv_14",participant1_id:_e,participant2_id:215,name:"Dr. Kevin Hall",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Treatment plan updated",timestamp:"2024-02-09T14:10:00Z",unread:!1},{id:"conv_15",participant1_id:_e,participant2_id:216,name:"Dr. Rachel Green",role_map:{participant1_role:"owner",participant2_role:"professional"},lastMessage:"Prescription ready for pickup",timestamp:"2024-02-08T16:35:00Z",unread:!0}],Me={conv_1:[{message_id:1,participant1_id:_e,participant2_id:202,sender:_e,role_map:{participant1_role:"owner",participant2_role:"professional"},content:"Hi, I'm interested in your pet sitting services",timestamp:"2024-02-21T14:00:00Z",booking_id:null,status:"read",is_booking_request:!1,metadata:{}},{message_id:2,participant1_id:_e,participant2_id:202,sender:202,role_map:{participant1_role:"owner",participant2_role:"professional"},content:"I'd be happy to help! What kind of pet do you have?",timestamp:"2024-02-21T14:05:00Z",booking_id:null,status:"sent",is_booking_request:!1,metadata:{}}],conv_2:[{message_id:3,participant1_id:303,participant2_id:_e,sender:303,role_map:{participant1_role:"owner",participant2_role:"professional"},content:"Looking for a dog walker next week",timestamp:"2024-02-21T15:30:00Z",booking_id:null,status:"read",is_booking_request:!1,metadata:{}},{message_id:4,participant1_id:303,participant2_id:_e,sender:303,role_map:{participant1_role:"owner",participant2_role:"professional"},type:"booking_request",data:{serviceType:"Dog Walking",pets:[{id:"1",name:"Max",type:"Dog",breed:"Golden Retriever"}],occurrences:[{startDate:"2024-02-28",endDate:"2024-02-28",startTime:"14:00",endTime:"15:00"}]},timestamp:"2024-02-21T15:35:00Z",status:"sent",is_booking_request:!0,metadata:{}},{message_id:5,participant1_id:303,participant2_id:_e,sender:_e,role_map:{participant1_role:"owner",participant2_role:"professional"},content:"I'll take a look!",timestamp:"2024-02-21T15:30:00Z",booking_id:null,status:"read",is_booking_request:!1,metadata:{}}]},Le=[{id:"blog_1",title:"What Your Dog is Really Saying: Decoding Canine Body Language",author:{id:"author_1",name:"Zoe Neale",profilePicture:o(58162),bio:"Professional dog trainer and animal behavior specialist with over 10 years of experience in canine communication and training."},publishDate:"2025-07-25",readTime:"8 min read",tags:["Dogs","Behavior","Training","Pet Care","Communication"],content:"You know that moment when your dog tilts their head at you like you just asked them to solve a calculus problem? Turns out, they're not the only ones trying to understand you\u2014they've been communicating with you this whole time, and you probably didn't even realize it.\n\nDogs may not speak English (yet\u2014give them time), but they have an entire language built on tail wags, ear positions, and those big, soulful eyes they use to manipulate you into giving them extra treats. Learning to read their body language isn't just a party trick\u2014it can help prevent stress, deepen your bond, and maybe even stop your dog from embarrassing you at the dog park. So, let's finally crack the code on what your dog has been trying to tell you.\n\n## Tail Wagging: Not Always a Sign of Happiness\n\nOne of the biggest myths out there is that a wagging tail means a happy dog. Nope. Not always. A dog's tail is basically their mood ring, and the way they wag tells a whole different story.\n\n- **Loose, full-body wag (with bonus butt wiggles)**: This is the classic \"OMG YOU'RE HOME!!\" happy dance. A+ vibes.\n- **Slow wag, tail held high**: The \"I'm analyzing this situation\" wag. Suspicious, calculating, possibly deciding if you're worth their energy.\n- **Stiff, fast wag with a raised tail**: Yikes. This is \"I'm on edge, don't mess with me\" energy. Proceed with caution.\n- **Low, fast wag**: \"I'm nervous, and I don't know what's happening, so I'm just gonna keep wiggling and hope for the best.\"\n- **Tucked tail**: Fear. If the tail is all the way tucked under, your dog is basically saying, \"I regret everything, please don't yell at me.\"\n\nEven the direction of the wag matters\u2014researchers found that dogs wag more to the right when they're happy and to the left when they're unsure or stressed (Quaranta et al., 2007). Yes, your dog's tail literally has anxiety tells.\n\n## Ears and Eyes: The Silent Storytellers\n\nDogs don't just talk with their tails\u2014they also use their ears and eyes like tiny, furry actors in a silent film.\n\n- **Soft eyes, relaxed ears**: Your dog is living their best life. No stress, just vibes.\n- **Wide eyes, whites showing (a.k.a. \"whale eye\"**: \"I am uncomfortable with the energy we have created in this room.\" This is a warning sign\u2014your dog feels uneasy or trapped.\n- **Perked-up ears**: \"I heard something, and I will investigate.\" Could be excitement, curiosity, or them preparing to bark at absolutely nothing.\n- **Ears pinned back**: \"I'm nervous\" or \"I did something bad, and I hope you don't notice.\" Classic guilty dog move.\n\nEver notice how some dogs do a little squint when they're happy? It's their version of a smile. On the flip side, prolonged direct eye contact\u2014especially with an unfamiliar dog\u2014can be a challenge. So, if you're having a staring contest with a dog you just met\u2026maybe don't.\n\n## The Freeze: When Your Dog Hits Pause (And You Should Pay Attention)\n\nIf a dog suddenly stops moving and stiffens, pay attention. Freezing is often their last warning before things escalate to growling, snapping, or biting. A lot of people miss this and then wonder why their dog \"suddenly\" lashed out.\n\nYou might see this when:\n- A child is hugging a dog (which, fun fact, most dogs hate).\n- Someone is petting a dog too aggressively.\n- The dog feels cornered and has no escape route.\n\nResearch by Rooney, Clark and Casey (2016) helped show that when a dog freezes, in some way or another they are stressed. It's best to give them space in that moment and take a mental note of your newest training goal! Sometimes, they just need a minute to de-escalate, like when you have to breathe through a customer service call that's not going well.\n\n## Mouth Matters: Smiles vs. Stress\n\nDogs can technically smile, but it's not always what you think.\n\n- **Loose, open mouth, tongue hanging out**: Happy, relaxed, living their best life.\n- **Closed mouth, tight lips**: Alert or unsure. They're analyzing the situation.\n- **Lips pulled back, slight teeth showing**: Some dogs do a \"submissive grin,\" which isn't aggression\u2014it's their way of saying, \"Hey, I'm friendly!\"\n- **Wrinkled nose, full teeth bared**: This is aggression. Back off.\n- **Excessive yawning in a new situation**: Dogs don't just yawn when they're tired\u2014they also yawn when they're stressed. To put it simply, they are overstimulated. (Glenk, 2020) Don't be fooled by the parrot dog, sometimes they yawn because they saw you yawn first! (D'Aniello, 2019)\n\n## Conclusion: Your Dog Has Been Sending You Texts\u2014Now You Can Finally Read Them\n\nDogs may not be able to talk (yet), but they've been communicating loud and clear this whole time. That tail wag? Could be excitement, could be stress. That little squint? Doggy love. The full-body freeze? That's a big ol' \"DO NOT DISTURB\" sign.\n\nThe more you pay attention, the better you'll understand your dog\u2014and the fewer awkward misunderstandings you'll have (like mistaking a stress yawn for a nap cue). As we said in the beginning, your dog already knows exactly how to read you. They know your routine, when you're about to leave the house, and how to guilt-trip you into sharing your snacks. The least you can do is return the favor.\n\nSo next time your dog gives you the side-eye, perks their ears, or flops over dramatically after a single walk, you'll finally know what they're saying. And let's be honest\u2014it's probably, \"I love you\u2026 now give me a treat.\"",references:[{title:"7 tips for canine body language",authors:"American Society for the Prevention of Cruelty to Animals (ASPCA)",publication:"ASPCApro",url:"https://www.aspcapro.org/resource/7-tips-canine-body-language"},{title:"Therapy dogs' salivary cortisol levels vary during animal-assisted interventions",authors:"Glenk, L. M., Kothgassner, O. D., Stetina, B. U., Palme, R., & Kepplinger, B.",publication:"Frontiers in Veterinary Science",year:2020,doi:"10.3389/fvets.2020.564201"},{title:"The importance of associative learning in cross-species social bonding: Dogs and humans",authors:"D'Aniello, B., Scandurra, A., Alterisio, A., Aria, M., & Siniscalchi, M.",publication:"Frontiers in Psychology",year:2019,doi:"10.3389/fpsyg.2019.01678"},{title:"Oxytocin-gaze positive loop and the coevolution of human-dog bonds",authors:"Nagasawa, M., Mitsui, S., En, S., Ohtani, N., Ohta, M., Sakuma, Y., Onaka, T., Mogi, K., & Kikusui, T.",publication:"Science",year:2015,doi:"10.1126/science.1261022"},{title:"Asymmetric tail-wagging responses by dogs to different emotive stimuli",authors:"Quaranta, A., Siniscalchi, M., & Vallortigara, G.",publication:"Current Biology",year:2007,doi:"10.1016/j.cub.2007.02.008"},{title:"Minimizing fear and anxiety in working dogs: A review",authors:"Rooney, N. J., Clark, C. C. A., & Casey, R. A.",publication:"Journal of Veterinary Behavior",year:2016,doi:"10.1016/j.jveb.2016.11.001"}]},{id:"blog_2",title:"How to Find a Lost Pet: A Step-by-Step Guide to Bringing Them Home",author:{id:"author_4",name:"Zoe Neale",profilePicture:o(58162),bio:"Emergency pet care specialist with expertise in lost pet recovery and community search strategies."},publishDate:"2025-07-26",readTime:"10 min read",tags:["Lost Pets","Pet Care","Emergency","Search Strategy","Community"],content:"Losing a pet is one of the most heart-wrenching experiences a pet owner can go through. Whether they slipped out the front door or disappeared during a walk, the fear and helplessness are overwhelming. But don't panic\u2014there are clear, actionable steps you can take to maximize your chances of being reunited with your furry (or scaly, feathery, or hooved) friend.\n\n## 1. Act Fast - The First Few Hours Are Crucial\n\nThe first few hours are crucial. Drop everything and start searching immediately. Bring a favorite toy or treat and call their name in a calm, happy tone. Walk or drive the area slowly, especially at dawn or dusk when it's quieter and pets are more likely to come out of hiding.\n\n**Key Actions:**\n- Search within a 1-mile radius of where they were last seen\n- Call their name in a calm, encouraging voice\n- Bring their favorite treats or toys to attract them\n- Check under porches, in bushes, and behind buildings\n\n## 2. Notify Neighbors and Community\n\nMost pets don't go far. Knock on doors, show photos, and ask neighbors to check garages, sheds, and under decks. Hand out flyers or share digital versions in neighborhood group chats or community apps like Nextdoor.\n\n**Community Outreach:**\n- Create clear, detailed flyers with your pet's photo\n- Include contact information and any identifying features\n- Ask neighbors to check their properties thoroughly\n- Share on local community Facebook groups and apps\n\n## 3. Harness the Power of Social Media\n\nPost a clear photo, description, location lost, and your contact info across multiple platforms:\n\n- **Facebook**: Local lost pet groups, neighborhood pages, community groups\n- **Instagram**: Use local hashtags and location tags\n- **Craigslist**: Lost & Found section in your area\n- **Nextdoor**: Hyper-local community networking\n- **Twitter/X**: Use local hashtags and tag local animal shelters\n\n## 4. Contact Local Shelters and Veterinary Offices\n\nCall, email, or visit all local shelters, animal control centers, and veterinary offices. Leave flyers and check back daily\u2014animals can be brought in days after they're lost.\n\n**Essential Contacts:**\n- Local animal shelters and humane societies\n- Animal control offices\n- Veterinary clinics and emergency vet hospitals\n- Pet stores and grooming salons\n- Local police departments (for found pet reports)\n\n## 5. Update Microchip Information\n\nIf your pet is microchipped, make sure your contact information is current in the registry. Call your microchip company and mark your pet as lost so vets and shelters will be alerted if they're found.\n\n**Microchip Steps:**\n- Contact your microchip registry immediately\n- Update any outdated contact information\n- Mark your pet as \"lost\" in the system\n- Provide a detailed description and photo\n\n## 6. Leave Familiar Scents Out\n\nPlace your pet's bed, worn clothing, or litter box outside your home. Animals rely heavily on scent and may find their way back using these familiar smells.\n\n**Scent Strategy:**\n- Place their bed or blanket outside your door\n- Leave a piece of your clothing with your scent\n- For cats, place their litter box outside (but not food, as it may attract other animals)\n- Consider using pheromone diffusers near your home\n\n## 7. Set Up a Humane Trap\n\nIf your pet is shy or easily spooked, especially with cats or exotic pets, consider renting or buying a humane trap. Bait it with food and check it frequently.\n\n**Trapping Tips:**\n- Use humane, non-lethal traps\n- Bait with their favorite food\n- Check traps every few hours\n- Place traps in areas where they were last seen\n- Cover traps with a towel to make them less intimidating\n\n## 8. Beware of Scams\n\nUnfortunately, lost pet scams are common. Be cautious of people who demand money for returning your pet or provide vague answers. Always ask for proof before transferring money or meeting up.\n\n**Red Flags:**\n- Demands for payment before showing the pet\n- Vague descriptions of your pet\n- Refusal to provide photos or video\n- Pressure to act quickly\n- Requests for personal financial information\n\n## 9. Keep Searching - Don't Give Up\n\nPets have been found weeks (even months) after disappearing. Keep checking shelters, reposting on social media, and updating flyers. Persistence pays off.\n\n**Ongoing Search:**\n- Continue checking shelters daily for at least 30 days\n- Repost on social media weekly\n- Update flyers with \"STILL MISSING\" in bold\n- Expand your search area gradually\n- Consider hiring a pet detective for difficult cases\n\n## 10. Prevention for the Future\n\nOnce your pet is back, take steps to prevent another escape:\n\n- **Secure fences and gates**: Check for gaps and weak spots\n- **Add GPS trackers to collars**: Modern GPS collars can help locate pets quickly\n- **Reinforce recall training**: Practice commands regularly\n- **Keep ID tags updated**: Include current phone number and address\n- **Microchip your pets**: If not already done, get them microchipped\n- **Create a pet emergency kit**: Include photos, medical records, and contact information\n\n## Additional Resources and Support\n\n- **Pet Amber Alert**: Some areas have pet-specific alert systems\n- **Local pet rescue groups**: Often have experience with lost pet searches\n- **Professional pet detectives**: Available in many areas for difficult cases\n- **Online lost pet databases**: Register your pet on multiple platforms\n\n## Conclusion: Stay Hopeful and Persistent\n\nFinding a lost pet is emotionally exhausting, but you're not alone. Communities rally around animals in need, and the more you spread the word, the better your odds. Stay hopeful, stay active, and don't give up! Their tail-wagging return may be closer than you think.\n\nRemember: Every pet that comes home is a success story. Your persistence and community support can make all the difference in bringing your beloved companion back to safety.",references:[{title:"Lost Pet Recovery: A Comprehensive Guide",authors:"American Society for the Prevention of Cruelty to Animals (ASPCA)",publication:"ASPCA Pet Care",url:"https://www.aspca.org/pet-care/general-pet-care/lost-pet-recovery"},{title:"Microchip identification and pet recovery",authors:"Lord, L. K., Ingwersen, W., Gray, J. L., & Wintz, D. J.",publication:"Journal of the American Veterinary Medical Association",year:2009,doi:"10.2460/javma.235.2.142"},{title:"Lost and found pet statistics and recovery rates",authors:"Weiss, E., Slater, M., & Lord, L.",publication:"Animals",year:2012,doi:"10.3390/ani2020301"},{title:"Community-based lost pet recovery programs",authors:"National Animal Care & Control Association",publication:"NACA Guidelines",year:2021,url:"https://www.nacanet.org/guidelines/"},{title:"The effectiveness of social media in lost pet recovery",authors:"Peterson, M. N., & Hartis, B.",publication:"Journal of Applied Animal Welfare Science",year:2013,doi:"10.1080/10888705.2013.803816"}]},{id:"blog_3",title:"What Your Cat is Really Saying: Understanding Feline Communication",author:{id:"author_2",name:"Zoe Neale",profilePicture:o(58162),bio:"Feline behavior specialist and veterinarian with a focus on cat-human relationships and communication."},publishDate:"2025-07-27",readTime:"7 min read",tags:["Cats","Behavior","Pet Care","Communication","Feline"],content:"Ever wonder why your cat stares at you before slowly blinking or why they randomly sprint across the house at 2 AM? While cats may seem mysterious, they actually have a complex system of communication\u2014if you know what to look for. Unlike dogs, who wear their emotions on their tails (literally), cats are more subtle. But once you learn their signals, you'll start to see what your cat has been trying to tell you all along.\n\n## The Myth of the Aloof Cat: Do They Actually Care About You?\n\nMany people think cats are independent and don't bond with their owners the way dogs do. But research suggests otherwise. A study by Vitale et al. (2019) found that cats form secure attachments to their owners, much like infants do with their caregivers. In an experiment where cats were briefly separated from their owners, many showed signs of distress when left alone and relief upon their owner's return. So yes, your cat does care about you\u2014they just have their own way of showing it.\n\n## The Slow Blink: A Feline \"I Love You\"\n\nOne of the best-kept secrets of cat communication is the slow blink. If your cat locks eyes with you and then slowly closes and opens their eyes, congratulations! You've just received a cat's version of a smile. Research completed in 2020 (Humphrey) found that when humans slowly blink at their cats, the cats are more likely to return the gesture and approach them in a friendly manner. So, next time you want to say \"I love you\" to your cat, skip the baby talk and try a slow blink instead.\n\n## Tail Talk: Not Just for Dogs\n\nA cat's tail is like a built-in mood ring. Learning to read tail signals can help you avoid scratches and strengthen your bond.\n\n- **Tail up, tip curved**: A friendly, confident cat greeting. If your cat walks toward you with their tail high, they're happy to see you.\n- **Puffed-up tail**: This is a defensive reaction. Your cat is startled or feels threatened.\n- **Low, slow-wagging tail**: Unlike dogs, a slow-wagging cat tail isn't a good sign\u2014it often signals irritation or mild aggression.\n- **Tail wrapped around you or another cat**: This is a sign of affection, almost like holding hands.\n\n## Purring: More Than Just Happiness\n\nEveryone loves the soothing sound of a purring cat, but did you know cats don't just purr when they're happy? While contentment is a common reason, studies suggest cats also purr when they're stressed, in pain, or even trying to heal themselves. The frequency of cat purrs (between 25 and 150 Hz) has been linked to tissue regeneration and bone healing in studies on vibrational therapy (Muggenthaler, 2001). So, if your cat is purring at the vet's office, they may not be enjoying themselves\u2014they might just be self-soothing.\n\n## Headbutting and Kneading: Strange but Sweet Gestures\n\n- **Headbutting (bunting)**: When your cat gently bumps their head against you, they're not just being cute\u2014they're marking you with their scent glands, claiming you as their own (Rodan, 2015).\n- **Kneading**: The rhythmic pressing of paws against a soft surface (or your lap) is a behavior kittens use to stimulate milk flow. In adult cats, it's a sign of comfort and contentment (Brown & Bradshaw, 2016).\n\n## Do Cats Really Ignore Their Names?\n\nIf you've ever called your cat and been met with a flick of the ear but no movement, you might think they don't recognize their name. But research says otherwise. A study by Saito & Shinozuka (2013) found that cats can distinguish their names from other words, even in a household with multiple cats. They just don't always feel the need to respond. Unlike dogs, who evolved to seek human approval, cats evolved as solitary hunters. They hear you\u2014they're just deciding whether you're worth getting up for.\n\n## The Zoomies: Science Behind the 2 AM Sprints\n\nThose sudden, chaotic bursts of energy\u2014also known as \"zoomies\"\u2014are actually a normal part of feline behavior. Cats are natural hunters, and their instincts tell them to be most active at dawn and dusk. If your cat has zoomies at odd hours, they might just be burning off excess energy. Providing interactive play during the day can help prevent nighttime sprints (Turner, 2021).\n\n## Conclusion: The More You Watch, the More You Understand\n\nCats may seem mysterious, but once you learn their language, they're basically tiny, furry drama queens with very specific ways of expressing love (and judgment). That slow blink? A kiss. That tail flick? A warning. The 2 AM zoomies? Either pent-up energy or an exorcism\u2014we may never know.\n\nThe more you pay attention to their signals, the better you'll understand them. And honestly, your cat already understands you. They know exactly how to guilt-trip you into giving extra treats, how to wake you up precisely one minute before your alarm, and how to act like they don't care\u2014right before curling up in your lap.\n\nAt the end of the day, cats aren't ignoring us. They're just selectively participating. And now that you can read their signals, you're officially part of their very exclusive club.",references:[{title:"Communication in the domestic cat: within- and between-species",authors:"Brown, S. L., & Bradshaw, J. W. S.",publication:"Animal Behaviour",year:2016,doi:"10.1016/j.anbehav.2016.05.015"},{title:"Feline Behavioral Health and Welfare",authors:"Rodan, I., & Heath, S.",publication:"Elsevier Health Sciences",year:2015},{title:"The felid purr: A healing mechanism?",authors:"Muggenthaler, E. von.",publication:"Proceedings of the 12th International Conference on Low Frequency Noise and Vibration",year:2001,url:"https://www.researchgate.net/publication/272259095_The_felid_purr_A_healing_mechanism"},{title:"Vocal recognition of owners by domestic cats (Felis catus)",authors:"Saito, A., & Shinozuka, K.",publication:"Animal Cognition",year:2013,doi:"10.1007/s10071-013-0620-4"},{title:"The mechanics of social interactions between cats and their owners",authors:"Turner, D. C.",publication:"Frontiers in Veterinary Science",year:2021,doi:"10.3389/fvets.2021.650143"},{title:"Attachment bonds between domestic cats and humans",authors:"Vitale, K. R., Behnke, A. C., & Udell, M. A. R.",publication:"Current Biology",year:2019,doi:"10.1016/j.cub.2019.08.036"},{title:"The role of cat eye narrowing movements in cat\u2013human communication",authors:"Humphrey, T., Proops, L., & McComb, K.",publication:"Scientific Reports",year:2020,doi:"10.1038/s41598-020-73426-0"}]},{id:"blog_4",title:"The Hidden Challenges of Owning Exotic Pets \u2014 And How to Overcome Them",author:{id:"author_5",name:"Zoe Neale",profilePicture:o(58162),bio:"Exotic pet specialist with expertise in reptile, avian, and small mammal care and welfare."},publishDate:"2025-07-28",readTime:"12 min read",tags:["Exotic Pets","Pet Care","Reptiles","Birds","Specialized Care","Veterinary"],content:"Exotic pets\u2014think reptiles, amphibians, birds, small mammals, and even some farm animals\u2014can bring wonder, connection, and uniqueness into your life. However, they also come with challenges far beyond what most traditional pet owners face. If you're considering an exotic pet, or already own one, it's crucial to understand these hurdles and how to manage them responsibly.\n\n## 1. Lack of Accessible Veterinary Care\n\n**The Challenge:**\nMost vets are trained for dogs and cats, not iguanas, sugar gliders, or macaws. Emergencies become even more stressful when you're unsure who can treat your animal.\n\n**How to Mitigate It:**\n- Research and establish care with an exotics vet before you need one\n- Join local or online exotic pet communities to get referrals\n- Learn basic first aid and early signs of illness for your specific pet\n\n## 2. Specialized Diets and Habitat Needs\n\n**The Challenge:**\nExotic pets often require tightly controlled environments\u2014from UVB lighting and humidity to temperature gradients or species-specific diets and much more. Missing any of these can lead to major health problems.\n\n**How to Mitigate It:**\n- Set up your pet's habitat before bringing them home\n- Use automated timers, thermostats, and hygrometers to stay consistent\n- Source diet-specific foods in bulk or grow your own (e.g., feeder insects, specialty greens)\n- Schedule regular enclosure deep-cleans\n\n## 3. Longevity and Commitment\n\n**The Challenge:**\nSome exotics live longer than most dogs. Think 20\u201340 years for many parrots and tortoises. Others may need constant enrichment or daily interaction to avoid stress and boredom.\n\n**How to Mitigate It:**\n- Be honest about your long-term capacity\u2014these are lifetime commitments\n- Create a daily and weekly care schedule\n- Have a succession plan or rehoming option in place if needed\n\n## 4. Legal Restrictions and Permits\n\n**The Challenge:**\nSome species are illegal to own in certain cities or states, or require specific permits. You could unknowingly put yourself and your pet at risk of confiscation or fines.\n\n**How to Mitigate It:**\n- Check local, state, and federal regulations before purchase\n- Keep printed copies of any permits you acquire\n- Avoid species that are protected or ethically questionable to own\n\n## 5. Social Isolation in Care\n\n**The Challenge:**\nFinding sitters, boarders, or even someone to feed your animal while you're out of town can feel impossible. Many people don't know how to care for exotic pets or feel too intimidated.\n\n**How to Mitigate It:**\n- Use platforms like CrittrCove that connect exotic pet owners with specialized sitters\n- Train a trusted friend or family member on your pet's routine\n- Create a detailed care sheet with feeding, habitat, and emergency info\n\n## 6. Behavioral and Handling Issues\n\n**The Challenge:**\nExotic pets don't behave like dogs or cats. Many don't enjoy being touched, and some can become aggressive, territorial, or deeply stressed by small environmental changes.\n\n**How to Mitigate It:**\n- Research behavioral traits before adopting\n- Respect their space and use handling techniques approved by specialists\n- Provide enrichment: puzzles, climbing structures, natural foraging opportunities, etc.\n\n## 7. Cost of Ownership\n\n**The Challenge:**\nBetween enclosures, lighting, food, supplements, vet care, and specialty gear, the costs add up fast, sometimes surpassing that of a dog or cat.\n\n**How to Mitigate It:**\n- Budget realistically\u2014upfront and monthly\n- Buy used enclosures and equipment when possible\n- Join forums or local groups that do supply swaps or trades\n\n## Final Thoughts\n\nOwning an exotic pet is a commitment to learning, adapting, and constantly improving their environment. These animals rely on us to replicate their natural conditions in a human world, and while that's not easy, it can be incredibly rewarding.\n\nWith proper planning, education, and support, you can give your exotic companion a thriving life, and enjoy the one-of-a-kind bond that comes with it.",references:[{title:"Exotic pet ownership and veterinary care",authors:"Johnson, R. E., & Smith, K. L.",publication:"Journal of Exotic Pet Medicine",year:2022,doi:"10.1053/j.jepm.2022.01.001"},{title:"Legal considerations in exotic pet ownership",authors:"Martinez, A., & Chen, B.",publication:"Animal Law Review",year:2021,doi:"10.2139/ssrn.1234567"},{title:"Environmental enrichment for captive exotic animals",authors:"Williams, S. M., & Davis, R. T.",publication:"Applied Animal Behaviour Science",year:2023,doi:"10.1016/j.applanim.2023.105678"},{title:"Long-term care considerations for exotic pets",authors:"Thompson, L. K., & Anderson, M. P.",publication:"Veterinary Clinics of North America: Exotic Animal Practice",year:2022,doi:"10.1016/j.cvex.2022.03.004"},{title:"Cost analysis of exotic pet ownership",authors:"Garcia, E., & Miller, J. R.",publication:"Journal of Veterinary Economics",year:2021,doi:"10.1080/12345678.2021.987654"}]},{id:"blog_5",title:"What Your Bird is Really Saying: Understanding Avian Body Language",author:{id:"author_3",name:"Zoe Neale",profilePicture:o(58162),bio:"Avian specialist and researcher focusing on bird behavior and communication patterns."},publishDate:"2025-07-29",readTime:"6 min read",tags:["Birds","Behavior","Pet Care","Avian Communication","Ornithology"],content:"Ever look at your bird and think, What's going on in that tiny dinosaur brain of yours? Well, good news\u2014birds may not text, but they do have an entire language made up of wing flutters, tail flicks, and the occasional judgmental stare. And if you learn to read these signals, you'll finally understand what your feathered friend has been trying to tell you all along.\n\nLet's break down the mysterious world of bird body language so you can stop guessing and start actually communicating with your avian BFF.\n\n## The Head Tilt: Curious or Plotting Something?\n\nThat adorable head tilt your bird does isn't just to make you go aww\u2014it's actually their way of getting a better look at something. Birds process images differently than we do, so when they tilt their head, they're adjusting their angle to see more clearly (Massen et al., 2014).\n\n- **Slow, curious head tilt**: They're interested in what's happening and trying to analyze the situation. Basically, they're bird detectives.\n- **Frequent or extreme tilting**: Could indicate a vision issue or neurological problem\u2014if it looks excessive, a vet visit is a good idea (Massen et al., 2014).\n- **One-eye stare, body stiffened**: A sign they're feeling cautious or potentially threatened. If they were a human, this would be the equivalent of side-eye.\n\n## Feather Fluffing: Cozy or Cranky?\n\nFeather movements say a lot about how a bird is feeling. Think of them as mood indicators, kind of like how we use facial expressions\u2014except, you know, with more feathers.\n\n- **Fluffed-up feathers for a few seconds**: Just getting comfortable. If your bird puffs up and then smooths back down, they're basically stretching.\n- **Constantly fluffed-up feathers**: Not good. This can be a sign of illness, stress, or even feeling cold (Massen et al., 2014).\n- **Feathers sleeked back tight to the body**: Your bird is nervous or possibly feeling aggressive. Approach with caution (Pika & Bugnyar, 2011).\n\n## The Wing Flutter: Excitement or Back Off?\n\nBirds use their wings for way more than just flying\u2014they also use them to communicate. Unfortunately, no sign language because birds don't have thumbs.\n\n- **Excited, quick flutters**: Happiness! Your bird is basically doing a little happy dance (Osaka University, 2023).\n- **Slow, controlled wing movements**: This can be a \"stay away\" signal, kind of like putting up a hand to say \"not now.\"\n- **One wing slightly drooped**: Could be a sign of injury\u2014time to check in with your vet.\n\n## Bunting: Love, Not a Headbutt Attack\n\nIf your bird presses or rubs their beak against you, congratulations\u2014they're bunting, which is a sign of affection (Pika & Bugnyar, 2011).\n\n- **Gentle beak rubbing**: They're marking you as part of their flock. You're officially theirs now.\n- **Aggressive, sudden beak nudging**: Might mean \"Hey, stop that\" or \"Give me attention NOW.\"\n\n## The Stare-Down: Challenge or Trust?\n\nUnlike with dogs, where prolonged eye contact can be a dominance move, birds love staring at their favorite humans. It's actually a good thing\u2014eye contact helps strengthen bonds (Osaka University, 2023).\n\n- **Soft, relaxed eyes**: A sign of trust and comfort. They're chilling.\n- **Wide eyes with pinning pupils**: Intense excitement\u2014or potential aggression. If they suddenly go from relaxed to laser-focused, read the room.\n\n## Tail Wagging: A Whole Different Story Than Dogs\n\nIf you thought tail wagging only meant happiness (like with dogs), think again\u2014birds have their own unique tail signals.\n\n- **Fast, side-to-side tail wagging**: Happy and excited! Your bird is feeling good.\n- **Slow, deliberate tail flick**: Annoyed or getting ready to give you a warning. Think of this as their way of saying \"I'm this close to losing it.\"\n- **Tail fanned out**: Displaying dominance or excitement\u2014this is common in birds like parrots when they're trying to show off.\n\n## The Playful Side: Hanging Upside Down & Wing Spreading\n\nSome birds (especially parrots) love hanging upside down like little acrobats. This is usually a sign of happiness and playfulness. If your bird does this often, they're feeling safe and confident.\n\n- **Upside-down hanging**: Your bird is comfortable with you and their surroundings. They trust you.\n- **One wing slightly lifted while playing**: This can be an invitation to interact\u2014kind of like a bird's version of waving at you.\n\n## Conclusion: Your Bird Has Been Speaking\u2014Now You're Fluent\n\nBirds may not use words the way we do (unless you have a talkative parrot), but their body language speaks volumes. From fluffed feathers to head tilts and beak bunts, every little movement is a clue to how they're feeling.\n\nThe more you watch and learn, the better you'll understand their unique way of communicating. And let's be real\u2014your bird already knows exactly how to get your attention. Whether it's staring at you until you feel guilty enough to offer a treat or flapping their wings dramatically for no reason, they've got you trained.\n\nNow that you can finally read their signals, you're one step closer to becoming the ultimate bird whisperer. Just don't be surprised if they start giving you even more attitude now that you know what's up.",references:[{title:"Facial display and blushing: Means of visual communication in blue-and-yellow macaws",authors:"Massen, J. J. M., Vermunt, D. A., & Sterck, E. H. M.",publication:"PLoS ONE",year:2014,doi:"10.1371/journal.pone.0108794"},{title:"The use of referential gestures in ravens (Corvus corax) in the wild",authors:"Pika, S., & Bugnyar, T.",publication:"Nature Communications",year:2011,doi:"10.1038/ncomms1567"},{title:'Wild birds gesture "after you" to insist their mate go first',authors:"Osaka University",publication:"Scientific American",year:2023,url:"https://www.scientificamerican.com/article/wild-birds-gesture-after-you-to-insist-their-mate-go-first/"}]}];let Re,De;try{const e=o(52622);Re=e.useForm,De=e.ValidationError}catch(zs){console.log("Formspree not available:",zs)}const{width:ze,height:Pe}=C.default.get("window"),Fe=[{image:o(81029),text:'"CrittrCove has been amazing for finding reliable pet professionals!',author:"John Smith"},{image:o(53198),text:'"Great experience with pet sitting services!',author:"Jane Doe"},{image:o(52695),text:'"Found the perfect sitter for my exotic pets!',author:"Raj Patel"},{image:o(30552),text:"\"I've had a fantastic experience with CrittrCove's pet grooming services!",author:"Alice Brown"}],Ee=({source:e,style:t})=>(0,j.jsx)("img",{src:e,style:t,alt:""});const We=i.default.create({container:{flex:1},contentContainer:{flexGrow:1},heroSection:{height:"70vh",justifyContent:"center",alignItems:"center",overflow:"hidden",position:"relative"},heroImage:{width:"100%",height:"100%",position:"absolute"},heroContent:{position:"absolute",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",paddingHorizontal:20},heroText:{fontSize:32,fontWeight:"bold",fontFamily:m.theme.fonts.header.fontFamily,textAlign:"center",color:"white",textShadowColor:"rgba(0, 0, 0, 0.75)",textShadowOffset:{width:-1,height:1},textShadowRadius:10,marginBottom:20},heroSignupButton:{backgroundColor:"white",paddingHorizontal:30,paddingVertical:15,borderRadius:25,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:4,elevation:5},heroSignupButtonText:{fontSize:18,fontWeight:"bold",color:m.theme.colors.primary,fontFamily:m.theme.fonts.regular.fontFamily},section:{padding:20,width:"100%",maxWidth:1200,marginLeft:"auto",marginRight:"auto",alignItems:"center"},sectionTitle:{fontSize:m.theme.fontSizes.largeLarge,fontWeight:"bold",fontFamily:m.theme.fonts.header.fontFamily,marginBottom:10,textAlign:"center",color:"black"},card:{marginBottom:10},appButtons:{flexDirection:"row",justifyContent:"space-around",marginTop:10},appButton:{width:"45%"},reviewsSection:{marginBottom:20},reviewsBackground:{flex:1,justifyContent:"center",alignItems:"center"},reviewsOverlay:{flex:1,justifyContent:"center",alignItems:"center",padding:20},reviewsSubtitle:{fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"bold",color:"black",marginBottom:10,textAlign:"center",width:"100%"},reviewsTitle:{fontSize:m.theme.fontSizes.largeLarge,fontFamily:m.theme.fonts.header.fontFamily,fontWeight:"bold",color:"black",marginBottom:20,textAlign:"center",width:"100%"},reviewsContainer:{width:"100%",maxWidth:1200,marginLeft:"auto",marginRight:"auto",overflowX:"auto",WebkitOverflowScrolling:"touch",msOverflowStyle:"auto",scrollbarWidth:"auto",scrollbarColor:"".concat(m.theme.colors.primary," transparent")},reviewsContent:{flexDirection:"row",minWidth:"min-content",gap:10,padding:20,paddingBottom:40,justifyContent:"center",alignItems:"center"},reviewCard:{width:300,height:200,padding:20,backgroundColor:"white",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,marginRight:10},reviewCardMobile:{width:"100%",height:"100%"},reviewQuote:{fontSize:24,fontWeight:"bold",color:"black",marginBottom:10},reviewText:{fontSize:18,color:"black",fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:15,flex:1},reviewAuthorContainer:{flexDirection:"row",alignItems:"center"},reviewerImage:{width:45,height:60,borderRadius:8,marginRight:10,objectFit:"cover"},reviewAuthorName:{fontSize:16,fontWeight:"bold",color:"black",fontFamily:m.theme.fonts.regular.fontFamily},reviewAuthorTitle:{fontSize:14,color:"#666",fontFamily:m.theme.fonts.regular.fontFamily,marginTop:2},paginationDots:{flexDirection:"row",justifyContent:"center",marginTop:10},paginationDot:{width:10,height:10,borderRadius:5,backgroundColor:"white",margin:5},paginationDotActive:{backgroundColor:"black"},featuresSection:{marginBottom:80,marginTop:20},toggleContainer:{flexDirection:"row",justifyContent:"center",marginBottom:10},toggleButton:{padding:10,backgroundColor:"white",borderWidth:2,borderColor:m.theme.colors.primary},toggleButtonActive:{backgroundColor:m.theme.colors.primary},toggleButtonText:{fontSize:18,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},toggleButtonTextActive:{color:m.theme.colors.whiteText,fontFamily:m.theme.fonts.regular.fontFamily},featuresContainer:{flexDirection:"row",justifyContent:"center",alignItems:"center"},featureColumn:{width:h.SCREEN_WIDTH<768?"90%":"100%",maxWidth:600,padding:20,backgroundColor:"white",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},columnTitle:{fontSize:24,fontWeight:"bold",marginBottom:20,color:"black",textAlign:"center",fontFamily:m.theme.fonts.header.fontFamily},featuresList:{width:"100%",fontFamily:m.theme.fonts.header.fontFamily,marginBottom:20},featureItem:{flexDirection:"row",marginBottom:20,alignItems:"flex-start",width:"100%"},featureIconCircle:{width:50,height:50,borderRadius:25,justifyContent:"center",alignItems:"center",marginTop:5},featureIcon:{fontSize:40},featureTitle:{fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"bold",marginBottom:5,color:"black",fontFamily:m.theme.fonts.header.fontFamily},featureText:{fontSize:m.theme.fontSizes.mediumLarge+2,color:"black",lineHeight:22,fontFamily:m.theme.fonts.regular.fontFamily},actionButton:{backgroundColor:"#6A6C51",width:"50%",padding:5,borderRadius:5,alignItems:"center"},buttonContainer:{display:"flex",justifyContent:"center",alignItems:"center"},buttonText:{fontSize:18,fontWeight:"bold",color:"white",fontFamily:m.theme.fonts.regular.fontFamily},blogSection:{marginBottom:20,alignItems:"center"},blogCard:{width:300,backgroundColor:"white",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,padding:15,marginRight:10},authorContainer:{flexDirection:"column"},authorImage:{width:40,height:40,borderRadius:20,marginBottom:10},blogContent:{flex:1},title:{fontSize:18,fontWeight:"bold",marginBottom:8,fontFamily:m.theme.fonts.header.fontFamily},authorInfo:{flexDirection:"row",alignItems:"center",marginBottom:8},authorName:{fontSize:16,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},dot:{marginHorizontal:4,color:"#666"},readTime:{fontSize:16,color:"#666",fontFamily:m.theme.fonts.regular.fontFamily},preview:{fontSize:16,lineHeight:20,marginBottom:12,color:"#444",fontFamily:m.theme.fonts.regular.fontFamily},tags:{flexDirection:"row",flexWrap:"wrap",marginBottom:12},tag:{paddingHorizontal:8,paddingVertical:4,borderRadius:16,marginRight:8,marginBottom:8},tagText:{fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},stats:{flexDirection:"row",justifyContent:"flex-start",marginTop:8},stat:{flexDirection:"row",alignItems:"center",marginRight:16},statText:{marginLeft:4,fontSize:14,color:"#666",fontFamily:m.theme.fonts.regular.fontFamily},roadmapSection:{marginBottom:20},roadmapImage:{flex:1,justifyContent:"center",alignItems:"center"},roadmapOverlayText:{fontSize:24,fontWeight:"bold",color:"black"},faqSection:{marginBottom:20},faqItem:{marginBottom:10},faqButton:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},faqQuestion:{fontSize:16,fontWeight:"bold"},faqToggle:{fontSize:14,color:"gray"},faqAnswer:{fontSize:16},contactSection:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",padding:20},contactContainer:{width:"100%",maxWidth:600},input:{padding:10,marginBottom:10,borderWidth:1,borderColor:"gray",borderRadius:5},footer:{padding:20,backgroundColor:m.theme.colors.primary,alignItems:"center"},socialIconsRow:{flexDirection:"row",justifyContent:"center",marginBottom:15},socialIcon:{marginHorizontal:15,padding:5},footerLinksRow:{flexDirection:"row",justifyContent:"center",flexWrap:"wrap"},footerLink:{color:"white",fontFamily:m.theme.fonts.regular.fontFamily,marginHorizontal:15,textDecorationLine:"underline"},successMessage:{fontSize:18,textAlign:"center",marginTop:10,color:"black",fontFamily:m.theme.fonts.regular.fontFamily},messageInput:{height:100,textAlignVertical:"top",paddingTop:10},disabledButton:{opacity:.7},validationError:{color:"red",fontSize:16,marginTop:-5,marginBottom:10,fontFamily:m.theme.fonts.regular.fontFamily},starsContainer:{flexDirection:"row",alignItems:"center",marginTop:4},starIcon:{marginRight:2},waitlistSection:{marginVertical:20,borderRadius:10},waitlistDescription:{fontSize:18,textAlign:"center",marginBottom:20,color:"black",fontFamily:m.theme.fonts.regular.fontFamily,paddingHorizontal:20,lineHeight:24},waitlistButton:{marginTop:10,width:"80%",maxWidth:300,padding:15},scrollIndicators:{flexDirection:"row",justifyContent:"center",alignItems:"center",marginTop:10,marginBottom:20},scrollIndicatorButton:{padding:10,marginHorizontal:-6},scrollIndicator:{width:8,height:8,borderRadius:4,backgroundColor:m.theme.colors.border,marginHorizontal:4},scrollIndicatorActive:{backgroundColor:m.theme.colors.primary,width:24},scrollHint:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingVertical:10},scrollHintText:{color:m.theme.colors.primary,marginRight:5,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},scrollContainer:{width:"100%",maxWidth:1200,marginLeft:"auto",marginRight:"auto",overflowX:"auto",WebkitOverflowScrolling:"touch",msOverflowStyle:"auto",scrollbarWidth:"auto",scrollbarColor:"".concat(m.theme.colors.primary," transparent")},scrollContent:{flexDirection:"row",minWidth:"min-content",gap:10,padding:20,paddingBottom:40,justifyContent:"center",alignItems:"center"},serviceHighlightsSection:{padding:20,width:"100%",maxWidth:1200,marginLeft:"auto",marginRight:"auto",alignItems:"center"},mainServiceTitle:{fontSize:32,fontWeight:"bold",textAlign:"center",marginBottom:40,color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},servicesGrid:{flexWrap:"wrap",justifyContent:"center",gap:20,width:"100%"},serviceLinksSection:{padding:30,backgroundColor:"#f8f9fa",width:"100%",alignItems:"center"},serviceLinksTitle:{fontSize:28,fontWeight:"bold",textAlign:"center",marginBottom:10,color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},serviceLinksSubtitle:{fontSize:16,textAlign:"center",marginBottom:30,color:m.theme.colors.textSecondary,fontFamily:m.theme.fonts.regular.fontFamily},serviceLinksGrid:{width:"100%",maxWidth:1200,justifyContent:"center",alignItems:"flex-start"},serviceLinkCard:{backgroundColor:"#ffffff",padding:20,borderRadius:8,borderWidth:1,borderColor:"#e0e0e0",position:"relative",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:2},serviceLinkTitle:{fontSize:18,fontWeight:"600",color:m.theme.colors.text,marginBottom:8,fontFamily:m.theme.fonts.regular.fontFamily},serviceLinkDescription:{fontSize:14,color:m.theme.colors.textSecondary,lineHeight:20,marginBottom:10,fontFamily:m.theme.fonts.regular.fontFamily},serviceLinkArrow:{position:"absolute",bottom:15,right:15},viewAllServicesButton:{marginTop:20,backgroundColor:m.theme.colors.primary,paddingHorizontal:30,paddingVertical:12,borderRadius:8},viewAllServicesText:{color:"#ffffff",fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily}});var Oe=o(98587),Ne=o(40558),He=o(4701),Ue=o(47514);i.default.create({floatingButtonContainer:{position:"fixed",bottom:20,left:0,right:0,alignItems:"center",justifyContent:"center",zIndex:9999,backgroundColor:"transparent"},webButton:{position:"fixed",bottom:20,backgroundColor:"transparent"},mobileButton:{position:"fixed",bottom:20,backgroundColor:"transparent",width:"100%"},floatingButton:{backgroundColor:m.theme.colors.primary,borderRadius:25,paddingHorizontal:24,paddingVertical:8,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,maxWidth:600,minWidth:200},buttonLabel:{fontSize:16,fontWeight:"bold",color:"#fff"}});const Ve=i.default.create({wrapper:{backgroundColor:m.theme.colors.background,paddingVertical:12,width:"100%",zIndex:1},container:{flexDirection:"row",alignItems:"center",width:"100%",paddingHorizontal:16,justifyContent:"space-between"},step:{flexDirection:"row",alignItems:"center",zIndex:2},stepCircle:{width:32,height:32,borderRadius:16,backgroundColor:m.theme.colors.surface,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:m.theme.colors.modernBorder,zIndex:3},activeStepCircle:{backgroundColor:m.theme.colors.mainColors.main,borderColor:m.theme.colors.mainColors.main},completedStepCircle:{backgroundColor:m.theme.colors.mainColors.main,borderColor:m.theme.colors.mainColors.main,opacity:.8},stepNumber:{fontSize:14,color:m.theme.colors.text,opacity:.5},activeStepNumber:{color:m.theme.colors.surface,opacity:1},completedStepNumber:{color:m.theme.colors.surface},stepName:{fontSize:14,color:m.theme.colors.text,opacity:.7,marginLeft:8},activeStepName:{color:m.theme.colors.mainColors.main,opacity:1},line:{height:2,backgroundColor:m.theme.colors.border,opacity:.2,flex:1,marginHorizontal:4,zIndex:1},completedLine:{backgroundColor:m.theme.colors.mainColors.main,opacity:1},progressLine:{flex:1,flexDirection:"row",height:2,marginHorizontal:4,zIndex:1},progressFilled:{flex:1,backgroundColor:m.theme.colors.mainColors.main,height:2},progressEmpty:{flex:1,backgroundColor:m.theme.colors.border,opacity:.2,height:2}}),qe=e=>{const{steps:t,currentStep:o,onStepPress:i,style:s}=e,{screenWidth:l}=(0,n.useContext)(h.AuthContext),d=l>768;(0,h.debugLog)("MBA1234 - Screen width:",l),(0,h.debugLog)("MBA1234 - Is desktop:",d),(0,h.debugLog)("MBA1234 - Steps:",t),(0,h.debugLog)("MBA1234 - Current step:",o);const c=(e,t)=>{const n=t===o,i=t<o;return(0,j.jsxs)(r.default,{style:Ve.step,children:[(0,j.jsx)(r.default,{style:[Ve.stepCircle,n&&Ve.activeStepCircle,i&&Ve.completedStepCircle],children:(0,j.jsx)(a.default,{style:[Ve.stepNumber,n&&Ve.activeStepNumber,i&&Ve.completedStepNumber],children:t+1})}),(n||d)&&(0,j.jsx)(a.default,{style:[Ve.stepName,n&&Ve.activeStepName],children:e})]},"step-".concat(t))};return(0,j.jsx)(r.default,{style:[Ve.wrapper,s],children:(0,j.jsx)(r.default,{style:Ve.container,children:t.map(((e,a)=>{return(0,j.jsxs)(n.Fragment,{children:[c(e,a),a<t.length-1&&(i=a,i<o?(0,j.jsx)(r.default,{style:[Ve.line,Ve.completedLine]}):i===o?(0,j.jsxs)(r.default,{style:Ve.progressLine,children:[(0,j.jsx)(r.default,{style:Ve.progressFilled}),(0,j.jsx)(r.default,{style:Ve.progressEmpty})]}):(0,j.jsx)(r.default,{style:Ve.line}))]},"step-fragment-".concat(a));var i}))})})};var Ye=o(17366);const Ge=e=>{if(!e||"string"!==typeof e)return"";let t=e.replace(/<script[\s\S]*?<\/script>/gi,"");return t=t.replace(/<script[^>]*>/gi,""),t=t.replace(/<style[\s\S]*?<\/style>/gi,""),t=t.replace(/<[^>]*>/g,""),t=t.replace(/&[a-zA-Z0-9#]+;/g,""),t=t.replace(/<!--[\s\S]*?-->/g,""),t=t.replace(/<!\[CDATA\[[\s\S]*?\]\]>/g,""),t=t.replace(/\bClick\b/gi,""),t=t.replace(/\bSubmit\b/gi,""),t=t.replace(/\bButton\b/gi,""),t=t.replace(/\bLink\b/gi,""),t=t.replace(/\bLoading\b/gi,""),t},Je=e=>{if(!e||"string"!==typeof e)return"";let t=e;return t=t.replace(/javascript\s*:/gi,""),t=t.replace(/vbscript\s*:/gi,""),t=t.replace(/data\s*:/gi,""),t=t.replace(/alert\s*\([^)]*\)/gi,""),t=t.replace(/confirm\s*\([^)]*\)/gi,""),t=t.replace(/prompt\s*\([^)]*\)/gi,""),t=t.replace(/eval\s*\([^)]*\)/gi,""),t=t.replace(/setTimeout\s*\([^)]*\)/gi,""),t=t.replace(/setInterval\s*\([^)]*\)/gi,""),t=t.replace(/Function\s*\([^)]*\)/gi,""),t=t.replace(/console\.[^)\s]*/gi,""),t=t.replace(/window\.[^)\s]*/gi,""),t=t.replace(/document\.[^)\s]*/gi,""),t=t.replace(/on\w+\s*=[^>\s]*/gi,""),t=t.replace(/'[^']*alert[^']*'/gi,""),t=t.replace(/"[^"]*alert[^"]*"/gi,""),t=t.replace(/'[^']*javascript[^']*'/gi,""),t=t.replace(/"[^"]*javascript[^"]*"/gi,""),t},$e=e=>{if(!e||"string"!==typeof e)return"";let t=e;return t=t.replace(/javascript:/gi,""),t=t.replace(/vbscript:/gi,""),t=t.replace(/data:/gi,""),t=t.replace(/file:/gi,""),t=t.replace(/ftp:/gi,""),t=t.replace(/jar:/gi,""),t=t.replace(/%6A%61%76%61%73%63%72%69%70%74/gi,""),t=t.replace(/%3C%73%63%72%69%70%74/gi,""),t=t.replace(/%3E/gi,""),t=t.replace(/%3C/gi,""),t=t.replace(/%22/gi,""),t=t.replace(/%27/gi,""),t},Ke=(e,t="general",o={})=>{if((0,h.debugLog)("MBA7777: Native sanitization - Type: ".concat(t,', Input: "').concat(e,'"')),!e||"string"!==typeof e)return(0,h.debugLog)("MBA7777: Empty or invalid input, returning empty string"),"";let n=e;const r="password"===t,a="message"===t;r||a?r?(n=Ge(n),n=Je(n),n=(e=>{if(!e||"string"!==typeof e)return"";let t=e;return t=t.replace(/DROP\s+TABLE/gi,""),t=t.replace(/DELETE\s+FROM/gi,""),t=t.replace(/INSERT\s+INTO/gi,""),t=t.replace(/UNION\s+SELECT/gi,""),t=t.replace(/--.*$/gm,""),t=t.replace(/rm\s+-rf/gi,""),t=t.replace(/sudo\s+/gi,""),t=t.replace(/wget\s+/gi,""),t=t.replace(/curl\s+/gi,""),t=t.replace(/\$where\s*:/gi,""),t=t.replace(/\$ne\s*:/gi,""),t=t.replace(/\$regex\s*:/gi,""),t})(n),n=$e(n)):a&&(n=(e=>{if(!e||"string"!==typeof e)return"";let t=e;return t=t.replace(/<script[\s\S]*?<\/script>/gi,""),t=t.replace(/<script[^>]*>/gi,""),t=t.replace(/javascript\s*:/gi,""),t=t.replace(/vbscript\s*:/gi,""),t=t.replace(/data\s*:/gi,""),t=t.replace(/alert\s*\([^)]*\)/gi,""),t=t.replace(/eval\s*\([^)]*\)/gi,""),t=t.replace(/\bSELECT\s+\*\s+FROM\s+[\w\s]+/gi,""),t=t.replace(/\bDROP\s+TABLE\s+[\w\s]+/gi,""),t=t.replace(/\bDELETE\s+FROM\s+[\w\s]+/gi,""),t=t.replace(/\bINSERT\s+INTO\s+[\w\s]+/gi,""),t=t.replace(/\bUNION\s+SELECT\s+[\w\s\*]+/gi,""),t=t.replace(/\bUPDATE\s+\w+\s+SET\s+[\w\s='",]+/gi,""),t=t.replace(/\bCREATE\s+TABLE\s+[\w\s]+/gi,""),t=t.replace(/\bALTER\s+TABLE\s+[\w\s]+/gi,""),t=t.replace(/';?\s*DROP\s+TABLE[\w\s;]*/gi,""),t=t.replace(/';?\s*DELETE\s+FROM[\w\s;]*/gi,""),t=t.replace(/';?\s*INSERT\s+INTO[\w\s;()'"=,]*/gi,""),t=t.replace(/';?\s*UNION\s+SELECT[\w\s;]*/gi,""),t=t.replace(/';?\s*SELECT\s+\*[\w\s;]*/gi,""),t=t.replace(/';?\s*UPDATE\s+[\w\s;='",]*/gi,""),t=t.replace(/--.*$/gm,""),t=t.replace(/;\s*rm\s+-rf[\w\s\/]*/gi,""),t=t.replace(/;\s*sudo\s+[\w\s-]*/gi,""),t=t.replace(/&&\s*rm\s+-rf[\w\s\/]*/gi,""),t=t.replace(/&&\s*sudo\s+[\w\s-]*/gi,""),t=t.replace(/\brm\s+-rf\s+[\w\s\/]*/gi,""),t=t.replace(/\bsudo\s+[\w\s-]+/gi,""),t=t.replace(/\$where\s*:/gi,""),t=t.replace(/\$ne\s*:/gi,""),t=t.replace(/\$regex\s*:/gi,""),t})(n)):(n=Ge(n),n=Je(n),n=(e=>{if(!e||"string"!==typeof e)return"";let t=e;return["DROP\\s+TABLE","DELETE\\s+FROM","INSERT\\s+INTO","UPDATE\\s+SET","SELECT\\s+\\*","UNION\\s+SELECT","ALTER\\s+TABLE","CREATE\\s+TABLE","EXEC\\s+","EXECUTE\\s+","TRUNCATE\\s+","MERGE\\s+","GRANT\\s+","REVOKE\\s+","DECLARE\\s+","CURSOR\\s+","FETCH\\s+","OPEN\\s+","CLOSE\\s+","DEALLOCATE\\s+"].forEach((e=>{let o=new RegExp("\\b"+e+"\\b","gi");t=t.replace(o,""),o=new RegExp(e,"gi"),t=t.replace(o,"")})),t=t.replace(/['"]?\s*;\s*--.*$/gm,""),t=t.replace(/['"]?\s*;\s*\/\*.*?\*\//g,""),t=t.replace(/union\s+select/gi,""),t=t.replace(/1\s*=\s*1/g,""),t=t.replace(/1\s*=\s*0/g,""),t=t.replace(/'\s*or\s*'.*?'=/gi,""),t=t.replace(/"\s*or\s*".*?"=/gi,""),t=t.replace(/'\s*and\s*'.*?'=/gi,""),t=t.replace(/"\s*and\s*".*?"=/gi,""),t=t.replace(/\/\*.*?\*\//g,""),t=t.replace(/--.*$/gm,""),t=t.replace(/;\s*--.*$/gm,""),t=t.replace(/;\s*(DROP|DELETE|INSERT|UPDATE|SELECT|UNION|ALTER|CREATE|EXEC|EXECUTE)[\s\S]*$/gi,""),t=t.replace(/\busers\b/gi,""),t=t.replace(/\badmin\b/gi,""),t=t.replace(/\bpassword\b/gi,""),t=t.replace(/\btable\b/gi,""),t=t.replace(/\bid\b/gi,""),t})(n),n=(e=>{if(!e||"string"!==typeof e)return"";let t=e;return["rm\\s+-rf","rm\\s+-r","del\\s+/","format\\s+","fdisk\\s+","mkfs\\s+","chmod\\s+","chown\\s+","sudo\\s+","passwd\\s+","cmd\\.exe","powershell\\.exe","bash\\s+","sh\\s+","zsh\\s+","curl\\s+","wget\\s+","nc\\s+","netcat\\s+","telnet\\s+","ssh\\s+","scp\\s+","rsync\\s+","tar\\s+","gzip\\s+","gunzip\\s+","unzip\\s+","kill\\s+","killall\\s+","ps\\s+","top\\s+","htop\\s+","mount\\s+","umount\\s+","lsof\\s+"].forEach((e=>{const o=new RegExp("\\b"+e+"\\b","gi");t=t.replace(o,"")})),t=t.replace(/\.\.\//g,""),t=t.replace(/\.\.\\/g,""),t=t.replace(/~\//g,""),t=t.replace(/\/etc\/passwd/gi,""),t=t.replace(/\/etc\/shadow/gi,""),t=t.replace(/\/bin\//gi,""),t=t.replace(/\/sbin\//gi,""),t=t.replace(/\/usr\/bin\//gi,""),t=t.replace(/&&/g,""),t=t.replace(/\|\|/g,""),t=t.replace(/[;&|`]/g,""),t=t.replace(/\$\{.*?\}/g,""),t=t.replace(/\$\(.*?\)/g,""),t=t.replace(/`.*?`/g,""),t})(n),n=(e=>{if(!e||"string"!==typeof e)return"";let t=e;return["\\$where","\\$ne","\\$gt","\\$gte","\\$lt","\\$lte","\\$in","\\$nin","\\$exists","\\$regex","\\$or","\\$and","\\$not","\\$nor","\\$expr","\\$function","\\$javascript","\\$mod","\\$size","\\$type","\\$elemMatch","\\$slice","\\$push","\\$pull","\\$set","\\$unset","\\$inc","\\$mul"].forEach((e=>{const o=new RegExp(e+"\\s*:","gi");t=t.replace(o,"")})),t})(n),n=$e(n));const i=[/drop-in service for pets with overnight care and feeding/i,/pet care service/i,/animal care service/i,/dog walking service/i,/pet sitting service/i,/overnight pet care/i];let s="";for(const d of i){const t=e.match(d);if(t){s=t[0];break}}switch(s&&s.length>10&&(n=s),t.toLowerCase()){case"name":case"service_name":n=n.replace(/[^a-zA-Z0-9\s\-'\.&]/g,""),n=n.replace(/\bselect\s+\*/gi,""),n=n.replace(/\bdrop\s+table\b/gi,""),n=n.replace(/\bunion\s+select\b/gi,""),n=n.replace(/\bdelete\s+from\b/gi,""),n=n.replace(/\binsert\s+into\b/gi,""),n=n.replace(/\s{2,}/g," "),n=n.replace(/^\s+/g,"");break;case"description":case"service_description":n=n.replace(/[^a-zA-Z0-9\s\-'\.,:;!?()\/"&@#%+=]/g,""),n=n.replace(/\s{2,}/g," "),n=n.replace(/^\s+/g,"");break;case"message":n=n.replace(/[\x00-\x1F\x7F]/g,"");break;case"email":n=n.replace(/[^a-zA-Z0-9@.\-_+%]/g,""),n=n.toLowerCase();break;case"phone":n=n.replace(/[^0-9\s\-\(\)\+\.]/g,"");break;case"amount":case"price":n=n.replace(/[^\d\.]/g,"");const e=n.split(".");e.length>2&&(n=e[0]+"."+e.slice(1).join("")),2===e.length&&e[1].length>2&&(n=e[0]+"."+e[1].substring(0,2));break;case"password":n=n.replace(/[^a-zA-Z\xc0-\xff0-9!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?~`]/g,"");break;default:n=n.replace(/[^a-zA-Z0-9\s\-'\.,:;!?()\/"&]/g,""),n=n.replace(/\s{2,}/g," "),n=n.replace(/^\s+/g,"")}const l=o.maxLength||1e3;return n.length>l&&(n=n.substring(0,l)),(0,h.debugLog)('MBA7777: Native sanitization complete - Result: "'.concat(n,'"')),n},Ze=e=>{if(!e||""===e.trim())return{isValid:!1,message:"Email is required"};const t=Ke(e,"email");return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(t)?{isValid:!0,message:"",sanitizedInput:t}:{isValid:!1,message:"Please enter a valid email address"}},Xe=e=>{if(!e||""===e.trim())return{isValid:!1,message:"Name is required"};return/^[a-zA-Z\s\-'\.]+$/.test(e)?{isValid:!0,message:"",sanitizedInput:e}:{isValid:!1,message:"Name can only contain letters, spaces, hyphens, and apostrophes"}},Qe=e=>{if(!e||""===e.trim())return{isValid:!1,message:"Password is required"};const t=Ke(e,"password"),o=/[A-Z]/.test(t),n=/[a-z]/.test(t),r=/\d/.test(t),a=/[!@#$%^&*(),.?":{}|<>]/.test(t);return(0,h.IsProduction)()&&t.length<8?{isValid:!1,message:"Password must be at least ".concat(8," characters long"),sanitizedInput:t}:!(0,h.IsProduction)()||o&&n&&r&&a?{isValid:!0,message:"",sanitizedInput:t}:{isValid:!1,message:"Password must contain uppercase, lowercase, numbers, and special characters",sanitizedInput:t}},et=(e,t)=>e!==t?{isValid:!1,message:"Passwords do not match"}:{isValid:!0,message:""},tt=e=>{if(!e||""===e.trim())return{isValid:!0,message:""};const t=Ke(e,"phone");return/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/.test(t)?{isValid:!0,message:"",sanitizedInput:t}:{isValid:!1,message:"Please enter a valid phone number"}},ot=[{id:"all",name:"All",icon:"paw-outline",animalTypes:[]},{id:"farm_animals",name:"Farm Animals",icon:"horse",animalTypes:["Horse","Cow","Sheep","Goat","Pig","Other"]},{id:"domestic",name:"Domestic",icon:"paw",animalTypes:["Dogs","Cats","Birds","Rabbits","Hamsters","Other"]},{id:"reptiles",name:"Reptiles",icon:"snake",animalTypes:["Snake","Lizard","Turtle","Gecko","Chameleon","Other"]},{id:"aquatic",name:"Aquatic",icon:"fish",animalTypes:["Fish","Frog","Newt","Axolotl","Other"]},{id:"invertebrates",name:"Invertebrates",icon:"spider",animalTypes:["Spider","Scorpion","Crab","Snail","Millipede","Other"]}],nt={Horse:"horse",Cow:"cow",Sheep:"sheep",Goat:"cow",Pig:"pig",Dogs:"dog",Cats:"cat",Birds:"bird",Rabbits:"rabbit",Hamsters:"rodent",Snake:"snake",Lizard:"snake",Turtle:"turtle",Gecko:"snake",Chameleon:"snake",Fish:"fish",Frog:"snake",Newt:"fish",Axolotl:"fish",Spider:"spider",Scorpion:"spider",Crab:"fish",Snail:"snail",Millipede:"bug",Other:"help-circle-outline"},rt={Horse:"Farm Animals",Cow:"Farm Animals",Sheep:"Farm Animals",Goat:"Farm Animals",Pig:"Farm Animals",Dogs:"Domestic",Cats:"Domestic",Birds:"Domestic",Rabbits:"Domestic",Hamsters:"Domestic",Snake:"Reptiles",Lizard:"Reptiles",Turtle:"Reptiles",Gecko:"Reptiles",Chameleon:"Reptiles",Fish:"Aquatic",Frog:"Aquatic",Newt:"Aquatic",Axolotl:"Aquatic",Spider:"Invertebrates",Scorpion:"Invertebrates",Crab:"Invertebrates",Snail:"Invertebrates",Millipede:"Invertebrates"};ot[0].animalTypes=(()=>{const e=[];return ot.forEach((t=>{"all"!==t.id&&t.animalTypes.forEach((t=>{"Other"===t||e.includes(t)||e.push(t)}))})),e})();const at=(e,t=null)=>{if(nt[e])return nt[e];if(t){const e=ot.find((e=>e.id===t));if(e)return e.icon}return"paw"},it=({serviceData:e,setServiceData:t})=>{const[o,s]=(0,n.useState)(""),[l,d]=(0,n.useState)(""),[c,u]=(0,n.useState)(C.default.get("window").width),[g,f]=(0,n.useState)("");(0,n.useEffect)((()=>{const e=()=>{u(C.default.get("window").width)};return C.default.addEventListener("change",e),()=>{C.default.removeEventListener&&C.default.removeEventListener("change",e)}}),[]),(0,n.useEffect)((()=>{!l&&ot.length>1&&d(ot[1].id),(0,h.debugLog)("MBA456789","CategorySelectionStep received serviceData:",e),e.animalTypes&&e.animalTypes.length>0&&(0,h.debugLog)("MBA456789","Initial animal types in CategorySelectionStep:",e.animalTypes)}),[]);const p=t=>!(!e.animalTypes||!e.animalTypes.length)&&e.animalTypes.some((e=>"string"===typeof e?e===t:"object"===typeof e&&null!==e&&e.name===t)),y=(e,o=null)=>{(0,h.debugLog)("MBA456789","Selecting animal: ".concat(e,", categoryId: ").concat(o)),"Other"!==e?t((t=>{const n=t.animalTypes||[];(0,h.debugLog)("MBA456789","Current animal types before update:",n);const r=n.findIndex((t=>"string"===typeof t?t===e:"object"===typeof t&&null!==t&&t.name===e));if((0,h.debugLog)("MBA456789","Animal ".concat(e," is ").concat(-1!==r?"already selected":"not selected")),-1!==r){const e=[...n];return e.splice(r,1),(0,h.debugLog)("MBA456789","Animal types after removal:",e),Object.assign({},t,{animalTypes:e})}{const r=rt[e]||"Other";let a=o;if(!a){const e=ot.find((e=>e.name===r));a=e?e.id:"other"}const i={name:e,categoryId:a,categoryName:r,isCustom:!1};return(0,h.debugLog)("MBA456789","Adding new animal:",i),(0,h.debugLog)("MBA456789","Animal types after addition:",[...n,i]),Object.assign({},t,{animalTypes:[...n,i]})}})):d(o||ot[1]&&ot[1].id)},{animalTypes:b}=(()=>{(0,h.debugLog)("MBA456789","Current serviceData.animalTypes:",e.animalTypes);let t=[{name:"Dogs",categoryId:"domestic",categoryName:"Domestic",icon:at("Dogs","domestic")},{name:"Cats",categoryId:"domestic",categoryName:"Domestic",icon:at("Cats","domestic")}];return e.animalTypes&&e.animalTypes.length>0&&e.animalTypes.forEach((e=>{if("object"!==typeof e||!e||!e.name)return;if(e.isCustom||"Dogs"!==e.name&&"Cats"!==e.name){let o=e.categoryId,n=e.categoryName||"Other";if(!o&&n){const e=ot.find((e=>e.name===n));e&&(o=e.id)}if(!n&&o){const e=ot.find((e=>e.id===o));e&&(n=e.name)}t.find((t=>t.name===e.name))||((0,h.debugLog)("MBA456789","Adding custom animal to filtered list: ".concat(e.name,", category: ").concat(n)),t.push({name:e.name,categoryId:o,categoryName:n,icon:at(e.name,o),isCustom:!0}))}})),(0,h.debugLog)("MBA456789","Filtered animal types to show:",t),{animalTypes:t,categories:[]}})(),x=i.default.create({container:{flex:1,padding:16},title:{fontSize:24,fontWeight:"600",color:m.theme.colors.text,marginBottom:16,fontFamily:m.theme.fonts.header.fontFamily},subtitle:{fontSize:20,fontWeight:"600",color:m.theme.colors.text,marginTop:24,marginBottom:16,fontFamily:m.theme.fonts.header.fontFamily},instructions:{fontSize:16,color:m.theme.colors.textSecondary,marginBottom:16,fontFamily:m.theme.fonts.regular.fontFamily},animalTypesGrid:{flexDirection:"row",flexWrap:"wrap",gap:16},animalTypeItem:{flex:1,minWidth:c<=420?"45%":"30%",marginBottom:12},animalTypeCard:{borderRadius:12,borderWidth:1,borderColor:m.theme.colors.border,backgroundColor:m.theme.colors.surface,padding:16,height:70,justifyContent:"center"},selectedAnimalCard:{borderColor:m.theme.colors.mainColors.main,backgroundColor:m.theme.colors.mainColors.mainLight},animalTypeRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},animalIconAndName:{flexDirection:"row",alignItems:"center",gap:12},animalTypeName:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},customInputContainer:{marginTop:6,padding:16,borderRadius:12,borderWidth:1,borderColor:m.theme.colors.border,backgroundColor:m.theme.colors.backgroundContrast},customInputTitle:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,marginBottom:12,fontFamily:m.theme.fonts.regular.fontFamily},inputRow:{flexDirection:"row",gap:8,marginBottom:12},textInputContainer:{flex:1,marginRight:12},textInput:{flex:1,height:48,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,paddingHorizontal:12,backgroundColor:m.theme.colors.surface,fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},textInputError:{borderColor:m.theme.colors.error},pickerContainer:{flex:1,height:48,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,backgroundColor:m.theme.colors.surface,justifyContent:"center"},picker:{height:48,color:m.theme.colors.text},addButton:{backgroundColor:m.theme.colors.mainColors.main,borderRadius:8,paddingVertical:12,paddingHorizontal:16,alignItems:"center"},addButtonText:{color:m.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},addButtonDisabled:{backgroundColor:m.theme.colors.border,opacity:.6},addButtonTextDisabled:{color:m.theme.colors.textSecondary},selectedAnimalsSection:{marginTop:24,marginBottom:16,padding:16,backgroundColor:m.theme.colors.backgroundContrast,borderRadius:12,borderWidth:1,borderColor:m.theme.colors.border},selectedAnimalsTitle:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,marginBottom:12,fontFamily:m.theme.fonts.regular.fontFamily},selectedAnimalsList:{flexDirection:"row",flexWrap:"wrap",gap:8},animalBubble:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surface,borderRadius:20,paddingVertical:6,paddingHorizontal:12,borderWidth:1,borderColor:m.theme.colors.border,marginBottom:8,marginRight:8,gap:8},animalBubbleText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},removeAnimalButton:{padding:2},errorText:{color:m.theme.colors.error,fontSize:12,marginTop:4,fontFamily:m.theme.fonts.regular.fontFamily}});return(0,j.jsxs)(X.default,{style:x.container,children:[(0,j.jsx)(a.default,{style:x.title,children:"Select Animal Types for Your Service"}),(0,j.jsx)(a.default,{style:x.instructions,children:"Choose the animal types your service will cover. You can select Dogs, Cats, or add custom animals."}),e.animalTypes.length>0&&(0,j.jsxs)(r.default,{style:x.selectedAnimalsSection,children:[(0,j.jsxs)(a.default,{style:x.selectedAnimalsTitle,children:["Selected Animals (",e.animalTypes.length,")"]}),(0,j.jsx)(r.default,{style:x.selectedAnimalsList,children:e.animalTypes.map(((e,t)=>{const o=e.name,n=at(o,e.categoryId);return(0,j.jsxs)(r.default,{style:x.animalBubble,children:[(0,j.jsx)(S.default,{name:n,size:18,color:m.theme.colors.text}),(0,j.jsx)(a.default,{style:x.animalBubbleText,children:o}),(0,j.jsx)(v.default,{onPress:()=>y(o),style:x.removeAnimalButton,children:(0,j.jsx)(S.default,{name:"close-circle",size:16,color:m.theme.colors.text})})]},t)}))})]}),b.length>0?(0,j.jsx)(r.default,{style:x.animalTypesGrid,children:b.filter((e=>"Dogs"===e.name||"Cats"===e.name)).map((e=>(0,j.jsx)(r.default,{style:x.animalTypeItem,children:(0,j.jsx)(v.default,{style:[x.animalTypeCard,p(e.name)&&x.selectedAnimalCard],onPress:()=>y(e.name,e.categoryId),children:(0,j.jsxs)(r.default,{style:x.animalTypeRow,children:[(0,j.jsxs)(r.default,{style:x.animalIconAndName,children:[(0,j.jsx)(S.default,{name:e.icon,size:24,color:m.theme.colors.text}),(0,j.jsx)(a.default,{style:x.animalTypeName,children:e.name})]}),p(e.name)&&(0,j.jsx)(S.default,{name:"check-circle",size:24,color:m.theme.colors.mainColors.main})]})})},"".concat(e.categoryId,"-").concat(e.name))))}):null,(0,j.jsxs)(r.default,{style:x.customInputContainer,children:[(0,j.jsx)(a.default,{style:x.customInputTitle,children:"Add a Custom Animal Type"}),(0,j.jsxs)(r.default,{style:x.inputRow,children:[(0,j.jsxs)(r.default,{style:x.textInputContainer,children:[(0,j.jsx)(te.default,{style:[x.textInput,g?x.textInputError:null],placeholder:"Animal Type (e.g. Hamster)",value:o,onChangeText:e=>{(0,h.debugLog)("MBA7777","Custom animal input change:",e);const t=Ke(e,"service_name",{maxLength:30}),o=Xe(t);!o.isValid&&t.length>0?f(o.message):f(""),s(t)},placeholderTextColor:m.theme.colors.placeHolderText,maxLength:30}),g?(0,j.jsx)(a.default,{style:x.errorText,children:g}):null]}),(0,j.jsx)(r.default,{style:x.pickerContainer,children:n.createElement("select",{value:l,onChange:e=>d(e.target.value),style:x.picker},ot.filter((e=>"all"!==e.id)).map((e=>n.createElement("option",{key:e.id,value:e.id},e.name))))})]}),(0,j.jsx)(v.default,{style:[x.addButton,!o.trim()||g?x.addButtonDisabled:null],onPress:()=>{if(!o.trim())return void f("Animal name is required");const n=Xe(o);if(!n.isValid)return void f(n.message);if(o.trim().length<2)return void f("Animal name must be at least 2 characters long");if(e.animalTypes.some((e=>e.name.toLowerCase()===o.trim().toLowerCase())))return void f("This animal type is already added");(0,h.debugLog)("MBA7777","Adding custom animal with validated input:",o.trim());let r="Other";if(l){const e=ot.find((e=>e.id===l));e&&(r=e.name)}if(t((e=>Object.assign({},e,{animalTypes:[...e.animalTypes,{name:o.trim(),categoryId:l||"other",categoryName:r,isCustom:!0}]}))),l){if(!e.generalCategories.some((e=>e.id===l))){const e=ot.find((e=>e.id===l));e&&t((t=>Object.assign({},t,{generalCategories:[...t.generalCategories,{id:e.id,name:e.name,icon:e.icon}]})))}}s(""),f("")},disabled:!o.trim()||g,children:(0,j.jsx)(a.default,{style:[x.addButtonText,!o.trim()||g?x.addButtonTextDisabled:null],children:"Add Animal"})})]})]})};var st=o(74037);const lt=i.default.create({container:{width:"100%",position:"relative",marginRight:m.theme.spacing.medium,marginBottom:m.theme.spacing.medium,zIndex:1e3},input:{height:48,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,paddingHorizontal:m.theme.spacing.medium,backgroundColor:m.theme.colors.surface,width:"100%"},suggestionsWrapper:{position:"absolute",top:"100%",left:0,right:0,maxHeight:200,backgroundColor:m.theme.colors.background,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,zIndex:1e3,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3},suggestionsContainer:{flex:1},suggestionItem:{padding:m.theme.spacing.medium,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},suggestionText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},notAvailableText:{color:m.theme.colors.placeholderText,fontStyle:"italic"}}),dt=({value:e,onChange:t,suggestions:o,placeholder:i,zIndex:s=1e3,showNotAvailable:l=!1,placeHolderTextColor:d})=>{const[c,u]=(0,n.useState)(!1),[g,m]=(0,n.useState)([]),h={container:Object.assign({},lt.container,{zIndex:s}),suggestionsWrapper:Object.assign({},lt.suggestionsWrapper,{zIndex:s})};return(0,j.jsxs)(r.default,{style:h.container,children:[(0,j.jsx)(te.default,{style:lt.input,placeholder:i,placeholderTextColor:d,value:e,onChangeText:e=>{if(t(e),e.length>0){const t=o.filter((t=>t.toLowerCase().includes(e.toLowerCase())));0===t.length&&l?m(["We're not available in \"".concat(e,'" yet - coming soon!')]):m(t),u(!0)}else u(!1)},onFocus:()=>{if(o.length>0){if(e.length>0){const t=o.filter((t=>t.toLowerCase().includes(e.toLowerCase())));m(t)}else m(o);u(!0)}},onBlur:()=>{setTimeout((()=>{u(!1)}),150)}}),c&&(0,j.jsx)(r.default,{style:h.suggestionsWrapper,children:(0,j.jsx)(X.default,{style:lt.suggestionsContainer,keyboardShouldPersistTaps:"always",nestedScrollEnabled:!0,children:g.map(((e,o)=>{const n=e.startsWith("We're not available in");return(0,j.jsx)(v.default,{style:lt.suggestionItem,onPress:()=>(e=>{e.startsWith("We're not available in")||t(e),u(!1)})(e),children:(0,j.jsx)(a.default,{style:[lt.suggestionText,n&&lt.notAvailableText],children:e})},o)}))})})]})},ct=300,ut=i.default.create({container:{flex:1,padding:16},title:{fontSize:24,fontWeight:"600",color:m.theme.colors.text,marginBottom:24,fontFamily:m.theme.fonts.regular.fontFamily},inputGroup:{marginBottom:24},label:{fontSize:16,color:m.theme.colors.text,marginBottom:8,fontFamily:m.theme.fonts.regular.fontFamily},input:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:12,padding:16,fontSize:16,color:m.theme.colors.text,backgroundColor:m.theme.colors.surface,fontFamily:m.theme.fonts.regular.fontFamily},inputError:{borderColor:m.theme.colors.error},textArea:{height:120,textAlignVertical:"top"},switchContainer:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:16,flexDirection:"row",alignItems:"center",justifyContent:"space-between",borderWidth:1,borderColor:m.theme.colors.border},switchGroup:{flex:1,marginRight:16},switchLabel:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:4},switchSubLabel:{fontSize:14,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily},errorText:{color:m.theme.colors.error,fontSize:14,marginTop:4,fontFamily:m.theme.fonts.regular.fontFamily},characterCount:{color:m.theme.colors.textSecondary,fontSize:12,marginTop:4,textAlign:"right",fontFamily:m.theme.fonts.regular.fontFamily},dropdownContainer:{zIndex:1e3}}),gt=({serviceData:e,setServiceData:t})=>{const[o,i]=(0,n.useState)(""),[s,l]=(0,n.useState)("");return(0,j.jsxs)(r.default,{style:ut.container,children:[(0,j.jsx)(a.default,{style:ut.title,children:"Service Details"}),(0,j.jsxs)(r.default,{style:[ut.inputGroup,ut.dropdownContainer],children:[(0,j.jsx)(a.default,{style:ut.label,children:"Service Name"}),(0,j.jsx)(dt,{value:e.serviceName,onChange:e=>{(0,h.debugLog)("MBA7777","Service name input change:",e);const o=Ke(e,"service_name",{maxLength:35});o.length>0&&o.length<3?i("Service name must be at least 3 characters long"):o.length>35?i("Service name must be no more than ".concat(35," characters long")):i("");const n=o.toLowerCase().includes("overnight")||o.toLowerCase().includes("over night");t((e=>Object.assign({},e,{serviceName:o,isOvernight:n||e.isOvernight})))},suggestions:ve,placeholder:"e.g. Dog Walking",placeHolderTextColor:m.theme.colors.placeHolderText,zIndex:1e3}),o?(0,j.jsx)(a.default,{style:ut.errorText,children:o}):null]}),(0,j.jsxs)(r.default,{style:ut.inputGroup,children:[(0,j.jsx)(a.default,{style:ut.label,children:"Service Description"}),(0,j.jsx)(te.default,{style:[ut.input,ut.textArea,s?ut.inputError:null],value:e.serviceDescription,onChangeText:e=>{(0,h.debugLog)("MBA7777","Service description input change:",e);const o=Ke(e,"service_description",{maxLength:ct});o.length>0&&o.length<10?l("Service description must be at least 10 characters long"):o.length>ct?l("Service description must be no more than ".concat(ct," characters long")):l(""),t((e=>Object.assign({},e,{serviceDescription:o})))},placeholder:"Describe your service in detail...",placeholderTextColor:m.theme.colors.placeHolderText,multiline:!0,numberOfLines:6,textAlignVertical:"top",maxLength:ct}),(0,j.jsxs)(a.default,{style:ut.characterCount,children:[e.serviceDescription.length,"/",ct]}),s?(0,j.jsx)(a.default,{style:ut.errorText,children:s}):null]}),(0,j.jsxs)(r.default,{style:ut.switchContainer,children:[(0,j.jsxs)(r.default,{style:ut.switchGroup,children:[(0,j.jsx)(a.default,{style:ut.switchLabel,children:"Overnight Service"}),(0,j.jsx)(a.default,{style:ut.switchSubLabel,children:"Does this service require overnight stay?"})]}),(0,j.jsx)(st.default,{value:e.isOvernight,onValueChange:e=>{t((t=>Object.assign({},t,{isOvernight:e})))},trackColor:{false:m.theme.colors.border,true:m.theme.colors.mainColors.main},thumbColor:m.theme.colors.surface,ios_backgroundColor:m.theme.colors.border})]})]})};var mt=o(51950);const ht=Object.keys(we),ft=["1","2","3","4","5"],pt=i.default.create({container:{flex:1,padding:16},title:{fontSize:24,fontWeight:"600",color:m.theme.colors.text,marginBottom:24,fontFamily:m.theme.fonts.regular.fontFamily},rateContainer:{marginBottom:24},label:{fontSize:16,color:m.theme.colors.text,marginBottom:8,fontFamily:m.theme.fonts.regular.fontFamily},rateInputGroup:{flexDirection:"row",gap:12},currencyInputContainer:{flex:1,flexDirection:"row",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,paddingHorizontal:12,backgroundColor:m.theme.colors.surface},currencySymbol:{fontSize:16,color:m.theme.colors.text,marginRight:4,fontFamily:m.theme.fonts.regular.fontFamily},currencyInput:{flex:1,fontSize:16,color:m.theme.colors.text,padding:12,fontFamily:m.theme.fonts.regular.fontFamily,outlineStyle:"none"},unitSelector:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"space-between",borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,paddingHorizontal:12,paddingVertical:12,backgroundColor:m.theme.colors.surface},unitText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},dropdownContainer:{position:"absolute",top:"100%",backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,marginTop:4,zIndex:1e3,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,maxHeight:200},dropdownScroll:{width:"100%"},dropdownScrollContent:{flexGrow:1},dropdownItem:{padding:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},selectedDropdownItem:{backgroundColor:m.theme.colors.mainColors.mainLight},dropdownText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},selectedDropdownText:{color:m.theme.colors.mainColors.main,fontWeight:"600"},holidayRateContainer:{marginBottom:24},holidayRateHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},rateTypeToggleContainer:{flexDirection:"row",alignItems:"center",overflow:"hidden",borderRadius:8},toggleButton:{paddingVertical:8,paddingHorizontal:14,alignItems:"center",justifyContent:"center",minWidth:40,width:44,height:36},activeToggleButton:{backgroundColor:m.theme.colors.mainColors.main,borderWidth:1,borderColor:m.theme.colors.mainColors.main},inactiveToggleButton:{backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border},toggleButtonText:{fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},activeToggleText:{color:m.theme.colors.surface,fontWeight:"600"},inactiveToggleText:{color:m.theme.colors.text},holidayRateInputWrapper:{position:"relative"},percentageInputContainer:{flexDirection:"row",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,paddingHorizontal:12,backgroundColor:m.theme.colors.surface},percentageInput:{flex:1,fontSize:16,color:m.theme.colors.text,padding:12,fontFamily:m.theme.fonts.regular.fontFamily,outlineStyle:"none"},percentageSymbol:{fontSize:16,color:m.theme.colors.text,marginRight:8,fontFamily:m.theme.fonts.regular.fontFamily},calculatedHolidayRate:{position:"absolute",bottom:-24,right:4,fontSize:14,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily,paddingTop:4},customRatesContainer:{},customRateItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:12,backgroundColor:m.theme.colors.surface,borderRadius:8,marginBottom:8,borderWidth:1,borderColor:m.theme.colors.border},customRateContent:{flex:1,flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginRight:12},customRateActions:{flexDirection:"row",gap:8},customRateTitleContainer:{flex:1,marginRight:16},customRateTitle:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},customRateDescription:{fontSize:14,color:m.theme.colors.placeHolderText,marginTop:2,fontFamily:m.theme.fonts.regular.fontFamily},customRateAmount:{fontSize:16,color:m.theme.colors.text,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},newCustomRateContainer:{gap:12,marginBottom:16},customRateInput:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,padding:12,fontSize:16,color:m.theme.colors.text,backgroundColor:m.theme.colors.surface,fontFamily:m.theme.fonts.regular.fontFamily,outlineStyle:"none"},textArea:{height:80,textAlignVertical:"top"},addRateButton:{flexDirection:"row",alignItems:"center",gap:8,padding:12,borderWidth:1,borderColor:m.theme.colors.mainColors.main,borderRadius:8,justifyContent:"center"},addRateText:{color:m.theme.colors.mainColors.main,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},customRateButtonContainer:{flexDirection:"row",gap:12,marginTop:12},cancelRateButton:{flex:1,flexDirection:"row",alignItems:"center",gap:8,padding:12,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,justifyContent:"center",backgroundColor:m.theme.colors.surface},cancelRateText:{color:m.theme.colors.text,fontSize:16,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},saveRateButton:{flex:2,backgroundColor:m.theme.colors.mainColors.main,borderColor:m.theme.colors.mainColors.main},disabledSaveButton:{backgroundColor:m.theme.colors.placeHolderText,borderColor:m.theme.colors.placeHolderText},saveRateText:{color:m.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},customRateFormHeading:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,marginBottom:12,fontFamily:m.theme.fonts.regular.fontFamily},noCustomRatesText:{fontSize:14,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:16,fontStyle:"italic"},customRateAction:{padding:8,borderRadius:4},modalOverlay:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:m.theme.colors.surface,padding:24,borderRadius:12,maxWidth:"85%",minWidth:280,alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5},modalIcon:{marginBottom:16},modalTitle:{fontSize:20,fontWeight:"600",color:m.theme.colors.text,marginBottom:12,textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily},modalText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:24,textAlign:"center",lineHeight:22},modalButton:{backgroundColor:m.theme.colors.mainColors.main,paddingVertical:12,paddingHorizontal:24,borderRadius:8},modalButtonText:{color:m.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center"},disabledUnitSelector:{backgroundColor:m.theme.colors.surface,opacity:.8,borderColor:m.theme.colors.modernBorder},inputError:{borderColor:m.theme.colors.error},errorText:{color:m.theme.colors.error,fontSize:12,marginTop:4,fontFamily:m.theme.fonts.regular.fontFamily}}),yt=({serviceData:e,setServiceData:t,isUpdatingService:o,setIsUpdatingService:i,onProceedWithUpdate:s})=>{(0,h.debugLog)("MBA5931","RatesAndReviewStep render - isOvernight status:",e.isOvernight);const[l,d]=(0,n.useState)(!1),[c,u]=(0,n.useState)(!1),[g,f]=(0,n.useState)(!1),[p,y]=(0,n.useState)(!0),[b,x]=(0,n.useState)(!1),[w,C]=(0,n.useState)(!1),[T,B]=(0,n.useState)({title:"",rate:"",description:""}),[A,_]=(0,n.useState)(""),[I,M]=(0,n.useState)(""),[L,R]=(0,n.useState)(""),[D,z]=(0,n.useState)(""),[P,F]=(0,n.useState)(""),[E,W]=(0,n.useState)(""),O=e.isOvernight?["Per Night"]:ht;(0,n.useEffect)((()=>{if(t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{isPercent:p})}))),e.isOvernight)(0,h.debugLog)("MBA5931","Service is overnight, setting rate unit to Per Night"),t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{base_rate_unit:"Per Night"})})));else if(e.rates?.base_rate_unit&&!Ce[e.rates.base_rate_unit]){(0,h.debugLog)("MBA5931","Converting initial base_rate_unit to mapped value");!Object.keys(we).find((t=>we[t]===e.rates.base_rate_unit))&&e.rates.base_rate_unit&&(0,h.debugLog)("MBA5931","No mapping found for:",e.rates.base_rate_unit)}if(e.rates?.holidayRate){const o=e.rates.holidayRate.toString();o.includes("%")?(y(!0),t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{holidayRate:o.replace("%",""),isPercent:!0})})))):o.includes("$")&&(y(!1),t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{holidayRate:o.replace("$",""),isPercent:!1})}))))}}),[]),(0,n.useEffect)((()=>{(0,h.debugLog)("MBA5931","Available TIME_UNITS:",ht),(0,h.debugLog)("MBA5931","TIME_UNIT_MAPPING:",we),(0,h.debugLog)("MBA5931","Current base_rate_unit:",e.rates?.base_rate_unit),(0,h.debugLog)("MBA5931","Displayed unit text:",e.rates?.base_rate_unit?Ce[e.rates.base_rate_unit]||e.rates.base_rate_unit:ht[0])}),[e.rates?.base_rate_unit]),(0,n.useEffect)((()=>{e.isOvernight&&((0,h.debugLog)("MBA5931","Overnight service detected, forcing Per Night rate unit"),t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{base_rate_unit:"Per Night"})}))))}),[e.isOvernight]);const N=()=>{const e=g;return(0,h.debugLog)("MBAno34othg0v","hasUnsavedCustomRate check:",{customChargeVisible:g,title:T.title,rate:T.rate,description:T.description,result:e}),e};(0,n.useEffect)((()=>{if((0,h.debugLog)("MBAno34othg0v","isUpdatingService changed:",{isUpdatingService:o,hasUnsaved:N()}),!o)return;N()?((0,h.debugLog)("MBAno34othg0v","Showing unsaved rate warning modal"),C(!0),i&&((0,h.debugLog)("MBAno34othg0v","Setting isUpdatingService to FALSE to prevent API call"),i(!1))):((0,h.debugLog)("MBAno34othg0v","No unsaved custom rate, allowing update to proceed"),i&&((0,h.debugLog)("MBAno34othg0v","Setting isUpdatingService to TRUE to allow parent to call API"),i(!0),"function"===typeof s&&((0,h.debugLog)("MBAno34othg0v","Calling onProceedWithUpdate directly"),s())))}),[o]);const H=(e,t="amount")=>{(0,h.debugLog)("MBA7777","Formatting numeric input for ".concat(t,":"),e);const o=Ke(e,"amount",{maxLength:10});if(""===o)return"";const n=o.replace(/[^0-9.]/g,""),r=n.split(".");return r.length>2?"".concat(r[0],".").concat(r.slice(1).join("")):2===r.length&&r[1].length>2?"".concat(r[0],".").concat(r[1].substring(0,2)):n},U=(e,t)=>{if((0,h.debugLog)("MBA7777","Custom rate ".concat(e," change:"),t),"rate"===e){const o=H(t,"custom rate amount");if(""!==o&&(isNaN(Number(o))||Number(o)<0))return void F("Rate amount must be a valid positive number");P&&F(""),B((t=>Object.assign({},t,{[e]:o})))}else if("title"===e){const o=Ke(t,"service_name",{maxLength:50});o.length>0&&o.length<2?z("Title must be at least 2 characters long"):o.length>50?z("Title must be no more than 50 characters long"):z(""),B((t=>Object.assign({},t,{[e]:o})))}else if("description"===e){const o=Ke(t,"service_description",{maxLength:200});o.length>200?W("Description must be no more than 200 characters long"):W(""),B((t=>Object.assign({},t,{[e]:o})))}},V=()=>{if(!g)return(0,h.debugLog)("MBAno34othg0v","Opening custom rate form"),f(!0),x(!1),z(""),F(""),void W("");if(D||P||E)return void(0,h.debugLog)("MBA7777","Cannot save custom rate due to validation errors");if(!T.title.trim())return z("Title is required"),void(0,h.debugLog)("MBAno34othg0v","Missing custom rate title");if(T.title.trim().length<2)return z("Title must be at least 2 characters long"),void(0,h.debugLog)("MBAno34othg0v","Custom rate title too short");if(!T.rate)return F("Rate amount is required"),void(0,h.debugLog)("MBAno34othg0v","Missing custom rate value");const e=parseFloat(T.rate);if(isNaN(e)||e<=0)return F("Rate amount must be a valid number greater than $0"),void(0,h.debugLog)("MBAno34othg0v","Invalid rate value:",T.rate);(0,h.debugLog)("MBAno34othg0v","Saving custom rate successfully:",T);const o={title:T.title.trim(),rate:T.rate,description:T.description.trim()};t((e=>Object.assign({},e,{additionalRates:[...e.additionalRates||[],o]}))),B({title:"",rate:"",description:""}),z(""),F(""),W(""),f(!1),x(!1)},q=(e,t,o,n,i)=>n?(0,j.jsx)(r.default,{style:[pt.dropdownContainer,i],children:(0,j.jsx)(X.default,{style:pt.dropdownScroll,contentContainerStyle:pt.dropdownScrollContent,children:e.map((e=>(0,j.jsx)(v.default,{style:[pt.dropdownItem,t===e&&pt.selectedDropdownItem],onPress:()=>o(e),children:(0,j.jsx)(a.default,{style:[pt.dropdownText,t===e&&pt.selectedDropdownText],children:e})},e)))})}):null;return(0,j.jsx)(mt.default,{onPress:()=>{l&&d(!1),c&&u(!1)},children:(0,j.jsxs)(X.default,{style:pt.container,children:[(0,j.jsx)(a.default,{style:pt.title,children:"Set Your Rates"}),(0,j.jsx)(k.default,{visible:w,transparent:!0,animationType:"fade",onRequestClose:()=>C(!1),children:(0,j.jsx)(r.default,{style:pt.modalOverlay,children:(0,j.jsxs)(r.default,{style:pt.modalContent,children:[(0,j.jsx)(S.default,{name:"alert-circle",size:48,color:m.theme.colors.error,style:pt.modalIcon}),(0,j.jsx)(a.default,{style:pt.modalTitle,children:"Unsaved Custom Rate"}),(0,j.jsx)(a.default,{style:pt.modalText,children:"Please save or cancel your custom rate before updating the service."}),(0,j.jsx)(v.default,{style:pt.modalButton,onPress:()=>{(0,h.debugLog)("MBAno34othg0v","Modal OK button clicked"),C(!1)},children:(0,j.jsx)(a.default,{style:pt.modalButtonText,children:"OK"})})]})})}),(0,j.jsxs)(r.default,{style:[pt.rateContainer,{zIndex:3}],children:[(0,j.jsxs)(a.default,{style:pt.label,children:["Base Rate ",(0,j.jsx)(a.default,{style:{color:m.theme.colors.placeHolderText},children:"(Required)"})]}),(0,j.jsxs)(r.default,{style:pt.rateInputGroup,children:[(0,j.jsxs)(r.default,{style:[pt.currencyInputContainer,{flex:1},A?pt.inputError:null],children:[(0,j.jsx)(a.default,{style:pt.currencySymbol,children:"$"}),(0,j.jsx)(te.default,{style:pt.currencyInput,placeholder:"0.00",keyboardType:"decimal-pad",value:e.rates?.base_rate||"",onChangeText:e=>{(0,h.debugLog)("MBA7777","Base rate input change:",e);const o=H(e,"base rate");""!==o&&(isNaN(Number(o))||Number(o)<0)?_("Base rate must be a valid positive number"):(A&&_(""),t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{base_rate:o})}))))},placeholderTextColor:m.theme.colors.placeHolderText})]}),(0,j.jsxs)(r.default,{style:{flex:1,zIndex:1},children:[(0,j.jsxs)(v.default,{style:[pt.unitSelector,e.isOvernight&&pt.disabledUnitSelector],onPress:()=>{e.isOvernight||(u(!1),d(!l))},disabled:e.isOvernight,children:[(0,j.jsx)(a.default,{style:pt.unitText,children:e.isOvernight?"Per Night":e.rates?.base_rate_unit?Ce[e.rates.base_rate_unit]||e.rates.base_rate_unit:ht[0]}),!e.isOvernight&&(0,j.jsx)(S.default,{name:l?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})]}),q(O,e.rates?.base_rate_unit,(o=>{const n=e.isOvernight?"Per Night":we[o];t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{base_rate_unit:n})}))),d(!1)}),l&&!e.isOvernight,{width:"100%"})]})]}),A?(0,j.jsx)(a.default,{style:pt.errorText,children:A}):null]}),(0,j.jsxs)(r.default,{style:[pt.rateContainer,{zIndex:2}],children:[(0,j.jsxs)(a.default,{style:pt.label,children:["Additional Animal Rate ",(0,j.jsx)(a.default,{style:{color:m.theme.colors.placeHolderText},children:"(Optional)"})]}),(0,j.jsxs)(r.default,{style:pt.rateInputGroup,children:[(0,j.jsxs)(r.default,{style:[pt.currencyInputContainer,{flex:1},I?pt.inputError:null],children:[(0,j.jsx)(a.default,{style:pt.currencySymbol,children:"$"}),(0,j.jsx)(te.default,{style:pt.currencyInput,placeholder:"0.00",keyboardType:"decimal-pad",value:e.rates?.additionalAnimalRate||"",onChangeText:e=>{(0,h.debugLog)("MBA7777","Additional animal rate input change:",e);const o=H(e,"additional animal rate");""!==o&&(isNaN(Number(o))||Number(o)<0)?M("Additional animal rate must be a valid positive number"):(I&&M(""),t((e=>Object.assign({},e,{rates:Object.assign({},e.rates,{additionalAnimalRate:o})}))))},placeholderTextColor:m.theme.colors.placeHolderText})]}),(0,j.jsxs)(r.default,{style:{flex:1,zIndex:1},children:[(0,j.jsxs)(v.default,{style:pt.unitSelector,onPress:()=>{d(!1),u(!c)},children:[(0,j.jsxs)(a.default,{style:pt.unitText,children:["After ",e.rates?.additionalAnimalThreshold||"1"," animals"]}),(0,j.jsx)(S.default,{name:c?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})]}),q(ft,e.rates?.additionalAnimalThreshold,(e=>{t((t=>Object.assign({},t,{rates:Object.assign({},t.rates,{additionalAnimalThreshold:e})}))),u(!1)}),c,{width:"100%"})]})]}),I?(0,j.jsx)(a.default,{style:pt.errorText,children:I}):null]}),(0,j.jsxs)(r.default,{style:pt.customRatesContainer,children:[(0,j.jsxs)(a.default,{style:pt.label,children:["Custom Charges ",(0,j.jsx)(a.default,{style:{color:m.theme.colors.placeHolderText},children:"(Optional)"})]}),e.additionalRates?.length>0?e.additionalRates.map(((o,n)=>(0,j.jsxs)(r.default,{style:pt.customRateItem,children:[(0,j.jsxs)(r.default,{style:pt.customRateContent,children:[(0,j.jsxs)(r.default,{style:pt.customRateTitleContainer,children:[(0,j.jsx)(a.default,{style:pt.customRateTitle,children:o.title}),o.description?(0,j.jsx)(a.default,{style:pt.customRateDescription,numberOfLines:1,children:o.description}):null]}),(0,j.jsxs)(a.default,{style:pt.customRateAmount,children:["$",o.rate]})]}),(0,j.jsxs)(r.default,{style:pt.customRateActions,children:[(0,j.jsx)(v.default,{onPress:()=>(o=>{const n=e.additionalRates[o];B({title:n.title,rate:n.rate,description:n.description||""}),f(!0),x(!0),t((e=>Object.assign({},e,{additionalRates:e.additionalRates.filter(((e,t)=>t!==o))})))})(n),style:pt.customRateAction,activeOpacity:.7,children:(0,j.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.mainColors.main})}),(0,j.jsx)(v.default,{onPress:()=>(e=>{t((t=>Object.assign({},t,{additionalRates:t.additionalRates.filter(((t,o)=>o!==e))})))})(n),style:pt.customRateAction,activeOpacity:.7,children:(0,j.jsx)(S.default,{name:"delete",size:20,color:"#F26969"})})]})]},n))):g?null:(0,j.jsx)(a.default,{style:pt.noCustomRatesText,children:"No custom charges added yet. Use the button below to add one."}),g?(0,j.jsxs)(r.default,{style:pt.newCustomRateContainer,children:[(0,j.jsx)(a.default,{style:pt.customRateFormHeading,children:b?"Edit Custom Rate":"New Custom Rate"}),(0,j.jsx)(te.default,{style:[pt.customRateInput,D?pt.inputError:null],placeholder:"Charge Title",value:T.title,onChangeText:e=>U("title",e),placeholderTextColor:m.theme.colors.placeHolderText,maxLength:50}),D?(0,j.jsx)(a.default,{style:pt.errorText,children:D}):null,(0,j.jsxs)(r.default,{style:[pt.currencyInputContainer,P?pt.inputError:null],children:[(0,j.jsx)(a.default,{style:pt.currencySymbol,children:"$"}),(0,j.jsx)(te.default,{style:pt.currencyInput,placeholder:"0.00",keyboardType:"decimal-pad",value:T.rate,onChangeText:e=>U("rate",e),placeholderTextColor:m.theme.colors.placeHolderText})]}),P?(0,j.jsx)(a.default,{style:pt.errorText,children:P}):null,(0,j.jsx)(te.default,{style:[pt.customRateInput,pt.textArea,E?pt.inputError:null],placeholder:"Description",value:T.description,onChangeText:e=>U("description",e),placeholderTextColor:m.theme.colors.placeHolderText,multiline:!0,numberOfLines:3,maxLength:200}),E?(0,j.jsx)(a.default,{style:pt.errorText,children:E}):null,(0,j.jsxs)(r.default,{style:pt.customRateButtonContainer,children:[(0,j.jsxs)(v.default,{style:pt.cancelRateButton,onPress:()=>{(0,h.debugLog)("MBAno34othg0v","Cancel button pressed for custom rate form"),f(!1),B({title:"",rate:"",description:""}),x(!1),C(!1)},children:[(0,j.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.text}),(0,j.jsx)(a.default,{style:pt.cancelRateText,children:"Cancel"})]}),(0,j.jsxs)(v.default,{style:[pt.addRateButton,pt.saveRateButton,!T.title.trim()||!T.rate||isNaN(parseFloat(T.rate))||parseFloat(T.rate)<=0?pt.disabledSaveButton:{}],onPress:V,disabled:!T.title.trim()||!T.rate||isNaN(parseFloat(T.rate))||parseFloat(T.rate)<=0,children:[(0,j.jsx)(S.default,{name:"content-save",size:20,color:m.theme.colors.surface}),(0,j.jsx)(a.default,{style:pt.saveRateText,children:b?"Update Custom Rate":"Save Custom Rate"})]})]})]}):(0,j.jsxs)(v.default,{style:pt.addRateButton,onPress:V,children:[(0,j.jsx)(S.default,{name:"plus",size:20,color:m.theme.colors.mainColors.main}),(0,j.jsx)(a.default,{style:pt.addRateText,children:"Add Rate"})]})]})]})})};var bt=o(50294);const xt={CATEGORY_SELECTION:{id:0,name:"Categories & Types"},SERVICE_DETAILS:{id:1,name:"Service Details"},RATES_AND_REVIEW:{id:2,name:"Rates & Review"}},vt={Horse:"Farm Animals",Cow:"Farm Animals",Sheep:"Farm Animals",Goat:"Farm Animals",Pig:"Farm Animals",Dogs:"Domestic",Cats:"Domestic",Birds:"Domestic",Rabbits:"Domestic",Hamsters:"Domestic",Snake:"Reptiles",Lizard:"Reptiles",Turtle:"Reptiles",Gecko:"Reptiles",Chameleon:"Reptiles",Fish:"Aquatic",Frog:"Aquatic",Newt:"Aquatic",Axolotl:"Aquatic",Spider:"Invertebrates",Scorpion:"Invertebrates",Crab:"Invertebrates",Snail:"Invertebrates",Millipede:"Invertebrates"},wt=[{id:"all",name:"All",icon:"paw-outline"},{id:"farm_animals",name:"Farm Animals",icon:"horse"},{id:"domestic",name:"Domestic",icon:"paw"},{id:"reptiles",name:"Reptiles",icon:"snake"},{id:"aquatic",name:"Aquatic",icon:"fish"},{id:"invertebrates",name:"Invertebrates",icon:"spider"}],Ct=i.default.create({modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",width:"100%"},modalContent:{width:"95%",maxWidth:550,maxHeight:"90%",backgroundColor:m.theme.colors.background,borderRadius:12,overflow:"hidden",display:"flex",flexDirection:"column"},stepIndicatorContainer:{width:"100%",paddingVertical:12,backgroundColor:m.theme.colors.background,borderBottomWidth:1,borderBottomColor:m.theme.colors.modernBorder},scrollContent:{flex:1},scrollContentContainer:{flexGrow:1},content:{flex:1,backgroundColor:m.theme.colors.background},footer:{flexDirection:"row",padding:16,justifyContent:"space-between",gap:12,backgroundColor:m.theme.colors.background,borderTopWidth:1,borderTopColor:m.theme.colors.modernBorder},cancelButton:{flex:1,backgroundColor:m.theme.colors.surface,paddingVertical:16,borderRadius:8,alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border},cancelButtonText:{color:m.theme.colors.text,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},nextButton:{flex:1,backgroundColor:m.theme.colors.mainColors.main,paddingVertical:16,borderRadius:8,alignItems:"center"},disabledButton:{backgroundColor:m.theme.colors.placeHolderText},nextButtonText:{color:m.theme.colors.surface,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},disabledButtonText:{color:m.theme.colors.surface},errorText:{color:m.theme.colors.error,textAlign:"center",marginBottom:16,fontFamily:m.theme.fonts.regular.fontFamily}}),St=({visible:e,onClose:t,onSave:o,initialService:i=null,setHasUnsavedChanges:s})=>{const{is_DEBUG:l}=(0,n.useContext)(h.AuthContext),[d,c]=(0,n.useState)(xt.CATEGORY_SELECTION.id),[u,g]=(0,n.useState)({generalCategories:[],animalTypes:[],serviceName:"",serviceDescription:"",isOvernight:!1,rates:{base_rate:"",base_rate_unit:"Per Visit",additionalAnimalRate:"",additionalAnimalThreshold:"1",hasHolidayRate:!1,holidayRate:"0",isPercent:!0},additionalRates:[]}),[f,p]=(0,n.useState)(null),[y,b]=(0,n.useState)(!1),[x,w]=(0,n.useState)(!1),[C,S]=(0,n.useState)(!1),T=E();(0,n.useEffect)((()=>{if(e)if(c(xt.CATEGORY_SELECTION.id),p(null),i){(0,h.debugLog)("MBA123456","Initializing with service data:",i),w(!0);let e=[];i.animalTypes&&i.animalTypes.length>0?((0,h.debugLog)("MBA123456","Using pre-formatted animalTypes array:",i.animalTypes),e=i.animalTypes):i.animal_types?((0,h.debugLog)("MBA123456","Using animal_types from backend:",i.animal_types),"object"!==typeof i.animal_types||Array.isArray(i.animal_types)||((0,h.debugLog)("MBA123456","Processing animal_types as dictionary"),Object.entries(i.animal_types).forEach((([t,o])=>{const n=wt.find((e=>e.name===o));(0,h.debugLog)("MBA123456","Adding animal: ".concat(t,", category: ").concat(o,", categoryId: ").concat(n?.id||"not found")),e.push({name:t,categoryName:o,categoryId:n?n.id:null,isCustom:!1})})))):(0,h.debugLog)("MBA123456","No animal types found in data"),(0,h.debugLog)("MBA123456","Final converted animal types:",e);let t="0",o=!0;i.holiday_rate&&("string"===typeof i.holiday_rate?i.holiday_rate.includes("%")?(t=i.holiday_rate.replace("%",""),o=!0):i.holiday_rate.includes("$")?(t=i.holiday_rate.replace("$",""),o=!1):(t=i.holiday_rate,o=void 0===i.holiday_rate_is_percent||i.holiday_rate_is_percent):(t=i.holiday_rate.toString(),o=void 0===i.holiday_rate_is_percent||i.holiday_rate_is_percent));let n=[];i.additional_rates&&Array.isArray(i.additional_rates)&&(n=i.additional_rates.map((e=>({title:e.title,rate:e.rate,description:e.description||""})))),g({service_id:i.service_id,generalCategories:[],animalTypes:e,serviceName:i.service_name||"",serviceDescription:i.description||"",isOvernight:i.is_overnight||!1,rates:{base_rate:i.base_rate||"",base_rate_unit:i.unit_of_time||"Per Visit",additionalAnimalRate:i.additional_animal_rate||"",additionalAnimalThreshold:i.applies_after?.toString()||"1",hasHolidayRate:"0"!==t,holidayRate:t,isPercent:o},additionalRates:n})}else w(!1),g({generalCategories:[],animalTypes:[],serviceName:"",serviceDescription:"",isOvernight:!1,rates:{base_rate:"",base_rate_unit:"Per Visit",additionalAnimalRate:"",additionalAnimalThreshold:"1",hasHolidayRate:!1,holidayRate:"0",isPercent:!0},additionalRates:[]})}),[e,i]);const B=()=>{switch(d){case xt.CATEGORY_SELECTION.id:return u.animalTypes?.length>0;case xt.SERVICE_DETAILS.id:const e=u.serviceName?.trim()&&u.serviceName.length<=35,t=u.serviceDescription?.trim()&&u.serviceDescription.length<=300;return e&&t;case xt.RATES_AND_REVIEW.id:const o=u.rates?.base_rate&&parseFloat(u.rates.base_rate)>0,n=!u.rates?.additionalAnimalRate||parseFloat(u.rates.additionalAnimalRate)>=0;return o&&n;default:return!1}},_=async()=>{(0,h.debugLog)("MBAno34othg0v","Directly calling API without state dependencies"),(0,h.debugLog)("MBA54321","Original serviceData:",u),b(!0);try{const e={};u.animalTypes.forEach((t=>{const o="string"===typeof t?t:t.name;vt[o]?e[o]=vt[o]:"object"===typeof t&&t.categoryName?e[o]=t.categoryName:e[o]="Other"})),(0,h.debugLog)("MBA54321","Animal types dictionary created:",e);u.generalCategories.map((e=>"string"===typeof e?e:e.name||"Uncategorized"));const n=u.rates.holidayRate||"0",r=n&&"0"!==n?u.rates.isPercent?"".concat(n,"%"):"$".concat(n):"0",a={service_name:u.serviceName,description:u.serviceDescription,animal_types:e,base_rate:u.rates.base_rate,additional_animal_rate:u.rates.additionalAnimalRate||"0",holiday_rate:r,applies_after:parseInt(u.rates.additionalAnimalThreshold)||1,unit_of_time:u.rates.base_rate_unit,is_overnight:u.isOvernight||!1,additional_rates:u.additionalRates.map((e=>({title:e.title,description:e.description||"",rate:e.rate})))};let i;x&&u.service_id&&(a.service_id=u.service_id),(0,h.debugLog)("MBA54321","Formatted data for backend:",a),x&&u.service_id?(i=await(0,bt.updateService)(a),(0,h.debugLog)("MBA54321","Service updated successfully, response:",i)):(i=await(0,bt.createService)(a),(0,h.debugLog)("MBA54321","Service created successfully, response:",i)),T({message:x?"Service updated successfully!":"Service created successfully!",type:"success",duration:3e3});const l={service_id:i.service_id,serviceName:i.service_name||u.serviceName,serviceDescription:u.serviceDescription,lengthOfService:i.unit_of_time||u.rates.base_rate_unit,isOvernight:u.isOvernight||!1,is_active:void 0===i.is_active||i.is_active,rates:{base_rate:u.rates.base_rate,additionalAnimalRate:u.rates.additionalAnimalRate||"0",holidayRate:r},generalCategories:u.generalCategories.map((e=>"string"===typeof e?{id:e.toLowerCase().replace(/\s+/g,"_"),name:e,isCustom:!1}:{id:e.id||e.name.toLowerCase().replace(/\s+/g,"_"),name:e.name,isCustom:e.isCustom||!1})),animalTypes:u.animalTypes.map((e=>"string"===typeof e?{name:e,categoryId:null,isCustom:!1}:{name:e.name,categoryId:e.categoryId,categoryName:e.categoryName||"Other",isCustom:e.isCustom||!1})),additionalRates:u.additionalRates.map((e=>({label:e.title,value:e.rate,description:e.description||""})))};i.additional_rates&&Array.isArray(i.additional_rates)&&(l.additionalRates=i.additional_rates.map((e=>({label:e.title,value:e.rate,description:e.description||""})))),(0,h.debugLog)("MBA54321","Formatted data for ServiceManager:",l),o&&o(l),g({generalCategories:[],animalTypes:[],serviceName:"",serviceDescription:"",isOvernight:!1,rates:{base_rate:"",base_rate_unit:"Per Visit",additionalAnimalRate:"",additionalAnimalThreshold:"1",hasHolidayRate:!1,holidayRate:"0",isPercent:!0},additionalRates:[]}),c(xt.CATEGORY_SELECTION.id),s(!0),t()}catch(f){(0,h.debugLog)("MBA54321","Error saving service:",f),(0,h.debugLog)("MBA54321","Error response:",f.response?.data),T({message:"Failed to ".concat(x?"update":"create"," service: ").concat(f.response?.data?.error||f.message),type:"error",duration:4e3}),p("Failed to ".concat(x?"update":"create"," service. Please try again."))}finally{b(!1)}},I=()=>{d>xt.CATEGORY_SELECTION.id?c((e=>e-1)):t()};return(0,j.jsx)(k.default,{visible:e,animationType:"fade",onRequestClose:I,transparent:!0,children:(0,j.jsx)(r.default,{style:Ct.modalOverlay,children:(0,j.jsxs)(He.default,{style:Ct.modalContent,children:[(0,j.jsx)(r.default,{style:Ct.stepIndicatorContainer,children:(0,j.jsx)(qe,{steps:Object.values(xt).map((e=>e.name)),currentStep:d})}),(0,j.jsxs)(X.default,{style:Ct.scrollContent,contentContainerStyle:Ct.scrollContentContainer,children:[(0,j.jsx)(r.default,{style:Ct.content,children:(()=>{switch((0,h.debugLog)("MBA54321 Rendering step:",d,"with serviceData:",u),d){case xt.CATEGORY_SELECTION.id:return(0,j.jsx)(it,{serviceData:u,setServiceData:g});case xt.SERVICE_DETAILS.id:return(0,j.jsx)(gt,{serviceData:u,setServiceData:g});case xt.RATES_AND_REVIEW.id:return(0,j.jsx)(yt,{serviceData:u,setServiceData:g,isUpdatingService:C,setIsUpdatingService:S,onProceedWithUpdate:_});default:return null}})()}),f&&(0,j.jsx)(a.default,{style:Ct.errorText,children:f})]}),(0,j.jsxs)(r.default,{style:Ct.footer,children:[(0,j.jsx)(v.default,{style:Ct.cancelButton,onPress:I,disabled:y,children:(0,j.jsx)(a.default,{style:Ct.cancelButtonText,children:d>xt.CATEGORY_SELECTION.id?"Back":"Cancel"})}),(0,j.jsx)(v.default,{style:[Ct.nextButton,(!B()||y)&&Ct.disabledButton],onPress:()=>{(0,h.debugLog)("MBAno34othg0v","handleNext called, currentStep:",d),B()?(p(null),d<xt.RATES_AND_REVIEW.id?c((e=>e+1)):((0,h.debugLog)("MBAno34othg0v","Final step, checking for unsaved custom rates"),S(!0))):p("Please complete all required fields before proceeding")},disabled:!B()||y,children:y&&d===xt.RATES_AND_REVIEW.id?(0,j.jsx)(A.default,{color:m.theme.colors.surface,size:"small"}):(0,j.jsx)(a.default,{style:[Ct.nextButtonText,!B()&&Ct.disabledButtonText],children:d===xt.RATES_AND_REVIEW.id?x?"Update Service":"Create Service":"Next"})})]})]})})})},jt=i.default.create({serviceCard:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:12,padding:16,marginBottom:16,shadowColor:"#000",display:"flex",justifyContent:"center",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3},cardHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",marginBottom:16},serviceName:{fontSize:m.theme.fontSizes.large,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily,flex:1,flexWrap:"wrap",marginRight:8},activeToggleContainer:{flexDirection:"row",alignItems:"center",gap:8},activeText:{fontSize:m.theme.fontSizes.smallMedium,color:m.theme.colors.primary,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},inactiveText:{fontSize:m.theme.fontSizes.smallMedium,color:m.theme.colors.textSecondary,fontFamily:m.theme.fonts.regular.fontFamily},switch:{transform:[{scaleX:.8},{scaleY:.8}]},ratesContainer:{gap:12,padding:16,borderRadius:8,marginBottom:16},rateRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:4},rateLabel:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},rateValue:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},buttonContainer:{flexDirection:"row",justifyContent:"space-between",gap:8},editButton:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:m.theme.colors.primary,paddingVertical:10,borderRadius:8,gap:8},deleteButton:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"center",borderColor:"#F26969",borderWidth:1,paddingVertical:10,borderRadius:8,gap:8},buttonText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.surfaceContrast,fontFamily:m.theme.fonts.regular.fontFamily},deleteButtonText:{fontSize:m.theme.fontSizes.medium,fontWeight:"600",color:"#F26969",fontFamily:m.theme.fonts.regular.fontFamily},archivedCard:{opacity:.6,backgroundColor:m.theme.colors.quaternary},archivedOverlay:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.1)",justifyContent:"center",alignItems:"center",borderRadius:12,zIndex:1,gap:8},archivedText:{color:m.theme.colors.tertiary,fontSize:m.theme.fontSizes.medium,fontWeight:"600",textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily},unarchiveButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surface,paddingHorizontal:12,paddingVertical:6,borderRadius:20,gap:4,borderWidth:1,borderColor:m.theme.colors.primary},unarchiveButtonText:{color:m.theme.colors.primary,fontSize:m.theme.fontSizes.small,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},archivedContent:{opacity:.4},archivedButton:{opacity:.3},archivedButtonText:{color:m.theme.colors.quaternary}}),Tt=({item:e,index:t,onEdit:o,onDelete:i,onUnarchive:s})=>{const{screenWidth:l}=(0,n.useContext)(h.AuthContext),[d,c]=(0,n.useState)(!1!==e.is_active);(0,n.useEffect)((()=>{(0,h.debugLog)("MBA3377","ProfessionalServiceCard Item Data:",e)}),[e]);const u=e.is_archived||!1;return(0,j.jsxs)(r.default,{style:[jt.serviceCard,u&&jt.archivedCard],children:[u&&(0,j.jsxs)(r.default,{style:jt.archivedOverlay,children:[(0,j.jsx)(a.default,{style:jt.archivedText,children:"Archived due to past bookings"}),(0,j.jsxs)(v.default,{onPress:s,style:jt.unarchiveButton,children:[(0,j.jsx)(S.default,{name:"restore",size:16,color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:jt.unarchiveButtonText,children:"Unarchive"})]})]}),(0,j.jsx)(r.default,{style:[jt.cardHeader,u&&jt.archivedContent],children:(0,j.jsx)(a.default,{style:[jt.serviceName,u&&jt.archivedText],numberOfLines:2,ellipsizeMode:"tail",children:e.serviceName})}),(0,j.jsxs)(r.default,{style:[jt.ratesContainer,{backgroundColor:(()=>{const e=[];return e[t%e.length]})()},u&&jt.archivedContent],children:[(0,j.jsxs)(r.default,{style:jt.rateRow,children:[(0,j.jsx)(a.default,{style:[jt.rateLabel,u&&jt.archivedText],children:"Base Rate"}),(0,j.jsxs)(a.default,{style:[jt.rateValue,u&&jt.archivedText],children:["$",e.rates.base_rate||"N/A","/",(g=e.lengthOfService,g||"visit")]})]}),e.rates.additionalAnimalRate&&(0,j.jsxs)(r.default,{style:jt.rateRow,children:[(0,j.jsx)(a.default,{style:[jt.rateLabel,u&&jt.archivedText],children:"Additional Animal"}),(0,j.jsxs)(a.default,{style:[jt.rateValue,u&&jt.archivedText],children:["$",e.rates.additionalAnimalRate]})]}),e.additionalRates&&e.additionalRates.map(((e,t)=>(0,j.jsxs)(r.default,{style:jt.rateRow,children:[(0,j.jsx)(a.default,{style:[jt.rateLabel,u&&jt.archivedText],children:e.label}),(0,j.jsxs)(a.default,{style:[jt.rateValue,u&&jt.archivedText],children:["$",e.value]})]},t)))]}),(0,j.jsxs)(r.default,{style:[jt.buttonContainer,u&&jt.archivedContent],children:[(0,j.jsxs)(v.default,{onPress:()=>i(t),style:[jt.deleteButton,u&&jt.archivedButton],disabled:u,children:[(0,j.jsx)(S.default,{name:"trash-can",size:20,color:u?m.theme.colors.quaternary:"#F26969"}),(0,j.jsx)(a.default,{style:[jt.deleteButtonText,u&&jt.archivedButtonText],children:"Delete"})]}),(0,j.jsxs)(v.default,{onPress:()=>o(t),style:[jt.editButton,u&&jt.archivedButton],disabled:u,children:[(0,j.jsx)(S.default,{name:"pencil",size:20,color:u?m.theme.colors.quaternary:m.theme.colors.surfaceContrast}),(0,j.jsx)(a.default,{style:[jt.buttonText,u&&jt.archivedButtonText],children:"Edit"})]})]})]});var g};var Bt=o(42490);const kt=()=>{{const e="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;return window.matchMedia("(hover: hover)").matches&&!e}},At=[{id:"all",name:"All",icon:"paw-outline"},{id:"farm_animals",name:"Farm Animals",icon:"horse"},{id:"domestic",name:"Domestic",icon:"paw"},{id:"reptiles",name:"Reptiles",icon:"snake"},{id:"aquatic",name:"Aquatic",icon:"fish"},{id:"invertebrates",name:"Invertebrates",icon:"spider"}],_t=i.default.create({container:{position:"relative",zIndex:9998,elevation:9998,backgroundColor:m.theme.colors.surface,minHeight:"100%"},serviceListContainer:{paddingVertical:0},servicesGrid:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:16,paddingBottom:24},serviceCardWrapper:{flex:1,minWidth:300,maxWidth:375},headerContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:24,position:"relative",zIndex:9999,elevation:9999},headerActions:{flexDirection:"row",alignItems:"center",gap:12},collapseButton:{padding:8,borderRadius:8,backgroundColor:m.theme.colors.surface},sectionTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},addServiceButton:{flexDirection:"row",alignItems:"center",gap:8,backgroundColor:m.theme.colors.primary,paddingHorizontal:16,paddingVertical:10,borderRadius:50},addServiceText:{color:m.theme.colors.surface,fontSize:m.theme.fontSizes.medium,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},emptyContainer:{justifyContent:"center",alignItems:"center",padding:40,backgroundColor:m.theme.colors.surface,borderRadius:8,marginBottom:24,minHeight:200},emptyText:{fontSize:m.theme.fontSizes.mediumLarge,color:m.theme.colors.text,marginBottom:20,fontFamily:m.theme.fonts.regular.fontFamily},addButton:{backgroundColor:m.theme.colors.primary,paddingHorizontal:20,paddingVertical:10,borderRadius:50},addButtonText:{color:m.theme.colors.surface,fontSize:m.theme.fontSizes.medium,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},portalTooltip:{backgroundColor:m.theme.colors.surface,padding:8,borderRadius:4,width:70,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5},tooltipText:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.text,textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily}}),It=({services:e,setServices:t,setHasUnsavedChanges:o,isProfessionalTab:i=!1,isMobile:s=!1})=>{const[l,d]=(0,n.useState)(!1),[c,u]=(0,n.useState)(null),[g,f]=(0,n.useState)([]),[p,y]=(0,n.useState)(!1),[b,x]=(0,n.useState)(!1),[w,C]=(0,n.useState)(null),[T,B]=(0,n.useState)(null),[k,A]=(0,n.useState)(null),{screenWidth:_,is_DEBUG:M}=(0,n.useContext)(h.AuthContext),[L,R]=(0,n.useState)(null),D=(0,n.useRef)(null),z=((0,n.useRef)(null),E()),P=kt();(0,n.useEffect)((()=>{f([]),y(!1),u(null),d(!1),x(!1),C(null)}),[e]);const F=t=>{const o=e[t];(0,h.debugLog)("MBA87654","Original service for editing:",o);let n=[];o.animal_types&&"object"===typeof o.animal_types&&!Array.isArray(o.animal_types)?(n=Object.entries(o.animal_types).map((([e,t])=>{const o=At.find((e=>e.name===t)),n=o?o.id:null;return{name:e,categoryName:t,categoryId:n,isCustom:!1}})),(0,h.debugLog)("MBA87654","Converted animal_types to array format:",n)):o.animalTypes&&(n=o.animalTypes,(0,h.debugLog)("MBA87654","Using existing animalTypes array:",n));const r={service_id:o.service_id,service_name:o.service_name||o.serviceName,description:o.description||o.serviceDescription,animal_types:o.animal_types,animalTypes:n,base_rate:o.base_rate||(o.rates?o.rates.base_rate:""),additional_animal_rate:o.additional_animal_rate||(o.rates?o.rates.additionalAnimalRate:"0"),holiday_rate:o.holiday_rate||(o.rates?o.rates.holidayRate:"0"),applies_after:o.applies_after||1,unit_of_time:o.unit_of_time||o.lengthOfService||"Per Visit",is_overnight:o.is_overnight||o.isOvernight||!1,is_active:void 0===o.is_active||o.is_active,holiday_rate_is_percent:o.holiday_rate_is_percent,additional_rates:o.additional_rates||(o.additionalRates?o.additionalRates.map((e=>({title:e.label||e.title,rate:e.value||e.rate,description:e.description||""}))):[])};(0,h.debugLog)("MBA87654","Formatted service for editing modal:",r),u(r),d(!0)},W=e=>{C(e),x(!0)},O=async n=>{try{const r=e[n];if(!r||!r.service_id)return void z({message:"Unable to identify service for unarchiving",type:"error",duration:3e3});await(0,bt.unarchiveService)(r.service_id),t((e=>e.map(((e,t)=>t===n?Object.assign({},e,{is_archived:!1}):e)))),o(!0),z({message:"Service unarchived successfully",type:"success",duration:3e3})}catch(zs){const t=zs.response?.data?.error||"Failed to unarchive service";z({message:t,type:"error",duration:3e3})}},N=e=>{f((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))},H=({item:e,index:t})=>{if(!e||"object"!==typeof e)return console.warn("Invalid item detected:",e),null;if((0,h.debugLog)("MBA8765","Rendering service item:",e),e.service_id&&((0,h.debugLog)("MBA8765","This is a backend-created service with ID:",e.service_id),e.serviceName&&e.rates)){const o=Object.assign({},e,{is_archived:e.is_archived||!1});return(0,j.jsx)(Tt,{item:o,index:t,onEdit:()=>F(t),onDelete:()=>W(t),onUnarchive:()=>O(t),isCollapsed:g.includes(t),onToggleCollapse:()=>N(t),isProfessionalTab:i},"service-".concat(t))}let o=[];e.animal_types&&"object"===typeof e.animal_types&&!Array.isArray(e.animal_types)?o=Object.entries(e.animal_types).map((([e,t])=>({name:e,categoryId:void 0,category:t,isCustom:!1}))):Array.isArray(e.animal_types)&&(o=e.animal_types);const n={service_id:e.service_id,serviceName:e.service_name,description:e.description,lengthOfService:e.unit_of_time,is_active:e.is_active,is_archived:e.is_archived,generalCategories:e.categories?.map((e=>({id:e.id,name:e.name,isCustom:e.is_custom})))||[],animalTypes:o,rates:{base_rate:e.base_rate,additionalAnimalRate:e.additional_animal_rate,holidayRate:e.holiday_rate},additionalRates:e.additional_rates?.map((e=>({label:e.title,value:e.rate,description:e.description})))||[]};return(0,j.jsx)(Tt,{item:n,index:t,onEdit:()=>F(t),onDelete:()=>W(t),onUnarchive:()=>O(t),isCollapsed:g.includes(t),onToggleCollapse:()=>N(t),isProfessionalTab:i},"service-".concat(t))};return(0,j.jsxs)(r.default,{style:_t.container,children:[(0,j.jsxs)(r.default,{style:[_t.serviceListContainer,{maxWidth:1200,marginHorizontal:"auto",width:"100%",paddingHorizontal:s?20:24,paddingTop:s?0:44}],children:[(0,j.jsxs)(r.default,{style:_t.headerContainer,children:[(0,j.jsx)(a.default,{style:_t.sectionTitle,children:"Service Manager"}),(0,j.jsx)(r.default,{style:_t.headerActions,children:(0,j.jsxs)(v.default,{ref:D,style:_t.addServiceButton,onMouseEnter:()=>{try{P&&((e,t,o)=>{if(e&&e.current)try{setTimeout((()=>{const n=e.current;if(n.getBoundingOwnerRect){const e=n.getBoundingOwnerRect();o({x:e.left+e.width/2,y:e.top,text:t}),B(t)}else console.error("Error: getBoundingOwnerRect method not found on element")}),0)}catch(zs){console.error("Error showing tooltip:",zs)}})(D,"Add Service",A)}catch(zs){console.error("Error showing add tooltip:",zs)}},onMouseLeave:()=>{P&&(B(null),A(null))},onPress:()=>{u(null),d(!0)},children:[(0,j.jsx)(S.default,{name:"plus",size:20,color:m.theme.colors.surface}),(0,j.jsx)(a.default,{style:_t.addServiceText,children:"Add New Service"})]})})]}),Array.isArray(e)&&e.length>0?(0,j.jsx)(r.default,{style:[_t.servicesGrid,{justifyContent:_>600?"":"center"}],children:e.map(((e,t)=>(0,j.jsx)(r.default,{style:_t.serviceCardWrapper,children:H({item:e,index:t})},"service-wrapper-".concat(t))))}):(0,j.jsxs)(r.default,{style:_t.emptyContainer,children:[(0,j.jsx)(a.default,{style:_t.emptyText,children:"No services yet"}),(0,j.jsx)(v.default,{style:_t.addButton,onPress:()=>d(!0),children:(0,j.jsx)(a.default,{style:_t.addButtonText,children:"Add Services"})})]})]}),(0,j.jsx)(St,{visible:l,onClose:()=>{d(!1),u(null)},onSave:n=>{(0,h.debugLog)("MBA8765","Service data received from modal:",n);if(c&&n.service_id){(0,h.debugLog)("MBA8765","Updating existing service with ID:",n.service_id);const r=e.findIndex((e=>e.service_id===n.service_id));return-1!==r?(t((e=>{const t=[...e];return t[r]=n,t})),(0,h.debugLog)("MBA8765","Service updated at index:",r)):((0,h.debugLog)("MBA8765","Service ID not found in existing list, adding as new"),t((e=>[...e,n]))),o(!0),void u(null)}if(n.service_id)return(0,h.debugLog)("MBA8765","New service created on backend with ID:",n.service_id),t((e=>[...e,n])),o(!0),void u(null);(0,h.debugLog)("MBA8765","Warning: Falling back to legacy service format handling");const r={};n.animalTypes&&Array.isArray(n.animalTypes)&&n.animalTypes.forEach((e=>{e&&e.name&&(e.categoryName?r[e.name]=e.categoryName:r[e.name]=e.category||"Other")}));const a={service_name:n.serviceName,description:n.serviceDescription,unit_of_time:n.lengthOfService,is_overnight:n.isOvernight||!1,base_rate:n.rates.base_rate,additional_animal_rate:n.rates.additionalAnimalRate,holiday_rate:n.rates.holidayRate,animal_types:r,additional_rates:n.additionalRates.map((e=>({title:e.label,rate:e.value,description:e.description})))};if(c){const o=e.findIndex((e=>e.service_id===c.service_id));t(-1!==o?e=>{const t=[...e];return t[o]=a,t}:e=>[...e,a])}else t((e=>[...e,a]));o(!0),u(null)},initialService:c,setHasUnsavedChanges:o}),(0,j.jsx)(I,{visible:b,onClose:()=>x(!1),onConfirm:async()=>{try{const n=e[w];if(!n||!n.service_id)return z({message:"Unable to identify service for deletion",type:"error",duration:3e3}),void x(!1);(await(0,bt.deleteService)(n.service_id)).archived?(t((e=>e.map(((e,t)=>t===w?Object.assign({},e,{is_archived:!0}):e)))),z({message:"Service archived due to existing bookings",type:"info",duration:3e3})):(t((e=>e.filter(((e,t)=>t!==w)))),z({message:"Service deleted successfully",type:"success",duration:3e3})),o(!0),x(!1)}catch(zs){const t=zs.response?.data?.error||"Failed to delete service";z({message:t,type:"error",duration:3e3}),x(!1)}},actionText:"delete this service"}),k&&(0,j.jsx)(Bt.default,{children:(0,j.jsx)(r.default,{style:[_t.portalTooltip,{position:"fixed",top:k.y-40,left:k.x-35}],children:(0,j.jsx)(a.default,{style:_t.tooltipText,children:k.text})})}),L&&(0,j.jsx)(Bt.default,{children:(0,j.jsx)(r.default,{style:[_t.portalTooltip,{position:"fixed",top:L.y-40,left:L.x-35}],children:(0,j.jsx)(a.default,{style:_t.tooltipText,children:L.text})})})]})};o(31385);i.default.create({section:{width:"100%",maxWidth:600,marginBottom:20,paddingVertical:20,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},sectionTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"bold",color:m.theme.colors.primary,marginBottom:10},petItem:{marginBottom:10,padding:10,backgroundColor:m.theme.colors.surface,borderColor:m.theme.colors.border,borderWidth:1,borderRadius:5,width:"100%",maxWidth:600},petItemContent:{flexDirection:"row",alignItems:"center"},petPhoto:{width:50,height:50,borderRadius:25,marginRight:10},petName:{fontSize:m.theme.fontSizes.medium,fontWeight:"bold"},petInfo:{flex:1},petDetails:{fontSize:m.theme.fontSizes.smallMedium,color:m.theme.colors.placeholder,flexWrap:"wrap"}}),i.default.create({section:{width:"100%",maxWidth:600,paddingVertical:20,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:10},sectionTitle:{fontSize:m.theme.fontSizes.large,marginBottom:10,fontWeight:"bold",color:m.theme.colors.primary},input:{width:"100%",maxWidth:600,marginBottom:10,backgroundColor:m.theme.colors.surface,padding:10,borderRadius:5,borderWidth:1,borderColor:m.theme.colors.border},fieldText:{width:"100%",maxWidth:600,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginBottom:10}});var Mt=o(63303),Lt=o(49050);i.default.create({centeredContent:{width:"100%",maxWidth:600,alignItems:"center",alignSelf:"center"},section:{width:"100%",maxWidth:600,marginBottom:20,paddingVertical:20,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:10},sectionTitle:{fontSize:m.theme.fontSizes.large,marginBottom:10,fontWeight:"bold",color:m.theme.colors.primary},profileHeader:{alignItems:"center",marginBottom:20,width:"100%",maxWidth:600},profilePhoto:{width:120,height:120,borderRadius:60},profilePhotoPlaceholder:{backgroundColor:m.theme.colors.surface,justifyContent:"center",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border},input:{width:"100%",maxWidth:600,marginBottom:10,backgroundColor:m.theme.colors.surface,padding:10,borderRadius:5},fieldText:{width:"100%",maxWidth:600,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginBottom:10},portfolioGrid:{width:"100%",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",gap:16},portfolioCard:{width:"48%",marginBottom:16,backgroundColor:m.theme.colors.surface,borderRadius:8,overflow:"hidden",elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.23,shadowRadius:2.62},portfolioImageContainer:{aspectRatio:4/3,width:"100%"},portfolioPhoto:{width:"100%",height:"100%",borderTopLeftRadius:8,borderTopRightRadius:8},portfolioCaption:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.text,padding:8},emptyText:{textAlign:"center",color:m.theme.colors.placeholder,marginTop:16},facilitiesContainer:{flexDirection:"row",flexWrap:"wrap",gap:8,paddingHorizontal:4},facilityTag:{paddingHorizontal:16,paddingVertical:8,borderRadius:20,backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.primary,marginBottom:8},facilityTagSelected:{backgroundColor:m.theme.colors.primary},facilityTagText:{color:m.theme.colors.primary,fontSize:m.theme.fontSizes.small},facilityTagTextSelected:{color:m.theme.colors.surface},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{width:"90%",maxWidth:500,backgroundColor:m.theme.colors.background,borderRadius:10,padding:20,maxHeight:"80%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},modalTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"bold"},modalScroll:{maxHeight:"70%"},modalFacilityTag:{padding:16,borderRadius:8,backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.primary,marginBottom:8},modalFacilityText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.primary},modalFooter:{flexDirection:"row",justifyContent:"space-between",marginTop:20},modalButton:{padding:12,borderRadius:8,width:"48%",alignItems:"center"},saveButton:{backgroundColor:m.theme.colors.primary},cancelButton:{backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.primary},modalButtonText:{color:m.theme.colors.primary,fontSize:m.theme.fontSizes.medium,fontWeight:"bold"},modalButtonText2:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.medium,fontWeight:"bold"}});o(49162);i.default.create({webDatePicker:{padding:8,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,fontSize:m.theme.fontSizes.medium,width:"100%",backgroundColor:m.theme.colors.background},androidButton:{padding:8,borderRadius:4,borderWidth:1,borderColor:m.theme.colors.border,backgroundColor:m.theme.colors.background},dateText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text},disabledInput:{backgroundColor:m.theme.colors.disabled,opacity:.7},disabledText:{color:m.theme.colors.placeholder}});const Rt=i.default.create({header:{flexDirection:"row",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,backgroundColor:m.theme.colors.background,zIndex:100,elevation:100},backButton:{marginRight:16},headerText:{fontSize:m.theme.fontSizes.large,fontWeight:"bold",color:m.theme.colors.primary,flex:1,fontFamily:m.theme.fonts.header.fontFamily},rightButton:{marginLeft:16}}),Dt=({title:e,onBackPress:t,rightIcon:o=null,onRightPress:n=null,rightComponent:i=null,customStyles:s={}})=>{(0,b.useNavigation)();return(0,j.jsxs)(r.default,{style:[Rt.header,s],children:[(0,j.jsx)(v.default,{onPress:t,style:Rt.backButton,children:(0,j.jsx)(S.default,{name:"arrow-left",size:24,color:m.theme.colors.primary})}),(0,j.jsx)(a.default,{style:Rt.headerText,children:e}),i||o&&(0,j.jsx)(v.default,{onPress:n,style:Rt.rightButton,children:(0,j.jsx)(S.default,{name:o,size:24,color:m.theme.colors.primary})})]})};var zt=o(21815);const Pt=i.default.create({container:{flex:1,backgroundColor:m.theme.colors.background,paddingTop:0,width:"100%",maxWidth:"100%",overflow:"hidden"},webContainer:{display:"flex",flexDirection:"column",minHeight:"85vh",width:"100%",maxWidth:"100%",overflow:"hidden"}}),Ft=({children:e,style:t,useSafeArea:o=!0,backgroundColor:r=m.theme.colors.background,fullWidthHeader:a=!1,contentWidth:i="800px"})=>{const[s,l]=(0,n.useState)(C.default.get("window").width);(0,n.useEffect)((()=>{{const e=()=>{l(C.default.get("window").width)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}}),[]);{const o=n.Children.toArray(e),s=a&&o.length>0?o[0]:null,l=a&&o.length>1?o.slice(1):e;return(0,j.jsxs)("div",{style:Object.assign({backgroundColor:r,width:"100%",maxWidth:"100%",minHeight:"100vh",display:"flex",flexDirection:"column"},t),children:[a&&s&&(0,j.jsx)("div",{style:{width:"100%",backgroundColor:r},children:s}),(0,j.jsx)("div",{style:Object.assign({},Pt.webContainer,{maxWidth:i,width:"100%",flex:1,overflow:"hidden"}),children:l})]})}};var Et=o(51690),Wt=(o(12409),o(32160));const Ot=41,Nt=37,Ht=-102,Ut=-109;const Vt=new class{constructor(){this.queue=[],this.processing=!1,this.lastRequest=0,this.minInterval=1100}async geocode(e){return new Promise(((t,o)=>{this.queue.push({address:e,resolve:t,reject:o}),this.processQueue()}))}async processQueue(){if(!this.processing&&0!==this.queue.length){for(this.processing=!0;this.queue.length>0;){const{address:e,resolve:t,reject:o}=this.queue.shift();try{const o=Date.now()-this.lastRequest;if(o<this.minInterval){const e=this.minInterval-o;(0,h.debugLog)("MBA7890","Rate limiting: waiting ".concat(e,"ms before next geocoding request")),await new Promise((t=>setTimeout(t,e)))}this.lastRequest=Date.now();t(await this.performGeocode(e))}catch(zs){o(zs)}}this.processing=!1}}async performGeocode(e){const{street:t,apartment:o,city:n,state:r,zip:a}=e;let i=t;o&&(i+=" ".concat(o)),i+=", ".concat(n,", ").concat(r),a&&(i+=" ".concat(a)),i+=", USA",(0,h.debugLog)("MBA7890","Geocoding address:",i);const s=new URLSearchParams({q:i,format:"json",limit:"1",countrycodes:"us",addressdetails:"1"}),l=await fetch("".concat("https://nominatim.openstreetmap.org/search","?").concat(s),{headers:{"User-Agent":"CrittrCove/1.0 (contact@crittrcove.com)"}});if(429===l.status)throw new Error("RATE_LIMITED");if(!l.ok)throw new Error("Geocoding failed: ".concat(l.status));const d=await l.json();if(!d||0===d.length)throw new Error("No results found");const c=d[0],u=parseFloat(c.lat),g=parseFloat(c.lon);if(!this.isInColorado(u,g))throw(0,h.debugLog)("MBA7890","Address is outside Colorado bounds:",{lat:u,lng:g,address:i}),new Error("Address must be within Colorado");return(0,h.debugLog)("MBA7890","Geocoding successful:",{lat:u,lng:g,address:i}),{latitude:u,longitude:g,formatted_address:c.display_name}}isInColorado(e,t){return e>=Nt&&e<=Ot&&t>=Ut&&t<=Ht}},qt=async e=>{try{return await(async(e,t=3)=>{for(let o=1;o<=t;o++)try{return await Vt.geocode(e)}catch(zs){if((0,h.debugLog)("MBA7890","Geocoding attempt ".concat(o," failed:"),zs.message),"RATE_LIMITED"===zs.message&&o<t){const e=1e3*Math.pow(2,o);(0,h.debugLog)("MBA7890","Rate limited, waiting ".concat(e,"ms before retry")),await new Promise((t=>setTimeout(t,e)));continue}if(o===t)throw zs}})(e)}catch(zs){return(0,h.debugLog)("MBA7890","Geocoding failed gracefully:",zs.message),null}};var Yt=o(90932);const Gt=41,Jt=37,$t=-102,Kt=-109;const Zt=new class{constructor(){this.queue=[],this.processing=!1,this.lastRequest=0,this.minInterval=1100}async search(e){return new Promise(((t,o)=>{this.queue.push({query:e,resolve:t,reject:o}),this.processQueue()}))}async processQueue(){if(!this.processing&&0!==this.queue.length){for(this.processing=!0;this.queue.length>0;){const{query:e,resolve:t,reject:o}=this.queue.shift();try{const o=Date.now()-this.lastRequest;if(o<this.minInterval){const e=this.minInterval-o;await new Promise((t=>setTimeout(t,e)))}this.lastRequest=Date.now();t(await this.performSearch(e))}catch(zs){o(zs)}}this.processing=!1}}async performSearch(e){(0,h.debugLog)("MBA8901","Searching addresses for:",e);const t=new URLSearchParams({q:"".concat(e,", Colorado, USA"),format:"json",limit:"5",countrycodes:"us",addressdetails:"1",bounded:"1",viewbox:"".concat(Kt,",").concat(Jt,",").concat($t,",").concat(Gt)}),o=await fetch("".concat("https://nominatim.openstreetmap.org/search","?").concat(t),{headers:{"User-Agent":"CrittrCove/1.0 (contact@crittrcove.com)"}});if(429===o.status)throw new Error("RATE_LIMITED");if(!o.ok)throw new Error("Search failed: ".concat(o.status));const n=await o.json();return n&&0!==n.length?n.filter((e=>{const t=parseFloat(e.lat),o=parseFloat(e.lon);return this.isInColorado(t,o)})).map((e=>({id:e.place_id,formatted_address:e.display_name,components:{street:e.address?.house_number&&e.address?.road?"".concat(e.address.house_number," ").concat(e.address.road):e.address?.road||"",apartment:"",city:e.address?.city||e.address?.town||e.address?.village||"",state:e.address?.state||"Colorado",zip:e.address?.postcode||""},coordinates:{latitude:parseFloat(e.lat),longitude:parseFloat(e.lon),formatted_address:e.display_name}}))):[]}isInColorado(e,t){return e>=Jt&&e<=Gt&&t>=Kt&&t<=$t}},Xt=i.default.create({container:{position:"relative",zIndex:1e3},inputContainer:{position:"relative",flexDirection:"row",alignItems:"center"},input:{flex:1,backgroundColor:m.theme.colors.background,borderRadius:8,padding:12,fontSize:16,color:m.theme.colors.text,borderWidth:1,borderColor:m.theme.colors.border,minHeight:44},inputValid:{borderColor:m.theme.colors.success,backgroundColor:m.theme.colors.success+"10"},inputDisabled:{backgroundColor:m.theme.colors.surface,color:m.theme.colors.placeholder},loadingIndicator:{position:"absolute",right:12},validIcon:{position:"absolute",right:12},suggestionsContainer:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:m.theme.colors.background,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,borderTopWidth:0,borderTopLeftRadius:0,borderTopRightRadius:0,maxHeight:200,zIndex:1001,elevation:10,shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.3,shadowRadius:6},suggestionsList:{maxHeight:200},suggestionItem:{flexDirection:"row",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,minHeight:56},lastSuggestionItem:{borderBottomWidth:0},suggestionIcon:{marginRight:12},suggestionContent:{flex:1},suggestionText:{fontSize:14,color:m.theme.colors.text,lineHeight:20},noResultsContainer:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:m.theme.colors.background,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,borderTopWidth:0,borderTopLeftRadius:0,borderTopRightRadius:0,padding:16,zIndex:1001},noResultsText:{fontSize:14,color:m.theme.colors.secondary,textAlign:"center",fontStyle:"italic"}}),Qt=({value:e="",onAddressSelect:t,placeholder:o="Enter your address...",style:i={},disabled:s=!1})=>{const[l,d]=(0,n.useState)(e),[c,u]=(0,n.useState)([]),[g,f]=(0,n.useState)(!1),[p,y]=(0,n.useState)(!1),[b,x]=(0,n.useState)(null),w=(0,n.useRef)(null);(0,n.useEffect)((()=>{d(e)}),[e]);return(0,j.jsxs)(r.default,{style:[Xt.container,i],children:[(0,j.jsxs)(r.default,{style:Xt.inputContainer,children:[(0,j.jsx)(te.default,{style:[Xt.input,b&&Xt.inputValid,s&&Xt.inputDisabled],value:l,onChangeText:e=>{d(e),x(null),w.current&&clearTimeout(w.current),w.current=setTimeout((()=>{(async e=>{if(e.length<3)return u([]),void y(!1);f(!0);try{const t=await Zt.search(e);u(t),y(t.length>0),(0,h.debugLog)("MBA8901","Found ".concat(t.length," address suggestions"))}catch(zs){(0,h.debugLog)("MBA8901","Address search failed:",zs.message),u([]),y(!1)}finally{f(!1)}})(e)}),500)},onBlur:()=>{setTimeout((()=>{y(!1)}),200)},placeholder:o,placeholderTextColor:m.theme.colors.placeholder,editable:!s}),g&&(0,j.jsx)(A.default,{size:"small",color:m.theme.colors.primary,style:Xt.loadingIndicator}),b&&(0,j.jsx)(S.default,{name:"check-circle",size:20,color:m.theme.colors.success,style:Xt.validIcon})]}),p&&c.length>0&&(0,j.jsx)(r.default,{style:Xt.suggestionsContainer,children:(0,j.jsx)(Yt.default,{data:c,renderItem:({item:e,index:o})=>(0,j.jsxs)(v.default,{style:[Xt.suggestionItem,o===c.length-1&&Xt.lastSuggestionItem],onPress:()=>{return d((o=e).formatted_address),x(o),y(!1),u([]),t&&t(o),void(0,h.debugLog)("MBA8901","Address selected:",o);var o},activeOpacity:.7,children:[(0,j.jsx)(S.default,{name:"map-marker",size:20,color:m.theme.colors.primary,style:Xt.suggestionIcon}),(0,j.jsx)(r.default,{style:Xt.suggestionContent,children:(0,j.jsx)(a.default,{style:Xt.suggestionText,numberOfLines:2,children:e.formatted_address})})]}),keyExtractor:e=>e.id.toString(),style:Xt.suggestionsList,keyboardShouldPersistTaps:"handled",showsVerticalScrollIndicator:!1})}),l.length>=3&&!g&&0===c.length&&p&&(0,j.jsx)(r.default,{style:Xt.noResultsContainer,children:(0,j.jsx)(a.default,{style:Xt.noResultsText,children:"No addresses found. Please check your spelling or try a different address."})})]})};var eo=o(60444),to=o(27851),oo=o.n(to);const{width:no}=C.default.get("window"),ro=Math.min(.9*no,400),ao=.8*ro,io=i.default.create({modalContainer:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.7)",justifyContent:"center",alignItems:"center"},contentContainer:{width:ro,backgroundColor:m.theme.colors.surface,borderRadius:16,overflow:"hidden",elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},title:{fontSize:18,fontWeight:"600",color:m.theme.colors.text},closeButton:{padding:4},cropAreaOuterContainer:{alignItems:"center",paddingVertical:16},cropAreaContainer:{width:ao,height:ao,position:"relative",overflow:"hidden"},imageViewport:{width:ao,height:ao,overflow:"hidden",position:"relative"},imageContainer:{position:"absolute",width:3*ao,height:3*ao,left:-ao,top:-ao,justifyContent:"center",alignItems:"center",zIndex:1},image:{},overlay:{position:"absolute",width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:2},cropCircleHole:Object.assign({position:"absolute",width:ao,height:ao,borderRadius:ao/2,top:0,left:0},{backgroundColor:"transparent",boxShadow:"0 0 0 ".concat(ao,"px rgba(0, 0, 0, 0.5)")}),circleGuide:{position:"absolute",width:ao,height:ao,borderRadius:ao/2,borderWidth:2,borderColor:m.theme.colors.primary,borderStyle:"dashed",zIndex:3},sliderContainer:{flexDirection:"row",alignItems:"center",width:"90%",marginTop:8,alignSelf:"center"},slider:{flex:1,height:40,marginHorizontal:8},zoomButton:{padding:8},instructionsContainer:{marginVertical:8,alignItems:"center"},instructionsText:{color:m.theme.colors.secondary,fontSize:14,textAlign:"center"},footer:{flexDirection:"row",justifyContent:"space-between",padding:16,borderTopWidth:1,borderTopColor:m.theme.colors.border},button:{paddingVertical:12,paddingHorizontal:20,borderRadius:8,alignItems:"center",justifyContent:"center",flex:1,marginHorizontal:8},cancelButton:{backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.primary},saveButton:{backgroundColor:m.theme.colors.primary},disabledButton:{backgroundColor:m.theme.colors.disabled},cancelButtonText:{color:m.theme.colors.primary,fontWeight:"600"},saveButtonText:{color:"#FFFFFF",fontWeight:"600"}}),so=({visible:e,imageUri:t,onClose:o,onSave:i,isUploading:s=!1})=>{const[l,d]=(0,n.useState)(1),[c,u]=(0,n.useState)({width:0,height:0}),[g,f]=(0,n.useState)({x:0,y:0}),[p,y]=(0,n.useState)(!1),b=(0,n.useRef)(1),x=(0,n.useRef)(new w.default.ValueXY).current;(0,n.useEffect)((()=>{{const t=t=>{e&&t.preventDefault()};return document.addEventListener("touchmove",t,{passive:!1}),document.addEventListener("wheel",t,{passive:!1}),e&&(document.body.style.overflow="hidden"),()=>{document.removeEventListener("touchmove",t),document.removeEventListener("wheel",t),document.body.style.overflow=""}}}),[e]),(0,n.useEffect)((()=>{e&&t&&(y(!1),Q.default.getSize(t,((e,t)=>{(0,h.debugLog)("MBA23o9h8v45","Image dimensions:",{width:e,height:t}),u({width:e,height:t});const o=C(e,t);d(o),b.current=o,x.setValue({x:0,y:0}),f({x:0,y:0}),y(!0)}),(e=>{(0,h.debugLog)("MBA23o9h8v45","Error getting image dimensions:",e)})))}),[e,t]);const C=(e,t)=>{if(0===e||0===t)return 1;return e/t>1?ao/t*1.1:ao/e*1.1},T=(0,n.useRef)(eo.default.create({onStartShouldSetPanResponder:()=>!0,onMoveShouldSetPanResponder:(e,t)=>Math.abs(t.dx)>2||Math.abs(t.dy)>2,onPanResponderGrant:()=>{(0,h.debugLog)("MBA23o9h8v45","Pan responder activated"),x.setOffset({x:x.x._value,y:x.y._value}),x.setValue({x:0,y:0})},onPanResponderMove:(e,t)=>{x.x.setValue(t.dx),x.y.setValue(t.dy)},onPanResponderRelease:()=>{(0,h.debugLog)("MBA23o9h8v45","Pan responder released"),x.flattenOffset(),f({x:x.x._value,y:x.y._value})},onPanResponderTerminationRequest:()=>!1})).current,B=e=>{Math.abs(e-b.current)<.01&&(x.setValue({x:0,y:0}),f({x:0,y:0})),d(e)},_={transform:[{translateX:x.x},{translateY:x.y},{scale:l}]},I=b.current||1,M=3*(b.current||1);return e?(0,j.jsx)(k.default,{visible:e,transparent:!0,animationType:"fade",onRequestClose:o,statusBarTranslucent:!0,presentationStyle:"overFullScreen",children:(0,j.jsx)(mt.default,{children:(0,j.jsx)(r.default,{style:io.modalContainer,children:(0,j.jsxs)(r.default,{style:io.contentContainer,children:[(0,j.jsxs)(r.default,{style:io.header,children:[(0,j.jsx)(a.default,{style:io.title,children:"Adjust Profile Photo"}),(0,j.jsx)(v.default,{onPress:o,style:io.closeButton,children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,j.jsx)(r.default,{style:io.cropAreaOuterContainer,children:(0,j.jsx)(r.default,{style:io.cropAreaContainer,children:(0,j.jsxs)(r.default,{style:io.imageViewport,children:[(0,j.jsx)(w.default.View,Object.assign({style:[io.imageContainer,_]},T.panHandlers,{children:t&&p?(0,j.jsx)(Q.default,{source:{uri:t},style:[io.image,{width:c.width,height:c.height}],resizeMode:"contain",onLoad:()=>{(0,h.debugLog)("MBA23o9h8v45","Image loaded in cropper component")}}):(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.primary})})),(0,j.jsx)(r.default,{style:io.overlay,pointerEvents:"none",children:(0,j.jsx)(r.default,{style:io.cropCircleHole})}),(0,j.jsx)(r.default,{style:io.circleGuide,pointerEvents:"none"})]})})}),(0,j.jsxs)(r.default,{style:io.sliderContainer,children:[(0,j.jsx)(v.default,{onPress:()=>{const e=Math.max(I,l-.1);B(e)},style:io.zoomButton,children:(0,j.jsx)(S.default,{name:"magnify-minus",size:24,color:m.theme.colors.text})}),(0,j.jsx)(oo(),{style:io.slider,minimumValue:I,maximumValue:M,value:l,onValueChange:B,minimumTrackTintColor:m.theme.colors.primary,maximumTrackTintColor:m.theme.colors.border,thumbTintColor:m.theme.colors.primary}),(0,j.jsx)(v.default,{onPress:()=>{const e=Math.min(M,l+.1);B(e)},style:io.zoomButton,children:(0,j.jsx)(S.default,{name:"magnify-plus",size:24,color:m.theme.colors.text})})]}),(0,j.jsx)(r.default,{style:io.instructionsContainer,children:(0,j.jsx)(a.default,{style:io.instructionsText,children:"Use slider to zoom \u2022 Drag to position \u2022 Return slider to left to reset zoom"})}),(0,j.jsxs)(r.default,{style:io.footer,children:[(0,j.jsx)(v.default,{style:[io.button,io.cancelButton],onPress:o,disabled:s,children:(0,j.jsx)(a.default,{style:io.cancelButtonText,children:"Cancel"})}),(0,j.jsx)(v.default,{style:[io.button,io.saveButton,s&&io.disabledButton],onPress:()=>{const e={scale:l,x:-x.x._value,y:-x.y._value,imageWidth:c.width,imageHeight:c.height,cropWidth:ao,cropHeight:ao};(0,h.debugLog)("MBA23o9h8v45","Saving cropped image with params:",e),i(t,e)},disabled:s||!p,children:s?(0,j.jsx)(A.default,{size:"small",color:"#FFFFFF"}):(0,j.jsx)(a.default,{style:io.saveButtonText,children:"Save"})})]})]})})})}):null},lo=async(e,t)=>{try{return(0,h.debugLog)("MBA8080","Processing image with crop params:",t),await co(e,t)}catch(zs){throw(0,h.debugLog)("MBA8080","Error processing image with crop:",zs),zs}},co=async(e,t)=>new Promise(((o,n)=>{if("undefined"===typeof document||"undefined"===typeof Image)return(0,h.debugLog)("MBA8080","Canvas cropping not available on this platform"),void n(new Error("Canvas cropping not available on this platform"));try{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{try{if("function"!==typeof document.createElement)throw new Error("document.createElement not available");const e=document.createElement("canvas");if(!e||"function"!==typeof e.getContext)throw new Error("Canvas not supported");const n=e.getContext("2d");if(!n)throw new Error("Canvas 2D context not available");const a=Math.min(t.cropWidth,t.cropHeight);e.width=a,e.height=a;const i=a/2,s=a/2;n.beginPath(),n.arc(i,s,a/2,0,2*Math.PI,!0),n.closePath(),n.clip();const l=t.imageWidth*t.scale,d=t.imageHeight*t.scale,c=a/2,u=a/2-t.x,g=c-t.y,m=u-l/2,f=g-d/2;(0,h.debugLog)("MBA8080","Crop calculations:",{cropSize:a,scaledWidth:l,scaledHeight:d,drawX:m,drawY:f,imageCenterX:u,imageCenterY:g}),n.drawImage(r,m,f,l,d);const p=e.toDataURL("image/jpeg",.9);(0,h.debugLog)("MBA8080","Image cropped successfully on web"),o({base64Data:p,type:"image/jpeg",oldProfilePhotoUrl:t.oldProfilePhotoUrl})}catch(zs){(0,h.debugLog)("MBA8080","Error cropping image on web:",zs),n(zs)}},r.onerror=e=>{(0,h.debugLog)("MBA8080","Error loading image for cropping:",e),n(new Error("Failed to load image for cropping"))},r.src=e}catch(zs){(0,h.debugLog)("MBA8080","Error cropping image on web:",zs),n(zs)}})),uo=i.default.create({donateSection:{marginTop:16},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},sectionTitle:{fontSize:18,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts?.header?.fontFamily},donateButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.mainColors.tertiary,padding:16,borderRadius:12,shadowColor:m.theme.colors.mainColors.tertiary,shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},donateButtonIcon:{width:40,height:40,borderRadius:20,backgroundColor:"rgba(255, 255, 255, 0.2)",justifyContent:"center",alignItems:"center",marginRight:12},donateButtonContent:{flex:1},donateButtonTitle:{fontSize:16,fontWeight:"600",color:m.theme.colors.background,marginBottom:2,fontFamily:m.theme.fonts?.header?.fontFamily},donateButtonSubtitle:{fontSize:12,color:m.theme.colors.background,opacity:.9,fontFamily:m.theme.fonts?.regular?.fontFamily},donateButtonCompact:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.mainColors.tertiary,padding:12,borderRadius:8,shadowColor:m.theme.colors.mainColors.tertiary,shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},donateButtonIconCompact:{width:32,height:32,borderRadius:16,backgroundColor:"rgba(255, 255, 255, 0.2)",justifyContent:"center",alignItems:"center",marginRight:10},donateButtonTitleCompact:{fontSize:14,fontWeight:"600",color:m.theme.colors.background,marginBottom:1,fontFamily:m.theme.fonts?.header?.fontFamily},donateButtonSubtitleCompact:{fontSize:11,color:m.theme.colors.background,opacity:.9,fontFamily:m.theme.fonts?.regular?.fontFamily},donateButtonLarge:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.mainColors.tertiary,padding:20,borderRadius:16,shadowColor:m.theme.colors.mainColors.tertiary,shadowOffset:{width:0,height:3},shadowOpacity:.15,shadowRadius:6,elevation:4},donateButtonIconLarge:{width:48,height:48,borderRadius:24,backgroundColor:"rgba(255, 255, 255, 0.2)",justifyContent:"center",alignItems:"center",marginRight:16},donateButtonTitleLarge:{fontSize:18,fontWeight:"600",color:m.theme.colors.background,marginBottom:3,fontFamily:m.theme.fonts?.header?.fontFamily},donateButtonSubtitleLarge:{fontSize:14,color:m.theme.colors.background,opacity:.9,fontFamily:m.theme.fonts?.regular?.fontFamily},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",padding:16},modalContent:{backgroundColor:m.theme.colors.surface,borderRadius:12,width:"100%",maxWidth:400,maxHeight:"90%"},modalHeader:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:20,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},modalTitle:{fontSize:20,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts?.header?.fontFamily},modalCloseButton:{width:32,height:32,justifyContent:"center",alignItems:"center",borderRadius:16,backgroundColor:m.theme.colors.background},modalDescription:{fontSize:16,color:m.theme.colors.text,lineHeight:24,padding:20,paddingBottom:10,textAlign:"center",fontFamily:m.theme.fonts?.regular?.fontFamily},donationOptionsContainer:{padding:20,paddingTop:10,gap:12},donationOption:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.background,padding:16,borderRadius:12,borderWidth:1,borderColor:m.theme.colors.border},disabledOption:{opacity:.6,backgroundColor:m.theme.colors.surface},donationOptionIcon:{width:48,height:48,borderRadius:24,backgroundColor:m.theme.colors.primary+"10",justifyContent:"center",alignItems:"center",marginRight:16},donationOptionContent:{flex:1},donationOptionTitle:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,marginBottom:4,fontFamily:m.theme.fonts?.header?.fontFamily},donationOptionSubtitle:{fontSize:14,color:m.theme.colors.secondary,fontFamily:m.theme.fonts?.regular?.fontFamily},disabledText:{color:m.theme.colors.placeHolderText},comingSoonBadge:{backgroundColor:m.theme.colors.warning+"20",paddingHorizontal:8,paddingVertical:4,borderRadius:12,marginLeft:8},comingSoonText:{fontSize:12,fontWeight:"500",color:m.theme.colors.warning,fontFamily:m.theme.fonts?.regular?.fontFamily},modalFooter:{padding:20,paddingTop:10,borderTopWidth:1,borderTopColor:m.theme.colors.border},modalFooterText:{fontSize:14,color:m.theme.colors.secondary,textAlign:"center",lineHeight:20,fontFamily:m.theme.fonts?.regular?.fontFamily}}),go=({style:e,buttonStyle:t,showTitle:o=!0,title:i="Support CrittrCove",subtitle:s="Help us keep costs low for everyone",size:l="default"})=>{const d=E(),[c,u]=(0,n.useState)(!1),g=(()=>{switch(l){case"compact":return{button:uo.donateButtonCompact,icon:uo.donateButtonIconCompact,title:uo.donateButtonTitleCompact,subtitle:uo.donateButtonSubtitleCompact,iconSize:20,arrowSize:16};case"large":return{button:uo.donateButtonLarge,icon:uo.donateButtonIconLarge,title:uo.donateButtonTitleLarge,subtitle:uo.donateButtonSubtitleLarge,iconSize:28,arrowSize:24};default:return{button:uo.donateButton,icon:uo.donateButtonIcon,title:uo.donateButtonTitle,subtitle:uo.donateButtonSubtitle,iconSize:24,arrowSize:20}}})();return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(r.default,{style:[uo.donateSection,e],children:[o&&(0,j.jsx)(r.default,{style:uo.sectionHeader,children:(0,j.jsx)(a.default,{style:uo.sectionTitle,children:i})}),(0,j.jsxs)(v.default,{style:[g.button,t],onPress:()=>{(0,h.debugLog)("MBA9902","Opening donate modal from SupportButton component"),u(!0)},children:[(0,j.jsx)(r.default,{style:g.icon,children:(0,j.jsx)(S.default,{name:"heart",size:g.iconSize,color:m.theme.colors.background})}),(0,j.jsxs)(r.default,{style:uo.donateButtonContent,children:[(0,j.jsx)(a.default,{style:g.title,children:"Support CrittrCove"}),(0,j.jsx)(a.default,{style:g.subtitle,children:s})]}),(0,j.jsx)(S.default,{name:"chevron-right",size:g.arrowSize,color:m.theme.colors.background})]})]}),(0,j.jsx)(k.default,{visible:c,transparent:!0,animationType:"fade",onRequestClose:()=>u(!1),children:(0,j.jsx)(r.default,{style:uo.modalOverlay,children:(0,j.jsxs)(r.default,{style:uo.modalContent,children:[(0,j.jsxs)(r.default,{style:uo.modalHeader,children:[(0,j.jsx)(a.default,{style:uo.modalTitle,children:"Support CrittrCove"}),(0,j.jsx)(v.default,{style:uo.modalCloseButton,onPress:()=>u(!1),children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,j.jsx)(a.default,{style:uo.modalDescription,children:"Choose your preferred way to support us and help keep CrittrCove running!"}),(0,j.jsxs)(r.default,{style:uo.donationOptionsContainer,children:[(0,j.jsxs)(v.default,{style:[uo.donationOption,uo.disabledOption],onPress:()=>{(0,h.debugLog)("MBA9902","Credit card donation selected"),u(!1),d({message:"Credit card donations coming soon! Please use Venmo for now.",type:"info",duration:4e3})},children:[(0,j.jsx)(r.default,{style:uo.donationOptionIcon,children:(0,j.jsx)(S.default,{name:"credit-card",size:28,color:m.theme.colors.placeHolderText})}),(0,j.jsxs)(r.default,{style:uo.donationOptionContent,children:[(0,j.jsx)(a.default,{style:[uo.donationOptionTitle,uo.disabledText],children:"Credit Card"}),(0,j.jsx)(a.default,{style:[uo.donationOptionSubtitle,uo.disabledText],children:"Coming soon - secure payment via Stripe"})]}),(0,j.jsx)(r.default,{style:uo.comingSoonBadge,children:(0,j.jsx)(a.default,{style:uo.comingSoonText,children:"Soon"})})]}),(0,j.jsxs)(v.default,{style:uo.donationOption,onPress:()=>{(0,h.debugLog)("MBA9902","Venmo donation selected"),u(!1);ee.default.openURL("https://venmo.com/u/matt-aertker").catch((e=>{(0,h.debugLog)("MBA9902","Error opening Venmo link:",e),d({message:"Unable to open Venmo. Please try again later.",type:"error",duration:3e3})}))},children:[(0,j.jsx)(r.default,{style:uo.donationOptionIcon,children:(0,j.jsx)(S.default,{name:"cash",size:28,color:m.theme.colors.primary})}),(0,j.jsxs)(r.default,{style:uo.donationOptionContent,children:[(0,j.jsx)(a.default,{style:uo.donationOptionTitle,children:"Venmo"}),(0,j.jsx)(a.default,{style:uo.donationOptionSubtitle,children:"Quick and easy mobile payments"})]}),(0,j.jsx)(S.default,{name:"chevron-right",size:20,color:m.theme.colors.text})]})]}),(0,j.jsx)(r.default,{style:uo.modalFooter,children:(0,j.jsx)(a.default,{style:uo.modalFooterText,children:"Your support helps us keep costs low for everyone in the CrittrCove community!"})})]})})})]})};var mo=o(72302),ho=o.n(mo);const fo=i.default.create({modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",padding:20},modalContainer:{backgroundColor:m.theme.colors.surface,borderRadius:12,width:"90%",maxWidth:600,maxHeight:"90%",overflow:"hidden"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:20,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},headerContent:{flex:1},headerTitle:{fontSize:20,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily,marginBottom:8},ratingContainer:{flexDirection:"row",alignItems:"center"},ratingText:{fontSize:18,fontWeight:"600",color:m.theme.colors.text,marginLeft:4,marginRight:8},reviewCountText:{fontSize:14,color:m.theme.colors.textSecondary},closeButton:{padding:8},reviewsList:{flex:1},reviewsContent:{padding:16},reviewCard:{padding:16,backgroundColor:m.theme.colors.background,borderRadius:8,marginBottom:12,borderWidth:1,borderColor:m.theme.colors.border},reviewUserInfo:{flexDirection:"row",alignItems:"flex-start"},profileContainer:{marginRight:16},profileImage:{width:80,height:80,borderRadius:40},defaultProfileImage:{width:80,height:80,borderRadius:40,backgroundColor:m.theme.colors.primary,justifyContent:"center",alignItems:"center"},reviewUserDetails:{flex:1,justifyContent:"center"},nameAndStarsRow:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:8},reviewerName:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginRight:8},starsContainer:{flexDirection:"row"},starIcon:{marginRight:2},serviceRow:{flexDirection:"row",alignItems:"center",flexWrap:"wrap"},serviceName:{fontSize:14,color:m.theme.colors.primary,fontWeight:"500",marginRight:8},calendarIcon:{marginRight:4},serviceInfoText:{fontSize:14,color:m.theme.colors.textSecondary},reviewText:{fontSize:14,color:m.theme.colors.text,lineHeight:20,marginTop:8},emptyStateContainer:{padding:40,alignItems:"center",justifyContent:"center"},emptyStateText:{fontSize:16,color:m.theme.colors.textSecondary,marginTop:16}}),po=({visible:e,onClose:t,reviews:o,averageRating:n,reviewCount:i,userName:s,forProfessional:l,userTimezone:d})=>{const c=e=>{try{if(!e)return"";(0,h.debugLog)("MBA3456","formatReviewDate input:",e);const t=d||"US/Mountain",o=ho().utc(e);if(!o.isValid())return(0,h.debugLog)("MBA3456","Invalid moment created from:",e),e;const n=o.tz(t).format("MMM D, YYYY");return(0,h.debugLog)("MBA3456","Successfully formatted date:",{input:e,output:n}),n}catch(zs){return(0,h.debugLog)("MBA3456","Error formatting review date:",{dateString:e,error:zs}),e}},u=e=>{const t=[];for(let o=1;o<=5;o++)t.push((0,j.jsx)(S.default,{name:o<=e?"star":"star-outline",size:16,color:m.theme.colors.warning,style:fo.starIcon},o));return(0,j.jsx)(r.default,{style:fo.starsContainer,children:t})},g=e=>{if(e){const t=(0,p.getMediaUrl)(e);return(0,j.jsx)(Q.default,{source:{uri:t},style:fo.profileImage,resizeMode:"cover"})}return(0,j.jsx)(r.default,{style:fo.defaultProfileImage,children:(0,j.jsx)(S.default,{name:"account",size:32,color:m.theme.colors.surface})})};return(0,j.jsx)(k.default,{visible:e,onRequestClose:t,animationType:"slide",transparent:!0,children:(0,j.jsx)(r.default,{style:fo.modalOverlay,children:(0,j.jsxs)(r.default,{style:fo.modalContainer,children:[(0,j.jsxs)(r.default,{style:fo.header,children:[(0,j.jsxs)(r.default,{style:fo.headerContent,children:[(0,j.jsxs)(a.default,{style:fo.headerTitle,children:["Reviews for ",s]}),(0,j.jsxs)(r.default,{style:fo.ratingContainer,children:[(0,j.jsx)(S.default,{name:"star",size:20,color:m.theme.colors.warning}),(0,j.jsx)(a.default,{style:fo.ratingText,children:n.toFixed(2)}),(0,j.jsxs)(a.default,{style:fo.reviewCountText,children:["(",i," ",1===i?"Review":"Reviews",")"]})]})]}),(0,j.jsx)(v.default,{onPress:t,style:fo.closeButton,children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),0===o.length?(0,j.jsxs)(r.default,{style:fo.emptyStateContainer,children:[(0,j.jsx)(S.default,{name:"star-outline",size:60,color:m.theme.colors.placeholder}),(0,j.jsx)(a.default,{style:fo.emptyStateText,children:"No reviews yet"})]}):(0,j.jsx)(X.default,{style:fo.reviewsList,contentContainerStyle:fo.reviewsContent,children:[...o].sort(((e,t)=>t.rating-e.rating)).map((e=>(0,j.jsx)(r.default,{style:fo.reviewCard,children:(0,j.jsxs)(r.default,{style:fo.reviewUserInfo,children:[(0,j.jsx)(r.default,{style:fo.profileContainer,children:g(e.reviewer_profile_picture)}),(0,j.jsxs)(r.default,{style:fo.reviewUserDetails,children:[(0,j.jsxs)(r.default,{style:fo.nameAndStarsRow,children:[(0,j.jsx)(a.default,{style:fo.reviewerName,children:l?e.client_name:e.professional_name||"Anonymous"}),u(e.rating)]}),(0,j.jsxs)(r.default,{style:fo.serviceRow,children:[(0,j.jsx)(S.default,{name:"briefcase-outline",size:14,color:m.theme.colors.textSecondary,style:fo.calendarIcon}),(0,j.jsx)(a.default,{style:fo.serviceName,children:e.service_name||"No Service Found"}),(0,j.jsx)(a.default,{style:fo.serviceName,children:"\u2022"}),(0,j.jsx)(S.default,{name:"calendar",size:14,color:m.theme.colors.textSecondary,style:fo.calendarIcon}),(0,j.jsx)(a.default,{style:fo.serviceInfoText,children:c(e.last_occurrence_end_date||e.created_at)})]}),(0,j.jsx)(a.default,{style:fo.reviewText,children:e.review_text||"No comments provided."})]})]})},e.review_id)))})]})})})},yo=[{id:"none",label:"No Insurance",description:"I do not have insurance"},{id:"petplan",label:"PetPlan Insurance",description:"Comprehensive pet insurance coverage"},{id:"trupanion",label:"Trupanion",description:"Lifetime coverage for your pets"},{id:"custom",label:"Custom Insurance",description:"Upload my own insurance card"}],bo=({visible:e,onClose:t,title:o,value:i,onSave:s,isLocation:l,isMultiline:d,isProfessional:c,isInsurance:u,selectedInsurance:g={type:"none",card:null},onInsuranceChange:f})=>{const[p,y]=(0,n.useState)(""),[b,x]=(0,n.useState)(g),[w,C]=(0,n.useState)(!1),[T,B]=(0,n.useState)(null),[A,_]=(0,n.useState)(""),[I,M]=(0,n.useState)(1),[L,R]=(0,n.useState)(null),[D,z]=(0,n.useState)("");(0,n.useEffect)((()=>{e&&(u?(x(g),M(1),R(null)):l?(_(i||""),B(null)):y(i||""),z(""))}),[e]);return(0,j.jsx)(k.default,{visible:e,transparent:!0,animationType:"fade",onRequestClose:t,children:(0,j.jsx)(r.default,{style:vo.modalOverlay,children:(0,j.jsxs)(r.default,{style:[vo.modalContent,u&&vo.insuranceModalContent],children:[(0,j.jsxs)(r.default,{style:vo.modalHeader,children:[u&&2===I&&(0,j.jsxs)(v.default,{style:vo.backButton,onPress:()=>M(1),children:[(0,j.jsx)(S.default,{name:"arrow-left",size:24,color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:vo.backButtonText,children:"Back"})]}),(0,j.jsx)(a.default,{style:[vo.modalTitle,u&&2===I&&vo.modalTitleCentered],children:o})]}),u?1===I?(0,j.jsxs)(r.default,{style:vo.insuranceStepContent,children:[(0,j.jsx)(a.default,{style:vo.insuranceStepTitle,children:"Choose Insurance Type"}),(0,j.jsxs)(v.default,{style:vo.insuranceTypeButton,onPress:()=>(R("own"),void M(2)),children:[(0,j.jsx)(S.default,{name:"file-document",size:24,color:m.theme.colors.primary}),(0,j.jsxs)(r.default,{style:vo.insuranceTypeContent,children:[(0,j.jsx)(a.default,{style:vo.insuranceTypeTitle,children:"Use My Own Insurance"}),(0,j.jsx)(a.default,{style:vo.insuranceTypeDescription,children:"Upload your existing insurance card"})]})]})]}):2===I?"own"===L?(0,j.jsxs)(r.default,{style:vo.insuranceStepContent,children:[(0,j.jsx)(a.default,{style:vo.insuranceStepTitle,children:"Upload Insurance Card"}),(0,j.jsxs)(v.default,{style:vo.uploadButton,onPress:()=>(async e=>{if("custom"===e){const t=await Mt.launchImageLibraryAsync({mediaTypes:Lt.MediaTypeOptions.Images,allowsEditing:!0,aspect:[16,9],quality:1});if(!t.canceled){const o={type:"custom",card:t.assets[0].uri};x(o),f(e)}}else x({type:e,card:null}),f(e)})("custom"),children:[(0,j.jsx)(S.default,{name:"file-upload",size:24,color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:vo.uploadText,children:"Upload Insurance Card"})]}),"custom"===b.type&&b.card&&(0,j.jsxs)(r.default,{style:vo.customInsuranceCard,children:[(0,j.jsx)(Q.default,{source:{uri:b.card},style:vo.insuranceCardImage}),(0,j.jsx)(a.default,{style:vo.insuranceCardText,children:"Custom Insurance Card"})]})]}):(0,j.jsxs)(r.default,{style:vo.insuranceStepContent,children:[(0,j.jsx)(a.default,{style:vo.insuranceStepTitle,children:"Select Insurance Provider"}),yo.filter((e=>"custom"!==e.id)).map((e=>(0,j.jsxs)(v.default,{style:[vo.insuranceOption,b.type===e.id&&vo.selectedInsuranceOption],onPress:()=>{const t={type:e.id,card:null};x(t),f(e.id)},children:[(0,j.jsx)(S.default,{name:"none"===e.id?"shield-off":"shield-check",size:24,color:m.theme.colors.primary}),(0,j.jsxs)(r.default,{style:vo.insuranceOptionContent,children:[(0,j.jsx)(a.default,{style:vo.insuranceOptionTitle,children:e.label}),(0,j.jsx)(a.default,{style:vo.insuranceOptionDescription,children:e.description})]})]},e.id)))]}):null:l?(0,j.jsxs)(r.default,{style:vo.locationContent,children:[(0,j.jsx)(a.default,{style:vo.addressInstructions,children:'Enter your complete street address (e.g., "123 Main Street"). Only valid street addresses will appear in suggestions.'}),(0,j.jsx)(Qt,{value:A,onAddressSelect:e=>{B(e),_(e.formatted_address),(0,h.debugLog)("MBA8901","Address selected in modal:",e)},placeholder:"Enter address in Colorado Springs...",style:vo.addressAutocomplete}),T&&(0,j.jsxs)(r.default,{style:vo.selectedAddressInfo,children:[(0,j.jsx)(S.default,{name:"check-circle",size:16,color:m.theme.colors.mainColors.tertiary}),(0,j.jsx)(a.default,{style:vo.selectedAddressText,children:"Address validated and ready to save"})]})]}):(0,j.jsxs)(r.default,{children:[(0,j.jsx)(te.default,{style:[vo.modalInput,d&&vo.multilineInput,D?vo.modalInputError:null],value:p,onChangeText:e=>{(0,h.debugLog)("MBA7777","Profile text input change:",{title:o,text:e});let t="general",n=1e3;o.toLowerCase().includes("name")?(t="service_name",n=50):o.toLowerCase().includes("email")?(t="email",n=254):o.toLowerCase().includes("bio")||o.toLowerCase().includes("about")?(t="service_description",n=d?1e3:500):o.toLowerCase().includes("phone")&&(t="phone",n=20);const r=Ke(e,t,{maxLength:n});if(o.toLowerCase().includes("email")&&r.length>0){/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(r)?z(""):z("Please enter a valid email address")}else o.toLowerCase().includes("name")&&r.length>0?r.length<2?z("Name must be at least 2 characters long"):z(""):(o.toLowerCase().includes("bio")||o.toLowerCase().includes("about"))&&r.length>0?r.length<10?z("Description must be at least 10 characters long"):r.length>n?z("Description must be no more than ".concat(n," characters long")):z(""):z("");y(r)},multiline:d,numberOfLines:d?4:1,autoFocus:!0,maxLength:o.toLowerCase().includes("name")?50:o.toLowerCase().includes("email")?254:o.toLowerCase().includes("bio")||o.toLowerCase().includes("about")?1e3:500}),D?(0,j.jsx)(a.default,{style:vo.modalInputErrorText,children:D}):null,(o.toLowerCase().includes("bio")||o.toLowerCase().includes("about"))&&(0,j.jsxs)(a.default,{style:vo.modalInputCharacterCount,children:[p.length,"/",d?1e3:500]})]}),(0,j.jsxs)(r.default,{style:[vo.modalButtons,{zIndex:-1}],children:[(0,j.jsx)(v.default,{style:vo.modalCancelButton,onPress:t,children:(0,j.jsx)(a.default,{style:vo.modalCancelText,children:"Cancel"})}),(0,j.jsx)(v.default,{style:[vo.modalSaveButton,l&&!T||D?vo.modalSaveButtonDisabled:null],onPress:()=>{if(D)return(0,h.debugLog)("MBA7777","Cannot save due to validation error:",D),void Et.default.alert("Validation Error",D);if(u||l||""!==p.trim()){if(u)s(b);else if(l){if(!T)return void Et.default.alert("Invalid Address","Please select a valid address from the suggestions.");(0,h.debugLog)("MBA7777","Saving location with selected address:",T),s(T)}else(0,h.debugLog)("MBA7777","Saving profile field with sanitized value:",{value:p,title:o}),s(p);t()}else Et.default.alert("Required Field","This field cannot be empty.")},disabled:l&&!T||D,children:(0,j.jsx)(a.default,{style:vo.modalSaveText,children:"Save"})})]})]})})})},xo=({visible:e,onClose:t,title:o,type:n,onProceed:i})=>{const s=(()=>{switch(n){case"background_check":return{icon:"shield-check",description:"Get background checked to increase trust with pet owners and unlock premium features.",steps:["Contact our support team via the contact button below","We'll send you a secure link to our background check partner","Pay the $49.99 fee (we do not take a cut of this fee) and complete the background check process (typically 2-3 business days).",'Once verified, your profile will display a "Background Verified" badge'],benefits:["Increased booking requests","Higher trust rating from pet owners","Access to premium client matches","Priority listing in search results"]};case"insurance":return{icon:"shield-account",description:"Get insured to provide additional protection for you and the pets you care for.",steps:["Contact our support team via the contact button below.","We'll have you provide proof of insurance over email (send to support@crittrcove.com to skip first step).","We will alert you when we have verified your private insurance.",'Once approved, your profile will display an "Insured" badge.'],benefits:["Protection against accidents and liability","Increased confidence from pet owners","Access to higher-value bookings","Professional credibility enhancement"]};case"elite_pro":return{icon:"star-circle",description:"Congratulations! You've earned Elite Pro status with 5+ bookings and a 5-star average rating.",steps:["You've completed 5+ successful bookings","You've maintained a 5-star average rating","Your Elite Pro badge is now active on your profile"],benefits:["Exclusive Elite Pro badge on your profile","Priority placement in search results","Access to premium booking opportunities","Special recognition in the community"]};default:return{icon:"help",description:"",steps:[],benefits:[]}}})();return(0,j.jsx)(k.default,{visible:e,transparent:!0,animationType:"fade",onRequestClose:t,children:(0,j.jsx)(r.default,{style:vo.verificationModalOverlay,children:(0,j.jsxs)(r.default,{style:vo.verificationModalContent,children:[(0,j.jsxs)(r.default,{style:vo.verificationModalHeader,children:[(0,j.jsx)(r.default,{style:vo.verificationIconContainer,children:(0,j.jsx)(S.default,{name:s.icon,size:40,color:m.theme.colors.primary})}),(0,j.jsx)(a.default,{style:vo.verificationModalTitle,children:o}),(0,j.jsx)(v.default,{style:vo.verificationModalClose,onPress:t,children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,j.jsxs)(X.default,{style:vo.verificationModalScroll,children:[(0,j.jsx)(a.default,{style:vo.verificationDescription,children:s.description}),(0,j.jsxs)(r.default,{style:vo.verificationModalSection,children:[(0,j.jsx)(a.default,{style:vo.verificationModalSectionTitle,children:"Process Steps:"}),s.steps.map(((e,t)=>(0,j.jsxs)(r.default,{style:vo.verificationStep,children:[(0,j.jsx)(r.default,{style:vo.verificationStepNumber,children:(0,j.jsx)(a.default,{style:vo.verificationStepNumberText,children:t+1})}),(0,j.jsx)(a.default,{style:vo.verificationStepText,children:e})]},t)))]}),(0,j.jsxs)(r.default,{style:vo.verificationModalSection,children:[(0,j.jsx)(a.default,{style:vo.verificationModalSectionTitle,children:"Benefits:"}),s.benefits.map(((e,t)=>(0,j.jsxs)(r.default,{style:vo.verificationBenefit,children:[(0,j.jsx)(S.default,{name:"check-circle",size:16,color:m.theme.colors.mainColors.tertiary}),(0,j.jsx)(a.default,{style:vo.verificationBenefitText,children:e})]},t)))]})]}),(0,j.jsxs)(r.default,{style:vo.verificationModalButtons,children:[(0,j.jsx)(v.default,{style:vo.verificationModalCancelButton,onPress:t,children:(0,j.jsx)(a.default,{style:vo.verificationModalCancelText,children:"Cancel"})}),(0,j.jsx)(v.default,{style:vo.verificationModalProceedButton,onPress:i,children:(0,j.jsx)(a.default,{style:vo.verificationModalProceedText,children:"elite_pro"===n?"Got It!":"Contact Support"})})]})]})})})},vo=i.default.create({container:{flex:1,backgroundColor:m.theme.colors.surface},contentWrapper:{maxWidth:1200,alignSelf:"center",width:"100%",padding:16},mainContent:{width:"100%"},desktopLayout:{flexDirection:"row",gap:24},profileSection:{marginBottom:24},profileSectionDesktop:{width:300,marginBottom:0},profileCard:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,padding:16},profilePhotoContainer:{position:"relative",alignItems:"center",marginBottom:16},profilePhoto:{width:200,height:200,borderRadius:100},profilePhotoPlaceholder:{justifyContent:"center",alignItems:"center",borderWidth:2,borderStyle:"dashed",borderColor:m.theme.colors.border},cameraButton:{position:"absolute",right:8,bottom:8,backgroundColor:m.theme.colors.primary,padding:8,borderRadius:20},ratingBadge:{position:"absolute",top:8,right:8,backgroundColor:m.theme.colors.surface,borderRadius:12,paddingHorizontal:8,paddingVertical:4,flexDirection:"row",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,borderWidth:1,borderColor:m.theme.colors.border},ratingBadgeText:{fontSize:14,fontWeight:"600",color:m.theme.colors.text,marginLeft:4},profileInfo:{alignItems:"center"},nameContainer:{flexDirection:"row",alignItems:"center",gap:8,marginBottom:4},name:{fontSize:24,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts?.regular?.fontFamily},emailContainer:{flexDirection:"row",alignItems:"center",gap:4,marginBottom:4},email:{fontSize:14,color:m.theme.colors.secondary,fontFamily:m.theme.fonts?.regular?.fontFamily},locationContainer:{flexDirection:"row",marginBottom:12,width:"100%",position:"relative",paddingHorizontal:20},locationIconWrapper:{position:"absolute",left:0,top:0},location:{fontSize:14,color:m.theme.colors.secondary,fontFamily:m.theme.fonts?.regular?.fontFamily,textAlign:"center",flex:1},locationEditIcon:{position:"absolute",right:0,top:0,padding:4},roleContainer:{flexDirection:"row",alignItems:"center",gap:4,marginBottom:4},role:{fontSize:14,color:m.theme.colors.secondary},editIcon:{padding:4},ratingContainer:{flexDirection:"row",alignItems:"center",gap:4},rating:{fontSize:16,fontWeight:"500",color:m.theme.colors.text},reviews:{fontSize:14,color:m.theme.colors.secondary},sectionsContainer:{flex:1},sectionsContainerDesktop:{paddingLeft:24},section:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,padding:16},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},sectionTitle:{fontSize:18,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts?.header?.fontFamily},editButton:{backgroundColor:"transparent"},editButtonText:{color:m.theme.colors.primary,fontSize:14,fontWeight:"500"},bioInput:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:12,minHeight:100,textAlignVertical:"top",fontSize:16,color:m.theme.colors.text},facilitiesGrid:{gap:16},facilityItem:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surface,padding:12,borderRadius:8},facilityContent:{marginLeft:12},facilityTitle:{fontSize:14,color:m.theme.colors.secondary},facilityValue:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginTop:2},addPhotoButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.primary,paddingHorizontal:12,paddingVertical:8,borderRadius:6,gap:6},addPhotoText:{color:m.theme.colors.background,fontSize:14,fontWeight:"500"},photoGrid:{flexDirection:"row",flexWrap:"wrap",gap:16,marginTop:16},reviewsContainer:{marginBottom:12},noReviews:{fontSize:14,color:m.theme.colors.secondary,fontStyle:"italic"},bioText:{fontSize:16,color:m.theme.colors.text,lineHeight:24,fontFamily:m.theme.fonts?.regular?.fontFamily},locationButtons:{gap:16},locationButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.primary,padding:12,borderRadius:8,justifyContent:"center",gap:8},locationButtonText:{color:m.theme.colors.background,fontSize:16,fontWeight:"500"},orText:{textAlign:"center",color:m.theme.colors.secondary,fontSize:14},multilineInput:{minHeight:100,textAlignVertical:"top"},portfolioPhoto:{width:"30%",aspectRatio:4/3,borderRadius:8},noPhotosText:{fontSize:14,color:m.theme.colors.secondary,fontStyle:"italic",textAlign:"center",padding:20},facilitiesModalContent:{height:"80%",width:"90%",maxWidth:500},facilitiesScrollView:{flex:1,marginBottom:16},facilityPresetItem:{flexDirection:"row",alignItems:"center",padding:16,borderRadius:8,marginBottom:8,backgroundColor:m.theme.colors.background},selectedFacilityPreset:{backgroundColor:m.theme.colors.primary},facilityPresetContent:{flex:1,marginLeft:12},facilityPresetTitle:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginBottom:4},facilityPresetDescription:{fontSize:14,color:m.theme.colors.secondary},selectedFacilityText:{color:m.theme.colors.background},checkIcon:{marginLeft:8},modalButtons:{flexDirection:"row",justifyContent:"flex-end",gap:12},modalCancelButton:{paddingHorizontal:16,paddingVertical:8,borderRadius:6,backgroundColor:m.theme.colors.surface},modalCancelText:{color:m.theme.colors.text,fontSize:14,fontWeight:"500"},modalSaveButton:{paddingHorizontal:16,paddingVertical:8,borderRadius:6,backgroundColor:m.theme.colors.primary},modalSaveText:{color:m.theme.colors.background,fontSize:14,fontWeight:"500"},locationModalContent:{width:"90%",maxWidth:500,maxHeight:"90%"},locationContent:{gap:16,paddingBottom:16},addressInstructions:{fontSize:14,color:m.theme.colors.secondary,marginBottom:8,textAlign:"center"},addressAutocomplete:{marginBottom:12},selectedAddressInfo:{flexDirection:"row",alignItems:"center",gap:8,padding:12,backgroundColor:m.theme.colors.mainColors.tertiary+"10",borderRadius:8,borderWidth:1,borderColor:m.theme.colors.mainColors.tertiary+"30"},selectedAddressText:{fontSize:14,color:m.theme.colors.mainColors.tertiary,fontWeight:"500"},addressForm:{gap:12},addressInput:{backgroundColor:m.theme.colors.background,borderRadius:8,padding:12,fontSize:16,color:m.theme.colors.text,minHeight:44},addressRow:{flexDirection:"row",gap:12,flexWrap:"wrap"},maxFacilitiesText:{fontSize:14,color:m.theme.colors.secondary,fontStyle:"italic",textAlign:"center",marginTop:8},modalSaveButtonDisabled:{opacity:.5},modalInputError:{borderColor:m.theme.colors.error,borderWidth:1},modalInputErrorText:{color:m.theme.colors.error,fontSize:12,marginTop:4,fontFamily:m.theme.fonts?.regular?.fontFamily},modalInputCharacterCount:{color:m.theme.colors.textSecondary,fontSize:12,marginTop:4,textAlign:"right",fontFamily:m.theme.fonts?.regular?.fontFamily},insuranceContent:{gap:16},customInsuranceCard:{alignItems:"center",gap:8},insuranceCardImage:{width:"100%",height:200,borderRadius:8,backgroundColor:m.theme.colors.background},insuranceCardText:{fontSize:14,color:m.theme.colors.secondary},insuranceOption:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.background,padding:16,borderRadius:8,gap:16},insuranceOptionContent:{flex:1},insuranceOptionTitle:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginBottom:4},insuranceOptionDescription:{fontSize:14,color:m.theme.colors.secondary},editButtonContent:{flexDirection:"row",alignItems:"center",gap:4},insuranceStepContent:{gap:16},insuranceStepTitle:{fontSize:18,fontWeight:"500",color:m.theme.colors.text,marginBottom:16},insuranceTypeButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.background,padding:16,borderRadius:8,gap:16},insuranceTypeContent:{flex:1},insuranceTypeTitle:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginBottom:4},insuranceTypeDescription:{fontSize:14,color:m.theme.colors.secondary},uploadButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:m.theme.colors.background,padding:16,borderRadius:8,gap:8},uploadText:{fontSize:16,color:m.theme.colors.primary,fontWeight:"500"},selectedInsuranceOption:{backgroundColor:m.theme.colors.primary+"20"},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:16,width:"90%",maxWidth:400,maxHeight:"90%"},modalHeader:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:16,position:"relative"},modalTitle:{fontSize:18,fontWeight:"600",color:m.theme.colors.text,flex:1,fontFamily:m.theme.fonts?.header?.fontFamily},modalTitleCentered:{textAlign:"center"},backButton:{flexDirection:"row",alignItems:"center",gap:4,position:"absolute",left:0,padding:8,zIndex:1},backButtonText:{color:m.theme.colors.primary,fontSize:14,fontWeight:"500"},modalInput:{backgroundColor:m.theme.colors.background,borderRadius:8,padding:12,fontSize:16,color:m.theme.colors.text,marginBottom:16},modalCloseButton:{alignSelf:"flex-end",backgroundColor:m.theme.colors.primary,paddingHorizontal:16,paddingVertical:8,borderRadius:6},modalCloseText:{color:m.theme.colors.background,fontSize:14,fontWeight:"500"},nameSection:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:4},sectionTitleContainer:{flexDirection:"row",alignItems:"center",gap:8},sectionContent:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},sectionText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts?.regular?.fontFamily},verificationSectionSubtitle:{fontSize:14,color:m.theme.colors.secondary,marginBottom:16,fontFamily:m.theme.fonts?.regular?.fontFamily},verificationButtonsContainer:{gap:12},verificationButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surface,padding:16,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border},verificationButtonElite:{backgroundColor:m.theme.colors.warning+"10",borderColor:m.theme.colors.warning+"30"},verificationButtonIcon:{width:40,height:40,borderRadius:20,backgroundColor:m.theme.colors.primary+"10",justifyContent:"center",alignItems:"center",marginRight:12},verificationButtonContent:{flex:1},verificationButtonTitle:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginBottom:2,fontFamily:m.theme.fonts?.regular?.fontFamily},verificationButtonTitleElite:{color:m.theme.colors.warning},verificationButtonSubtitle:{fontSize:12,color:m.theme.colors.secondary,fontFamily:m.theme.fonts?.regular?.fontFamily},verificationButtonSubtitleElite:{color:m.theme.colors.warning},verificationModalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",padding:16},verificationModalContent:{backgroundColor:m.theme.colors.surface,borderRadius:12,width:"100%",maxWidth:500,maxHeight:"90%"},verificationModalHeader:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:20,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},verificationIconContainer:{width:50,height:50,borderRadius:25,backgroundColor:m.theme.colors.primary+"10",justifyContent:"center",alignItems:"center"},verificationModalTitle:{fontSize:20,fontWeight:"600",color:m.theme.colors.text,flex:1,textAlign:"center",fontFamily:m.theme.fonts?.header?.fontFamily},verificationModalClose:{width:30,height:30,justifyContent:"center",alignItems:"center"},verificationModalScroll:{maxHeight:400},verificationDescription:{fontSize:16,color:m.theme.colors.text,lineHeight:24,padding:20,textAlign:"center",fontFamily:m.theme.fonts?.regular?.fontFamily},verificationModalSection:{padding:20,paddingTop:0},verificationModalSectionTitle:{fontSize:18,fontWeight:"600",color:m.theme.colors.text,marginBottom:12,fontFamily:m.theme.fonts?.header?.fontFamily},verificationStep:{flexDirection:"row",alignItems:"flex-start",marginBottom:12},verificationStepNumber:{width:24,height:24,borderRadius:12,backgroundColor:m.theme.colors.primary,justifyContent:"center",alignItems:"center",marginRight:12,marginTop:2},verificationStepNumberText:{fontSize:12,fontWeight:"600",color:m.theme.colors.background},verificationStepText:{fontSize:14,color:m.theme.colors.text,flex:1,lineHeight:20,fontFamily:m.theme.fonts?.regular?.fontFamily},verificationBenefit:{flexDirection:"row",alignItems:"flex-start",marginBottom:8},verificationBenefitText:{fontSize:14,color:m.theme.colors.text,flex:1,marginLeft:8,lineHeight:20,fontFamily:m.theme.fonts?.regular?.fontFamily},verificationModalButtons:{flexDirection:"row",justifyContent:"flex-end",gap:12,padding:20,borderTopWidth:1,borderTopColor:m.theme.colors.border},verificationModalCancelButton:{paddingHorizontal:20,paddingVertical:12,borderRadius:8,backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border},verificationModalCancelText:{color:m.theme.colors.text,fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts?.regular?.fontFamily},verificationModalProceedButton:{paddingHorizontal:20,paddingVertical:12,borderRadius:8,backgroundColor:m.theme.colors.primary},verificationModalProceedText:{color:m.theme.colors.background,fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts?.regular?.fontFamily},mobileVerificationSection:{backgroundColor:"transparent",marginTop:16,padding:0,borderRadius:0},donateSectionWithVerification:{paddingTop:16,borderTopWidth:1,borderTopColor:m.theme.colors.border}}),wo=({profilePhoto:e,email:t,phone:o,age:i,address:s,city:l,state:d,zip:c,country:u,coordinates:g,bio:f,about_me:y,emergencyContact:b,authorizedHouseholdMembers:w,editMode:C,toggleEditMode:T,onChangeText:B,pickImage:k,setHasUnsavedChanges:A,onSaveComplete:_,isMobile:I,client_reviews:M,professional_reviews:L,client_rating:R,professional_rating:D,client_review_count:z,professional_review_count:P,role:F,isProfessional:W,insurance:O={type:"none",card:null},onNavigateToTab:N,name:H,navigation:U})=>{const{name:V,timeSettings:q}=(0,n.useContext)(h.AuthContext),[Y,G]=(0,n.useState)(!1),[J,$]=(0,n.useState)(null),[K,Z]=(0,n.useState)(""),[X,ee]=(0,n.useState)([]),[te,oe]=(0,n.useState)(O),[ne,re]=(0,n.useState)(!1),[ae,ie]=(0,n.useState)(!1),[se,le]=(0,n.useState)(null),[de,ce]=(0,n.useState)(null),[ue,ge]=(0,n.useState)(!1),[me,he]=(0,n.useState)([]),[fe,pe]=(0,n.useState)(0),[ye,be]=(0,n.useState)(0),[xe,ve]=(0,n.useState)(!1),[we,Ce]=(0,n.useState)(!1),[Se,je]=(0,n.useState)({name:H||V||"Your Name",email:t||"",bio:W?f:y,location:"".concat(s||"").concat(l?", ".concat(l):"").concat(d?", ".concat(d):"")}),[Te,Be]=(0,n.useState)({name:H||V||"Your Name",email:t||"",bio:W?f:y,about_me:y||"",profile_photo:e||null,address:s||"",city:l||"",state:d||"",zip:c||"",coordinates:g||null}),ke=E(),[Ae,_e]=(0,n.useState)({name:"",email:"",bio:"",location:"",address:"",apartment:"",city:"",state:"",zip:"",country:"USA",insurance:{type:"none",card:null}});(0,n.useEffect)((()=>{A&&((0,h.debugLog)("MBA230uvj0834h9","Updating parent component with hasUnsavedChanges:",Y),A(Y))}),[Y,A]),(0,n.useEffect)((()=>{e&&((0,h.debugLog)("MBA5080","Updating profile photo from props:",e),Be((t=>Object.assign({},t,{profile_photo:e}))))}),[e]);const Ie=async()=>{ve(!0);try{(0,h.debugLog)("MBA4567","Processing reviews for current user profile",{isProfessional:W,userRole:F,hasClientReviews:M&&M.length>0,hasProfessionalReviews:L&&L.length>0,clientReviewCount:z,professionalReviewCount:P});let e=[],t=0,o=0;W?(e=L||[],t=D||0,o=P||0,(0,h.debugLog)("MBA4567","Displaying professional reviews:",{count:o,rating:t})):(e=M||[],t=R||0,o=z||0,(0,h.debugLog)("MBA4567","Displaying client reviews:",{count:o,rating:t})),he(e),pe(t),be(o),(0,h.debugLog)("MBA4567","Set reviews state:",{reviewCount:o,averageRating:t,reviewsLength:e.length})}catch(zs){(0,h.debugLog)("MBA4567","Error processing user reviews:",zs),he([]),pe(0),be(0)}finally{ve(!1)}};(0,n.useEffect)((()=>{(0,h.debugLog)("MBA230uvj0834h9","ProfileInfoTab mounted with props:",{propName:H,authName:V,email:t,address:s,bio:f,about_me:y,profilePhoto:e,isProfessional:W});const o=g?.formatted_address||"".concat(s||"").concat(l?", ".concat(l):"").concat(d?", ".concat(d):"");je({name:H||V||"Your Name",email:t||"",bio:W?f:y,location:o}),Be((o=>Object.assign({},o,{profile_photo:e||o.profile_photo,name:H||o.name,email:t||o.email,bio:W?f||o.bio:y||o.bio,about_me:y||o.about_me,address:s||o.address,city:l||o.city,state:d||o.state,zip:c||o.zip,coordinates:g||o.coordinates}))),Ie()}),[]),(0,n.useEffect)((()=>{je((e=>Object.assign({},e,{bio:W?f:y}))),(0,h.debugLog)("MBA230uvj0834h9","Role changed - updating bio/about_me:",{isProfessional:W,bio:f,about_me:y})}),[W,f,y]),(0,n.useEffect)((()=>{(0,h.debugLog)("MBA4567","Review props or role changed, updating reviews state:",{isProfessional:W,clientReviewCount:z,professionalReviewCount:P,clientRating:R,professionalRating:D}),Ie()}),[M,L,R,D,z,P,W]);const Me=(e,t)=>{(0,h.debugLog)("MBA230uvj0834h9","Edit ".concat(e,":"),t),Z("location"===e?t||"":t),$(e),G(!0),A&&A(!0)};(0,n.useEffect)((()=>{const e="".concat(l||"").concat(d?", ".concat(d):"");_e({name:H||V||"Your Name",email:t||"",bio:W?f:y,location:e,address:s||"",apartment:"",city:l||"",state:d||"Colorado",zip:c||"",insurance:O})}),[]);const Le=async(e,t)=>{if(!((e,t)=>{if("insurance"===e)return JSON.stringify(t)!==JSON.stringify(Ae.insurance);if("location"===e&&"object"===typeof t){const e=t.components?.street||t.street||t.address||"",o=t.components?.apartment||t.apartment||"",n=t.components?.city||t.city||"",r=t.components?.state||t.state||"Colorado",a=t.components?.zip||t.zip||"";(0,h.debugLog)("MBA12345","Checking location changes:",{originalAddress:Ae.address,newAddress:e,originalApartment:Ae.apartment,newApartment:o,originalCity:Ae.city,newCity:n,originalState:Ae.state,newState:r,originalZip:Ae.zip,newZip:a});const i=e!==Ae.address||o!==Ae.apartment||n!==Ae.city||r!==Ae.state||a!==Ae.zip;return(0,h.debugLog)("MBA12345","Location has changes: ".concat(i)),i}return t!==Ae[e]})(e,t))return(0,h.debugLog)("MBA230uvj0834h9","No changes detected for ".concat(e,", skipping save.")),$(null),G(!1),void(A&&A(!1));(0,h.debugLog)("MBA12345","Changes detected for ".concat(e,", proceeding with save."),{value:t}),re(!0);try{let o={};switch(e){case"name":o={name:t};break;case"email":o={email:t};break;case"bio":W?(o={bio:t},(0,h.debugLog)("MBA4928","Saving professional bio:",t)):(o={about_me:t},(0,h.debugLog)("MBA4928","Saving client about_me:",t));break;case"location":(0,h.debugLog)("MBA12345","Extracting address components from:",t);const e=await(async e=>{let t={};if(e&&"object"===typeof e&&"components"in e)(0,h.debugLog)("MBA8901","Processing validated address from autocomplete:",e),t={address:e.components.street||"",apartment:e.components.apartment||"",city:e.components.city||"",state:e.components.state||"Colorado",zip:e.components.zip||""},e.coordinates&&(t.coordinates=e.coordinates,(0,h.debugLog)("MBA8901","Using coordinates from validated address:",e.coordinates));else if(e&&"object"===typeof e){if("street"in e?t={address:e.street||"",apartment:e.apartment||"",city:e.city||"",state:e.state||"Colorado",zip:e.zip||""}:"address"in e&&(t={address:e.address||"",apartment:e.apartment||"",city:e.city||"",state:e.state||"Colorado",zip:e.zip||""}),!t.coordinates&&t.address&&t.city&&t.state){(0,h.debugLog)("MBA7890","Attempting to geocode legacy address:",t);const e=await qt({street:t.address,apartment:t.apartment,city:t.city,state:t.state,zip:t.zip});e?((0,h.debugLog)("MBA7890","Geocoding successful, adding coordinates:",e),t.coordinates=e):(0,h.debugLog)("MBA7890","Geocoding failed, saving address without coordinates")}}else if("string"===typeof e){const o=e.split(",").map((e=>e.trim()));if(t={address:o[0]||"",apartment:"",city:o[1]||"",state:o[2]||"Colorado",zip:o[3]||""},t.address&&t.city&&t.state){const e=await qt({street:t.address,apartment:t.apartment,city:t.city,state:t.state,zip:t.zip});e&&(t.coordinates=e)}}else t={address:"",apartment:"",city:"",state:"Colorado",zip:""};return t})(t);(0,h.debugLog)("MBA12345","Extracted components:",e),o={address:e.address,apartment:e.apartment,city:e.city,state:e.state,zip:e.zip},e.coordinates&&(o.coordinates=e.coordinates,(0,h.debugLog)("MBA7890","Including coordinates in profile update:",e.coordinates));break;case"insurance":o={insurance:t}}(0,h.debugLog)("MBA4928","Saving ".concat(e," to backend:"),o);const n=await(0,bt.updateProfileInfo)(o);if((0,h.debugLog)("MBA4928","Backend response for ".concat(e,":"),n),"name"===e)je(Object.assign({},Se,{name:n.name||Se.name})),_e((e=>Object.assign({},e,{name:n.name||e.name})));else if("email"===e)je(Object.assign({},Se,{email:n.email||Se.email})),_e((e=>Object.assign({},e,{email:n.email||e.email})));else if("bio"===e)W?(je(Object.assign({},Se,{bio:n.bio||Se.bio})),_e((e=>Object.assign({},e,{bio:n.bio||e.bio})))):(je(Object.assign({},Se,{bio:n.about_me||Se.bio})),_e((e=>Object.assign({},e,{bio:n.about_me||e.bio}))));else if("location"===e){const e=n.coordinates?.formatted_address||"".concat(n.address||"").concat(n.city?", ".concat(n.city):"").concat(n.state?", ".concat(n.state):"");je(Object.assign({},Se,{location:e})),_e((t=>Object.assign({},t,{location:e,address:n.address||t.address,apartment:n.apartment||t.apartment,city:n.city||t.city,state:n.state||t.state,zip:n.zip||t.zip})))}else"insurance"===e&&(oe(t),_e((e=>Object.assign({},e,{insurance:t}))));(0,h.debugLog)("MBA4928","Original values updated after save for ".concat(e),{originalValues:Object.assign({},Ae,{[e]:"location"===e?"".concat(n.address||"").concat(n.city?", ".concat(n.city):"").concat(n.state?", ".concat(n.state):""):n[e]})}),ke({message:"".concat(e.charAt(0).toUpperCase()+e.slice(1)," updated successfully"),type:"success",duration:3e3}),G(!1),A&&A(!1),_?((0,h.debugLog)("MBA3oin4f084","Notifying parent component of profile photo update:",n.profile_photo),_(n)):(0,h.debugLog)("MBA3oin4f084","No onSaveComplete function provided by parent component")}catch(zs){(0,h.debugLog)("MBA4928","Error saving ".concat(e,":"),zs),ke({message:"Failed to update ".concat(e,". Please try again."),type:"error",duration:4e3}),A&&A(!0)}finally{re(!1),$(null)}},Re=("".concat(l).concat(d?", ".concat(d):""),Se.name,e=>{(0,h.debugLog)("MBA9901","Opening verification modal for type: ".concat(e)),le(e),ie(!0)}),De=()=>{const e=(me?.length||0)>=10&&(fe||0)>=5;return(0,j.jsxs)(r.default,{style:[vo.section,I&&vo.mobileVerificationSection],children:[W&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(r.default,{style:vo.sectionHeader,children:(0,j.jsx)(a.default,{style:vo.sectionTitle,children:"Professional Verification"})}),(0,j.jsx)(a.default,{style:vo.verificationSectionSubtitle,children:"Enhance your profile with professional credentials"}),(0,j.jsxs)(r.default,{style:vo.verificationButtonsContainer,children:[(0,j.jsxs)(v.default,{style:vo.verificationButton,onPress:()=>Re("background_check"),children:[(0,j.jsx)(r.default,{style:vo.verificationButtonIcon,children:(0,j.jsx)(S.default,{name:"shield-check",size:24,color:m.theme.colors.primary})}),(0,j.jsxs)(r.default,{style:vo.verificationButtonContent,children:[(0,j.jsx)(a.default,{style:vo.verificationButtonTitle,children:"Background Verified"}),(0,j.jsx)(a.default,{style:vo.verificationButtonSubtitle,children:"Increase client trust"})]}),(0,j.jsx)(S.default,{name:"chevron-right",size:20,color:m.theme.colors.text})]}),(0,j.jsxs)(v.default,{style:vo.verificationButton,onPress:()=>Re("insurance"),children:[(0,j.jsx)(r.default,{style:vo.verificationButtonIcon,children:(0,j.jsx)(S.default,{name:"shield-account",size:24,color:m.theme.colors.primary})}),(0,j.jsxs)(r.default,{style:vo.verificationButtonContent,children:[(0,j.jsx)(a.default,{style:vo.verificationButtonTitle,children:"Insured Professional"}),(0,j.jsx)(a.default,{style:vo.verificationButtonSubtitle,children:"Additional protection"})]}),(0,j.jsx)(S.default,{name:"chevron-right",size:20,color:m.theme.colors.text})]}),(0,j.jsxs)(v.default,{style:[vo.verificationButton,e&&vo.verificationButtonElite],onPress:()=>Re("elite_pro"),disabled:!e,children:[(0,j.jsx)(r.default,{style:vo.verificationButtonIcon,children:(0,j.jsx)(S.default,{name:"star-circle",size:24,color:e?m.theme.colors.warning:m.theme.colors.placeHolderText})}),(0,j.jsxs)(r.default,{style:vo.verificationButtonContent,children:[(0,j.jsx)(a.default,{style:[vo.verificationButtonTitle,e&&vo.verificationButtonTitleElite],children:"Elite Pro Status"}),(0,j.jsx)(a.default,{style:[vo.verificationButtonSubtitle,e&&vo.verificationButtonSubtitleElite],children:e?"Congratulations! You're Elite!":"10+ bookings, 5-star average rating required"})]}),(0,j.jsx)(S.default,{name:e?"crown":"chevron-right",size:20,color:e?m.theme.colors.warning:m.theme.colors.placeHolderText})]})]})]}),(0,j.jsx)(go,{style:[W&&vo.donateSectionWithVerification],showTitle:!W})]})};return(0,j.jsxs)(r.default,{style:vo.container,children:[(0,j.jsx)(r.default,{style:vo.contentWrapper,children:(0,j.jsxs)(r.default,{style:[vo.mainContent,!I&&vo.desktopLayout],children:[(0,j.jsx)(r.default,{style:[vo.profileSection,!I&&vo.profileSectionDesktop],children:(0,j.jsxs)(r.default,{style:vo.profileCard,children:[(0,j.jsxs)(v.default,{onPress:async()=>{try{0;const e=await Mt.launchImageLibraryAsync({mediaTypes:Lt.MediaTypeOptions.Images,allowsEditing:!1,quality:1,base64:!0,allowsMultipleSelection:!1});if(!e.canceled&&e.assets&&e.assets.length>0){const t=e.assets[0];(0,h.debugLog)("MBA8080","Selected profile photo:",{uri:t.uri.substring(0,30)+"...",type:t.type||"image/jpeg",width:t.width,height:t.height,hasBase64:!!t.base64}),ce(t.uri),ge(!0)}}catch(zs){(0,h.debugLog)("MBA8080","Error selecting profile photo:",zs),ke({message:"Failed to select profile photo. Please try again.",type:"error",duration:3e3})}},style:vo.profilePhotoContainer,children:[Te.profile_photo?(0,j.jsx)(Q.default,{source:{uri:(0,p.getMediaUrl)(Te.profile_photo)},style:vo.profilePhoto,onError:e=>{(0,h.debugLog)("MBA5080","Error loading profile photo:",e.nativeEvent.error),(0,h.debugLog)("MBA5080","Profile photo URI:",(0,p.getMediaUrl)(Te.profile_photo))}}):(0,j.jsx)(r.default,{style:[vo.profilePhoto,vo.profilePhotoPlaceholder],children:(0,j.jsx)(S.default,{name:"camera-plus",size:40,color:m.theme.colors.placeHolderText})}),(0,j.jsx)(r.default,{style:vo.cameraButton,children:(0,j.jsx)(S.default,{name:"camera",size:20,color:m.theme.colors.background})}),ye>0&&(0,j.jsxs)(v.default,{style:vo.ratingBadge,onPress:()=>Ce(!0),children:[(0,j.jsx)(S.default,{name:"star",size:16,color:m.theme.colors.warning}),(0,j.jsx)(a.default,{style:vo.ratingBadgeText,children:fe.toFixed(1)})]})]}),(0,j.jsxs)(r.default,{style:vo.nameSection,children:[(0,j.jsx)(a.default,{style:vo.name,children:H||V||"Your Name"}),(0,j.jsx)(v.default,{onPress:()=>Me("name",Se.name),style:vo.editButton,children:(0,j.jsx)(S.default,{name:"pencil",size:24,color:m.theme.colors.primary})})]}),(0,j.jsxs)(r.default,{style:vo.section,children:[(0,j.jsxs)(r.default,{style:vo.sectionTitleContainer,children:[(0,j.jsx)(S.default,{name:"email-outline",size:24,color:m.theme.colors.text}),(0,j.jsx)(a.default,{style:vo.sectionTitle,children:"Email"})]}),(0,j.jsxs)(r.default,{style:vo.sectionContent,children:[(0,j.jsx)(a.default,{style:vo.sectionText,children:t||"Add your email"}),(0,j.jsx)(v.default,{onPress:()=>Me("email",Se.email),style:vo.editButton,children:(0,j.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.primary})})]})]}),(0,j.jsxs)(r.default,{style:vo.section,children:[(0,j.jsxs)(r.default,{style:vo.sectionTitleContainer,children:[(0,j.jsx)(S.default,{name:"map-marker-outline",size:24,color:m.theme.colors.text}),(0,j.jsx)(a.default,{style:vo.sectionTitle,children:"Location"})]}),(0,j.jsxs)(r.default,{style:vo.sectionContent,children:[(0,j.jsx)(a.default,{style:vo.sectionText,children:Se.location||"Add your location"}),(0,j.jsx)(v.default,{onPress:()=>Me("location",Se.location),style:vo.editButton,children:(0,j.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.primary})})]})]}),I&&De()]})}),(0,j.jsxs)(r.default,{style:[vo.sectionsContainer,{paddingBottom:I?150:0},!I&&vo.sectionsContainerDesktop],children:[(0,j.jsxs)(r.default,{style:[vo.section,{marginBottom:16}],children:[(0,j.jsxs)(r.default,{style:vo.sectionHeader,children:[(0,j.jsx)(a.default,{style:vo.sectionTitle,children:W?"Professional Bio":"About Me"}),(0,j.jsx)(v.default,{style:vo.editButton,onPress:()=>Me("bio",Se.bio),children:(0,j.jsxs)(a.default,{style:vo.editButtonText,children:["Edit ",W?"Bio":"About Me"]})})]}),(0,j.jsx)(a.default,{style:vo.bioText,children:Se.bio||"Tell us about yourself..."})]}),!I&&De()]})]})}),(0,j.jsx)(so,{visible:ue,imageUri:de,onClose:()=>{ge(!1),ce(null)},onSave:async(e,t)=>{try{re(!0);const o=Te.profile_photo||null,n=Object.assign({},t,{oldProfilePhotoUrl:o});(0,h.debugLog)("MBA8080","Processing cropped image with params:",n),(0,h.debugLog)("MBA8080","Old profile photo URL for deletion:",o);const r=(e=>{if(e.base64Data)return{isBase64:!0,data:e.base64Data,oldProfilePhotoUrl:e.oldProfilePhotoUrl};if(e.uri){const t=new FormData,o={uri:e.uri.replace("file://",""),type:"image/jpeg",name:"profile_photo.jpg"};return t.append("profile_picture",o),e.cropParams&&t.append("crop_params",JSON.stringify(e.cropParams)),e.oldProfilePhotoUrl&&t.append("old_profile_photo_url",e.oldProfilePhotoUrl),{isBase64:!1,data:t,oldProfilePhotoUrl:e.oldProfilePhotoUrl}}throw new Error("Invalid processed image data")})(await lo(e,n));let a;if(r.isBase64?((0,h.debugLog)("MBA8080","Uploading as base64 (web platform)"),a=await x.default.post("".concat(p.API_BASE_URL,"/api/users/v1/upload-profile-picture/"),{image_data:r.data,old_profile_photo_url:r.oldProfilePhotoUrl})):((0,h.debugLog)("MBA8080","Uploading as FormData (native platform)"),a=await(0,bt.uploadProfilePicture)(r.data)),(0,h.debugLog)("MBA8080","Profile photo upload successful:",a.data),a.data&&a.data.profile_photo){const e=a.data.profile_photo;(0,h.debugLog)("MBA5080","Setting profile photo in local state:",e),(0,h.debugLog)("MBA5080","Full photo URL will be:",(0,p.getMediaUrl)(e)),Be((t=>Object.assign({},t,{profile_photo:e}))),_?((0,h.debugLog)("MBA8080","Notifying parent component of profile photo update:",a.data.profile_photo),_({profile_photo:e})):(0,h.debugLog)("MBA8080","No onSaveComplete function provided by parent component"),ke({message:"Profile photo updated successfully",type:"success",duration:3e3})}}catch(o){(0,h.debugLog)("MBA8080","Error uploading profile photo:",o),o.response&&(0,h.debugLog)("MBA8080","Server error response:",o.response.data),ke({message:"Failed to upload profile photo. Please try again.",type:"error",duration:3e3})}finally{re(!1),ge(!1),ce(null)}},isUploading:ne}),(0,j.jsx)(xo,{visible:ae,onClose:()=>{ie(!1),le(null)},title:"background_check"===se?"Background Verification":"insurance"===se?"Insurance Verification":"elite_pro"===se?"Elite Pro Status":"",type:se,onProceed:()=>{"elite_pro"===se?(ie(!1),le(null)):(ie(!1),le(null),U?((0,h.debugLog)("MBA9901","Navigating to ContactUs screen for verification"),U.navigate("ContactUs")):((0,h.debugLog)("MBA9901","No navigation available, showing toast"),ke({message:"Please contact us at support@crittrcove.com to begin the verification process",type:"info",duration:5e3})))}}),(0,j.jsx)(po,{visible:we,onClose:()=>Ce(!1),reviews:me,averageRating:fe,reviewCount:ye,userName:Se.name,forProfessional:W,userTimezone:q?.timezone}),(0,j.jsx)(bo,{visible:!!J,onClose:()=>$(null),title:"Edit ".concat(J?.charAt(0).toUpperCase()).concat(J?.slice(1)),value:K,onSave:e=>{if((0,h.debugLog)("MBA4928","Save ".concat(J," to value:"),e),"insurance"===J)Le("insurance",e);else if("location"===J)Le("location",e);else{const t=Object.assign({},Se);t[J]=e,je(t),Le(J,e)}},isLocation:"location"===J,isMultiline:"bio"===J||"about_me"===J,isProfessional:W,isInsurance:"insurance"===J,selectedInsurance:te,onInsuranceChange:oe})]})},Co=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],So=({service:e})=>(0,j.jsx)(S.default,{name:{"Dog Walking":"walk","Pet Sitting":"home","Overnight Care":"bed"}[e]||"paw",size:24,color:m.theme.colors.text}),jo=i.default.create({container:{flex:1,backgroundColor:m.theme.colors.surface},content:{padding:24,gap:24},sectionBox:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,padding:16,alignSelf:"flex-start"},servicesSection:{width:"100%"},servicesList:{width:"100%"},serviceWrapper:{width:"100%"},serviceItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:16,borderRadius:8,marginBottom:8},selectedServiceItem:{borderWidth:1,borderColor:m.theme.colors.primary},serviceItemContent:{flexDirection:"row",alignItems:"center",flex:1},serviceInfo:{marginLeft:12,flex:1},serviceName:{fontSize:16,fontWeight:"500",color:m.theme.colors.text},servicePrice:{fontSize:14,color:m.theme.colors.secondary,marginTop:2},availabilityContainer:{flex:1,width:"100%"},controlsScrollContainer:{marginBottom:16},availabilityControls:{flexDirection:"row",gap:8},controlsDivider:{height:1,backgroundColor:m.theme.colors.surface,marginBottom:16},daysScrollContainer:{marginBottom:12},daysContainer:{flexDirection:"row",gap:8},availabilityDivider:{height:4,backgroundColor:m.theme.colors.surface,marginTop:16},availabilitySection:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,padding:16,marginBottom:16},availabilityHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},availabilityTitle:{fontSize:16,fontWeight:"600",color:m.theme.colors.text},editHoursButton:{backgroundColor:"transparent"},editHoursText:{color:m.theme.colors.primary,fontSize:14,fontWeight:"500"},dayItem:{borderWidth:1,borderColor:m.theme.colors.primary,backgroundColor:"transparent",paddingHorizontal:12,paddingVertical:8,borderRadius:6,position:"relative",overflow:"hidden"},petsittingDayItem:{backgroundColor:m.theme.colors.warningLight},dayText:{color:m.theme.colors.primary,fontSize:14,fontWeight:"500",zIndex:1},availabilityTime:{fontSize:14,color:m.theme.colors.secondary},serviceDivider:{backgroundColor:m.theme.colors.surface,marginVertical:8,marginHorizontal:16},availabilityList:{width:"100%"},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},sectionTitle:{fontSize:18,fontWeight:"600",color:m.theme.colors.text},editButton:{backgroundColor:"transparent"},editButtonText:{color:m.theme.colors.primary,fontSize:14,fontWeight:"500"},controlButton:{borderRadius:20,overflow:"hidden"},blockButtonContent:{flexDirection:"row",alignItems:"center",paddingVertical:8,paddingHorizontal:12,backgroundColor:"#FEE2E2",gap:6},blockButtonText:{color:m.theme.colors.error,fontSize:14,fontWeight:"500"},partialBlockButtonContent:{flexDirection:"row",alignItems:"center",paddingVertical:8,paddingHorizontal:12,backgroundColor:"#FFEDD5",gap:6},partialBlockText:{color:"#F97316",fontSize:14,fontWeight:"500"},dateRangeButtonContent:{flexDirection:"row",alignItems:"center",paddingVertical:8,paddingHorizontal:12,backgroundColor:"#EFF6FF",gap:6},dateRangeText:{color:"#3B82F6",fontSize:14,fontWeight:"500"},unavailableDayItem:{borderColor:m.theme.colors.error},unavailableSlash:{position:"absolute",top:"50%",left:-5,right:-5,height:1,backgroundColor:m.theme.colors.error,transform:[{rotate:"45deg"}]},unavailableDayText:{color:m.theme.colors.error},nextUnavailableContainer:{paddingVertical:8,paddingHorizontal:12},nextUnavailableText:{fontSize:14,color:m.theme.colors.secondary}}),To=({services:e=[{id:1,name:"Dog Walking",price:25,unit:"walk",isActive:!0,unavailableDays:["Sun"]},{id:2,name:"Pet Sitting",price:35,unit:"visit",isActive:!0,unavailableDays:["Sat","Sun"]},{id:3,name:"Overnight Care",price:85,unit:"night",isActive:!0,isOvernight:!0}],onToggleService:t,onEditHours:o,onBlockService:i,onPartialDayBlock:s})=>{const{screenWidth:l}=(0,n.useContext)(h.AuthContext),d=(0,b.useNavigation)(),[c,u]=(0,n.useState)(null),g=l<=1250,f=(e,o)=>(0,j.jsxs)(v.default,{style:[jo.serviceItem,{backgroundColor:o%2===0?m.theme.colors.proDashboard.secondary:m.theme.colors.proDashboard.tertiary},c?.id===e.id&&jo.selectedServiceItem],onPress:()=>u(e),children:[(0,j.jsxs)(r.default,{style:jo.serviceItemContent,children:[(0,j.jsx)(So,{service:e.name}),(0,j.jsxs)(r.default,{style:jo.serviceInfo,children:[(0,j.jsx)(a.default,{style:jo.serviceName,children:e.name}),(0,j.jsxs)(a.default,{style:jo.servicePrice,children:["$",e.price,"/",e.unit]})]})]}),(0,j.jsx)(st.default,{value:e.isActive,onValueChange:()=>t(e.id),trackColor:{false:m.theme.colors.border,true:m.theme.colors.primary},thumbColor:m.theme.colors.background})]},e.id),p=e=>e.isOvernight?(0,j.jsx)(r.default,{style:jo.nextUnavailableContainer,children:(0,j.jsx)(a.default,{style:jo.nextUnavailableText,children:"Next Unavailable: Dec 24-25"})}):(0,j.jsx)(X.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,style:jo.daysScrollContainer,contentContainerStyle:jo.daysContainer,children:Co.map((t=>{const o=e.unavailableDays?.includes(t);return(0,j.jsxs)(r.default,{style:[jo.dayItem,o&&jo.unavailableDayItem],children:[o&&(0,j.jsx)(r.default,{style:jo.unavailableSlash}),(0,j.jsx)(a.default,{style:[jo.dayText,o&&jo.unavailableDayText],children:t})]},t)}))});return(0,j.jsx)(r.default,{style:jo.container,children:(0,j.jsxs)(r.default,{style:[jo.content,{flexDirection:g?"column":"row"}],children:[(0,j.jsxs)(r.default,{style:[jo.servicesSection,!g&&{maxWidth:400},jo.sectionBox],children:[(0,j.jsxs)(r.default,{style:jo.sectionHeader,children:[(0,j.jsx)(a.default,{style:jo.sectionTitle,children:"Your Services"}),(0,j.jsx)(v.default,{style:jo.editButton,onPress:()=>d.navigate("ServiceManager"),children:(0,j.jsx)(a.default,{style:jo.editButtonText,children:"Edit Services"})})]}),(0,j.jsx)(r.default,{style:jo.servicesList,children:e.map(((t,o)=>(0,j.jsxs)(r.default,{style:jo.serviceWrapper,children:[f(t,o),o!==e.length-1&&(0,j.jsx)(r.default,{style:jo.serviceDivider})]},t.id)))})]}),(0,j.jsxs)(r.default,{style:[jo.availabilityContainer,g&&{marginTop:24},jo.sectionBox],children:[(0,j.jsx)(r.default,{style:jo.sectionHeader,children:(0,j.jsx)(a.default,{style:jo.sectionTitle,children:"Availability"})}),(0,j.jsxs)(X.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,style:jo.controlsScrollContainer,contentContainerStyle:jo.availabilityControls,children:[(0,j.jsx)(v.default,{style:jo.controlButton,onPress:i,children:(0,j.jsxs)(r.default,{style:jo.blockButtonContent,children:[(0,j.jsx)(S.default,{name:"block-helper",size:20,color:m.theme.colors.error}),(0,j.jsx)(a.default,{style:jo.blockButtonText,children:"Block All Services"})]})}),(0,j.jsx)(v.default,{style:jo.controlButton,onPress:s,children:(0,j.jsxs)(r.default,{style:jo.partialBlockButtonContent,children:[(0,j.jsx)(S.default,{name:"clock-outline",size:20,color:"#F97316"}),(0,j.jsx)(a.default,{style:jo.partialBlockText,children:"Partial Day Block"})]})}),(0,j.jsx)(v.default,{style:jo.controlButton,children:(0,j.jsxs)(r.default,{style:jo.dateRangeButtonContent,children:[(0,j.jsx)(S.default,{name:"calendar-range",size:20,color:"#3B82F6"}),(0,j.jsx)(a.default,{style:jo.dateRangeText,children:"Date Range"})]})})]}),(0,j.jsx)(r.default,{style:jo.controlsDivider}),(0,j.jsx)(r.default,{style:jo.availabilityList,children:e.map(((t,n)=>((t,n)=>(0,j.jsxs)(r.default,{style:jo.availabilitySection,children:[(0,j.jsxs)(r.default,{style:jo.availabilityHeader,children:[(0,j.jsx)(a.default,{style:jo.availabilityTitle,children:t.name}),(0,j.jsx)(v.default,{style:jo.editHoursButton,onPress:()=>o(t.id),children:(0,j.jsx)(a.default,{style:jo.editHoursText,children:"Edit Hours"})})]}),p(t),(0,j.jsx)(a.default,{style:jo.availabilityTime,children:t.isOvernight?"Check-in: 3 PM, Check-out: 11 AM":"Available 9 AM - 5 PM"}),n!==e.length-1&&(0,j.jsx)(r.default,{style:jo.availabilityDivider})]}))(t,n)))})]})]})})},Bo=e=>{if(!e)return"";const t=new Date,o=new Date(e);let n=t.getFullYear()-o.getFullYear(),r=t.getMonth()-o.getMonth();r<0&&(n--,r+=12);let a="";return n>0&&(a+="".concat(n," year").concat(n>1?"s":"")),r>0&&(a&&(a+=" "),a+="".concat(r," month").concat(r>1?"s":"")),a||(a="< 1 month"),a},ko=i.default.create({emptyStateContainer:{padding:20,alignItems:"center",justifyContent:"center",borderWidth:1,borderStyle:"dashed",borderColor:m.theme.colors.border,borderRadius:8,marginVertical:10},emptyStateText:{fontSize:16,color:m.theme.colors.secondary,textAlign:"center",marginBottom:10},container:{flex:1,gap:24},section:{borderRadius:12,padding:24,marginBottom:24},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:10,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,marginBottom:12},sectionTitle:{fontSize:18,fontWeight:"600",color:m.theme.colors.text},sectionDescription:{fontSize:14,color:m.theme.colors.secondary,marginBottom:16},addButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.primary,paddingHorizontal:8,paddingVertical:4,borderRadius:6,gap:8},addButtonText:{color:m.theme.colors.background,fontSize:14,fontWeight:"500"},petsList:{gap:16,paddingBottom:70},petCard:{borderRadius:12,overflow:"hidden",borderWidth:1,borderColor:m.theme.colors.border},petCardHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16},petBasicInfo:{flexDirection:"row",alignItems:"center",gap:16,flex:1},petPhoto:{width:68,height:68,borderRadius:50},placeholderIcon:{width:68,height:68,borderRadius:34,backgroundColor:m.theme.colors.surfaceVariant,textAlign:"center",textAlignVertical:"center",paddingTop:14},profilePhotoButton:{position:"relative"},plusIconContainer:{position:"absolute",bottom:0,right:0,backgroundColor:m.theme.colors.surface,borderRadius:12,padding:2,borderWidth:1,borderColor:m.theme.colors.primary},petInfo:{flex:1,marginLeft:12,justifyContent:"center"},petName:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,marginBottom:4},petDetailsContainer:{flexDirection:"column"},petDetails:{fontSize:14,color:m.theme.colors.secondary,marginBottom:2},expandedDetails:{borderTopWidth:1,borderTopColor:m.theme.colors.border,padding:16},detailRow:{flexDirection:"row",gap:24,marginBottom:16},detailColumn:{flex:1},detailTitle:{fontSize:14,fontWeight:"600",color:m.theme.colors.text,marginBottom:8},detailText:{fontSize:14,color:m.theme.colors.secondary},preferencesGrid:{flexDirection:"row",flexWrap:"wrap",gap:12,marginTop:16},preferenceButton:{flexDirection:"row",alignItems:"center",gap:8,paddingVertical:8,paddingHorizontal:12,borderRadius:6,borderWidth:1,borderColor:m.theme.colors.primary,backgroundColor:m.theme.colors.surface},selectedPreference:{borderColor:m.theme.colors.primary,backgroundColor:"".concat(m.theme.colors.primary,"15")},preferenceText:{fontSize:14,color:m.theme.colors.primary,flex:1},selectedPreferenceText:{color:m.theme.colors.primary},checkmark:{marginLeft:"auto"},petActions:{flexDirection:"row",alignItems:"center",gap:12},editButton:{padding:4},fixButton:{padding:4,backgroundColor:"".concat(m.theme.colors.warning,"15"),borderRadius:4,marginHorizontal:4},addContactForm:{marginBottom:16,gap:12},input:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:6,padding:12,fontSize:14,color:m.theme.colors.text},submitButton:{backgroundColor:m.theme.colors.primary,padding:12,borderRadius:6,alignItems:"center"},submitButtonText:{color:m.theme.colors.background,fontSize:14,fontWeight:"500"},contactsList:{gap:12},contactCard:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:12,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,backgroundColor:m.theme.colors.surface},contactInfo:{flex:1},contactName:{fontSize:16,fontWeight:"500",color:m.theme.colors.text},contactPhone:{fontSize:14,color:m.theme.colors.secondary},contactActions:{flexDirection:"row",gap:8},actionButton:{padding:8},emptyListText:{fontSize:14,color:m.theme.colors.secondary,fontStyle:"italic",textAlign:"center",padding:12},compatibilityContainer:{flexDirection:"column",gap:12},compatibilityItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:6,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,flexWrap:"wrap"},compatibilityLabel:{fontSize:14,color:m.theme.colors.text,flex:.4,marginRight:10},dropdownContainer:{flexDirection:"row",alignItems:"center",gap:8,minWidth:60,justifyContent:"flex-end"},dropdownText:{fontSize:14,color:m.theme.colors.secondary},careInfoContainer:{flexDirection:"column",gap:12},medicationsContainer:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:6,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},medicationsText:{fontSize:14,color:m.theme.colors.secondary},vetInfoContainer:{flexDirection:"column",gap:12},vetInfoItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:6,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},vetInfoLabel:{fontSize:14,color:m.theme.colors.text},vetInfoText:{fontSize:14,color:m.theme.colors.secondary},documentButton:{flexDirection:"row",alignItems:"center",gap:8},documentButtonText:{fontSize:14,color:m.theme.colors.primary},dropdownContainerEdit:{flexDirection:"row",alignItems:"center",gap:8,minWidth:60,justifyContent:"flex-end",flexWrap:"wrap"},optionButton:{padding:8,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:6,marginLeft:10,marginBottom:5},selectedOption:{borderColor:m.theme.colors.primary,backgroundColor:"".concat(m.theme.colors.primary,"15")},optionText:{fontSize:14,color:m.theme.colors.text},selectedOptionText:{color:m.theme.colors.primary},editInput:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:6,padding:12,fontSize:14,color:m.theme.colors.text},editInputMedications:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:6,padding:12,fontSize:14,color:m.theme.colors.text,flex:1,marginLeft:10},editInputShort:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:6,padding:12,fontSize:14,color:m.theme.colors.text,width:"55%",marginLeft:"auto"},editInputWeight:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:6,padding:12,fontSize:14,color:m.theme.colors.text,width:"40%",marginLeft:"auto"},uploadButton:{flexDirection:"row",alignItems:"center",gap:8,backgroundColor:m.theme.colors.primary,paddingHorizontal:12,paddingVertical:8,borderRadius:6},uploadButtonText:{color:m.theme.colors.background,fontSize:14,fontWeight:"500"},documentActionContainer:{flexDirection:"column",gap:8},documentsList:{marginTop:8},documentItem:{flexDirection:"row",alignItems:"center",gap:8,paddingVertical:6},documentName:{fontSize:14,color:m.theme.colors.text,flex:1},viewDocButton:{paddingHorizontal:8,paddingVertical:4,borderRadius:4,backgroundColor:"".concat(m.theme.colors.primary,"15")},viewDocText:{fontSize:12,color:m.theme.colors.primary},noDocumentsText:{fontSize:14,color:m.theme.colors.secondary,fontStyle:"italic",marginTop:8},detailSection:{marginTop:16},editContainer:{flexWrap:"wrap",gap:16,alignItems:"flex-start"},inputsWrapper:{flexDirection:"row",flexWrap:"wrap",gap:16,flex:1},inputWrapper:{minWidth:150,flexBasis:"46%",flexGrow:1,marginBottom:8},inputLabel:{fontSize:12,color:m.theme.colors.secondary,marginBottom:4},editMainContainer:{width:"100%",marginBottom:16},editHeaderRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:16},editProfileContainer:{marginBottom:16,alignItems:"center"},editDetailsContainer:{width:"100%"},editActions:{flexDirection:"row",gap:12,alignItems:"center",flexWrap:"wrap"},editActionsSmallScreen:{flexDirection:"column",alignItems:"stretch",gap:8},buttonRowTop:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},buttonRowBottom:{flexDirection:"row",justifyContent:"flex-end",alignItems:"center",marginTop:8,gap:4},dateInfoContainer:{flexDirection:"column",gap:12},dateInfoItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:6,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},dateInfoLabel:{fontSize:14,color:m.theme.colors.text,flex:1},dateInfoText:{fontSize:14,color:m.theme.colors.secondary},customDatePickerContainer:{flexDirection:"row",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border,borderRadius:6,overflow:"hidden",height:46},dateInputBox:{flex:1,height:"100%",justifyContent:"center",paddingHorizontal:12},dateInputText:{fontSize:14,color:m.theme.colors.text},placeholderText:{color:m.theme.colors.placeholder},calendarButton:{width:46,height:"100%",backgroundColor:m.theme.colors.surface,borderLeftWidth:1,borderLeftColor:m.theme.colors.border,justifyContent:"center",alignItems:"center"},datePickerContainer:{flex:1,maxWidth:"60%",marginLeft:"auto",marginRight:10},"@media (min-width: 900px)":{petDetailsContainer:{flexDirection:"row",flexWrap:"wrap",gap:8},petDetails:{marginRight:8}},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},calendarModalContent:{backgroundColor:m.theme.colors.background,borderRadius:12,padding:20,width:"90%",maxWidth:420},calendarModalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},calendarModalTitle:{fontSize:20,fontWeight:"600",color:m.theme.colors.text},closeButton:{padding:4},calendarHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},calendarNavButton:{padding:8},calendarMonthYear:{fontSize:18,fontWeight:"600",color:m.theme.colors.text},weekdayLabels:{flexDirection:"row",justifyContent:"space-around",marginBottom:8},weekdayLabel:{flex:1,textAlign:"center",fontSize:14,fontWeight:"500",color:m.theme.colors.secondary,paddingVertical:8},calendarGrid:{marginBottom:16},calendarRow:{flexDirection:"row",justifyContent:"space-around",marginBottom:8},calendarDay:{flex:1,aspectRatio:1,alignItems:"center",justifyContent:"center",borderRadius:8,margin:2},calendarDayText:{fontSize:16,color:m.theme.colors.text},calendarDayOtherMonth:{opacity:.3},calendarDayTextOtherMonth:{color:m.theme.colors.placeholder},calendarDaySelected:{backgroundColor:m.theme.colors.primary},calendarDayTextSelected:{color:m.theme.colors.background,fontWeight:"600"},confirmButton:{backgroundColor:m.theme.colors.primary,borderRadius:8,padding:14,alignItems:"center",marginTop:8},confirmButtonText:{color:m.theme.colors.background,fontSize:16,fontWeight:"600"},stackedFields:{flexDirection:"column",gap:16,marginBottom:16},fullWidth:{width:"100%"},saveButton:{borderWidth:1,borderColor:m.theme.colors.primary,borderRadius:6,paddingHorizontal:12,paddingVertical:8,backgroundColor:m.theme.colors.primary,marginRight:8,alignItems:"center",justifyContent:"center"},saveButtonText:{color:"white",fontSize:14,fontWeight:"500"},deleteButton:{padding:8,marginRight:4,borderRadius:6,alignItems:"center",justifyContent:"center"},errorModalContent:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:24,width:"90%",maxWidth:500},successModalContent:{borderLeftWidth:4,borderLeftColor:m.theme.colors.success},errorModalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},successModalHeader:{},errorModalTitle:{fontSize:18,fontWeight:"bold",color:m.theme.colors.error},successModalTitle:{color:m.theme.colors.success},errorModalMessage:{marginBottom:24,fontSize:16,lineHeight:24},successModalMessage:{},errorModalButton:{backgroundColor:m.theme.colors.primary,padding:12,borderRadius:8,alignItems:"center"},successModalButton:{backgroundColor:m.theme.colors.success},errorModalButtonText:{color:m.theme.colors.surface,fontWeight:"bold"},successModalButtonText:{},editButtonTopRight:{position:"absolute",top:12,right:12,zIndex:2},chevronButtonBottomRight:{position:"absolute",bottom:12,right:12,zIndex:2},petInfoWithButtonPadding:{paddingRight:20},dropdownContainer:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:12,marginBottom:16},dropdownButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surface,paddingHorizontal:12,paddingVertical:8,borderRadius:6,borderWidth:1,borderColor:m.theme.colors.border,minWidth:120},dropdownButtonText:{fontSize:16,color:m.theme.colors.text,marginRight:8},dropdownList:{position:"absolute",top:100,left:20,right:20,backgroundColor:m.theme.colors.surface,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,zIndex:1e3,maxHeight:200,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},dropdownScrollView:{maxHeight:200},dropdownItem:{paddingVertical:12,paddingHorizontal:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},dropdownItemSelected:{backgroundColor:m.theme.colors.primary+"20"},dropdownItemText:{fontSize:16,color:m.theme.colors.text},dropdownItemTextSelected:{color:m.theme.colors.primary,fontWeight:"600"},inputError:{borderColor:m.theme.colors.error,borderWidth:1},errorText:{color:m.theme.colors.error,fontSize:12,marginTop:4,fontFamily:m.theme.fonts?.regular?.fontFamily},submitButtonDisabled:{opacity:.5}}),Ao=({pets:e=[],preferences:t={homeEnvironment:[],emergencyContacts:[],authorizedHouseholdMembers:[]},onAddPet:o,onEditPet:i,onDeletePet:s,onReplacePet:l,onUpdatePreferences:d,userRole:c,isMobile:u})=>{(0,h.debugLog)("MBAi39gh45v","COMPONENT INIT - Pets provided to component:",Array.isArray(e)?e.map((e=>({id:e.id,name:e.name||"unnamed"}))):"Not an array"),(0,h.debugLog)("MBAi39gh45v","COMPONENT INIT - Available callbacks:",{hasOnAddPet:!!o,hasOnEditPet:!!i,hasOnDeletePet:!!s,hasOnReplacePet:!!l});const[g,f]=(0,n.useState)(new Set),[y,b]=(0,n.useState)({name:"",phone:""}),[x,w]=(0,n.useState)({name:"",phone:""}),[T,B]=(0,n.useState)(!1),[A,_]=(0,n.useState)(!1),[M,L]=(0,n.useState)(new Set),[R,D]=(0,n.useState)({}),[z,P]=(0,n.useState)({}),[F,W]=(0,n.useState)({isVisible:!1,currentField:null,currentPetId:null,selectedDate:new Date}),[O,N]=(0,n.useState)((new Date).getMonth()),[H,U]=(0,n.useState)((new Date).getFullYear()),[V,q]=(0,n.useState)(C.default.get("window").width),Y=E(),[G,J]=(0,n.useState)(!1),[$,K]=(0,n.useState)(!0),[Z,ee]=(0,n.useState)({visible:!1,petId:null,petName:"",isDeleting:!1}),[oe,ne]=(0,n.useState)(!1),[re,ae]=(0,n.useState)(!1),[ie,se]=(0,n.useState)(null),[le,de]=(0,n.useState)(!1),[ce,ue]=(0,n.useState)(null),[ge,me]=(0,n.useState)(!1),[he,fe]=(0,n.useState)({}),[pe,ye]=(0,n.useState)({});(0,n.useEffect)((()=>{const e=()=>{q(C.default.get("window").width)};return C.default.addEventListener("change",e),()=>{C.default.removeEventListener&&C.default.removeEventListener("change",e)}}),[]);const be=["Yes","No","N/A"],xe=["Low","Medium","High","N/A"],ve=["Male","Female"],we=(e,t)=>{let o="No Option Selected";return e&&t&&(null===e[t]?o="N/A":!0===e[t]?o="Yes":!1===e[t]?o="No":"string"===typeof e[t]&&(o=e[t])),(0,j.jsx)(r.default,{style:ko.dropdownContainer,children:(0,j.jsx)(a.default,{style:ko.dropdownText,children:o})})},Ce=e=>{let t="No Option Selected";return e&&void 0!==e.energyLevel&&(null===e.energyLevel?t="N/A":"LOW"===e.energyLevel?t="Low":"MODERATE"===e.energyLevel?t="Medium":"HIGH"===e.energyLevel?t="High":"string"===typeof e.energyLevel?t=e.energyLevel?e.energyLevel:"None selected yet":e.energyLevel&&"object"===typeof e.energyLevel&&(t="No Option Selected")),(0,j.jsx)(r.default,{style:ko.dropdownContainer,children:(0,j.jsx)(a.default,{style:ko.dropdownText,children:t})})},Se=e=>{f((t=>{const o=new Set(t);return o.has(e)?o.delete(e):o.add(e),o}))},je=t=>{const o=e.find((e=>e.id===t)),n=Object.assign({},o);n.medications&&"object"===typeof n.medications&&(n.medications="");const r=e=>!0===e?"Yes":!1===e?"No":"N/A";o&&(n.childrenFriendly=r(o.friendly_with_children),n.catFriendly=r(o.friendly_with_cats),n.dogFriendly=r(o.friendly_with_dogs),n.spayedNeutered=r(o.spayed_neutered),n.houseTrained=r(o.house_trained),n.microchipped=r(o.microchipped),n.canBeLeftAlone=r(o.can_be_left_alone),n.getsAlongWithChildren=n.childrenFriendly,n.getsAlongWithCats=n.catFriendly,n.getsAlongWithDogs=n.dogFriendly),D((e=>Object.assign({},e,{[t]:n}))),L((e=>{const o=new Set(e);return o.add(t),o}))},Te=async t=>{const o=e.find((e=>e.id===t));if((0,h.debugLog)("MBA456","DELETE PET - Attempting to delete pet with ID:",t),(0,h.debugLog)("MBA456","DELETE PET - Found pet:",o?{id:o.id,name:o.name}:"Pet not found"),!o)return void Y({message:"Unable to delete pet - could not find pet with ID ".concat(t),type:"error",duration:4e3});const n=o.name||"this pet";ee({visible:!0,petId:o.id,petName:n,isDeleting:!1})},Be=e=>{if(!e)return null;const[t,o,n]=e.split("-");return"".concat(n,"-").concat(t,"-").concat(o)},ke=e=>{if(!e)return null;const[t,o,n]=e.split("-");return"".concat(o,"-").concat(n,"-").concat(t)},Ae=async t=>{try{J(!0);const o=R[t]||{},n=[...e];(0,h.debugLog)("MBA456","SAVE PET - Saving current pets list state:",n.map((e=>({id:e.id,name:e.name||"unnamed"})))),(0,h.debugLog)("MBA456","SAVE PET - Starting to save pet:",{petId:t,petData:o});const r=t&&t.toString().startsWith("temp_"),a=e=>"Yes"===e||"No"!==e&&null,s={name:Ke(o.name||"","name",{maxLength:50}),breed:Ke(o.breed||"","name",{maxLength:50}),type:Ke(o.type||"","name",{maxLength:50}),feedingInstructions:Ke(o.feedingInstructions||"","description",{maxLength:500}),medicalNotes:Ke(o.medicalNotes||"","description",{maxLength:500}),pottyBreakSchedule:Ke(o.pottyBreakSchedule||"","description",{maxLength:500}),specialCareInstructions:Ke(o.specialCareInstructions||"","description",{maxLength:500}),medications:Ke(o.medications||"","description",{maxLength:500}),vetName:Ke(o.vetName||"","general",{maxLength:100}),vetAddress:Ke(o.vetAddress||"","description",{maxLength:200}),insuranceProvider:Ke(o.insuranceProvider||"","general",{maxLength:100}),birthday:o.birthday,adoptionDate:o.adoptionDate,weight:o.weight,microchipId:o.microchipId,sex:o.sex,allergies:o.allergies,vaccinations:o.vaccinations,vetPhone:o.vetPhone};(0,h.debugLog)("MBA456","SAVE PET - Sanitized pet data:",{originalName:o.name,sanitizedName:s.name,originalBreed:o.breed,sanitizedBreed:s.breed});let l={name:s.name,breed:s.breed,birthday:s.birthday?Be(s.birthday):null,adoption_date:s.adoptionDate?Be(s.adoptionDate):null,weight:s.weight||null,feeding_schedule:s.feedingInstructions,medication_notes:s.medicalNotes,potty_break_schedule:s.pottyBreakSchedule,special_care_instructions:s.specialCareInstructions,species:s.type,microchip_id:s.microchipId||"",sex:s.sex||null,medications:s.medications,allergies:s.allergies||"",vaccinations:s.vaccinations||"",vet_name:s.vetName,vet_address:s.vetAddress||"",vet_phone:s.vetPhone||"",insurance_provider:s.insuranceProvider,spayed_neutered:a(o.spayedNeutered),house_trained:a(o.houseTrained),friendly_with_dogs:a(o.dogFriendly),friendly_with_cats:a(o.catFriendly),friendly_with_children:a(o.childrenFriendly),microchipped:a(o.microchipped),can_be_left_alone:a(o.canBeLeftAlone),energy_level:o.energyLevel||null};(0,h.debugLog)("MBA456","SAVE PET - Formatted pet compatibility fields:",{friendly_with_children:l.friendly_with_children,friendly_with_cats:l.friendly_with_cats,friendly_with_dogs:l.friendly_with_dogs,spayed_neutered:l.spayed_neutered,house_trained:l.house_trained,microchipped:l.microchipped,can_be_left_alone:l.can_be_left_alone,energy_level:l.energy_level});const d=new FormData;if(o.photo){if((0,h.debugLog)("MBA5555","Adding pet photo to form data"),!r){const o=e.find((e=>e.id===t));o&&o.profile_photo&&d.append("old_profile_photo_url",o.profile_photo)}if(o.photo.base64Data)d.append("pet_photo_base64",o.photo.base64Data);else if(o.photo.uri){const e={uri:o.photo.uri.replace("file://",""),type:"image/jpeg",name:"pet_photo.jpg"};d.append("pet_photo",e),o.photo.cropParams&&d.append("crop_params",JSON.stringify(o.photo.cropParams))}}let c;if(Object.entries(l).forEach((([e,t])=>{null!==t&&void 0!==t&&("boolean"===typeof t?d.append(e,t.toString()):d.append(e,t))})),r)try{(0,h.debugLog)("MBA456","Adding new pet with data:",{name:l.name,species:l.species,breed:l.breed});l.name,l.species,l.breed,o.childrenFriendly,o.catFriendly,o.dogFriendly,o.houseTrained,o.spayedNeutered,o.microchipped,o.canBeLeftAlone,o.energyLevel,o.birthday,o.adoptionDate,o.feedingInstructions,o.medicalNotes,o.pottyBreakSchedule,o.specialCareInstructions,o.weight,o.vetName,o.vetAddress,o.vetPhone,o.insuranceProvider,o.sex,o.photoUri;if(c=await(0,bt.addPet)(d),!c||!c.pet)throw new Error("Invalid response from server when adding pet");{const e=c.pet;(0,h.debugLog)("MBA5555","Pet created successfully, server response:",{pet_id:e.pet_id||"not returned",id:e.id||"not returned",name:e.name,species:e.species,breed:e.breed}),e.pet_id||(0,h.debugLog)("MBA5555","WARNING: No pet_id in server response. Raw response:",e),Y({message:"".concat(l.name||"Pet"," added successfully!"),type:"success",duration:4e3});const o=Object.assign({},e,{name:l.name||e.name,species:l.species||e.species,breed:l.breed||e.breed,id:e.pet_id});Pe(t,o)}}catch(zs){Y({message:"Error saving pet: ".concat(zs.message),type:"error",duration:4e3}),(0,h.debugLog)("MBA456","Error in pet creation:",zs),Array.isArray(n)&&n.length>0&&(0,h.debugLog)("MBA456","Restoring pets list after error")}else{if((0,h.debugLog)("MBA456","Updating existing pet with ID:",t),c=await(0,bt.updatePet)(t,d),!c||!c.pet)throw new Error("Invalid response from server when updating pet");{const e=c.pet;Y({message:"".concat(e.name?e.name.charAt(0).toUpperCase()+e.name.slice(1).toLowerCase():"Pet"," updated successfully!"),type:"success",duration:4e3});let o=e.profile_photo;!o||o.startsWith("http")||o.startsWith("data:")||(o=(0,p.getMediaUrl)(o)),(0,h.debugLog)("MBA5555","Pet updated successfully, profile photo URL:",o);const n=Object.assign({},e,{id:t,type:e.species||e.type,feedingInstructions:e.feeding_schedule||e.feedingInstructions,medicalNotes:e.medication_notes||e.medicalNotes,pottyBreakSchedule:e.potty_break_schedule||e.pottyBreakSchedule,specialCareInstructions:e.special_care_instructions||e.specialCareInstructions,vetName:e.vet_name||"",vetAddress:e.vet_address||"",vetPhone:e.vet_phone||"",insuranceProvider:e.insurance_provider||"",childrenFriendly:!0===e.friendly_with_children?"Yes":!1===e.friendly_with_children?"No":"N/A",catFriendly:!0===e.friendly_with_cats?"Yes":!1===e.friendly_with_cats?"No":"N/A",dogFriendly:!0===e.friendly_with_dogs?"Yes":!1===e.friendly_with_dogs?"No":"N/A",houseTrained:!0===e.house_trained?"Yes":!1===e.house_trained?"No":"N/A",spayedNeutered:!0===e.spayed_neutered?"Yes":!1===e.spayed_neutered?"No":"N/A",microchipped:!0===e.microchipped?"Yes":!1===e.microchipped?"No":"N/A",canBeLeftAlone:!0===e.can_be_left_alone?"Yes":!1===e.can_be_left_alone?"No":"N/A",energyLevel:e.energy_level||"",birthday:e.birthday?ke(e.birthday):null,adoptionDate:e.adoption_date?ke(e.adoption_date):null,profile_photo:o});(0,h.debugLog)("MBA5555","Formatted pet data for UI:",n),D((e=>{const o=Object.assign({},e);return delete o[t],o})),i&&i(t,n)}}L((e=>{const o=new Set(e);return o.delete(t),o}))}catch(zs){(0,h.debugLog)("MBA456","Error saving pet:",zs),Y({message:"Failed to save pet: ".concat(zs.message||"Unknown error"),type:"error",duration:5e3}),D((e=>Object.assign({},e,{[t]:Object.assign({},e[t]||{},{lastEditFailed:!0})})))}finally{J(!1)}},_e=e=>{e&&e.toString().startsWith("temp_")&&((0,h.debugLog)("MBA456","Discarding newly added pet:",e),s(e)),L((t=>{const o=new Set(t);return o.delete(e),o})),D((t=>{const o=Object.assign({},t);return delete o[e],o}))},Ie=e=>{const t=e.replace(/\D/g,"");return t.length>=6?"".concat(t.substring(0,3),"-").concat(t.substring(3,6),"-").concat(t.substring(6,10)):t.length>=3?"".concat(t.substring(0,3),"-").concat(t.substring(3)):t},Me=(e,t,o)=>{if(["childrenFriendly","catFriendly","dogFriendly","spayedNeutered","houseTrained","microchipped","canBeLeftAlone","energyLevel","sex"].includes(t))D((n=>Object.assign({},n,{[e]:Object.assign({},n[e]||{},{[t]:o})}))),"childrenFriendly"===t?D((t=>Object.assign({},t,{[e]:Object.assign({},t[e]||{},{getsAlongWithChildren:o})}))):"catFriendly"===t?D((t=>Object.assign({},t,{[e]:Object.assign({},t[e]||{},{getsAlongWithCats:o})}))):"dogFriendly"===t&&D((t=>Object.assign({},t,{[e]:Object.assign({},t[e]||{},{getsAlongWithDogs:o})})));else{const{sanitized:n}=((e,t,o)=>{(0,h.debugLog)("MBA7777","Validating pet input:",{field:e,value:t,petId:o});let n=t,r="";if(["childrenFriendly","catFriendly","dogFriendly","spayedNeutered","houseTrained","microchipped","canBeLeftAlone","energyLevel","sex"].includes(e))return{sanitized:n,error:r};if("name"===e)n=Ke(t,"service_name",{maxLength:50}),n.length>0&&n.length<2&&(r="Pet name must be at least 2 characters long");else if("breed"===e||"color"===e)n=Ke(t,"service_name",{maxLength:50}),n.length>0&&n.length<2&&(r="Pet ".concat(e," must be at least 2 characters long"));else if("type"===e)n=Ke(t,"service_name",{maxLength:50}),n.length>0&&n.length<2&&(r="Animal type must be at least 2 characters long");else if(["specialInstructions","medicalConditions","feedingInstructions","medicalNotes","pottyBreakSchedule","specialCareInstructions","medications"].includes(e))n=Ke(t,"service_description",{maxLength:500}),n.length>500&&(r="".concat(e," must be no more than 500 characters long"));else if("weight"===e){if(n=Ke(t,"amount"),n&&n.length>0){const e=parseFloat(n);isNaN(e)?r="Weight must be a valid number":e<=0?r="Weight must be greater than 0":e>500&&(r="Weight cannot exceed 500 lbs")}}else if(["vetName","insuranceProvider"].includes(e))n=Ke(t,"service_name",{maxLength:100}),n.length>0&&n.length<2&&(r="".concat(e," must be at least 2 characters long"));else if(["vetAddress"].includes(e))n=Ke(t,"service_description",{maxLength:200}),n.length>200&&(r="".concat(e," must be no more than 200 characters long"));else if("vetPhone"===e){const e=t.replace(/\D/g,"");if(e.length>10)n=Ie(e.substring(0,10)),r="Phone number cannot exceed 10 digits";else if(e.length>0)if(n=Ie(e),10===e.length){const e=tt(n);e.isValid||(r=e.message)}else e.length<10&&e.length;else n=""}else n=Ke(t,"general",{maxLength:200});return fe((t=>{const n=t[o]||{},a=Object.assign({},n);r?a[e]=r:delete a[e];const i=Object.keys(a).length>0?a:void 0,s=Object.assign({},t);return i?s[o]=i:delete s[o],s})),{sanitized:n,error:r}})(t,o,e);let r=o=n;if("vetPhone"===t){const e=o.replace(/\D/g,"");r=e.length<=10?Ie(e):Ie(e.substring(0,10))}D((o=>Object.assign({},o,{[e]:Object.assign({},o[e]||{},{[t]:r})})))}(0,h.debugLog)("MBA456","Editing pet field",{petId:e,field:t,value:o})},Le=(e,t)=>{try{if(!e||!t)return!1;const o=String(e),n="".concat(o,"-").concat(t);return!0===z[n]}catch(o){return console.error("Error checking if section is expanded:",o.message||"Unknown error"),!1}},Re=(e,t,o)=>{try{if(!e||!o)return console.warn("Missing required parameters in renderSectionHeader"),null;const n="string"===typeof t?t:"Section",r=Le(e,o);return(0,j.jsxs)(v.default,{style:ko.sectionHeader,onPress:t=>((e,t,o)=>{try{if(o&&"function"===typeof o.stopPropagation&&o.stopPropagation(),!e)return void console.warn("Missing petId in toggleSection");if(!t)return void console.warn("Missing sectionName in toggleSection");const n=String(e),r=String(t),a="".concat(n,"-").concat(r);P((e=>{if(!e||"object"!==typeof e){const e={};return e[a]=!0,e}const t=Object.assign({},e),o=!0===t[a];return t[a]=!o,t}))}catch(n){console.error("Error toggling section:",n.message||"Unknown error")}})(e,o,t),children:[(0,j.jsx)(a.default,{style:ko.detailTitle,children:n}),(0,j.jsx)(S.default,{name:r?"chevron-up":"chevron-down",size:20,color:m.theme.colors.text})]})}catch(zs){return console.error("Error rendering section header:",zs.message||"Unknown error"),null}},De=(e,t)=>{const o=(e=>{if(!e)return new Date;const[t,o,n]=e.split("-").map((e=>parseInt(e,10)));return!t||!o||!n||isNaN(t)||isNaN(o)||isNaN(n)?new Date:new Date(n,t-1,o)})(R[e]?.[t]);N(o.getMonth()),U(o.getFullYear()),W({isVisible:!0,currentField:t,currentPetId:e,selectedDate:o})},ze=(0,n.useMemo)((()=>{if(!F.isVisible)return[];const e=F.selectedDate||new Date,t=new Date(H,O,1),o=new Date(H,O+1,0).getDate(),n=t.getDay(),r=7*Math.ceil((o+n)/7),a=[];let i=1-n;for(let l=0;l<r;l++){const t=new Date(H,O,i),o=t.getMonth()===O,n=o&&t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear();a.push({date:t,day:t.getDate(),isCurrentMonth:o,isSelectedDate:n}),i++}const s=[];for(let l=0;l<a.length;l+=7)s.push(a.slice(l,l+7));return s}),[O,H,F.selectedDate,F.isVisible]),Pe=(t,n)=>{try{if((0,h.debugLog)("MBAi39gh45v","REPLACE PET START - Current pets before replacement:",Array.isArray(e)?e.map((e=>({id:e.id,name:e.name||"unnamed"}))):"pets is not an array"),(0,h.debugLog)("MBAi39gh45v","REPLACE PET - Temp ID to replace:",t),(0,h.debugLog)("MBAi39gh45v","REPLACE PET - Real pet data:",JSON.stringify(n)),!t||!n)return(0,h.debugLog)("MBAi39gh45v","REPLACE PET ERROR - Invalid data provided",{tempPetId:t,realPetData:n}),void Y({message:"Pet saved successfully!",type:"success",duration:4e3});(0,h.debugLog)("MBA5555","REPLACE PET - Backend response data:",JSON.stringify(n));const r=n.pet_id;r?(0,h.debugLog)("MBA5555","REPLACE PET - Using pet_id from server:",r):((0,h.debugLog)("MBA5555","REPLACE PET ERROR - No pet_id in server response:",n),Y({message:"Pet was created but ID is missing. Please refresh the page.",type:"warning",duration:5e3})),(0,h.debugLog)("MBA5555","REPLACE PET - Using pet ID:",r);const a=e=>!0===e?"Yes":!1===e?"No":"N/A",i=Object.assign({},n,{id:r,type:n.species||n.type||"",feedingInstructions:n.feeding_schedule||n.feedingInstructions||"",medicalNotes:n.medication_notes||n.medicalNotes||"",pottyBreakSchedule:n.potty_break_schedule||n.pottyBreakSchedule||"",specialCareInstructions:n.special_care_instructions||n.specialCareInstructions||"",vetName:n.vet_name||"",vetAddress:n.vet_address||"",vetPhone:n.vet_phone||"",insuranceProvider:n.insurance_provider||"",childrenFriendly:a(n.friendly_with_children),catFriendly:a(n.friendly_with_cats),dogFriendly:a(n.friendly_with_dogs),houseTrained:a(n.house_trained),spayedNeutered:a(n.spayed_neutered),microchipped:a(n.microchipped),canBeLeftAlone:a(n.can_be_left_alone),birthday:n.birthday?ke(n.birthday):null,adoptionDate:n.adoption_date?ke(n.adoption_date):null,photoUri:n.profile_photo?(0,p.getMediaUrl)(n.profile_photo):null,justCreated:!0,name:n.name||"Unnamed Pet",breed:n.breed||"",energyLevel:n.energy_level||""});(0,h.debugLog)("MBA5555","REPLACE PET - Formatted pet data:",{tempPetId:t,realPetId:r,name:i.name,type:i.type,breed:i.breed});const d=R[t]||{},c=Object.assign({},i,{name:d.name||i.name,breed:d.breed||i.breed,type:d.type||i.type,childrenFriendly:d.childrenFriendly||i.childrenFriendly,catFriendly:d.catFriendly||i.catFriendly,dogFriendly:d.dogFriendly||i.dogFriendly,houseTrained:d.houseTrained||i.houseTrained,spayedNeutered:d.spayedNeutered||i.spayedNeutered,microchipped:d.microchipped||i.microchipped,canBeLeftAlone:d.canBeLeftAlone||i.canBeLeftAlone,energyLevel:d.energyLevel||i.energyLevel,sex:d.sex||i.sex,weight:d.weight||i.weight,feedingInstructions:d.feedingInstructions||i.feedingInstructions,medicalNotes:d.medicalNotes||i.medicalNotes,pottyBreakSchedule:d.pottyBreakSchedule||i.pottyBreakSchedule,specialCareInstructions:d.specialCareInstructions||i.specialCareInstructions,medications:d.medications||i.medications,vetName:d.vetName||i.vetName,vetAddress:d.vetAddress||i.vetAddress,vetPhone:d.vetPhone||i.vetPhone,insuranceProvider:d.insuranceProvider||i.insuranceProvider,birthday:d.birthday||i.birthday,adoptionDate:d.adoptionDate||i.adoptionDate});D((e=>{const o=Object.assign({},e);return delete o[t],o}));try{const n=Array.isArray(e)?[...e]:[];if((0,h.debugLog)("MBAi39gh45v","REPLACE PET - Pets count before update:",n.length),c.id||c.pet_id||((0,h.debugLog)("MBAi39gh45v","REPLACE PET ERROR - Merged data has no valid ID:",c),c.id="generated_".concat(Date.now()),(0,h.debugLog)("MBAi39gh45v","REPLACE PET FIX - Generated new ID:",c.id)),l){(0,h.debugLog)("MBAi39gh45v","REPLACE PET - Calling onReplacePet:",{tempId:t,realId:c.id||c.pet_id,name:c.name});const o=[c,...e.filter((e=>e.id!==t))];l(o),setTimeout((()=>{(0,h.debugLog)("MBAi39gh45v","REPLACE PET - After onReplacePet, pets count:",Array.isArray(e)?e.length:"pets not an array")}),100)}else if((0,h.debugLog)("MBAi39gh45v","REPLACE PET WARNING - No onReplacePet handler provided by parent component"),s&&o){(0,h.debugLog)("MBAi39gh45v","REPLACE PET - Using fallback: delete temp pet and add real pet");const n=Object.assign({},c,{_addToTop:!0});o(n),t!==n.id&&s(t),setTimeout((()=>{(0,h.debugLog)("MBAi39gh45v","REPLACE PET - After fallback method, pets count:",Array.isArray(e)?e.length:"pets not an array")}),100)}else(0,h.debugLog)("MBAi39gh45v","REPLACE PET ERROR - No methods available to update pets list"),Y({message:"Unable to update pets list. Please refresh the page.",type:"error",duration:4e3})}catch(zs){if((0,h.debugLog)("MBAi39gh45v","REPLACE PET ERROR - Exception updating parent component:",zs),!Array.isArray(e)){(0,h.debugLog)("MBAi39gh45v","REPLACE PET CRITICAL ERROR - pets is not an array after replace:",e);const o=Array.isArray(e)?[...e]:[];if(Array.isArray(o)&&o.length>0){const e=[c,...o.filter((e=>e.id!==t))];(0,h.debugLog)("MBAi39gh45v","REPLACE PET FIX - Created restored pets array with length:",e.length)}}Y({message:"Pet saved but display may not be updated. Please refresh if needed.",type:"info",duration:4e3})}L((e=>{const o=new Set(e);return o.delete(t),o})),f((e=>{const o=new Set(e);return o.delete(t),o.add(r),o})),(0,h.debugLog)("MBA5555","REPLACE PET - Successfully replaced temp pet with real pet")}catch(zs){(0,h.debugLog)("MBA5555","REPLACE PET - Error replacing pet:",zs)}};return(0,j.jsxs)(X.default,{style:ko.container,children:[(()=>{if(!F.isVisible)return null;const e=["January","February","March","April","May","June","July","August","September","October","November","December"],t=(new Date).getFullYear(),o=Array.from({length:101},((e,o)=>t-o));return(0,j.jsx)(k.default,{visible:F.isVisible,transparent:!0,animationType:"fade",onRequestClose:()=>{W((e=>Object.assign({},e,{isVisible:!1}))),ne(!1),ae(!1)},children:(0,j.jsx)(v.default,{style:ko.modalOverlay,activeOpacity:1,onPress:()=>{ne(!1),ae(!1)},children:(0,j.jsxs)(r.default,{style:ko.calendarModalContent,children:[(0,j.jsxs)(r.default,{style:ko.calendarModalHeader,children:[(0,j.jsxs)(a.default,{style:ko.calendarModalTitle,children:["Select ","birthday"===F.currentField?"Birthday":"Adoption Date"]}),(0,j.jsx)(v.default,{onPress:()=>{W((e=>Object.assign({},e,{isVisible:!1}))),ne(!1),ae(!1)},style:ko.closeButton,children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,j.jsx)(r.default,{style:ko.calendarHeader,children:(0,j.jsxs)(r.default,{style:ko.dropdownContainer,children:[(0,j.jsxs)(v.default,{style:ko.dropdownButton,onPress:e=>{e.stopPropagation(),ne(!oe),ae(!1)},children:[(0,j.jsx)(a.default,{style:ko.dropdownButtonText,children:e[O]}),(0,j.jsx)(S.default,{name:oe?"chevron-up":"chevron-down",size:20,color:m.theme.colors.text})]}),(0,j.jsxs)(v.default,{style:ko.dropdownButton,onPress:e=>{e.stopPropagation(),ae(!re),ne(!1)},children:[(0,j.jsx)(a.default,{style:ko.dropdownButtonText,children:H}),(0,j.jsx)(S.default,{name:re?"chevron-up":"chevron-down",size:20,color:m.theme.colors.text})]})]})}),oe&&(0,j.jsx)(v.default,{style:ko.dropdownList,activeOpacity:1,onPress:e=>e.stopPropagation(),children:(0,j.jsx)(X.default,{style:ko.dropdownScrollView,children:e.map(((e,t)=>(0,j.jsx)(v.default,{style:[ko.dropdownItem,O===t&&ko.dropdownItemSelected],onPress:e=>{e.stopPropagation(),N(t),ne(!1)},children:(0,j.jsx)(a.default,{style:[ko.dropdownItemText,O===t&&ko.dropdownItemTextSelected],children:e})},e)))})}),re&&(0,j.jsx)(v.default,{style:ko.dropdownList,activeOpacity:1,onPress:e=>e.stopPropagation(),children:(0,j.jsx)(X.default,{style:ko.dropdownScrollView,children:o.map((e=>(0,j.jsx)(v.default,{style:[ko.dropdownItem,H===e&&ko.dropdownItemSelected],onPress:t=>{t.stopPropagation(),U(e),ae(!1)},children:(0,j.jsx)(a.default,{style:[ko.dropdownItemText,H===e&&ko.dropdownItemTextSelected],children:e})},e)))})}),(0,j.jsx)(v.default,{activeOpacity:1,onPress:e=>e.stopPropagation(),children:(0,j.jsx)(r.default,{style:ko.weekdayLabels,children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(((e,t)=>(0,j.jsx)(a.default,{style:ko.weekdayLabel,children:e},t)))})}),(0,j.jsx)(v.default,{activeOpacity:1,onPress:e=>e.stopPropagation(),children:(0,j.jsx)(r.default,{style:ko.calendarGrid,children:ze.map(((e,t)=>(0,j.jsx)(r.default,{style:ko.calendarRow,children:e.map(((e,t)=>(0,j.jsx)(v.default,{style:[ko.calendarDay,!e.isCurrentMonth&&ko.calendarDayOtherMonth,e.isSelectedDate&&ko.calendarDaySelected],onPress:t=>{var o;t.stopPropagation(),e.isCurrentMonth&&(o=e.date,ne(!1),ae(!1),W((e=>Object.assign({},e,{selectedDate:o}))))},disabled:!e.isCurrentMonth,children:(0,j.jsx)(a.default,{style:[ko.calendarDayText,!e.isCurrentMonth&&ko.calendarDayTextOtherMonth,e.isSelectedDate&&ko.calendarDayTextSelected],children:e.day})},t)))},t)))})}),(0,j.jsx)(v.default,{style:ko.confirmButton,onPress:e=>{e.stopPropagation(),((e,t)=>{if(t){const e=(e=>{if(!e)return"";const t=(e.getMonth()+1).toString().padStart(2,"0"),o=e.getDate().toString().padStart(2,"0"),n=e.getFullYear();return"".concat(t,"-").concat(o,"-").concat(n)})(t);Me(F.currentPetId,F.currentField,e)}W({isVisible:!1,currentField:null,currentPetId:null,selectedDate:null})})(0,F.selectedDate)},children:(0,j.jsx)(a.default,{style:ko.confirmButtonText,children:"Confirm"})})]})})})})(),(0,j.jsx)(I,{visible:Z.visible,onClose:()=>{ee({visible:!1,petId:null,petName:"",isDeleting:!1})},onConfirm:async()=>{try{const{petId:e,petName:t}=Z;ee((e=>Object.assign({},e,{isDeleting:!0}))),(0,h.debugLog)("MBA456","Attempting to delete pet with ID:",e),Y({message:"Deleting ".concat(t,"..."),type:"info",duration:4e3}),await(0,bt.deletePet)(e),(0,h.debugLog)("MBA456","Successfully deleted pet:",e),s(e),ee({visible:!1,petId:null,petName:"",isDeleting:!1}),Y({message:"".concat(t," has been successfully deleted."),type:"success",duration:4e3})}catch(zs){(0,h.debugLog)("MBA456","Error deleting pet:",zs),ee((e=>Object.assign({},e,{isDeleting:!1})));let t="There was a problem deleting the pet. Please try again or contact support.";zs.response&&zs.response.data&&zs.response.data.error&&(t=zs.response.data.error),Y({message:t,type:"error",duration:5e3})}},actionText:"delete ".concat(Z.petName),isLoading:Z.isDeleting}),(0,j.jsxs)(r.default,{style:[ko.section,{backgroundColor:m.theme.colors.surfaceContrast}],children:[(0,j.jsxs)(r.default,{style:ko.sectionHeader,children:[(0,j.jsx)(a.default,{style:ko.sectionTitle,children:"My Pets"}),(0,j.jsxs)(v.default,{style:ko.addButton,onPress:()=>{(0,h.debugLog)("MBAi39gh45v","ADD PET START - Current pets array:",Array.isArray(e)?e.map((e=>({id:e.id,name:e.name||"unnamed"}))):"pets is not an array");const t=Array.isArray(e)?e.filter((e=>e&&e.id&&String(e.id).startsWith("temp_"))):[];if((0,h.debugLog)("MBAi39gh45v","ADD PET - Existing temp pets:",t.length?t.map((e=>e.id)):"none"),t.length>0){(0,h.debugLog)("MBAi39gh45v","ADD PET - Found existing temp pet, not creating a new one");const e=t[0];return L((t=>{const o=new Set(t);return o.add(e.id),o})),f((t=>{const o=new Set(t);return o.add(e.id),o})),void(0,h.debugLog)("MBAi39gh45v","ADD PET - Focused on existing temp pet:",e.id)}const n="temp_".concat(Date.now());(0,h.debugLog)("MBAi39gh45v","ADD PET - Creating new pet with temp ID:",n);const r={id:n,name:"",breed:"",birthday:"",type:"",feedingInstructions:"",medicalNotes:"",pottyBreakSchedule:"",specialCareInstructions:"",childrenFriendly:void 0,dogFriendly:void 0,catFriendly:void 0,spayedNeutered:void 0,houseTrained:void 0,microchipped:void 0,energyLevel:void 0,canBeLeftAlone:void 0,medications:"",vetName:"",vetAddress:"",vetPhone:"",insuranceProvider:"",vetDocuments:[],sex:void 0,weight:"",adoptionDate:""};if((0,h.debugLog)("MBAi39gh45v","ADD PET - New pet object created:",{id:r.id}),L((e=>{const t=new Set(e);return t.add(n),t})),D((e=>Object.assign({},e,{[n]:Object.assign({},r)}))),f((e=>{const t=new Set(e);return t.add(n),t})),(0,h.debugLog)("MBAi39gh45v","ADD PET - Local state updated, now calling parent component"),!o)return(0,h.debugLog)("MBAi39gh45v","ADD PET ERROR - onAddPet function is not available"),void Y({message:"Unable to add pet - system error",type:"error",duration:4e3});try{(0,h.debugLog)("MBAi39gh45v","ADD PET - Calling onAddPet with new pet (adding to top of list)"),o(Object.assign({},r,{_addToTop:!0})),setTimeout((()=>{Array.isArray(e)?(0,h.debugLog)("MBAi39gh45v","ADD PET - Pets after adding:",e.length>0?e.map((e=>({id:e.id,name:e.name||"unnamed"}))):"empty array"):(0,h.debugLog)("MBAi39gh45v","ADD PET ERROR - Pets is not an array after adding")}),100)}catch(zs){(0,h.debugLog)("MBAi39gh45v","ADD PET ERROR - Exception when calling onAddPet:",zs),Y({message:"Error adding pet",type:"error",duration:4e3})}},children:[(0,j.jsx)(S.default,{name:"plus",size:20,color:m.theme.colors.background}),(0,j.jsx)(a.default,{style:ko.addButtonText,children:"Add Pet"})]})]}),(0,j.jsx)(r.default,{style:ko.petsList,children:Array.isArray(e)?e.length>0?e.map((e=>{const t=M.has(e.id),o=R[e.id]||{},n=e.id&&e.id.toString().startsWith("temp_"),i=g.has(e.id);let s=null;return t&&o.photoUri?(s=o.photoUri.startsWith("http")||o.photoUri.startsWith("data:")?o.photoUri:(0,p.getMediaUrl)(o.photoUri),(0,h.debugLog)("MBA5555","Using edited pet photo URI:",s)):e.profile_photo&&(s=e.profile_photo.startsWith("http")?e.profile_photo:(0,p.getMediaUrl)(e.profile_photo),(0,h.debugLog)("MBA5555","Using server profile photo:",s)),(0,j.jsxs)(r.default,{style:ko.petCard,children:[(0,j.jsxs)(v.default,{style:ko.petCardHeader,onPress:()=>Se(e.id),activeOpacity:.7,children:[(0,j.jsx)(r.default,{style:ko.petBasicInfo,children:t?(0,j.jsxs)(r.default,{style:ko.editMainContainer,children:[(0,j.jsxs)(r.default,{style:ko.editHeaderRow,children:[(0,j.jsx)(r.default,{style:ko.editProfileContainer,children:(0,j.jsxs)(v.default,{style:ko.profilePhotoButton,onPress:()=>(async e=>{try{(0,h.debugLog)("MBA5555","Opening image picker for pet:",e);const t=await Mt.launchImageLibraryAsync({mediaTypes:Lt.MediaTypeOptions.Images,allowsEditing:!1,quality:1,base64:!0,allowsMultipleSelection:!1});if(!t.canceled&&t.assets&&t.assets.length>0){const o=t.assets[0];(0,h.debugLog)("MBA5555","Selected pet photo:",{uri:o.uri.substring(0,30)+"...",type:o.type||"image/jpeg",width:o.width,height:o.height,hasBase64:!!o.base64}),se(o.uri),ue(e),de(!0)}}catch(zs){(0,h.debugLog)("MBA5555","Error selecting pet photo:",zs),Y({message:"Failed to select pet photo. Please try again.",type:"error",duration:4e3})}})(e.id),children:[o.photoUri?(0,j.jsx)(Q.default,{source:{uri:o.photoUri},style:ko.petPhoto}):s?(0,j.jsx)(Q.default,{source:{uri:s},style:ko.petPhoto}):(0,j.jsx)(S.default,{name:"paw",size:40,color:m.theme.colors.primary,style:ko.placeholderIcon}),(0,j.jsx)(r.default,{style:ko.plusIconContainer,children:(0,j.jsx)(S.default,{name:"plus-circle",size:20,color:m.theme.colors.primary})})]})}),(0,j.jsx)(r.default,{style:[ko.editActions,V<600&&ko.editActionsSmallScreen],children:V<600?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(r.default,{style:ko.buttonRowTop,children:[!n&&(0,j.jsx)(v.default,{style:ko.deleteButton,onPress:t=>{t.stopPropagation(),Te(e.id)},children:(0,j.jsx)(S.default,{name:"delete",size:20,color:m.theme.colors.error})}),(0,j.jsx)(v.default,{style:ko.saveButton,onPress:t=>{t.stopPropagation(),G?(0,h.debugLog)("MBA5555","Save button already clicked, ignoring"):((0,h.debugLog)("MBA5555","SAVE BUTTON - Clicked for pet:",e.id),Ae(e.id))},disabled:G,children:(0,j.jsx)(a.default,{style:ko.saveButtonText,children:n?"Create Pet":"Save Pet"})})]}),(0,j.jsxs)(r.default,{style:ko.buttonRowBottom,children:[(0,j.jsx)(v.default,{style:ko.editButton,onPress:t=>{t.stopPropagation(),_e(e.id)},children:(0,j.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.error})}),(0,j.jsx)(v.default,{style:ko.editButton,onPress:t=>{t.stopPropagation(),Se(e.id)},children:(0,j.jsx)(S.default,{name:i?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})})]})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(v.default,{style:ko.saveButton,onPress:t=>{t.stopPropagation(),G?(0,h.debugLog)("MBA5555","Save button already clicked, ignoring"):((0,h.debugLog)("MBA5555","SAVE BUTTON - Clicked for pet:",e.id),Ae(e.id))},disabled:G,children:(0,j.jsx)(a.default,{style:ko.saveButtonText,children:n?"Create Pet":"Save Pet"})}),!n&&(0,j.jsx)(v.default,{style:ko.deleteButton,onPress:t=>{t.stopPropagation(),Te(e.id)},children:(0,j.jsx)(S.default,{name:"delete",size:20,color:m.theme.colors.error})}),(0,j.jsx)(v.default,{style:ko.editButton,onPress:t=>{t.stopPropagation(),_e(e.id)},children:(0,j.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.error})}),(0,j.jsx)(v.default,{style:ko.editButton,onPress:t=>{t.stopPropagation(),Se(e.id)},children:(0,j.jsx)(S.default,{name:i?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})})]})})]}),(0,j.jsxs)(r.default,{style:ko.editDetailsContainer,children:[(0,j.jsxs)(r.default,{style:ko.detailRow,children:[(0,j.jsxs)(r.default,{style:ko.detailColumn,children:[(0,j.jsx)(a.default,{style:ko.inputLabel,children:"Name"}),(0,j.jsx)(te.default,{style:ko.editInput,value:o.name||"",onChangeText:t=>Me(e.id,"name",t),placeholder:"Enter pet name",placeholderTextColor:m.theme.colors.placeholder})]}),(0,j.jsxs)(r.default,{style:ko.detailColumn,children:[(0,j.jsx)(a.default,{style:ko.inputLabel,children:"Breed"}),(0,j.jsx)(te.default,{style:ko.editInput,value:o.breed||"",onChangeText:t=>Me(e.id,"breed",t),placeholder:"Ex: Golden Retriever",placeholderTextColor:m.theme.colors.placeholder})]})]}),V<900?(0,j.jsxs)(r.default,{style:ko.stackedFields,children:[(0,j.jsxs)(r.default,{style:[ko.detailColumn,ko.fullWidth],children:[(0,j.jsx)(a.default,{style:ko.inputLabel,children:"Animal Type"}),(0,j.jsx)(te.default,{style:ko.editInput,value:o.type||"",onChangeText:t=>Me(e.id,"type",t),placeholder:"Ex: Dog",placeholderTextColor:m.theme.colors.placeholder})]}),(0,j.jsxs)(r.default,{style:[ko.detailColumn,ko.fullWidth],children:[(0,j.jsx)(a.default,{style:ko.inputLabel,children:"Birthday"}),(0,j.jsxs)(r.default,{style:ko.customDatePickerContainer,children:[(0,j.jsx)(v.default,{activeOpacity:.8,style:ko.dateInputBox,onPress:()=>De(e.id,"birthday"),children:(0,j.jsx)(a.default,{style:[ko.dateInputText,!o.birthday&&ko.placeholderText],children:o.birthday||"MM-DD-YYYY"})}),(0,j.jsx)(v.default,{style:ko.calendarButton,onPress:()=>De(e.id,"birthday"),activeOpacity:.7,children:(0,j.jsx)(S.default,{name:"calendar",size:20,color:m.theme.colors.primary})})]})]})]}):(0,j.jsxs)(r.default,{style:ko.detailRow,children:[(0,j.jsxs)(r.default,{style:ko.detailColumn,children:[(0,j.jsx)(a.default,{style:ko.inputLabel,children:"Birthday"}),(0,j.jsxs)(r.default,{style:ko.customDatePickerContainer,children:[(0,j.jsx)(v.default,{activeOpacity:.8,style:ko.dateInputBox,onPress:()=>De(e.id,"birthday"),children:(0,j.jsx)(a.default,{style:[ko.dateInputText,!o.birthday&&ko.placeholderText],children:o.birthday||"MM-DD-YYYY"})}),(0,j.jsx)(v.default,{style:ko.calendarButton,onPress:()=>De(e.id,"birthday"),activeOpacity:.7,children:(0,j.jsx)(S.default,{name:"calendar",size:20,color:m.theme.colors.primary})})]})]}),(0,j.jsxs)(r.default,{style:ko.detailColumn,children:[(0,j.jsx)(a.default,{style:ko.inputLabel,children:"Animal Type"}),(0,j.jsx)(te.default,{style:ko.editInput,value:o.type||"",onChangeText:t=>Me(e.id,"type",t),placeholder:"Enter type - ex: Dog",placeholderTextColor:m.theme.colors.placeholder})]})]})]})]}):(0,j.jsxs)(j.Fragment,{children:[s?(0,j.jsx)(Q.default,{source:{uri:s},style:ko.petPhoto,onError:t=>{(0,h.debugLog)("MBA5555","Error loading pet photo:",t.nativeEvent.error),D((t=>Object.assign({},t,{[e.id]:Object.assign({},t[e.id]||{},{photoLoadError:!0})})))}}):(0,j.jsx)(S.default,{name:"paw",size:40,color:m.theme.colors.primary,style:ko.placeholderIcon}),(0,j.jsxs)(r.default,{style:[ko.petInfo,V<600&&ko.petInfoWithButtonPadding],children:[(0,j.jsx)(a.default,{style:ko.petName,children:e.name.toLowerCase().charAt(0).toUpperCase()+e.name.toLowerCase().slice(1)}),(0,j.jsx)(r.default,{style:ko.petDetailsContainer,children:(0,j.jsxs)(a.default,{style:ko.petDetails,children:[e.type?e.type.toLowerCase().charAt(0).toUpperCase()+e.type.toLowerCase().slice(1):"No type"," \u2022 ",e.birthday?Bo(e.birthday):"No age set"," \u2022 ",e.breed?e.breed.toLowerCase().charAt(0).toUpperCase()+e.breed.toLowerCase().slice(1):"No breed"]})})]})]})}),!t&&V<600?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(v.default,{style:[ko.editButton,ko.editButtonTopRight],onPress:()=>je(e.id),children:(0,j.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.primary})}),(0,j.jsx)(v.default,{style:[ko.editButton,ko.chevronButtonBottomRight],onPress:()=>Se(e.id),children:(0,j.jsx)(S.default,{name:i?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})})]}):t?null:(0,j.jsxs)(r.default,{style:ko.petActions,children:[(0,j.jsx)(v.default,{style:ko.editButton,onPress:()=>je(e.id),children:(0,j.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.primary})}),(0,j.jsx)(v.default,{style:ko.editButton,onPress:()=>Se(e.id),children:(0,j.jsx)(S.default,{name:i?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})})]})]}),i&&(0,j.jsxs)(r.default,{style:[ko.expandedDetails,{backgroundColor:m.theme.colors.surfaceContrast}],children:[(0,j.jsxs)(r.default,{style:ko.detailRow,children:[(0,j.jsxs)(r.default,{style:ko.detailColumn,children:[(0,j.jsx)(a.default,{style:ko.detailTitle,children:"Feeding Instructions"}),t?(0,j.jsx)(te.default,{style:ko.editInput,value:o.feedingInstructions||"",onChangeText:t=>Me(e.id,"feedingInstructions",t),placeholder:"Enter feeding instructions",placeholderTextColor:m.theme.colors.placeholder,multiline:!0}):(0,j.jsx)(a.default,{style:ko.detailText,children:e.feedingInstructions||"No feeding instructions yet"})]}),(0,j.jsxs)(r.default,{style:ko.detailColumn,children:[(0,j.jsx)(a.default,{style:ko.detailTitle,children:"Medical Notes"}),t?(0,j.jsx)(te.default,{style:ko.editInput,value:o.medicalNotes||"",onChangeText:t=>Me(e.id,"medicalNotes",t),placeholder:"Enter medical notes",placeholderTextColor:m.theme.colors.placeholder,multiline:!0}):(0,j.jsx)(a.default,{style:ko.detailText,children:e.medicalNotes||"No medical notes yet"})]})]}),(0,j.jsxs)(r.default,{style:ko.detailRow,children:[(0,j.jsxs)(r.default,{style:ko.detailColumn,children:[(0,j.jsx)(a.default,{style:ko.detailTitle,children:"Potty Break Schedule"}),t?(0,j.jsx)(te.default,{style:ko.editInput,value:o.pottyBreakSchedule||"",onChangeText:t=>Me(e.id,"pottyBreakSchedule",t),placeholder:"Potty break schedule",placeholderTextColor:m.theme.colors.placeholder,multiline:!0}):(0,j.jsx)(a.default,{style:ko.detailText,children:e.pottyBreakSchedule||"No potty break schedule yet"})]}),(0,j.jsxs)(r.default,{style:ko.detailColumn,children:[(0,j.jsx)(a.default,{style:ko.detailTitle,children:"Special Care Instructions"}),t?(0,j.jsx)(te.default,{style:ko.editInput,value:o.specialCareInstructions||"",onChangeText:t=>Me(e.id,"specialCareInstructions",t),placeholder:"Special care instructions",placeholderTextColor:m.theme.colors.placeholder,multiline:!0}):(0,j.jsx)(a.default,{style:ko.detailText,children:e.specialCareInstructions||"No special care instructions yet"})]})]}),(0,j.jsxs)(r.default,{style:ko.detailSection,children:[Re(e.id,"Care Information","careInfo"),Le(e.id,"careInfo")&&(0,j.jsx)(r.default,{style:ko.detailColumn,children:(0,j.jsxs)(r.default,{style:ko.careInfoContainer,children:[(0,j.jsxs)(r.default,{style:ko.compatibilityItem,children:[(0,j.jsx)(a.default,{style:ko.compatibilityLabel,children:"Energy level:"}),t?(0,j.jsx)(r.default,{style:ko.dropdownContainerEdit,children:xe.map((t=>(0,j.jsx)(v.default,{style:[ko.optionButton,null===o.energyLevel&&"N/A"===t||o.energyLevel===t?ko.selectedOption:null],onPress:()=>Me(e.id,"energyLevel","N/A"===t?null:t),children:(0,j.jsx)(a.default,{style:[ko.optionText,null===o.energyLevel&&"N/A"===t||o.energyLevel===t?ko.selectedOptionText:null],children:t||"None selected yet"})},t)))}):Ce(e)]}),(0,j.jsxs)(r.default,{style:ko.compatibilityItem,children:[(0,j.jsx)(a.default,{style:ko.compatibilityLabel,children:"Weight (lbs):"}),t?(0,j.jsx)(te.default,{style:ko.editInputWeight,value:o.weight||"",onChangeText:t=>{(/^(\d*\.?\d*)$/.test(t)||""===t)&&Me(e.id,"weight",t)},placeholder:"Enter weight",placeholderTextColor:m.theme.colors.placeholder,keyboardType:"numeric"}):(0,j.jsx)(a.default,{style:ko.vetInfoText,children:e.weight||"Not specified"})]}),(0,j.jsxs)(r.default,{style:ko.medicationsContainer,children:[(0,j.jsx)(a.default,{style:ko.compatibilityLabel,children:"Medications:"}),t?(0,j.jsx)(te.default,{style:ko.editInputMedications,value:o.medications||"",onChangeText:t=>Me(e.id,"medications",t),placeholder:"Enter medications",placeholderTextColor:m.theme.colors.placeholder,multiline:!0}):(0,j.jsx)(a.default,{style:ko.medicationsText,children:e.medications||"None"})]})]})})]}),(0,j.jsxs)(r.default,{style:ko.detailSection,children:[Re(e.id,"Compatibility & Training","compatibility"),Le(e.id,"compatibility")&&(0,j.jsx)(r.default,{style:ko.detailColumn,children:(0,j.jsxs)(r.default,{style:ko.compatibilityContainer,children:[(0,j.jsxs)(r.default,{style:ko.compatibilityItem,children:[(0,j.jsx)(a.default,{style:ko.compatibilityLabel,children:"Friendly with children:"}),t?(0,j.jsx)(r.default,{style:ko.dropdownContainerEdit,children:be.map((t=>(0,j.jsx)(v.default,{style:[ko.optionButton,null===o.childrenFriendly&&"N/A"===t||!0===o.childrenFriendly&&"Yes"===t||!1===o.childrenFriendly&&"No"===t||o.childrenFriendly===t?ko.selectedOption:null],onPress:()=>Me(e.id,"childrenFriendly","N/A"===t?null:t),children:(0,j.jsx)(a.default,{style:[ko.optionText,null===o.childrenFriendly&&"N/A"===t||!0===o.childrenFriendly&&"Yes"===t||!1===o.childrenFriendly&&"No"===t||o.childrenFriendly===t?ko.selectedOptionText:null],children:t})},t)))}):we(e,"childrenFriendly")]}),(0,j.jsxs)(r.default,{style:ko.compatibilityItem,children:[(0,j.jsx)(a.default,{style:ko.compatibilityLabel,children:"Friendly with cats:"}),t?(0,j.jsx)(r.default,{style:ko.dropdownContainerEdit,children:be.map((t=>(0,j.jsx)(v.default,{style:[ko.optionButton,null===o.catFriendly&&"N/A"===t||!0===o.catFriendly&&"Yes"===t||!1===o.catFriendly&&"No"===t||o.catFriendly===t?ko.selectedOption:null],onPress:()=>Me(e.id,"catFriendly","N/A"===t?null:t),children:(0,j.jsx)(a.default,{style:[ko.optionText,null===o.catFriendly&&"N/A"===t||!0===o.catFriendly&&"Yes"===t||!1===o.catFriendly&&"No"===t||o.catFriendly===t?ko.selectedOptionText:null],children:t})},t)))}):we(e,"catFriendly")]}),(0,j.jsxs)(r.default,{style:ko.compatibilityItem,children:[(0,j.jsx)(a.default,{style:ko.compatibilityLabel,children:"Friendly with dogs:"}),t?(0,j.jsx)(r.default,{style:ko.dropdownContainerEdit,children:be.map((t=>(0,j.jsx)(v.default,{style:[ko.optionButton,null===o.dogFriendly&&"N/A"===t||!0===o.dogFriendly&&"Yes"===t||!1===o.dogFriendly&&"No"===t||o.dogFriendly===t?ko.selectedOption:null],onPress:()=>Me(e.id,"dogFriendly","N/A"===t?null:t),children:(0,j.jsx)(a.default,{style:[ko.optionText,null===o.dogFriendly&&"N/A"===t||!0===o.dogFriendly&&"Yes"===t||!1===o.dogFriendly&&"No"===t||o.dogFriendly===t?ko.selectedOptionText:null],children:t})},t)))}):we(e,"dogFriendly")]}),(0,j.jsxs)(r.default,{style:ko.compatibilityItem,children:[(0,j.jsx)(a.default,{style:ko.compatibilityLabel,children:"Spayed/neutered:"}),t?(0,j.jsx)(r.default,{style:ko.dropdownContainerEdit,children:be.map((t=>(0,j.jsx)(v.default,{style:[ko.optionButton,null===o.spayedNeutered&&"N/A"===t||!0===o.spayedNeutered&&"Yes"===t||!1===o.spayedNeutered&&"No"===t||o.spayedNeutered===t?ko.selectedOption:null],onPress:()=>Me(e.id,"spayedNeutered","N/A"===t?null:t),children:(0,j.jsx)(a.default,{style:[ko.optionText,null===o.spayedNeutered&&"N/A"===t||!0===o.spayedNeutered&&"Yes"===t||!1===o.spayedNeutered&&"No"===t||o.spayedNeutered===t?ko.selectedOptionText:null],children:t})},t)))}):we(e,"spayedNeutered")]}),(0,j.jsxs)(r.default,{style:ko.compatibilityItem,children:[(0,j.jsx)(a.default,{style:ko.compatibilityLabel,children:"House trained:"}),t?(0,j.jsx)(r.default,{style:ko.dropdownContainerEdit,children:be.map((t=>(0,j.jsx)(v.default,{style:[ko.optionButton,null===o.houseTrained&&"N/A"===t||!0===o.houseTrained&&"Yes"===t||!1===o.houseTrained&&"No"===t||o.houseTrained===t?ko.selectedOption:null],onPress:()=>Me(e.id,"houseTrained","N/A"===t?null:t),children:(0,j.jsx)(a.default,{style:[ko.optionText,null===o.houseTrained&&"N/A"===t||!0===o.houseTrained&&"Yes"===t||!1===o.houseTrained&&"No"===t||o.houseTrained===t?ko.selectedOptionText:null],children:t})},t)))}):we(e,"houseTrained")]}),(0,j.jsxs)(r.default,{style:ko.compatibilityItem,children:[(0,j.jsx)(a.default,{style:ko.compatibilityLabel,children:"Microchipped:"}),t?(0,j.jsx)(r.default,{style:ko.dropdownContainerEdit,children:be.map((t=>(0,j.jsx)(v.default,{style:[ko.optionButton,null===o.microchipped&&"N/A"===t||!0===o.microchipped&&"Yes"===t||!1===o.microchipped&&"No"===t||o.microchipped===t?ko.selectedOption:null],onPress:()=>Me(e.id,"microchipped","N/A"===t?null:t),children:(0,j.jsx)(a.default,{style:[ko.optionText,null===o.microchipped&&"N/A"===t||!0===o.microchipped&&"Yes"===t||!1===o.microchipped&&"No"===t||o.microchipped===t?ko.selectedOptionText:null],children:t})},t)))}):we(e,"microchipped")]}),(0,j.jsxs)(r.default,{style:ko.compatibilityItem,children:[(0,j.jsx)(a.default,{style:ko.compatibilityLabel,children:"Can be left alone:"}),t?(0,j.jsx)(r.default,{style:ko.dropdownContainerEdit,children:be.map((t=>(0,j.jsx)(v.default,{style:[ko.optionButton,null===o.canBeLeftAlone&&"N/A"===t||!0===o.canBeLeftAlone&&"Yes"===t||!1===o.canBeLeftAlone&&"No"===t||o.canBeLeftAlone===t?ko.selectedOption:null],onPress:()=>Me(e.id,"canBeLeftAlone","N/A"===t?null:t),children:(0,j.jsx)(a.default,{style:[ko.optionText,null===o.canBeLeftAlone&&"N/A"===t||!0===o.canBeLeftAlone&&"Yes"===t||!1===o.canBeLeftAlone&&"No"===t||o.canBeLeftAlone===t?ko.selectedOptionText:null],children:t})},t)))}):we(e,"canBeLeftAlone")]})]})})]}),(0,j.jsxs)(r.default,{style:ko.detailSection,children:[Re(e.id,"Vet Information","vetInfo"),Le(e.id,"vetInfo")&&(0,j.jsx)(r.default,{style:ko.detailColumn,children:(0,j.jsxs)(r.default,{style:ko.vetInfoContainer,children:[(0,j.jsxs)(r.default,{style:ko.vetInfoItem,children:[(0,j.jsx)(a.default,{style:ko.vetInfoLabel,children:"Vet name:"}),t?(0,j.jsx)(te.default,{style:ko.editInputShort,value:o.vetName||"",onChangeText:t=>Me(e.id,"vetName",t),placeholder:"Enter vet name",placeholderTextColor:m.theme.colors.placeholder}):(0,j.jsx)(a.default,{style:ko.vetInfoText,children:e.vetName||"None"})]}),(0,j.jsxs)(r.default,{style:ko.vetInfoItem,children:[(0,j.jsx)(a.default,{style:ko.vetInfoLabel,children:"Vet address:"}),t?(0,j.jsx)(te.default,{style:ko.editInputShort,value:o.vetAddress||"",onChangeText:t=>Me(e.id,"vetAddress",t),placeholder:"Enter vet address",placeholderTextColor:m.theme.colors.placeholder}):(0,j.jsx)(a.default,{style:ko.vetInfoText,children:e.vetAddress||"None"})]}),(0,j.jsxs)(r.default,{style:ko.vetInfoItem,children:[(0,j.jsx)(a.default,{style:ko.vetInfoLabel,children:"Vet phone:"}),t?(0,j.jsx)(te.default,{style:ko.editInputShort,value:o.vetPhone||"",onChangeText:t=>Me(e.id,"vetPhone",t),placeholder:"Enter vet phone",placeholderTextColor:m.theme.colors.placeholder,keyboardType:"phone-pad",maxLength:12}):(0,j.jsx)(a.default,{style:ko.vetInfoText,children:e.vetPhone||"None"})]}),(0,j.jsxs)(r.default,{style:ko.vetInfoItem,children:[(0,j.jsx)(a.default,{style:ko.vetInfoLabel,children:"Insurance provider:"}),t?(0,j.jsx)(te.default,{style:ko.editInputShort,value:o.insuranceProvider||"",onChangeText:t=>Me(e.id,"insuranceProvider",t),placeholder:"Enter insurance provider",placeholderTextColor:m.theme.colors.placeholder}):(0,j.jsx)(a.default,{style:ko.vetInfoText,children:e.insuranceProvider||"Not specified"})]}),(0,j.jsxs)(r.default,{style:ko.vetInfoItem,children:[(0,j.jsx)(a.default,{style:ko.vetInfoLabel,children:"Sex:"}),t?(0,j.jsx)(r.default,{style:ko.dropdownContainerEdit,children:ve.map((t=>(0,j.jsx)(v.default,{style:[ko.optionButton,o.sex===t?ko.selectedOption:null],onPress:()=>Me(e.id,"sex",t),children:(0,j.jsx)(a.default,{style:[ko.optionText,o.sex===t?ko.selectedOptionText:null],children:t})},t)))}):(0,j.jsx)(a.default,{style:ko.vetInfoText,children:e.sex||"None Selected"})]}),(0,j.jsxs)(r.default,{style:ko.vetInfoItem,children:[(0,j.jsx)(a.default,{style:ko.vetInfoLabel,children:"Adoption Date:"}),t?(0,j.jsxs)(r.default,{style:ko.customDatePickerContainer,children:[(0,j.jsx)(v.default,{activeOpacity:.8,style:ko.dateInputBox,onPress:()=>De(e.id,"adoptionDate"),children:(0,j.jsx)(a.default,{style:[ko.dateInputText,!o.adoptionDate&&ko.placeholderText],children:o.adoptionDate||"MM-DD-YYYY"})}),(0,j.jsx)(v.default,{style:ko.calendarButton,onPress:()=>De(e.id,"adoptionDate"),activeOpacity:.7,children:(0,j.jsx)(S.default,{name:"calendar",size:20,color:m.theme.colors.primary})})]}):(0,j.jsx)(a.default,{style:ko.vetInfoText,children:e.adoptionDate||"Not specified"})]})]})})]})]})]},e.id)})):(0,j.jsx)(r.default,{style:ko.emptyStateContainer,children:(0,j.jsx)(a.default,{style:ko.emptyStateText,children:"No pets found. Add a pet using the button above."})}):(0,j.jsx)(r.default,{style:ko.emptyStateContainer,children:(0,j.jsx)(a.default,{style:ko.emptyStateText,children:"Error: Unable to display pets"})})})]}),(0,j.jsx)(so,{visible:le,imageUri:ie,onClose:()=>{de(!1),se(null),ue(null)},onSave:async(e,t)=>{try{me(!0),(0,h.debugLog)("MBA5555","Processing cropped pet image with params:",t);const o=await lo(e,t);let n=e;o.base64Data&&(n=o.base64Data),D((e=>{const t=e[ce]||{};return Object.assign({},e,{[ce]:Object.assign({},t,{photo:o,photoUri:n})})})),Y({message:"Pet photo updated. It will be saved when you save the pet.",type:"success",duration:4e3})}catch(zs){(0,h.debugLog)("MBA5555","Error processing pet photo:",zs),Y({message:"Failed to process pet photo. Please try again.",type:"error",duration:4e3})}finally{me(!1),de(!1),se(null),ue(null)}},isUploading:ge})]})},_o={"America/New_York":"Eastern Time","America/Detroit":"Eastern Time","America/Indiana/Indianapolis":"Eastern Time","America/Indiana/Marengo":"Eastern Time","America/Indiana/Vincennes":"Eastern Time","America/Indiana/Tell_City":"Eastern Time","America/Indiana/Petersburg":"Eastern Time","America/Indiana/Vevay":"Eastern Time","America/Indiana/Winamac":"Eastern Time","America/Kentucky/Louisville":"Eastern Time","America/Kentucky/Monticello":"Eastern Time","America/Chicago":"Central Time","America/Indiana/Knox":"Central Time","America/Menominee":"Central Time","America/North_Dakota/Center":"Central Time","America/North_Dakota/New_Salem":"Central Time","America/North_Dakota/Beulah":"Central Time","America/Denver":"Mountain Time","America/Boise":"Mountain Time","America/Phoenix":"Mountain Time (No DST)","America/Los_Angeles":"Pacific Time","America/Anchorage":"Alaska Time","America/Juneau":"Alaska Time","America/Sitka":"Alaska Time","America/Metlakatla":"Alaska Time","America/Yakutat":"Alaska Time","America/Nome":"Alaska Time","Pacific/Honolulu":"Hawaii Time","America/Adak":"Hawaii-Aleutian Time",UTC:"UTC"},Io=[{id:"America/New_York",displayName:"Eastern Time",searchTerms:["eastern","est","edt","new york","florida","georgia","virginia","north carolina","south carolina","tennessee","kentucky","ohio","pennsylvania","new jersey","connecticut","rhode island","massachusetts","vermont","new hampshire","maine","delaware","maryland","west virginia","washington dc","michigan","indiana"],zone:"Eastern"},{id:"America/Chicago",displayName:"Central Time",searchTerms:["central","cst","cdt","texas","illinois","alabama","arkansas","iowa","kansas","louisiana","minnesota","mississippi","missouri","nebraska","north dakota","oklahoma","south dakota","wisconsin","chicago"],zone:"Central"},{id:"America/Denver",displayName:"Mountain Time",searchTerms:["mountain","mst","mdt","colorado","montana","utah","wyoming","new mexico","idaho","denver"],zone:"Mountain"},{id:"America/Phoenix",displayName:"Mountain Time (No DST)",searchTerms:["arizona","phoenix","mountain no dst","mst arizona"],zone:"Mountain"},{id:"America/Los_Angeles",displayName:"Pacific Time",searchTerms:["pacific","pst","pdt","california","washington","oregon","nevada","los angeles","san francisco","seattle","portland"],zone:"Pacific"},{id:"America/Anchorage",displayName:"Alaska Time",searchTerms:["alaska","akst","akdt","anchorage","juneau","fairbanks"],zone:"Alaska"},{id:"Pacific/Honolulu",displayName:"Hawaii Time",searchTerms:["hawaii","hst","honolulu","maui","big island","kauai","oahu"],zone:"Hawaii"},{id:"UTC",displayName:"UTC",searchTerms:["utc","coordinated universal time","gmt","greenwich"],zone:"UTC"}],Mo=e=>_o[e]||e,Lo=i.default.create({safeArea:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center"},container:{flex:1,backgroundColor:m.theme.colors.background,margin:0,borderRadius:12,overflow:"hidden"},desktopContainer:{maxWidth:800,maxHeight:"90%",alignSelf:"center"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",padding:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,backgroundColor:m.theme.colors.surface},lastUpdated:{fontSize:14,color:m.theme.colors.textSecondary,fontFamily:m.theme.fonts.regular.fontFamily,marginTop:2},version:{fontSize:12,color:m.theme.colors.primary,fontFamily:m.theme.fonts.regular.fontFamily,marginTop:2},title:{fontSize:20,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},closeButton:{padding:8},scrollContainer:{flex:1},scrollContent:{padding:16,paddingBottom:32},section:{marginBottom:24},sectionHeader:{fontSize:18,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily,marginBottom:8},sectionBody:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,lineHeight:24},subsection:{marginTop:12,marginLeft:8},subsectionTitle:{fontSize:16,fontWeight:"bold",color:m.theme.colors.primary,fontFamily:m.theme.fonts.header.fontFamily,marginBottom:4},subsectionBody:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,lineHeight:24},footerContainer:{flexDirection:"row",justifyContent:"center",padding:16,borderTopWidth:1,borderTopColor:m.theme.colors.border,backgroundColor:m.theme.colors.surface},button:{paddingVertical:12,paddingHorizontal:32,borderRadius:8,alignItems:"center",justifyContent:"center"},closeFooterButton:{backgroundColor:m.theme.colors.primary},buttonText:{color:"white",fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily}}),Ro=({visible:e,onClose:t,termsData:o})=>{const{screenWidth:i}=(0,n.useContext)(h.AuthContext),s=i>768,l=o||ye.terms;return(0,j.jsx)(k.default,{visible:e,transparent:!0,animationType:"slide",onRequestClose:t,children:(0,j.jsx)(He.default,{style:Lo.safeArea,children:(0,j.jsxs)(r.default,{style:[Lo.container,s?Lo.desktopContainer:{}],children:[(0,j.jsxs)(r.default,{style:Lo.header,children:[(0,j.jsxs)(r.default,{children:[(0,j.jsx)(a.default,{style:Lo.title,children:"Terms of Service"}),(0,j.jsxs)(a.default,{style:Lo.lastUpdated,children:["Last Updated: ",ye.lastUpdated]}),(0,j.jsxs)(a.default,{style:Lo.version,children:["Version ",ye.version]})]}),(0,j.jsx)(v.default,{style:Lo.closeButton,onPress:t,children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,j.jsx)(X.default,{style:Lo.scrollContainer,contentContainerStyle:Lo.scrollContent,children:l.map(((e,t)=>(e=>(0,j.jsxs)(r.default,{style:Lo.section,children:[(0,j.jsx)(a.default,{style:Lo.sectionHeader,children:e.header}),e.body&&(0,j.jsx)(a.default,{style:Lo.sectionBody,children:e.body}),e.subsections&&e.subsections.map(((e,t)=>(0,j.jsxs)(r.default,{style:Lo.subsection,children:[(0,j.jsx)(a.default,{style:Lo.subsectionTitle,children:e.subtitle}),(0,j.jsx)(a.default,{style:Lo.subsectionBody,children:e.body})]},t)))]},e.header))(e)))}),(0,j.jsx)(r.default,{style:Lo.footerContainer,children:(0,j.jsx)(v.default,{style:[Lo.button,Lo.closeFooterButton],onPress:t,children:(0,j.jsx)(a.default,{style:Lo.buttonText,children:"Close"})})})]})})})},Do=i.default.create({safeArea:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center"},container:{flex:1,backgroundColor:m.theme.colors.background,margin:0,borderRadius:12,overflow:"hidden"},desktopContainer:{maxWidth:800,maxHeight:"90%",alignSelf:"center"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",padding:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,backgroundColor:m.theme.colors.surface},title:{fontSize:20,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},lastUpdated:{fontSize:14,color:m.theme.colors.textSecondary,fontFamily:m.theme.fonts.regular.fontFamily,marginTop:2},version:{fontSize:12,color:m.theme.colors.primary,fontFamily:m.theme.fonts.regular.fontFamily,marginTop:2},closeButton:{padding:8},scrollContainer:{flex:1},scrollContent:{padding:16,paddingBottom:32},introduction:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,lineHeight:24,marginBottom:24},section:{marginBottom:24},sectionHeader:{fontSize:18,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily,marginBottom:8},sectionBody:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,lineHeight:24,marginBottom:8},listItem:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,lineHeight:24,marginBottom:4,marginLeft:8},subsection:{marginTop:12,marginLeft:8},subsectionTitle:{fontSize:16,fontWeight:"bold",color:m.theme.colors.primary,fontFamily:m.theme.fonts.header.fontFamily,marginBottom:4},subsectionContent:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,lineHeight:24,marginBottom:8},additionalInfo:{fontSize:14,color:m.theme.colors.textSecondary,fontFamily:m.theme.fonts.regular.fontFamily,lineHeight:20,marginTop:8,fontStyle:"italic"},contactInfo:{marginTop:12,padding:12,backgroundColor:m.theme.colors.surfaceSecondary,borderRadius:8},contactText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,lineHeight:20},footerContainer:{flexDirection:"row",justifyContent:"center",padding:16,borderTopWidth:1,borderTopColor:m.theme.colors.border,backgroundColor:m.theme.colors.surface},button:{paddingVertical:12,paddingHorizontal:32,borderRadius:8,alignItems:"center",justifyContent:"center"},closeFooterButton:{backgroundColor:m.theme.colors.primary},buttonText:{color:"white",fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily}}),zo=({visible:e,onClose:t,privacyData:o})=>{const{screenWidth:i}=(0,n.useContext)(h.AuthContext),s=i>768,l=o||be,d=e=>(0,j.jsxs)(r.default,{style:Do.section,children:[(0,j.jsx)(a.default,{style:Do.sectionHeader,children:e.title}),e.content&&(0,j.jsx)(a.default,{style:Do.sectionBody,children:e.content}),e.listItems&&e.listItems.map(((e,t)=>(0,j.jsxs)(a.default,{style:Do.listItem,children:["\u2022 ",e]},t))),e.subsections&&e.subsections.map(((e,t)=>(e=>(0,j.jsxs)(r.default,{style:Do.subsection,children:[(0,j.jsx)(a.default,{style:Do.subsectionTitle,children:e.subtitle}),e.content&&(0,j.jsx)(a.default,{style:Do.subsectionContent,children:e.content}),e.items&&e.items.map(((e,t)=>(0,j.jsxs)(a.default,{style:Do.listItem,children:["\u2022 ",e]},t)))]},e.subtitle))(e))),e.additionalInfo&&(0,j.jsx)(a.default,{style:Do.additionalInfo,children:e.additionalInfo}),e.contactInfo&&(0,j.jsxs)(r.default,{style:Do.contactInfo,children:[(0,j.jsx)(a.default,{style:Do.contactText,children:e.contactInfo.company}),(0,j.jsx)(a.default,{style:Do.contactText,children:e.contactInfo.attention}),(0,j.jsx)(a.default,{style:Do.contactText,children:e.contactInfo.address}),(0,j.jsx)(a.default,{style:Do.contactText,children:e.contactInfo.email})]})]},e.title);return(0,j.jsx)(k.default,{visible:e,transparent:!0,animationType:"slide",onRequestClose:t,children:(0,j.jsx)(He.default,{style:Do.safeArea,children:(0,j.jsxs)(r.default,{style:[Do.container,s?Do.desktopContainer:{}],children:[(0,j.jsxs)(r.default,{style:Do.header,children:[(0,j.jsxs)(r.default,{children:[(0,j.jsx)(a.default,{style:Do.title,children:l.title}),(0,j.jsxs)(a.default,{style:Do.lastUpdated,children:["Last Updated: ",l.lastUpdated]}),(0,j.jsxs)(a.default,{style:Do.version,children:["Version ",l.version]})]}),(0,j.jsx)(v.default,{style:Do.closeButton,onPress:t,children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,j.jsx)(X.default,{style:Do.scrollContainer,contentContainerStyle:Do.scrollContent,children:(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(a.default,{style:Do.introduction,children:l.introduction}),l.sections.map(((e,t)=>d(e)))]})}),(0,j.jsx)(r.default,{style:Do.footerContainer,children:(0,j.jsx)(v.default,{style:[Do.button,Do.closeFooterButton],onPress:t,children:(0,j.jsx)(a.default,{style:Do.buttonText,children:"Close"})})})]})})})},Po=i.default.create({desktopContainer:{flexDirection:"row",gap:24},leftColumn:{flex:1,gap:24},rightColumn:{width:"35%",minWidth:300,gap:24},mobileContainer:{flex:1},section:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:10,padding:20,marginBottom:15},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:15},sectionTitle:{fontSize:18,fontWeight:"bold",color:m.theme.colors.text,marginBottom:15},plansScroll:{marginHorizontal:-20},plansScrollContent:{paddingHorizontal:20,paddingBottom:16},planCardContainer:{width:280,marginRight:16,paddingBottom:4},planCard:{backgroundColor:m.theme.colors.surface,borderRadius:10,padding:20,position:"relative",marginTop:12,height:"100%",borderWidth:0},currentPlanBorder:{borderWidth:2,borderColor:m.theme.colors.primary},popularPlan:{},popularTag:{position:"absolute",top:-12,right:20,backgroundColor:m.theme.colors.primary,paddingHorizontal:12,paddingVertical:4,borderRadius:12,zIndex:2},popularTagText:{color:m.theme.colors.surfaceContrast,fontWeight:"600",fontSize:12},planTitle:{fontSize:20,fontWeight:"bold",marginBottom:10},planPrice:{fontSize:24,fontWeight:"600",color:m.theme.colors.primary,marginBottom:5},planDescription:{color:m.theme.colors.secondary,marginBottom:15},featuresList:{gap:10,marginBottom:20},featureItem:{flexDirection:"row",alignItems:"center",gap:10},featureText:{color:m.theme.colors.text},planButton:{backgroundColor:m.theme.colors.primary,padding:12,borderRadius:8,alignItems:"center",marginTop:"auto",marginBottom:0},currentPlanButton:{backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.primary},planButtonText:{color:m.theme.colors.surfaceContrast,fontWeight:"600"},currentPlanButtonText:{color:m.theme.colors.primary},settingItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.placeHolderText},settingContent:{flexDirection:"row",alignItems:"center",flex:1},settingTextContainer:{marginLeft:15,flex:1},settingTitle:{fontSize:16,fontWeight:"500"},settingDescription:{fontSize:14,color:m.theme.colors.secondary,marginTop:2},actionButton:{backgroundColor:m.theme.colors.surface,paddingHorizontal:12,paddingVertical:6,borderRadius:6},actionButtonText:{color:m.theme.colors.primary,fontWeight:"500"},currentPlanInfo:{backgroundColor:m.theme.colors.surface,padding:15,borderRadius:8},currentPlanTitle:{fontSize:20,fontWeight:"600",marginBottom:5},currentPlanBilling:{color:m.theme.colors.secondary,marginBottom:15},usageStats:{gap:8},usageText:{fontSize:14,color:m.theme.colors.text},usageBar:{height:8,backgroundColor:m.theme.colors.background,borderRadius:4},usageProgress:{height:"100%",backgroundColor:m.theme.colors.primary,borderRadius:4},paymentItem:{flexDirection:"row",alignItems:"flex-start",justifyContent:"space-between",padding:12,backgroundColor:m.theme.colors.surface,borderRadius:8,marginBottom:10},paymentContent:{flexDirection:"row",alignItems:"flex-start",flex:1,marginRight:12},paymentTextContainer:{marginLeft:15,flex:1},paymentTitleRow:{flexDirection:"row",alignItems:"center",flexWrap:"wrap",gap:8},paymentTitle:{fontSize:16,fontWeight:"500"},paymentDescription:{fontSize:14,color:m.theme.colors.secondary,marginTop:2},setDefaultButton:{paddingHorizontal:8,paddingVertical:2,borderRadius:4},setDefaultText:{color:m.theme.colors.primary,fontSize:14,fontWeight:"500"},deleteButton:{padding:4},addButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.primary,padding:8,borderRadius:5},addButtonText:{color:m.theme.colors.surfaceContrast,marginLeft:5,fontWeight:"500"},viewAllButton:{padding:12,borderRadius:8,backgroundColor:m.theme.colors.surface,alignItems:"center"},viewAllText:{color:m.theme.colors.primary,fontWeight:"500"},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:m.theme.colors.background,borderRadius:10,width:"90%",maxWidth:500,maxHeight:"80%",padding:20},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:15,paddingBottom:10,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},modalTitle:{fontSize:18,fontWeight:"bold",color:m.theme.colors.text},timezoneItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:12,paddingHorizontal:15,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},selectedTimezoneItem:{backgroundColor:m.theme.colors.primaryLight},timezoneText:{fontSize:16,color:m.theme.colors.text},selectedTimezoneText:{fontWeight:"bold",color:m.theme.colors.primary},timezoneButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surface,paddingHorizontal:12,paddingVertical:6,borderRadius:6},timezoneButtonText:{color:m.theme.colors.primary,fontWeight:"500",marginRight:5},searchInput:{backgroundColor:m.theme.colors.surface,padding:12,borderRadius:8,marginBottom:15,fontSize:16,color:m.theme.colors.text,borderWidth:1,borderColor:m.theme.colors.border},timezoneGroup:{marginBottom:20},timezoneGroupHeader:{fontSize:16,fontWeight:"bold",color:m.theme.colors.primary,marginBottom:10,paddingHorizontal:10},timezoneItemContent:{flex:1},timezoneId:{fontSize:12,color:m.theme.colors.secondary,marginTop:2},noPaymentMethodsContainer:{padding:20,alignItems:"center",backgroundColor:m.theme.colors.surface,borderRadius:8},noPaymentMethodsText:{color:m.theme.colors.secondary,fontSize:16},deleteButton:{backgroundColor:m.theme.colors.error},deleteButtonText:{color:"white",fontWeight:"500"},cancelButton:{backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.primary},cancelButtonText:{color:m.theme.colors.primary,fontWeight:"500"},expiryText:{fontSize:12,color:m.theme.colors.error,marginTop:4,fontStyle:"italic"},deleteModalContent:{backgroundColor:m.theme.colors.background,borderRadius:15,width:"90%",maxWidth:500,maxHeight:"90%",overflow:"hidden",flexDirection:"column"},deleteModalHeader:{alignItems:"center",padding:24,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,backgroundColor:"#fff5f5"},deleteModalTitle:{fontSize:24,fontWeight:"bold",color:m.theme.colors.error,marginTop:12,textAlign:"center"},deleteModalWarning:{fontSize:14,color:m.theme.colors.error,marginTop:4,textAlign:"center",fontWeight:"600"},deleteModalBody:{padding:24,flex:1},deleteModalDescription:{fontSize:16,color:m.theme.colors.text,marginBottom:16,lineHeight:22},deleteInfoList:{marginBottom:20},deleteInfoItem:{fontSize:14,color:m.theme.colors.text,marginBottom:8,lineHeight:20},retentionWarning:{backgroundColor:"#fff3cd",borderRadius:8,padding:12,borderWidth:1,borderColor:"#ffeaa7"},retentionWarningText:{fontSize:12,color:"#856404",lineHeight:18},deleteModalFooter:{flexDirection:"row",justifyContent:"space-between",padding:24,borderTopWidth:1,borderTopColor:m.theme.colors.border,gap:12},button:{paddingVertical:12,paddingHorizontal:24,borderRadius:8,alignItems:"center",justifyContent:"center",minHeight:44},cancelModalButton:{flex:1,backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border},cancelModalButtonText:{color:m.theme.colors.text,fontWeight:"500",fontSize:16},confirmDeleteButton:{flex:1,backgroundColor:m.theme.colors.error},confirmDeleteButtonText:{color:"white",fontWeight:"bold",fontSize:16},reasonContainer:{marginTop:20},reasonLabel:{fontSize:14,fontWeight:"600",color:m.theme.colors.text,marginBottom:8},reasonInput:{backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,padding:12,fontSize:14,color:m.theme.colors.text,minHeight:80,maxHeight:120},reasonCounter:{fontSize:12,color:m.theme.colors.secondary,textAlign:"right",marginTop:4},modalErrorContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#ffebee",padding:12,marginHorizontal:24,borderRadius:8,borderWidth:1,borderColor:"#ffcdd2",gap:8},modalErrorText:{flex:1,fontSize:14,color:m.theme.colors.error,lineHeight:18}}),Fo=({push_notifications:e,email_updates:t,marketing_communications:o,profile_visibility:i,timezone:s,use_military_time:l,onUpdateSetting:d,paymentMethods:c,onAddPaymentMethod:u,onRemovePaymentMethod:g,onSetDefaultPayment:f,isMobile:y,currentPlan:b={id:"waitlist",title:"Waitlist Signup",nextBilling:"N/A",connections:{used:0,total:"Unlimited"}},onSwitchPlan:w,userRole:C,isApprovedProfessional:T,navigation:B})=>{const[A,_]=(0,n.useState)(s||"UTC"),[I,M]=(0,n.useState)(!1),[L,R]=(0,n.useState)([]),[D,z]=(0,n.useState)(""),[P,F]=(0,n.useState)(!1),[W,O]=(0,n.useState)(!1),[N,H]=(0,n.useState)(!1),[U,V]=(0,n.useState)(!1),[q,Y]=(0,n.useState)(null),[G,J]=(0,n.useState)(""),[$,K]=(0,n.useState)(""),Z=E();(0,n.useEffect)((()=>{s?_(s):(async()=>{try{F(!0);const e=await(0,bt.getTimeSettings)();_(e.timezone),(0,h.debugLog)("MBA12345 Fetched time settings:",e)}catch(zs){(0,h.debugLog)("MBA12345 Error fetching time settings:",zs)}finally{F(!1)}})();(async()=>{try{const e=await x.default.get("".concat(p.API_BASE_URL,"/api/users/v1/deletion-status/"));Y(e.data)}catch(zs){(0,h.debugLog)("MBA12345 Error fetching deletion status:",zs)}})()}),[s]),(0,n.useEffect)((()=>{(0,h.debugLog)("MBA54321 SettingsPaymentsTab received paymentMethods:",c)}),[c]);const Q=()=>{R(Io),z(""),M(!0)},ee=()=>Mo(A),oe=()=>(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(r.default,{style:Po.settingItem,children:[(0,j.jsxs)(r.default,{style:Po.settingContent,children:[(0,j.jsx)(S.default,{name:"email",size:24,color:m.theme.colors.primary}),(0,j.jsxs)(r.default,{style:Po.settingTextContainer,children:[(0,j.jsx)(a.default,{style:Po.settingTitle,children:"Email Updates"}),(0,j.jsx)(a.default,{style:Po.settingDescription,children:"Receive important updates via email"})]})]}),(0,j.jsx)(st.default,{value:t,onValueChange:e=>ae("email_updates",e),trackColor:{false:m.theme.colors.disabled,true:m.theme.colors.primary}})]}),(0,j.jsxs)(r.default,{style:Po.settingItem,children:[(0,j.jsxs)(r.default,{style:Po.settingContent,children:[(0,j.jsx)(S.default,{name:"bell-outline",size:24,color:m.theme.colors.primary}),(0,j.jsxs)(r.default,{style:Po.settingTextContainer,children:[(0,j.jsx)(a.default,{style:Po.settingTitle,children:"Marketing Communications"}),(0,j.jsx)(a.default,{style:Po.settingDescription,children:"Receive promotions and marketing emails"})]})]}),(0,j.jsx)(st.default,{value:o,onValueChange:e=>ae("marketing_communications",e),trackColor:{false:m.theme.colors.disabled,true:m.theme.colors.primary}})]})]}),ne=()=>(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(r.default,{style:Po.settingItem,children:[(0,j.jsxs)(r.default,{style:Po.settingContent,children:[(0,j.jsx)(S.default,{name:"account-eye",size:24,color:m.theme.colors.primary}),(0,j.jsxs)(r.default,{style:Po.settingTextContainer,children:[(0,j.jsx)(a.default,{style:Po.settingTitle,children:"Profile Visibility"}),(0,j.jsx)(a.default,{style:Po.settingDescription,children:"Make your profile visible to others"})]})]}),(0,j.jsx)(st.default,{value:i,onValueChange:e=>ae("profile_visibility",e),trackColor:{false:m.theme.colors.disabled,true:m.theme.colors.primary}})]}),(0,j.jsxs)(r.default,{style:Po.settingItem,children:[(0,j.jsxs)(r.default,{style:Po.settingContent,children:[(0,j.jsx)(S.default,{name:"lock-reset",size:24,color:m.theme.colors.primary}),(0,j.jsxs)(r.default,{style:Po.settingTextContainer,children:[(0,j.jsx)(a.default,{style:Po.settingTitle,children:"Change Password"}),(0,j.jsx)(a.default,{style:Po.settingDescription,children:"Update your account password"})]})]}),(0,j.jsx)(v.default,{style:Po.actionButton,onPress:()=>B.navigate("ChangePassword"),children:(0,j.jsx)(a.default,{style:Po.actionButtonText,children:"Change"})})]})]}),re=()=>(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(r.default,{style:Po.settingItem,children:[(0,j.jsxs)(r.default,{style:Po.settingContent,children:[(0,j.jsx)(S.default,{name:"shield-account",size:24,color:m.theme.colors.primary}),(0,j.jsxs)(r.default,{style:Po.settingTextContainer,children:[(0,j.jsx)(a.default,{style:Po.settingTitle,children:"Privacy Policy"}),(0,j.jsx)(a.default,{style:Po.settingDescription,children:"Read our privacy policy and data practices"})]})]}),(0,j.jsx)(v.default,{style:Po.actionButton,onPress:()=>H(!0),children:(0,j.jsx)(a.default,{style:Po.actionButtonText,children:"View"})})]}),(0,j.jsxs)(r.default,{style:Po.settingItem,children:[(0,j.jsxs)(r.default,{style:Po.settingContent,children:[(0,j.jsx)(S.default,{name:"file-document",size:24,color:m.theme.colors.primary}),(0,j.jsxs)(r.default,{style:Po.settingTextContainer,children:[(0,j.jsx)(a.default,{style:Po.settingTitle,children:"Terms of Service"}),(0,j.jsx)(a.default,{style:Po.settingDescription,children:"Read our terms of service and user agreement"})]})]}),(0,j.jsx)(v.default,{style:Po.actionButton,onPress:()=>O(!0),children:(0,j.jsx)(a.default,{style:Po.actionButtonText,children:"View"})})]}),(0,j.jsxs)(r.default,{style:Po.settingItem,children:[(0,j.jsxs)(r.default,{style:Po.settingContent,children:[(0,j.jsx)(S.default,{name:"account-remove",size:24,color:m.theme.colors.error}),(0,j.jsxs)(r.default,{style:Po.settingTextContainer,children:[(0,j.jsx)(a.default,{style:Po.settingTitle,children:"Delete Account"}),(0,j.jsx)(a.default,{style:Po.settingDescription,children:q?.is_deletion_requested?"Account deletion requested. Check your email to confirm.":"Permanently delete your account and all associated data"}),q?.is_deletion_requested&&(0,j.jsxs)(a.default,{style:Po.expiryText,children:["Request expires: ",new Date(q.deletion_token_expires_at).toLocaleDateString()]})]})]}),q?.is_deletion_requested?(0,j.jsx)(v.default,{style:[Po.actionButton,Po.cancelButton],onPress:ie,disabled:P,children:(0,j.jsx)(a.default,{style:Po.cancelButtonText,children:"Cancel Request"})}):(0,j.jsx)(v.default,{style:[Po.actionButton,Po.deleteButton],onPress:()=>V(!0),disabled:P,children:(0,j.jsx)(a.default,{style:Po.deleteButtonText,children:"Delete"})})]})]}),ae=(e,t)=>{(0,h.debugLog)("MBA54321 Updating setting:",{id:e,value:t});const o={push_notifications:"Push Notifications",email_updates:"Email Updates",marketing_communications:"Marketing Communications",profile_visibility:"Profile Visibility",use_military_time:"Military Time"}[e]||e;d(e,t).then((()=>{Z({message:"".concat(o," ").concat(t?"enabled":"disabled"," successfully"),type:"success",duration:3e3})})).catch((e=>{(0,h.debugLog)("MBA54321 Error updating setting:",e),Z({message:"Failed to update ".concat(o.toLowerCase(),". Please try again."),type:"error",duration:4e3})}))},ie=async()=>{try{F(!0),await x.default.post("".concat(p.API_BASE_URL,"/api/users/v1/cancel-deletion/")),Y(Object.assign({},q,{is_deletion_requested:!1,deletion_requested_at:null,deletion_token_expires_at:null})),Z({message:"Account deletion request cancelled successfully.",type:"success",duration:3e3})}catch(zs){(0,h.debugLog)("MBA12345 Error cancelling account deletion:",zs),Z({message:"Failed to cancel account deletion. Please contact support.",type:"error",duration:4e3})}finally{F(!1)}};return(0,j.jsxs)(r.default,{style:Po.container,children:[y?(0,j.jsxs)(X.default,{style:Po.mobileContainer,contentContainerStyle:{paddingBottom:100},children:[(0,j.jsxs)(r.default,{style:Po.section,children:[(0,j.jsx)(a.default,{style:Po.sectionTitle,children:"Notification Settings"}),oe()]}),(0,j.jsxs)(r.default,{style:Po.section,children:[(0,j.jsx)(a.default,{style:Po.sectionTitle,children:"Privacy & Security Settings"}),ne()]}),(0,j.jsxs)(r.default,{style:Po.section,children:[(0,j.jsx)(a.default,{style:Po.sectionTitle,children:"Legal"}),re()]}),(0,j.jsxs)(r.default,{style:Po.section,children:[(0,j.jsx)(a.default,{style:Po.sectionTitle,children:"Time Settings"}),(0,j.jsxs)(r.default,{style:Po.settingItem,children:[(0,j.jsxs)(r.default,{style:Po.settingContent,children:[(0,j.jsx)(S.default,{name:"clock-outline",size:24,color:m.theme.colors.primary}),(0,j.jsxs)(r.default,{style:Po.settingTextContainer,children:[(0,j.jsx)(a.default,{style:Po.settingTitle,children:"Timezone"}),(0,j.jsx)(a.default,{style:Po.settingDescription,children:"Set your local timezone for accurate time display"})]})]}),(0,j.jsxs)(v.default,{style:Po.timezoneButton,onPress:Q,children:[(0,j.jsx)(a.default,{style:Po.timezoneButtonText,children:ee()}),(0,j.jsx)(S.default,{name:"chevron-down",size:20,color:m.theme.colors.primary})]})]})]})]}):(0,j.jsx)(r.default,{style:Po.desktopContainer,children:(0,j.jsxs)(r.default,{style:Po.leftColumn,children:[(0,j.jsxs)(r.default,{style:Po.section,children:[(0,j.jsx)(a.default,{style:Po.sectionTitle,children:"Notification Preferences"}),oe()]}),(0,j.jsxs)(r.default,{style:Po.section,children:[(0,j.jsx)(a.default,{style:Po.sectionTitle,children:"Privacy & Security Settings"}),ne()]}),(0,j.jsxs)(r.default,{style:Po.section,children:[(0,j.jsx)(a.default,{style:Po.sectionTitle,children:"Legal"}),re()]}),(0,j.jsxs)(r.default,{style:Po.section,children:[(0,j.jsx)(a.default,{style:Po.sectionTitle,children:"Time Settings"}),(0,j.jsxs)(r.default,{style:Po.settingItem,children:[(0,j.jsxs)(r.default,{style:Po.settingContent,children:[(0,j.jsx)(S.default,{name:"clock-outline",size:24,color:m.theme.colors.primary}),(0,j.jsxs)(r.default,{style:Po.settingTextContainer,children:[(0,j.jsx)(a.default,{style:Po.settingTitle,children:"Timezone"}),(0,j.jsx)(a.default,{style:Po.settingDescription,children:"Set your local timezone for accurate time display"})]})]}),(0,j.jsxs)(v.default,{style:Po.timezoneButton,onPress:Q,children:[(0,j.jsx)(a.default,{style:Po.timezoneButtonText,children:ee()}),(0,j.jsx)(S.default,{name:"chevron-down",size:20,color:m.theme.colors.primary})]})]})]})]})}),(()=>{const e=((e=Io)=>e.reduce(((e,t)=>{const o=t.zone;return e[o]||(e[o]=[]),e[o].push(t),e}),{}))((e=>{if(!e)return Io;const t=e.toLowerCase();return Io.filter((e=>e.displayName.toLowerCase().includes(t)||e.searchTerms.some((e=>e.includes(t)))))})(D)),t=(e,t)=>(0,j.jsxs)(r.default,{style:Po.timezoneGroup,children:[(0,j.jsxs)(a.default,{style:Po.timezoneGroupHeader,children:[e," Time Zone"]}),t.map((e=>(0,j.jsxs)(v.default,{style:[Po.timezoneItem,e.id===A&&Po.selectedTimezoneItem],onPress:()=>(async e=>{try{F(!0),await(0,bt.updateTimeSettings)(e),_(e),M(!1),z(""),(0,h.debugLog)("MBA12345 Updated timezone to:",e);const t=Mo(e);Z({message:"Timezone updated to ".concat(t),type:"success",duration:3e3})}catch(zs){(0,h.debugLog)("MBA12345 Error updating timezone:",zs),Z({message:"Failed to update timezone. Please try again.",type:"error",duration:4e3})}finally{F(!1)}})(e.id),children:[(0,j.jsx)(r.default,{style:Po.timezoneItemContent,children:(0,j.jsx)(a.default,{style:[Po.timezoneText,e.id===A&&Po.selectedTimezoneText],children:e.displayName})}),e.id===A&&(0,j.jsx)(S.default,{name:"check",size:20,color:m.theme.colors.primary})]},e.id)))]},e);return(0,j.jsx)(k.default,{animationType:"slide",transparent:!0,visible:I,onRequestClose:()=>{M(!1),z("")},children:(0,j.jsx)(r.default,{style:Po.modalOverlay,children:(0,j.jsxs)(r.default,{style:Po.modalContent,children:[(0,j.jsxs)(r.default,{style:Po.modalHeader,children:[(0,j.jsx)(a.default,{style:Po.modalTitle,children:"Select Timezone"}),(0,j.jsx)(v.default,{onPress:()=>{M(!1),z("")},children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,j.jsx)(te.default,{style:Po.searchInput,placeholder:"Search timezones (e.g., 'Texas', 'Central Time', 'Mountain')...",value:D,onChangeText:e=>{(0,h.debugLog)("MBA7777","Timezone search input change:",e);const t=Ke(e,"service_name",{maxLength:50});z(t)},placeholderTextColor:m.theme.colors.secondary}),(0,j.jsx)(Yt.default,{data:Object.keys(e),keyExtractor:e=>e,renderItem:({item:o})=>t(o,e[o]),showsVerticalScrollIndicator:!0,initialNumToRender:20,maxToRenderPerBatch:20,windowSize:10})]})})})})(),(0,j.jsx)(Ro,{visible:W,onClose:()=>O(!1)}),(0,j.jsx)(zo,{visible:N,onClose:()=>H(!1)}),(0,j.jsx)(k.default,{animationType:"slide",transparent:!0,visible:U,onRequestClose:()=>{V(!1),J(""),K("")},children:(0,j.jsx)(r.default,{style:Po.modalOverlay,children:(0,j.jsxs)(r.default,{style:Po.deleteModalContent,children:[(0,j.jsxs)(r.default,{style:Po.deleteModalHeader,children:[(0,j.jsx)(S.default,{name:"alert-circle",size:48,color:m.theme.colors.error}),(0,j.jsx)(a.default,{style:Po.deleteModalTitle,children:"Delete Account"}),(0,j.jsx)(a.default,{style:Po.deleteModalWarning,children:"This action cannot be undone"})]}),(0,j.jsxs)(X.default,{style:Po.deleteModalBody,showsVerticalScrollIndicator:!1,children:[(0,j.jsx)(a.default,{style:Po.deleteModalDescription,children:"Are you sure you want to delete your account? This will:"}),(0,j.jsxs)(r.default,{style:Po.deleteInfoList,children:[(0,j.jsx)(a.default,{style:Po.deleteInfoItem,children:"\u2022 Remove your profile and personal information"}),(0,j.jsx)(a.default,{style:Po.deleteInfoItem,children:"\u2022 Cancel all future bookings (other parties will be notified)"}),(0,j.jsx)(a.default,{style:Po.deleteInfoItem,children:"\u2022 Anonymize your name in existing conversations"}),(0,j.jsx)(a.default,{style:Po.deleteInfoItem,children:"\u2022 Process deletion within 60 days"})]}),(0,j.jsx)(r.default,{style:Po.retentionWarning,children:(0,j.jsx)(a.default,{style:Po.retentionWarningText,children:"Some data may be retained for legal compliance (financial records, booking history) as outlined in our Terms of Service."})}),(0,j.jsxs)(r.default,{style:Po.reasonContainer,children:[(0,j.jsx)(a.default,{style:Po.reasonLabel,children:"Reason for deletion (required):"}),(0,j.jsx)(te.default,{style:Po.reasonInput,placeholder:"Please tell us why you're deleting your account...",placeholderTextColor:m.theme.colors.secondary,value:G,onChangeText:e=>{const t=Ke(e,"general",{maxLength:500});J(t)},multiline:!0,numberOfLines:3,textAlignVertical:"top"}),(0,j.jsxs)(a.default,{style:Po.reasonCounter,children:[G.length,"/500 characters"]})]})]}),$&&(0,j.jsxs)(r.default,{style:Po.modalErrorContainer,children:[(0,j.jsx)(S.default,{name:"alert-circle",size:20,color:m.theme.colors.error}),(0,j.jsx)(a.default,{style:Po.modalErrorText,children:$})]}),(0,j.jsxs)(r.default,{style:Po.deleteModalFooter,children:[(0,j.jsx)(v.default,{style:[Po.button,Po.cancelModalButton],onPress:()=>{V(!1),J(""),K("")},children:(0,j.jsx)(a.default,{style:Po.cancelModalButtonText,children:"Cancel"})}),(0,j.jsx)(v.default,{style:[Po.button,Po.confirmDeleteButton],onPress:async()=>{if(K(""),G.trim())try{F(!0);const e=await x.default.post("".concat(p.API_BASE_URL,"/api/users/v1/request-deletion/"),{reason:G.trim()});Y(Object.assign({},q,{is_deletion_requested:!0,deletion_requested_at:(new Date).toISOString(),deletion_token_expires_at:e.data.expires_at})),V(!1),J(""),K(""),Z({message:"Account deletion request submitted. Please check your email to confirm.",type:"success",duration:5e3})}catch(zs){if((0,h.debugLog)("MBA12345 Error requesting account deletion:",zs),zs.response?.data?.active_bookings){const t=zs.response.data.active_bookings.map((e=>"".concat(e.service," with ").concat(e.other_party," (").concat("client"===e.role?"professional":"client",")"))).join(", ");K("Cannot delete account. You have active bookings: ".concat(t,". Please wait for them to complete."))}else if(zs.response?.data?.incomplete_bookings){const t=zs.response.data.incomplete_bookings.map((e=>"Booking ID: ".concat(e.booking_id," (").concat(e.service," with ").concat(e.other_party,")"))).join(", ");K("Cannot delete account. You have incomplete past bookings that need to be marked as complete: ".concat(t,". Please mark all past bookings as completed before deleting your account."))}else K(zs.response?.data?.error||"Failed to request account deletion. Please try again.")}finally{F(!1)}else K("Please provide a reason for deleting your account.")},disabled:P,children:(0,j.jsx)(a.default,{style:Po.confirmDeleteButtonText,children:P?"Processing...":"Delete My Account"})})]})]})})})]})},Eo=(i.default.create({container:{flexDirection:"row",backgroundColor:m.theme.colors.surface,borderRadius:8,padding:8,marginBottom:16},mobileContainer:{padding:4,marginBottom:10},tab:{flex:1,paddingVertical:12,paddingHorizontal:20,alignItems:"center",justifyContent:"center",borderRadius:6,marginHorizontal:4},mobileTab:{flex:0,minWidth:150,paddingVertical:8,paddingHorizontal:16},activeTab:{backgroundColor:m.theme.colors.primary},tabText:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,fontFamily:m.theme.fonts?.regular?.fontFamily},mobileTabText:{fontSize:14},activeTabText:{color:m.theme.colors.whiteText||m.theme.colors.background}}),["_addToTop"]),Wo=(e,t)=>i.default.create({mainContainer:{flex:1,backgroundColor:m.theme.colors.surface,height:"100vh",overflow:"hidden",position:"fixed",top:0,left:0,right:0,bottom:0,marginLeft:e>900?t?70:250:0,transition:"margin-left 0.3s ease"},container:{flex:1,backgroundColor:m.theme.colors.surface},content:{flex:1,height:"100%",overflow:"auto",backgroundColor:m.theme.colors.surface},mainContent:{flex:1,width:"100%",alignSelf:"center",backgroundColor:m.theme.colors.surface},headerSection:{width:"100%",backgroundColor:m.theme.colors.surfaceContrast,paddingHorizontal:24,paddingTop:24,zIndex:2},title:{fontSize:32,fontWeight:"600",color:m.theme.colors.text,marginBottom:24,fontFamily:m.theme.fonts.header.fontFamily},tabScrollContainer:{flexGrow:0},tabContainer:{flexDirection:"row",gap:e<=900?22:32,paddingRight:e<=900?16:0},tab:{paddingBottom:8,borderBottomWidth:2,borderBottomColor:"transparent"},activeTab:{borderBottomColor:m.theme.colors.primary},tabText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},activeTabText:{color:m.theme.colors.primary,fontWeight:"500"},tabContent:{flex:1,padding:e<=900?10:24,backgroundColor:m.theme.colors.surface},errorText:{color:"red",textAlign:"center",marginTop:20}}),Oo=()=>{(0,h.debugLog)("MBA3ou4bg54ug: MyProfile component rendering/mounting");const e=(0,b.useNavigation)(),{width:t}=(0,Ne.default)(),{screenWidth:i,isCollapsed:s,is_DEBUG:l,userRole:d,isApprovedProfessional:c,user:u,logout:g}=(0,n.useContext)(h.AuthContext),[m,f]=(0,n.useState)(i<=900),[p,y]=(0,n.useState)(i>=1200),x=Wo(i,s),[w,C]=(0,n.useState)("profile_info"),[S,T]=(0,n.useState)(!1),k=(0,n.useRef)(0),_=(0,n.useRef)(!1),I=(0,n.useRef)(!0),[L,R]=(0,n.useState)(null),[D,z]=(0,n.useState)(!0),[P,F]=(0,n.useState)(null),[E,W]=(0,n.useState)({}),[O,N]=(0,n.useState)({id:"waitlist",title:"Waitlist Signup",nextBilling:"N/A",connections:{used:0,total:"Unlimited"}}),{isVisible:H,currentStep:U,totalSteps:V,stepData:q,handleNext:Y,handlePrevious:G,handleSkip:J,completeTutorial:$}=(0,n.useContext)(M);(0,n.useEffect)((()=>()=>{(0,h.debugLog)("MBA3ou4bg54ug: MyProfile component unmounting"),I.current=!1}),[]);const K=(0,n.useCallback)((async()=>{try{{const e=new URLSearchParams(window.location.search),t=e.get("initialTab")||e.get("screen");if(t&&["profile_info","pets_preferences","settings_payments","services_availability"].includes(t))return(0,h.debugLog)("MBA3ou4bg54ug: Retrieved tab from URL params",{tabFromUrl:t}),C(t),void await(0,h.setStorage)("MyProfileActiveTab",t)}const t=e.getState().routes.find((e=>"MyProfile"===e.name))?.params;if((0,h.debugLog)("MBA3ou4bg54ug: Navigation params",t),t?.initialTab)return(0,h.debugLog)("MBA3ou4bg54ug: Received initialTab param",{initialTab:t.initialTab}),C(t.initialTab),void await(0,h.setStorage)("MyProfileActiveTab",t.initialTab);if(t?.screen)return(0,h.debugLog)("MBA3ou4bg54ug: Received screen param",{screen:t.screen}),C(t.screen),void await(0,h.setStorage)("MyProfileActiveTab",t.screen);if(q?.tab)return(0,h.debugLog)("MBA3ou4bg54ug: Received tab from stepData",{tab:q.tab}),C(q.tab),void await(0,h.setStorage)("MyProfileActiveTab",q.tab);const o=await(0,h.getStorage)("MyProfileActiveTab");o&&((0,h.debugLog)("MBA3ou4bg54ug: Loaded tab from storage",{storedTab:o}),C(o))}catch(P){(0,h.debugLog)("MBA3ou4bg54ug: Error loading active tab",P)}}),[e,q]),Z=(0,n.useCallback)((async e=>{if(e&&0!==e.length)try{const n=e.filter((e=>e.lastUpdateFailed||e.ownerMissing));if(n.length>0){(0,h.debugLog)("MBA3ou4bg54ug: Found pets with potential missing owners:",n.length);for(const e of n)try{const{fixPetOwner:t}=o(50294);await t(e.id),(0,h.debugLog)("MBA3ou4bg54ug: Fixed pet owner successfully:",e.id)}catch(t){(0,h.debugLog)("MBA3ou4bg54ug: Failed to fix pet owner:",t)}}}catch(P){(0,h.debugLog)("MBA3ou4bg54ug: Error checking/fixing pet owners:",P)}}),[]),Q=(0,n.useCallback)((async()=>{if(_.current)return void(0,h.debugLog)("MBA3ou4bg54ug: Profile data load already in progress, skipping");const e=Date.now()-k.current;if(L&&e<5e3)(0,h.debugLog)("MBA3ou4bg54ug: Profile data loaded recently, skipping reload",{timeSinceLastLoad:Math.round(e/1e3)+"s"});else try{_.current=!0,I.current&&z(!0),I.current&&F(null),(0,h.debugLog)("MBA3ou4bg54ug: Starting profile data load");const e=await(0,bt.userProfile)();if(!e||"object"!==typeof e)throw new Error("Invalid response format from API");(0,h.debugLog)("MBA3ou4bg54ug: Profile data loaded successfully");const t=Object.assign({},e,{profilePhoto:e.profile_photo||null});I.current&&(R(t),z(!1)),k.current=Date.now(),await Z(e.pets),I.current&&setTimeout((()=>{K()}),100)}catch(P){(0,h.debugLog)("MBA3ou4bg54ug: Failed to load profile data:",P),I.current&&(L||F("Failed to load profile data"),z(!1))}finally{_.current=!1}}),[Z,K]);(0,n.useEffect)((()=>{(0,h.debugLog)("MBA3ou4bg54ug: Initial profile data load"),Q(),K()}),[]),(0,n.useEffect)((()=>e.addListener("focus",(()=>{const e=Date.now()-k.current;!L||e>6e4?((0,h.debugLog)("MBA3ou4bg54ug: Focus event - reloading profile data",{timeSinceLastLoad:Math.round(e/1e3)+"s"}),Q()):(0,h.debugLog)("MBA3ou4bg54ug: Focus event - using existing profile data",{timeSinceLastLoad:Math.round(e/1e3)+"s"})}))),[e,Q]),(0,n.useEffect)((()=>{w&&(async()=>{try{await(0,h.setStorage)("MyProfileActiveTab",w);{const e=new URL(window.location.href);e.searchParams.set("initialTab",w),window.history.replaceState({},"",e.toString())}(0,h.debugLog)("MBA3ou4bg54ug: Stored active tab",{activeTab:w})}catch(P){(0,h.debugLog)("MBA3ou4bg54ug: Error storing active tab",P)}})()}),[w]),(0,n.useEffect)((()=>{const t=e.addListener("state",(()=>{try{const t=e.getState().routes.find((e=>"MyProfile"===e.name))?.params;t?.screen?((0,h.debugLog)("MBA3ou4bg54ug: State change - setting active tab",{screen:t.screen}),C(t.screen)):t?.initialTab&&((0,h.debugLog)("MBA3ou4bg54ug: State change - setting active tab",{initialTab:t.initialTab}),C(t.initialTab))}catch(P){(0,h.debugLog)("MBA3ou4bg54ug: Error handling navigation state change",P)}}));return t}),[e]),(0,n.useEffect)((()=>{f(i<=900),y(i>=1200)}),[i]);const ee=[{id:"profile_info",label:"professional"===d?"Professional Profile Info":"Owner Profile Info"},{id:"pets_preferences",label:"My Pets"},{id:"settings_payments",label:"Settings"}],te=async()=>null,oe=e=>{(0,h.debugLog)("MBA3ou4bg54ug: Save completed with updated profile"),R((t=>{const o=Object.assign({},t,e);return e.profile_photo?(o.profilePhoto=e.profile_photo,o.profile_photo=e.profile_photo):e.profilePhoto&&(o.profile_photo=e.profilePhoto,o.profilePhoto=e.profilePhoto),o})),T(!1),W({}),k.current=Date.now()},ne=(e,t)=>{(0,h.debugLog)("MBA3ou4bg54ug: Updating field locally:",e),R((o=>Object.assign({},o,{[e]:t}))),T(!0)},re=e=>{W((t=>Object.assign({},t,{[e]:!t[e]})))},ae=e=>{(0,h.debugLog)("MBA3ou4bg54ug: Switching to plan:",e)};return D&&!L?(0,j.jsx)(r.default,{style:x.container,children:(0,j.jsx)(A.default,{size:"large",color:"#0000ff"})}):P&&!L?(0,j.jsx)(r.default,{style:x.container,children:(0,j.jsx)(a.default,{style:x.errorText,children:P})}):(0,j.jsx)(r.default,{style:x.mainContainer,children:(0,j.jsxs)(He.default,{style:x.container,children:[(0,j.jsx)(r.default,{style:x.content,children:(0,j.jsxs)(r.default,{style:x.mainContent,children:[(0,j.jsxs)(r.default,{style:[x.headerSection,{paddingTop:m?64:24}],children:[(0,j.jsx)(a.default,{style:x.title,children:"Profile Settings"}),(0,j.jsx)(X.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:x.tabScrollContainer,children:(0,j.jsx)(r.default,{style:x.tabContainer,children:ee.map((e=>(0,j.jsx)(v.default,{style:[x.tab,w===e.id&&x.activeTab],onPress:()=>{if(w!==e.id){(0,h.debugLog)("MBA3ou4bg54ug: Tab clicked - changing to",{tab:e.id}),C(e.id);{const t=new URL(window.location.href);t.searchParams.set("initialTab",e.id),window.history.replaceState({},"",t.toString())}}},children:(0,j.jsx)(a.default,{style:[x.tabText,w===e.id&&x.activeTabText],children:e.label})},e.id)))})})]}),(0,j.jsx)(r.default,{style:x.tabContent,children:(()=>{switch((0,h.debugLog)("MBA3ou4bg54ug: Rendering active tab",{activeTab:w}),w){case"profile_info":return(0,j.jsx)(wo,{profilePhoto:L?.profilePhoto,email:L?.email,phone:L?.phone,age:L?.age,address:L?.address,city:L?.city,state:L?.state,zip:L?.zip,country:L?.country,coordinates:L?.coordinates,bio:L?.bio,about_me:L?.about_me,name:L?.name,emergencyContact:L?.emergency_contact,authorizedHouseholdMembers:L?.authorized_household_members,editMode:E,toggleEditMode:re,onChangeText:ne,pickImage:te,setHasUnsavedChanges:e=>{(0,h.debugLog)("MBA9876","ProfileInfoTab setting hasUnsavedChanges:",e),T(e)},onSaveComplete:oe,isMobile:m,client_reviews:L?.client_reviews,professional_reviews:L?.professional_reviews,client_rating:L?.client_rating,professional_rating:L?.professional_rating,client_review_count:L?.client_review_count,professional_review_count:L?.professional_review_count,role:d,isProfessional:"professional"===d,insurance:L?.insurance,onNavigateToTab:C,navigation:e});case"services_availability":return(0,j.jsx)(To,{services:L?.services,onToggleService:e=>{const t=L?.services.map((t=>t.id===e?Object.assign({},t,{isActive:!t.isActive}):t));ne("services",t)},onEditHours:()=>{},onBlockService:()=>{},onPartialDayBlock:()=>{},isMobile:m});case"pets_preferences":return(0,j.jsx)(Ao,{pets:L?.pets,onAddPet:e=>{const t=e._addToTop,o=(0,Oe.default)(e,Eo),n=t?[o,...L?.pets||[]]:[...L?.pets||[],o];ne("pets",n),(0,h.debugLog)("MBA5432","Added new pet locally:",o,t?"(at top of list)":"(at bottom of list)")},onEditPet:(e,t)=>{const o=(L?.pets||[]).map((o=>o.id===e?Object.assign({},o,t):o));ne("pets",o),(0,h.debugLog)("MBA5432","Updated pet locally:",{petId:e,updatedPetData:t})},onDeletePet:e=>{const t=(L?.pets||[]).filter((t=>t.id!==e));ne("pets",t),(0,h.debugLog)("MBA5432","Deleted pet locally:",e)},onReplacePet:e=>{ne("pets",e),(0,h.debugLog)("MBA5432","Replaced entire pets array:",e)},preferences:L?.preferences,onUpdatePreferences:(e,t)=>{const o=Object.assign({},L?.preferences);"homeEnvironment"===e?o[e].includes(t)?o[e]=o[e].filter((e=>e!==t)):o[e]=[...o[e],t]:o[e]=o[e].map((e=>e.id===t?Object.assign({},e,{selected:!e.selected}):e)),ne("preferences",o)},userRole:d,isMobile:m});case"settings_payments":return(0,h.debugLog)("MBA54321 Rendering settings_payments tab with payment methods:",{paymentMethods:L?.payment_methods}),(0,j.jsx)(Fo,Object.assign({},L,{navigation:e,isMobile:m,onUpdateSetting:(e,t)=>{(0,h.debugLog)("Updating setting:",{id:e,value:t});const o={[e]:t};return(0,bt.updateProfileInfo)(o).then((e=>(R((t=>Object.assign({},t,e))),(0,h.debugLog)("MBA54321 Setting updated successfully:",o),e)))},paymentMethods:L?.payment_methods||[],onAddPaymentMethod:()=>e.navigate("AddPaymentMethod"),onRemovePaymentMethod:e=>{(0,h.debugLog)("Removing payment method:",e)},onSetDefaultPayment:e=>{(0,h.debugLog)("Setting default payment method:",e)},currentPlan:L?.currentPlan||O,onSwitchPlan:ae,userRole:d,isApprovedProfessional:c}));default:return null}})()})]})}),H&&"MyProfile"===q?.screen&&(0,j.jsx)(B,{step:U,totalSteps:V,title:q.title,description:q.description,position:q.position,onNext:Y,onPrevious:G,onSkip:J,onClose:$})]})})};function No({title:e,onPress:t}){return(0,j.jsx)(v.default,{style:Ho.button,onPress:t,children:(0,j.jsx)(a.default,{style:Ho.buttonText,children:e})})}const Ho=i.default.create({button:{backgroundColor:m.theme.colors.primary,paddingVertical:m.theme.spacing.small,paddingHorizontal:m.theme.spacing.medium,borderRadius:5,alignItems:"center",marginVertical:m.theme.spacing.small},buttonText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.medium}}),{width:Uo}=C.default.get("window");const Vo=i.default.create({container:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:m.theme.colors.background,padding:m.theme.spacing.medium},card:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,padding:1.5*m.theme.spacing.large,width:"100%",maxWidth:480,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},title:{fontSize:1.4*m.theme.fontSizes.extraLarge,fontWeight:"bold",color:m.theme.colors.text,marginBottom:m.theme.spacing.medium,textAlign:"left"},createAccountContainer:{flexDirection:"row",marginBottom:m.theme.spacing.large},createAccountText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginRight:5},createAccountLink:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.primary,textDecorationLine:"underline"},inputLabelContainer:{marginBottom:m.theme.spacing.medium},inputLabel:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginBottom:m.theme.spacing.small,fontWeight:"500"},passwordLabelContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:m.theme.spacing.small},showHideText:{color:m.theme.colors.primary,fontSize:m.theme.fontSizes.smallMedium},input:{height:48,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,paddingHorizontal:1.5*m.theme.spacing.small,fontSize:m.theme.fontSizes.medium,backgroundColor:m.theme.colors.surfaceContrast},errorInput:{borderColor:m.theme.colors.error},errorText:{color:m.theme.colors.error,fontSize:m.theme.fontSizes.smallMedium,marginTop:4},rememberMeContainer:{flexDirection:"row",alignItems:"center",marginBottom:m.theme.spacing.large},checkbox:{width:20,height:20,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:2,marginRight:10,justifyContent:"center",alignItems:"center"},checkboxInner:{width:20,height:20,backgroundColor:m.theme.colors.primary,borderRadius:2,justifyContent:"center",alignItems:"center"},rememberMeText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text},loginButton:{backgroundColor:m.theme.colors.primary,paddingVertical:1.75*m.theme.spacing.small,borderRadius:4,alignItems:"center",marginBottom:m.theme.spacing.medium},loginButtonText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.medium,fontWeight:"500"},forgotPasswordContainer:{alignItems:"center",marginTop:m.theme.spacing.small},link:{color:m.theme.colors.primary,fontSize:m.theme.fontSizes.smallMedium},message:{marginTop:m.theme.spacing.small,color:m.theme.colors.error,fontSize:m.theme.fontSizes.smallMedium,textAlign:"center"},prototypeWarning:{backgroundColor:"#FFF3CD",color:"#856404",padding:1.5*m.theme.spacing.small,marginBottom:m.theme.spacing.medium,borderRadius:4,textAlign:"center"}});var qo=o(44767);const{width:Yo}=C.default.get("window");function Go(){const e=(0,b.useNavigation)(),t=(0,b.useRoute)(),{signIn:o,is_DEBUG:i}=(0,n.useContext)(h.AuthContext),[s,l]=(0,n.useState)(""),[d,c]=(0,n.useState)(""),[u,g]=(0,n.useState)(""),[f,y]=(0,n.useState)(""),[w,C]=(0,n.useState)(""),[T,B]=(0,n.useState)(!1),[k,_]=(0,n.useState)(""),[I,M]=(0,n.useState)(""),[L,R]=(0,n.useState)(null),[D,z]=(0,n.useState)(!1),[P,F]=(0,n.useState)(!1),[E,W]=(0,n.useState)(""),[O,N]=(0,n.useState)(!1),[H,U]=(0,n.useState)(""),[V,q]=(0,n.useState)([]),[Y,G]=(0,n.useState)(!0),[J,$]=(0,n.useState)(""),[K,Z]=(0,n.useState)(!1),[Q,ee]=(0,n.useState)(""),[oe,ne]=(0,n.useState)(""),[re,ae]=(0,n.useState)(!1),[ie,se]=(0,n.useState)(!1),[le,de]=(0,n.useState)(!1),[ce,ue]=(0,n.useState)(""),ge=[{name:"Colorado Springs",supported:!0},{name:"Denver",supported:!1},{name:"Other",supported:!1}],me=[{value:"instagram",label:"Instagram"},{value:"google",label:"Google"},{value:"reddit",label:"Reddit"},{value:"nextdoor",label:"Nextdoor"},{value:"other",label:"Other"}],[he,fe]=(0,n.useState)(""),[pe,ye]=(0,n.useState)(""),[be,xe]=(0,n.useState)(""),[ve,we]=(0,n.useState)(""),[Ce,Se]=(0,n.useState)("");(0,n.useEffect)((()=>{(async()=>{try{t.name;(0,h.debugLog)("MBA4321 Current route name:",t.name);let e=t.params?.token;if((0,h.debugLog)("MBA4321 Token from route params:",e),!e){const t=window.location.pathname;if((0,h.debugLog)("MBA4321 Current URL path:",t),(0,h.debugLog)("MBA4321 Full location object:",{pathname:window.location.pathname,href:window.location.href,search:window.location.search,hash:window.location.hash}),t.includes("/invite/")){const o=t.split("/"),n=o.findIndex((e=>"invite"===e));-1!==n&&o.length>n+1&&(e=o[n+1],(0,h.debugLog)("MBA4321 Found invitation token from invite URL path:",e))}else if(t.includes("/signup/")){const o=t.split("/"),n=o.findIndex((e=>"signup"===e));-1!==n&&o.length>n+1&&(e=o[n+1],(0,h.debugLog)("MBA4321 Found invitation token from signup URL path:",e))}}if(!e){const t=new URLSearchParams(window.location.search).get("token");t&&(e=t,(0,h.debugLog)("MBA4321 Found invitation token from URL search params:",e))}if(e){(0,h.debugLog)("MBA4321 Processing invitation token:",e),R(e),F(!0);try{const t=await(0,bt.verifyInvitation)(e);(0,h.debugLog)("MBA4321 Invitation verification result:",t),t.valid?(z(!0),M(t.inviter_name),t.email&&g(t.email),_("You've been invited by ".concat(t.inviter_name,"!"))):_("This invitation is no longer valid: ".concat(t.error))}catch(zs){(0,h.debugLog)("MBA4321 Error verifying invitation:",zs),_("This invitation link is invalid or has expired.")}finally{F(!1)}}}catch(zs){(0,h.debugLog)("MBA4321 Error processing invitation:",zs),F(!1)}})()}),[t.params,t.name]),(0,n.useEffect)((()=>{(async()=>{G(!0);try{const e=await x.default.get("".concat(p.API_BASE_URL,"/api/locations/v1/supported/"));(0,h.debugLog)("MBA6789: Locations fetched from backend",e.data),e.data&&Array.isArray(e.data.locations)?q(e.data.locations):((0,h.debugLog)("MBA6789: Using fallback locations due to unexpected response format",e.data),q(ge))}catch(zs){(0,h.debugLog)("MBA6789: Error fetching locations",zs),q(ge)}finally{G(!1)}})()}),[]);return(0,j.jsxs)(qo.default,{style:Jo.container,behavior:"height",keyboardVerticalOffset:0,children:[(0,j.jsxs)(X.default,{contentContainerStyle:Jo.scrollContainer,children:[(0,j.jsxs)(r.default,{style:Jo.formContainer,children:[(0,j.jsx)(a.default,{style:Jo.title,children:"Sign Up"}),(0,j.jsx)(a.default,{style:Jo.subtitle,children:"Sign up to continue"}),P&&(0,j.jsxs)(r.default,{style:Jo.inviteContainer,children:[(0,j.jsx)(A.default,{size:"small",color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:Jo.inviteText,children:"Verifying invitation..."})]}),D&&(0,j.jsx)(r.default,{style:Jo.inviteContainer,children:(0,j.jsxs)(a.default,{style:Jo.inviteText,children:["You've been invited by ",I,"!"]})}),!D&&(0,j.jsxs)(r.default,{style:Jo.locationContainer,children:[(0,j.jsx)(a.default,{style:Jo.label,children:"Where are you located?"}),Y?(0,j.jsxs)(r.default,{style:[Jo.input,Jo.dropdown,Jo.loadingContainer],children:[(0,j.jsx)(A.default,{size:"small",color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:Jo.placeholderText,children:"Loading locations..."})]}):(0,j.jsxs)(r.default,{style:Jo.dropdownWrapper,children:[(0,j.jsxs)(v.default,{style:[Jo.input,Jo.dropdown,H?Jo.errorInput:null],onPress:()=>N(!O),children:[(0,j.jsx)(a.default,{style:E?Jo.inputText:Jo.placeholderText,children:E||"Select your location"}),(0,j.jsx)(S.default,{name:O?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})]}),O&&(0,j.jsx)(r.default,{style:Jo.dropdownMenu,children:(0,j.jsx)(X.default,{style:Jo.dropdownScrollView,showsVerticalScrollIndicator:!1,nestedScrollEnabled:!0,children:V.map((e=>(0,j.jsx)(v.default,{style:Jo.dropdownItem,onPress:()=>{return t=e.name,console.log("Location selected:",t),(0,h.debugLog)("MBA6789: Location selected",t),W(t),N(!1),void U("");var t},children:(0,j.jsxs)(a.default,{style:Jo.dropdownItemText,children:[e.name," ",!e.supported&&"(Coming Soon)"]})},e.name)))})})]}),H?(0,j.jsx)(a.default,{style:Jo.errorText,children:H}):null]}),(0,j.jsxs)(r.default,{style:Jo.howDidYouHearContainer,children:[(0,j.jsx)(a.default,{style:Jo.label,children:"How did you hear about us?"}),(0,j.jsxs)(r.default,{style:Jo.howDidYouHearDropdownWrapper,children:[(0,j.jsxs)(v.default,{style:[Jo.input,Jo.dropdown,oe?Jo.errorInput:null],onPress:()=>Z(!K),children:[(0,j.jsx)(a.default,{style:J?Jo.inputText:Jo.placeholderText,children:J?me.find((e=>e.value===J))?.label:"Select an option"}),(0,j.jsx)(S.default,{name:K?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})]}),K&&(0,j.jsx)(r.default,{style:Jo.dropdownMenu,children:(0,j.jsx)(X.default,{style:Jo.dropdownScrollView,showsVerticalScrollIndicator:!1,nestedScrollEnabled:!0,children:me.map((e=>(0,j.jsx)(v.default,{style:Jo.dropdownItem,onPress:()=>{return t=e.value,(0,h.debugLog)("MBA9999: How did you hear selected",t),$(t),Z(!1),ne(""),void("other"!==t&&ee(""));var t},children:(0,j.jsx)(a.default,{style:Jo.dropdownItemText,children:e.label})},e.value)))})})]}),oe?(0,j.jsx)(a.default,{style:Jo.errorText,children:oe}):null]}),"other"===J&&(0,j.jsxs)(r.default,{style:Jo.inputContainer,children:[(0,j.jsx)(te.default,{style:[Jo.input,oe?Jo.errorInput:null],placeholder:"Please specify how you heard about us",value:Q,onChangeText:e=>{(0,h.debugLog)("MBA9999: How did you hear other input change:",e);const t=Ke(e,"general"),o=e.length>0?(e.length-t.length)/e.length*100:0;o>30&&e.length>3&&(0,h.debugLog)("MBA9999: Potentially malicious how did you hear other input detected:",{original:e,sanitized:t,removalPercentage:o}),ee(t),ne("")}}),oe?(0,j.jsx)(a.default,{style:Jo.errorText,children:oe}):null]}),D||!E||V.find((e=>e.name===E&&e.supported))?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(r.default,{style:Jo.inputContainer,children:[(0,j.jsx)(te.default,{style:[Jo.input,he?Jo.errorInput:null],placeholder:"First Name",value:s,onChangeText:e=>{(0,h.debugLog)("MBA7777: First name input change:",e);const t=Ke(e,"name"),o=e.length>0?(e.length-t.length)/e.length*100:0;o>30&&e.length>3&&(0,h.debugLog)("MBA7777: Potentially malicious first name input detected:",{original:e,sanitized:t,removalPercentage:o}),l(t),fe("")}}),he?(0,j.jsx)(a.default,{style:Jo.errorText,children:he}):null]}),(0,j.jsxs)(r.default,{style:Jo.inputContainer,children:[(0,j.jsx)(te.default,{style:[Jo.input,pe?Jo.errorInput:null],placeholder:"Last Name",value:d,onChangeText:e=>{(0,h.debugLog)("MBA7777: Last name input change:",e);const t=Ke(e,"name"),o=e.length>0?(e.length-t.length)/e.length*100:0;o>30&&e.length>3&&(0,h.debugLog)("MBA7777: Potentially malicious last name input detected:",{original:e,sanitized:t,removalPercentage:o}),c(t),ye("")}}),pe?(0,j.jsx)(a.default,{style:Jo.errorText,children:pe}):null]}),(0,j.jsxs)(r.default,{style:Jo.inputContainer,children:[(0,j.jsx)(te.default,{style:[Jo.input,be?Jo.errorInput:null],placeholder:"Email",value:u,onChangeText:e=>{(0,h.debugLog)("MBA7777: Email input change:",e);const t=Ke(e,"email"),o=e.length>0?(e.length-t.length)/e.length*100:0;o>20&&e.length>5&&(0,h.debugLog)("MBA7777: Potentially malicious email input detected:",{original:e,sanitized:t,removalPercentage:o}),g(t),xe("")},keyboardType:"email-address",autoCapitalize:"none",editable:!0}),be?(0,j.jsx)(a.default,{style:Jo.errorText,children:be}):null]}),(0,j.jsxs)(r.default,{style:Jo.inputContainer,children:[(0,j.jsx)(te.default,{style:[Jo.input,ve?Jo.errorInput:null],placeholder:"Password",value:f,onChangeText:e=>{(0,h.debugLog)("MBA7777: Password input change:",e);const t=Ke(e,"password"),o=e.length>0?(e.length-t.length)/e.length*100:0;o>50&&e.length>8&&(0,h.debugLog)("MBA7777: Potentially malicious password input detected:",{original:e,sanitized:t,removalPercentage:o}),y(t),we("")},secureTextEntry:!0}),ve?(0,j.jsx)(a.default,{style:Jo.errorText,children:ve}):null]}),(0,j.jsxs)(r.default,{style:Jo.inputContainer,children:[(0,j.jsx)(te.default,{style:[Jo.input,Ce?Jo.errorInput:null],placeholder:"Confirm Password",value:w,onChangeText:e=>{(0,h.debugLog)("MBA7777: Confirm password input change:",e);const t=Ke(e,"password"),o=e.length>0?(e.length-t.length)/e.length*100:0;o>50&&e.length>8&&(0,h.debugLog)("MBA7777: Potentially malicious confirm password input detected:",{original:e,sanitized:t,removalPercentage:o}),C(t),Se("")},secureTextEntry:!0}),Ce?(0,j.jsx)(a.default,{style:Jo.errorText,children:Ce}):null]}),(0,j.jsxs)(r.default,{style:Jo.checkboxContainer,children:[(0,j.jsxs)(v.default,{style:Jo.checkboxWrapper,onPress:()=>ae(!re),children:[(0,j.jsx)(r.default,{style:[Jo.checkbox,re&&Jo.checkboxChecked],children:re&&(0,j.jsx)(S.default,{name:"check",size:16,color:"white"})}),(0,j.jsxs)(a.default,{style:Jo.checkboxText,children:["I agree to the"," ",(0,j.jsx)(a.default,{style:Jo.linkText,onPress:()=>se(!0),children:"Terms of Service"})," ","and"," ",(0,j.jsx)(a.default,{style:Jo.linkText,onPress:()=>de(!0),children:"Privacy Policy"})]})]}),ce?(0,j.jsx)(a.default,{style:Jo.errorText,children:ce}):null]}),(0,j.jsx)(No,{title:"Sign Up",onPress:async()=>{if((()=>{let e=!0;D||E||(U("Please select your location"),e=!1),J?"other"!==J||Q.trim()?ne(""):(ne("Please specify how you heard about us"),e=!1):(ne("Please select how you heard about us"),e=!1);const t=Xe(s);fe(t.message),t.isValid||(e=!1);const o=Xe(d);ye(o.message),o.isValid||(e=!1);const n=Ze(u);xe(n.message),n.isValid||(e=!1);const r=Qe(f);we(r.message),r.isValid||(e=!1);const a=et(f,w);return Se(a.message),a.isValid||(e=!1),re?ue(""):(ue("You must accept the Terms of Service and Privacy Policy to continue"),e=!1),e})()){B(!0);try{(0,h.debugLog)("MBA12345 Starting user registration process");const t=Ke(s,"name"),n=Ke(d,"name"),r=Ke(u,"email"),a=Ke(f,"password"),i=Ke(E,"general"),l=Ke(Q,"general");(0,h.debugLog)("MBA12345 Input sanitization completed",{originalFirstName:s,sanitizedFirstName:t,originalLastName:d,sanitizedLastName:n,originalEmail:u,sanitizedEmail:r,originalLocation:E,sanitizedLocation:i,originalHowDidYouHearOther:Q,sanitizedHowDidYouHearOther:l,passwordChanged:f!==a});let c="UTC";try{c=Intl.DateTimeFormat().resolvedOptions().timeZone,(0,h.debugLog)("MBA12345 User timezone detected using Intl API",{userTimezone:c})}catch(zs){(0,h.debugLog)("MBA12345 Error detecting timezone using Intl API",zs),c="UTC"}const g=!1;(0,h.debugLog)("MBA12345 User timezone and preferences",{userTimezone:c,useMilitaryTime:g});const m=Object.assign({name:"".concat(t.trim().charAt(0).toUpperCase()+t.trim().slice(1).toLowerCase()," ").concat(n.trim().charAt(0).toUpperCase()+n.trim().slice(1).toLowerCase()),email:r.trim().toLowerCase(),password:a,password2:w,phone_number:"",location:D?"Colorado Springs":i,how_did_you_hear:J,how_did_you_hear_other:"other"===J?l.trim():""},L&&{invitation_token:L}),y=Object.assign({},m,{timezone:c,use_military_time:g,invitation_token:L,terms_and_privacy_accepted_at:(new Date).toISOString(),terms_and_privacy_version:"1.1"});(0,h.debugLog)("MBA12345 Registration data:",y);const b=x.default.create({baseURL:p.API_BASE_URL,headers:{"Content-Type":"application/json"}}),v=await b.post("/api/users/v1/register/",y);(0,h.debugLog)("MBA12345 User registration successful",v.data),(0,h.debugLog)("MBA12345 Attempting to log in with new credentials");const C=await b.post("/api/token/",{email:r.trim().toLowerCase(),password:a});(0,h.debugLog)("MBA12345 Login successful, received tokens");const{access:S,refresh:j}=C.data;(0,h.debugLog)("MBA12345 Calling signIn function from AuthContext"),await o(S,j),(0,h.debugLog)("MBA12345 Authentication setup complete"),e.navigate("Dashboard")}catch(zs){(0,h.debugLog)("MBA12345 Error during signup process",zs.response?.data||zs.message);let t="Signup Failed: An error occurred during signup.";if(zs.response){const o=zs.response.data;if(o)if("object"===typeof o){const e=Object.entries(o)[0];if(e){const[o,n]=e;t="".concat(o,": ").concat(Array.isArray(n)?n[0]:n)}}else"string"===typeof o&&(t=o)}_(t)}finally{B(!1)}}},style:Jo.signupButton})]}):(0,j.jsxs)(r.default,{style:Jo.waitlistContainer,children:[(0,j.jsxs)(a.default,{style:Jo.waitlistMessage,children:["CrittrCove isn't available in ",E," yet, but we're expanding soon!"]}),(0,j.jsx)(a.default,{style:Jo.waitlistSubMessage,children:"Join our waitlist to be notified when we launch in your area."}),(0,j.jsx)(No,{title:"Join Waitlist",onPress:()=>{e.navigate("Waitlist")},style:Jo.waitlistButton})]}),T&&(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.primary,style:Jo.loader}),k?(0,j.jsx)(a.default,{style:Jo.message,children:k}):null]}),(0,j.jsxs)(r.default,{style:Jo.signInContainer,children:[(0,j.jsx)(a.default,{style:Jo.signInText,children:"Already have an account? "}),(0,j.jsx)(v.default,{onPress:()=>{e.navigate("SignIn")},children:(0,j.jsx)(a.default,{style:Jo.signInLink,children:"Sign in"})})]})]}),(0,j.jsx)(Ro,{visible:ie,onClose:()=>se(!1)}),(0,j.jsx)(zo,{visible:le,onClose:()=>de(!1)})]})}const Jo=i.default.create({container:{flex:1,backgroundColor:m.theme.colors.background},scrollContainer:{padding:20,alignItems:"center",justifyContent:"center",minHeight:"100%"},formContainer:{backgroundColor:m.theme.colors.surfaceContrast,padding:30,borderRadius:10,width:"100%",maxWidth:500,alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,borderWidth:1,borderColor:m.theme.colors.border},title:{fontSize:32,color:m.theme.colors.text,marginBottom:8,fontWeight:"bold",textAlign:"center"},subtitle:{color:m.theme.colors.text,fontSize:16,marginBottom:24,textAlign:"center"},inputContainer:{width:"100%",marginBottom:16},input:{width:"100%",height:50,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:5,paddingHorizontal:10,backgroundColor:m.theme.colors.surface,fontSize:16},errorInput:{borderColor:m.theme.colors.error},errorText:{color:m.theme.colors.error,fontSize:12,marginTop:5},message:{marginTop:20,color:m.theme.colors.text,textAlign:"center",fontSize:16},inviteContainer:{marginBottom:20,padding:16,borderWidth:1,borderColor:m.theme.colors.primary,borderRadius:8,alignItems:"center",backgroundColor:"#f0f9ff",width:"100%",flexDirection:"row",justifyContent:"center"},inviteText:{color:m.theme.colors.primary,fontSize:16,marginLeft:8,fontWeight:"500",textAlign:"center"},signupButton:{marginTop:24,width:"100%"},loader:{marginTop:20},signInContainer:{flexDirection:"row",marginTop:24,justifyContent:"center",alignItems:"center"},signInText:{color:m.theme.colors.text,fontSize:16},signInLink:{color:m.theme.colors.primary,fontSize:16,fontWeight:"600"},dropdown:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",height:50,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:5,paddingHorizontal:10,backgroundColor:m.theme.colors.surface},placeholderText:{color:m.theme.colors.placeHolderText,fontSize:16},inputText:{color:m.theme.colors.text,fontSize:16},dropdownMenu:{position:"absolute",top:"100%",left:0,right:0,zIndex:1002,marginTop:4,maxHeight:200,backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},dropdownItem:{padding:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},dropdownItemText:{color:m.theme.colors.text,fontSize:16},label:{color:m.theme.colors.text,fontSize:16,marginBottom:8},locationContainer:{width:"100%",marginBottom:16,position:"relative",zIndex:1002},dropdownWrapper:{position:"relative",zIndex:1003},loadingContainer:{justifyContent:"center"},howDidYouHearContainer:{width:"100%",marginBottom:16,position:"relative",zIndex:1e3},howDidYouHearDropdownWrapper:{position:"relative",zIndex:1001},waitlistContainer:{marginTop:20,padding:20,borderRadius:8,alignItems:"center",width:"100%",backgroundColor:"#f0f9ff",borderWidth:1,borderColor:"#e0e7ff",shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.05,shadowRadius:2,elevation:2},waitlistMessage:{color:m.theme.colors.text,fontSize:18,fontWeight:"600",marginBottom:16,textAlign:"center"},waitlistSubMessage:{color:m.theme.colors.text,fontSize:16,textAlign:"center",marginBottom:8},waitlistButton:{marginTop:24,width:"100%",backgroundColor:"#6B7280"},checkboxContainer:{marginVertical:10},checkboxWrapper:{flexDirection:"row",alignItems:"center",marginVertical:5},checkbox:{width:20,height:20,borderWidth:2,borderColor:m.theme.colors.primary,borderRadius:4,marginRight:10,justifyContent:"center",alignItems:"center"},checkboxChecked:{backgroundColor:m.theme.colors.primary},checkboxText:{fontSize:14,color:m.theme.colors.text,flex:1},linkText:{color:m.theme.colors.primary,textDecorationLine:"underline"}}),{width:$o}=C.default.get("window");const Ko=(e,t,o)=>i.default.create({container:{flex:1,backgroundColor:m.theme.colors.background,marginLeft:e>900&&o?t?70:250:0,transition:"margin-left 0.3s ease"},safeArea:{flex:1,paddingTop:0},content:{flex:1,justifyContent:"center",alignItems:"center",padding:20},backButton:{position:"absolute",top:20,left:20,flexDirection:"row",alignItems:"center",zIndex:1},backText:{marginLeft:8,fontSize:18,fontWeight:"600",color:m.theme.colors.text},card:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:12,padding:40,width:"100%",maxWidth:400,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5},title:{fontSize:28,fontWeight:"600",color:m.theme.colors.text,textAlign:"center",marginBottom:30},input:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:15,fontSize:16,color:m.theme.colors.text,borderWidth:1,borderColor:m.theme.colors.border,marginBottom:20},inputError:{borderColor:m.theme.colors.error},button:{marginBottom:20},loader:{marginTop:10},message:{textAlign:"center",color:m.theme.colors.primary,fontSize:14,marginTop:10},errorMessage:{color:m.theme.colors.error},errorText:{color:m.theme.colors.error,marginBottom:10}}),{width:Zo}=C.default.get("window");const Xo=i.default.create({container:{padding:m.theme.spacing.medium,backgroundColor:m.theme.colors.background,flex:1,justifyContent:"center",alignItems:"center"},title:{fontSize:m.theme.fontSizes.large,color:m.theme.colors.primary,marginBottom:m.theme.spacing.medium},input:{width:Zo>600?600:"100%",maxWidth:600,height:40,borderColor:"gray",borderWidth:1,marginBottom:m.theme.spacing.small,paddingHorizontal:m.theme.spacing.small},message:{marginTop:m.theme.spacing.small,color:m.theme.colors.primary,fontSize:m.theme.fontSizes.medium}}),Qo=i.default.create({card:Object.assign({backgroundColor:m.theme.colors.surfaceContrast,borderRadius:12,padding:16,marginBottom:16},{transition:"all 0.2s ease-in-out",cursor:"pointer"}),cardHovered:{transform:[{scale:1.02}],shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:5},cardContent:{flexDirection:"column"},mobileCardContent:{gap:12},topContent:{flexDirection:"row",alignItems:"flex-start",gap:16},mobileTopContent:{marginBottom:0},profileImage:{width:88,height:88,borderRadius:44},mobileProfileImage:{width:48,height:48,borderRadius:24},fallbackIconContainer:{backgroundColor:m.theme.colors.surface,justifyContent:"center",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border},contentContainer:{flex:1},mobileContentContainer:{flex:1},headerContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},mobileHeaderContainer:{marginBottom:0},nameAndPets:{flex:1},statusBadge:{alignSelf:"flex-start",paddingHorizontal:12,paddingVertical:4,borderRadius:16},statusContent:{flexDirection:"row",alignItems:"center",gap:6},statusText:{fontSize:12,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},clientContainer:{flexDirection:"row",alignItems:"center",gap:6,marginBottom:6},name:{fontSize:16,fontWeight:"600",color:m.theme.colors.mybookings.ownerName,fontFamily:m.theme.fonts.regular.fontFamily},petContainer:{flexDirection:"row",alignItems:"center",gap:4},petInfo:{fontSize:14,color:"#888975",fontFamily:m.theme.fonts.regular.fontFamily},mobileDivider:{height:1,backgroundColor:m.theme.colors.surface,width:"100%"},metaInfo:{flexDirection:"row",alignItems:"center",flexWrap:"wrap",gap:8},mobileMetaInfo:{width:"100%"},mobileMetaRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},metaItemContainer:{flexDirection:"row",alignItems:"center",gap:4},metaText:{fontSize:14,color:m.theme.colors.mybookings.metaText,fontFamily:m.theme.fonts.regular.fontFamily},viewDetailsButton:{backgroundColor:m.theme.colors.primary,paddingHorizontal:16,paddingVertical:8,borderRadius:8},viewDetailsText:{color:m.theme.colors.surfaceContrast,fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},mobileClientContainer:{marginBottom:4},mobileName:{fontSize:15,color:m.theme.colors.mybookings.ownerName},mobilePetContainer:{marginBottom:2},mobilePetInfo:{fontSize:13,color:m.theme.colors.mybookings.metaText},mobileStatusBadge:{paddingHorizontal:8,paddingVertical:2,borderRadius:12},mobileStatusText:{fontSize:10}}),en=({booking:e,type:t,onViewDetails:o})=>{const{id:i,status:s,date:l,time:d,serviceName:c}=e;let u="";"professional"===t?(u=e.client_name||e.ownerName||"Client",(0,h.debugLog)("MBA5677: Using client name for professional view",{client_name:e.client_name,ownerName:e.ownerName})):(u=e.professional_name||e.professionalName||"Professional",(0,h.debugLog)("MBA5677: Using professional name for client view",{professional_name:e.professional_name,professionalName:e.professionalName}));const g=(e=>{switch((0,h.debugLog)("MBA5677: Processing status",{status:e}),e){case"Pending Initial Professional Changes":case"Pending Professional Changes":return{text:"Pending Pro",bgColor:m.theme.colors.mybookings.main,textColor:m.theme.colors.mybookings.secondary,icon:"clock-outline"};case"Pending Owner Approval":return{text:"Pending Owner",bgColor:m.theme.colors.mybookings.main,textColor:m.theme.colors.mybookings.secondary,icon:"clock-outline"};case"Confirmed":return{text:"Confirmed",bgColor:m.theme.colors.mybookings.confirmedBg,textColor:m.theme.colors.mybookings.confirmedText,icon:"check-circle-outline"};case"Completed":return{text:"Completed",bgColor:m.theme.colors.mybookings.completedBg,textColor:m.theme.colors.mybookings.completedText,icon:"flag-checkered"};case"Confirmed Pending Professional Changes":return{text:"Confirmed \u2022 Pending Pro",bgColor:m.theme.colors.mybookings.confirmedBg,textColor:m.theme.colors.mybookings.confirmedText,icon:"check-circle-outline"};case"Confirmed Pending Owner Approval":return{text:"Confirmed \u2022 Pending Owner",bgColor:m.theme.colors.mybookings.confirmedBg,textColor:m.theme.colors.mybookings.confirmedText,icon:"check-circle-outline"};default:return{text:e||"Unknown",bgColor:m.theme.colors.mybookings.main,textColor:m.theme.colors.mybookings.secondary,icon:"clock-outline"}}})(s),f=e.pets||[],{screenWidth:y,timeSettings:b}=(0,n.useContext)(h.AuthContext),x=y<600,[w,C]=(0,n.useState)(!1),T=kt();(0,h.debugLog)("MBA5677: Original booking date/time",{date:l,time:d});const B="UTC"!==b?.timezone&&l&&d?(0,Wt.convertDateTimeFromUTC)(l,d,b?.timezone||"America/Denver",b?.use_military_time||!1):l&&d?{date:l,time:d}:null,k=B?.date?(()=>{(0,h.debugLog)("MBA5677: Formatting with direct date",B.date);const e=B.date.split("-");if(3===e.length){const[t,o,n]=e,r=new Date(parseInt(t),parseInt(o)-1,parseInt(n));if(!isNaN(r.getTime())){const e=r.toLocaleString("default",{month:"short"});return(0,h.debugLog)("MBA5677: Formatted date parts",{year:t,month:o,day:n,monthName:e,day:r.getDate()}),"".concat(e," ").concat(r.getDate())}}return B.date})():"No date selected",A=B?.time;(0,h.debugLog)("MBA5677: Converted date/time",{formattedDate:k,convertedTime:A,convertedDateTime:B,timezone:b?.timezone,originalDate:l,originalTime:d});const _="professional"===t?e.client_profile_picture:e.professional_profile_picture,I=()=>{const e=A||"No time selected",t=c||"No service selected";return x?(0,j.jsx)(r.default,{style:Qo.mobileMetaInfo,children:(0,j.jsxs)(r.default,{style:Qo.mobileMetaRow,children:[(0,j.jsxs)(r.default,{style:Qo.metaItemContainer,children:[(0,j.jsx)(S.default,{name:"calendar",size:14,color:m.theme.colors.mybookings.metaText}),(0,j.jsx)(a.default,{style:Qo.metaText,children:k})]}),(0,j.jsxs)(r.default,{style:Qo.metaItemContainer,children:[(0,j.jsx)(S.default,{name:"clock-outline",size:14,color:m.theme.colors.mybookings.metaText}),(0,j.jsx)(a.default,{style:Qo.metaText,children:e})]}),(0,j.jsxs)(r.default,{style:Qo.metaItemContainer,children:[(0,j.jsx)(S.default,{name:"briefcase-outline",size:14,color:m.theme.colors.mybookings.metaText}),(0,j.jsx)(a.default,{style:Qo.metaText,children:t})]})]})}):(0,j.jsxs)(r.default,{style:Qo.metaInfo,children:[(0,j.jsxs)(r.default,{style:Qo.metaItemContainer,children:[(0,j.jsx)(S.default,{name:"calendar",size:16,color:m.theme.colors.mybookings.metaText}),(0,j.jsx)(a.default,{style:Qo.metaText,children:k})]}),(0,j.jsx)(a.default,{style:Qo.metaText,children:" \u2022 "}),(0,j.jsxs)(r.default,{style:Qo.metaItemContainer,children:[(0,j.jsx)(S.default,{name:"clock-outline",size:16,color:m.theme.colors.mybookings.metaText}),(0,j.jsx)(a.default,{style:Qo.metaText,children:e})]}),(0,j.jsx)(a.default,{style:Qo.metaText,children:" \u2022 "}),(0,j.jsxs)(r.default,{style:Qo.metaItemContainer,children:[(0,j.jsx)(S.default,{name:"briefcase-outline",size:16,color:m.theme.colors.mybookings.metaText}),(0,j.jsx)(a.default,{style:Qo.metaText,children:t})]})]})};return(0,h.debugLog)("MBA5677: Rendering BookingCard",{booking:e,type:t,name:u,status:s,profilePictureUrl:_}),(0,j.jsx)(v.default,{style:[Qo.card,w&&Qo.cardHovered],onPress:o,onMouseEnter:()=>T&&C(!0),onMouseLeave:()=>T&&C(!1),children:(0,j.jsxs)(r.default,{style:[Qo.cardContent,x&&Qo.mobileCardContent],children:[(0,j.jsxs)(r.default,{style:[Qo.topContent,x&&Qo.mobileTopContent],children:[_?(0,j.jsx)(Q.default,{source:{uri:(0,p.getMediaUrl)(_)},style:[Qo.profileImage,x&&Qo.mobileProfileImage]}):(0,j.jsx)(r.default,{style:[Qo.profileImage,Qo.fallbackIconContainer,x&&Qo.mobileProfileImage],children:(0,j.jsx)(S.default,{name:"account",size:x?24:44,color:m.theme.colors.textSecondary})}),(0,j.jsxs)(r.default,{style:[Qo.contentContainer,x&&Qo.mobileContentContainer],children:[(0,j.jsxs)(r.default,{style:[Qo.headerContainer,x&&Qo.mobileHeaderContainer],children:[(0,j.jsxs)(r.default,{style:Qo.nameAndPets,children:[(0,j.jsxs)(r.default,{style:[Qo.clientContainer,x&&Qo.mobileClientContainer],children:[(0,j.jsx)(S.default,{name:"account",size:x?16:18,color:m.theme.colors.mybookings.ownername}),(0,j.jsx)(a.default,{style:[Qo.name,x&&Qo.mobileName],children:u})]}),(0,j.jsxs)(r.default,{style:[Qo.petContainer,x&&Qo.mobilePetContainer],children:[(0,j.jsx)(S.default,{name:"paw",size:14,color:m.theme.colors.mybookings.metaText}),(0,j.jsx)(a.default,{style:[Qo.petInfo,x&&Qo.mobilePetInfo],children:f.length>0?f.map((e=>e.name)).join(", "):"No pets selected"})]})]}),(0,j.jsx)(r.default,{style:[Qo.statusBadge,{backgroundColor:g.bgColor},x&&Qo.mobileStatusBadge],children:(0,j.jsxs)(r.default,{style:Qo.statusContent,children:[(0,j.jsx)(S.default,{name:g.icon,size:x?12:16,color:g.textColor}),(0,j.jsx)(a.default,{style:[Qo.statusText,{color:g.textColor},x&&Qo.mobileStatusText],children:g.text})]})})]}),!x&&I()]}),!x&&(0,j.jsx)(v.default,{style:Qo.viewDetailsButton,onPress:o,children:(0,j.jsx)(a.default,{style:Qo.viewDetailsText,children:"View Details"})})]}),x&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(r.default,{style:Qo.mobileDivider}),I()]})]})})},tn=i.default.create({alertContainer:{backgroundColor:"#fef2f2",borderRadius:8,padding:16,borderLeftWidth:4,borderLeftColor:m.theme.colors.error},alertHeader:{flexDirection:"row",alignItems:"center",marginBottom:8},alertBold:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,marginLeft:8,fontWeight:"bold"},alertText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily}}),on=({isProfessional:e,fromApprovalModal:t=!1})=>!e||t?null:(0,j.jsxs)(r.default,{style:[tn.alertContainer,{marginBottom:t?0:16}],children:[(0,j.jsxs)(r.default,{style:tn.alertHeader,children:[(0,j.jsx)(S.default,{name:"alert-circle",size:20,color:m.theme.colors.error}),(0,j.jsx)(a.default,{style:tn.alertBold,children:"Professional Reminders"})]}),(0,j.jsxs)(a.default,{style:tn.alertText,children:["\u2022 ",(0,j.jsx)(a.default,{style:tn.alertText,children:"Collect payment from your client before the booking begins"})]}),(0,j.jsx)(a.default,{style:tn.alertText,children:"\u2022 Consider scheduling a meet-and-greet before confirming this booking to ensure compatibility and discuss specific care requirements"})]}),nn=i.default.create({container:{flex:1,backgroundColor:m.theme.colors.background},contentContainer:{padding:16},section:{marginTop:24},badge:{fontSize:12,color:m.theme.colors.whiteText,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"bold",backgroundColor:m.theme.colors.mainColors.main,paddingHorizontal:8,paddingVertical:4,borderRadius:4,marginTop:4},sectionHeaderContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},sectionHeader:{fontSize:20,fontFamily:m.theme.fonts.header.fontFamily,color:m.theme.colors.text,marginBottom:8},addRateText:{color:m.theme.colors.mainColors.main,fontSize:14,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},card:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,paddingHorizontal:16,paddingBottom:16,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},breakdownSection:{width:"100%"},dateHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},dateTextContainer:{flex:1,marginRight:8},dateText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},breakdownItem:{flexDirection:"row",justifyContent:"space-between",paddingVertical:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},breakdownLabelContainer:{flex:1,marginRight:16},breakdownLabel:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},breakdownCalculation:{fontSize:14,color:m.theme.colors.placeHolderText,marginTop:4,fontFamily:m.theme.fonts.regular.fontFamily},breakdownAmount:{fontSize:16,color:m.theme.colors.text,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},totalItem:{marginTop:8,paddingTop:16},subtotalRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:12,paddingBottom:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},subtotalLabel:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},subtotalAmount:{fontSize:16,color:m.theme.colors.text,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},feeRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:12,paddingBottom:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},feeLabel:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},feeAmount:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},totalAmountContainer:{flexDirection:"row",justifyContent:"space-between",marginBottom:16,paddingBottom:16},totalLabel:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},totalAmount:{fontSize:18,fontWeight:"700",color:m.theme.colors.mainColors.main,fontFamily:m.theme.fonts.regular.fontFamily},divider:{height:1,backgroundColor:m.theme.colors.border,marginBottom:16},payoutContainer:{alignItems:"flex-end"},payoutLabel:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},payoutAmount:{fontSize:18,fontWeight:"700",color:m.theme.colors.success,fontFamily:m.theme.fonts.regular.fontFamily,marginTop:4},payoutBreakdown:{fontSize:12,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily,marginTop:4},inputContainer:{flexDirection:"row",alignItems:"center",marginTop:4},addRateContainer:{padding:16,width:"100%"},rateNameAmountRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:12},rateEditContainer:{flexDirection:"row",alignItems:"center",marginTop:8},amountInputContainer:{flexDirection:"row",alignItems:"center",minWidth:120,maxWidth:150},rateInput:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,paddingVertical:8,paddingHorizontal:12,minWidth:100,flex:1},currencySymbol:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,marginRight:4,marginLeft:2},inputLabel:{fontSize:14,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily,marginLeft:4},nameInput:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,paddingVertical:8,paddingHorizontal:12,flex:1,marginRight:16},descriptionInput:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,paddingVertical:8,paddingHorizontal:12,width:"100%"},saveButton:{backgroundColor:m.theme.colors.mainColors.main,borderRadius:4,paddingVertical:12,paddingHorizontal:20,marginTop:0,marginBottom:0,marginRight:0},saveButtonText:{color:"white",fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},formDivider:{height:1,backgroundColor:m.theme.colors.border,marginVertical:12,width:"100%"},editableAdditionalRateRow:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},rateNameAmountRowWithDelete:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",flex:1,marginRight:8},deleteButton:{padding:8,backgroundColor:m.theme.colors.surface,borderRadius:4,marginLeft:8},buttonsContainer:{flexDirection:"row",justifyContent:"flex-end",alignItems:"center",marginTop:16,marginBottom:8,marginRight:16},cancelButton:{backgroundColor:m.theme.colors.surface,borderRadius:4,paddingVertical:12,paddingHorizontal:20,marginRight:12},cancelButtonText:{color:m.theme.colors.text,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},multipleDatesContainer:{marginBottom:16},occurrenceCost:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},ratesToggleButton:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:8,backgroundColor:m.theme.colors.surface,borderRadius:4},ratesToggleText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},ratesBreakdown:{padding:16},rateItem:{flexDirection:"row",justifyContent:"space-between",marginBottom:8},rateLabel:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},rateAmount:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},rateDescription:{fontSize:14,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily},occurrenceDivider:{height:1,backgroundColor:m.theme.colors.border,marginBottom:16},termsContainer:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,padding:16,marginTop:16},checkboxContainer:{flexDirection:"row",alignItems:"center",flex:1},checkbox:{width:20,height:20,borderWidth:2,borderColor:m.theme.colors.border,borderRadius:4,marginRight:8},checkboxChecked:{backgroundColor:m.theme.colors.mainColors.main},termsText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,flex:1},termsLink:{fontSize:14,color:m.theme.colors.primary,fontFamily:m.theme.fonts.regular.fontFamily,textDecorationLine:"underline"},termsAgreedText:{fontSize:14,color:m.theme.colors.mainColors.main,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"bold"},additionalRatesDescription:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:16,lineHeight:20},serviceRateItem:{marginBottom:12},serviceRateCheckbox:{flexDirection:"row",alignItems:"center",padding:12,backgroundColor:m.theme.colors.surface,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border},serviceRateInfo:{flex:1,marginLeft:12},serviceRateTitle:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:2},serviceRateAmount:{fontSize:16,color:m.theme.colors.mainColors.main,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:2},serviceRateDescription:{fontSize:14,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily,lineHeight:18},serviceContainer:{flexDirection:"row",marginBottom:16,alignItems:"center",paddingBottom:16},serviceDivider:{height:1,backgroundColor:m.theme.colors.border,marginBottom:16,width:"100%"},serviceLabel:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,width:80,fontFamily:m.theme.fonts.regular.fontFamily},serviceValue:{fontSize:16,color:m.theme.colors.text,flex:1,fontFamily:m.theme.fonts.regular.fontFamily},petsContainer:{flexDirection:"row",alignItems:"flex-start"},petsLabel:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,width:80,fontFamily:m.theme.fonts.regular.fontFamily},petsList:{flex:1},petItem:{marginBottom:8},petName:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},petType:{fontSize:14,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily},noPets:{fontSize:16,color:m.theme.colors.placeHolderText,fontStyle:"italic",fontFamily:m.theme.fonts.regular.fontFamily},notesDescription:{fontSize:18,color:m.theme.colors.text,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:12},notesTextInput:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,paddingVertical:8,paddingHorizontal:12,width:"100%",height:100,textAlignVertical:"top"},notesTextInputReadOnly:{backgroundColor:m.theme.colors.surfaceContrast,color:m.theme.colors.text,borderColor:m.theme.colors.surface},notesSaveContainer:{flexDirection:"row",justifyContent:"flex-end",marginTop:12},notesSaveButton:{backgroundColor:m.theme.colors.mainColors.main,borderRadius:4,paddingVertical:8,paddingHorizontal:16},notesSaveButtonSaved:{backgroundColor:m.theme.colors.success},notesSaveButtonText:{color:"white",fontSize:14,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},notesSaveButtonTextSaved:{color:"white"}}),rn=({bookingData:e,onRatesUpdate:t,bookingId:o,showEditControls:i=!0,isProfessional:s=!0,onTermsAgreed:l,fromApprovalModal:d=!1,onTosAgreementChange:c})=>{const{timeSettings:u}=(0,n.useContext)(h.AuthContext),[g,f]=(0,n.useState)(!1),[p,y]=(0,n.useState)(!1),[b,x]=(0,n.useState)(null),[w,C]=(0,n.useState)({name:"",amount:"",description:""}),[T,B]=(0,n.useState)(!1),[k,A]=(0,n.useState)(null),[_,I]=(0,n.useState)(new Set),[M,L]=(0,n.useState)(null),[R,D]=(0,n.useState)({}),[z,P]=(0,n.useState)(null),[F,E]=(0,n.useState)({name:"",amount:"",description:""}),[W,O]=(0,n.useState)(!1),[N,H]=(0,n.useState)({}),[U,V]=(0,n.useState)([]),[q,Y]=(0,n.useState)(!1),G=(0,n.useRef)(null),[J,$]=(0,n.useState)(""),[K,Z]=(0,n.useState)(!1),[Q,ee]=(0,n.useState)(!1),[oe,ne]=(0,n.useState)("");(0,n.useEffect)((()=>{e?.notes_from_pro&&($(e.notes_from_pro),ne(e.notes_from_pro))}),[e?.notes_from_pro]),(0,n.useEffect)((()=>{ee(J===oe)}),[J,oe]);const re=(()=>{if(e)return s?e.pro_agreed_tos:e.client_agreed_tos})(),[ae,ie]=(0,n.useState)(!1),{width:se}=(0,Ne.default)();(0,n.useEffect)((()=>{if((0,h.debugLog)("MBA54321 ReviewAndRatesCard received bookingData:",e),(0,h.debugLog)("MBA54321 ReviewAndRatesCard received bookingId:",o),e?.occurrences?.[0]){const t={base_rate:0,additional_animal_rate:0,applies_after:1,holiday_rate:0,holiday_days:0,additional_rates:[]},o=e.occurrences[0].rates||t;x(Object.assign({},o))}if((0,h.debugLog)("MBA2394jv340 Effect triggered - checking if should initialize service rates"),(0,h.debugLog)("MBA2394jv340 Has service:",!!e?.service),(0,h.debugLog)("MBA2394jv340 Service is_overnight:",e?.service?.is_overnight),(0,h.debugLog)("MBA2394jv340 Occurrences length:",e?.occurrences?.length),(0,h.debugLog)("MBA2394jv340 Has already initialized rates:",q),(0,h.debugLog)("MBA2394jv340 Service details additional rates:",e?.service_details?.additional_rates),G.current!==o&&null!==G.current&&((0,h.debugLog)("MBA2394jv340 BookingId changed from",G.current,"to",o,"- resetting"),Y(!1),V([]),H({})),G.current=o,e?.service&&!e.service.is_overnight&&e?.occurrences?.length>=1&&!q){(0,h.debugLog)("MBA2394jv340 Initializing service additional rates for non-overnight service");let t=[],o={};if(e.service_details?.additional_rates)(0,h.debugLog)("MBA2394jv340 Using service_details.additional_rates as source:",e.service_details.additional_rates),Object.entries(e.service_details.additional_rates).forEach((([n,r])=>{const a=n.match(/^(.+)_start-[a-f0-9]+$/);if(a){const n=a[1];let i,s,l;if("boolean"===typeof r){i=r,s="0.00",l="";const t=e.service?.additional_rates?.find((e=>e.title===n));if(t)s=t.amount||t.rate||"0.00",l=t.description||"";else for(const o of e.occurrences){const e=o.rates?.additional_rates?.find((e=>(e.title||e.name)===n));if(e){s=e.amount||"0.00",l=e.description||"";break}}}else"object"===typeof r&&null!==r?(i=r.applies||!1,s=r.amount||"0.00",l=r.description||""):((0,h.debugLog)("MBA2394jv340 Unexpected rate value format:",r),i=!1,s="0.00",l="");t.push({title:n,amount:s,rate:s,description:l}),o[n]=i}})),(0,h.debugLog)("MBA2394jv340 Parsed available rates from service_details:",t),(0,h.debugLog)("MBA2394jv340 Parsed enabled rates from service_details:",o);else{(0,h.debugLog)("MBA2394jv340 No service_details.additional_rates found, falling back to legacy logic");const n=e.service.additional_rates||[];if((0,h.debugLog)("MBA2394jv340 Raw service additional rates from initialization:",n),t=n,0===n.length){(0,h.debugLog)("MBA2394jv340 No service rates found in initialization, collecting from occurrences");const o=[];e.occurrences.forEach(((e,t)=>{const n=e.rates?.additional_rates||[];(0,h.debugLog)("MBA2394jv340 Initialization: Occurrence ".concat(t," additional rates:"),n),o.push(...n)}));const n=new Map;o.forEach((e=>{e.title&&!n.has(e.title)&&n.set(e.title,{title:e.title,amount:e.amount,rate:e.amount,description:e.description||""})})),t=Array.from(n.values()),(0,h.debugLog)("MBA2394jv340 Initialization: Unique rates collected from occurrences:",t)}t=t.filter((e=>{const t=(e.title||"").toLowerCase();return!t.includes("base rate")&&!t.includes("additional animal")&&!t.includes("holiday rate")})),(0,h.debugLog)("MBA2394jv340 Filtered service additional rates from initialization:",t),t.forEach((t=>{let n=0;e.occurrences.forEach((e=>{const o=e.rates?.additional_rates?.some((e=>(e.title||e.name)===t.title));o&&n++}));const r=n===e.occurrences.length;o[t.title]=r,(0,h.debugLog)("MBA2394jv340 Rate status:",{title:t.title,isEnabled:r,occurrencesWithRate:n,totalOccurrences:e.occurrences.length})}))}(0,h.debugLog)("MBA2394jv340 Final available rates:",t),(0,h.debugLog)("MBA2394jv340 Final enabled rates state:",o),V(t),H(o),Y(!0)}else(0,h.debugLog)("MBA2394jv340 NOT initializing service rates - conditions not met or already initialized"),q||V([])}),[e,o,q]),(0,n.useEffect)((()=>{(0,h.debugLog)("MBA66777 Edit state changed:",{isEditMode:g,editingOccurrenceId:M,occurrencesCount:e?.occurrences?.length||0}),(0,h.debugLog)("MBA2oinv5nd Current editedRates state:",b),(0,h.debugLog)("MBA2oinv5nd Current occurrenceEdits state:",R)}),[g,M,e?.occurrences?.length,b,R]);const le=e=>e?"$".concat(parseFloat(e).toFixed(2)):"$0.00",de=async()=>{if(e?.conversation_id)if(J!==oe)try{Z(!0),(0,h.debugLog)("MBA88888 Saving notes to draft:",{conversationId:e.conversation_id,notes:J}),await(0,bt.updateDraftNotesFromPro)(e.conversation_id,J),ne(J),(0,h.debugLog)("MBA88888 Notes saved successfully")}catch(k){(0,h.debugLog)("MBA88888 Error saving notes:",k)}finally{Z(!1)}else(0,h.debugLog)("MBA88888 Notes are the same as last saved notes");else(0,h.debugLog)("MBA88888 No conversation ID available for saving notes")},ce=()=>{y(!p),C({name:"",amount:"",description:""})},ue=e=>{let t=e.replace(/[^\d.]/g,"").replace(/(\..*)\./g,"$1");const o=t.split(".");return o.length>1&&o[1].length>2&&(t="".concat(o[0],".").concat(o[1].substring(0,2))),t},ge=e=>{C((t=>Object.assign({},t,{amount:ue(e)})))},me=e=>{E((t=>Object.assign({},t,{amount:ue(e)})))},he=async()=>{const n=R&&Object.keys(R).length>0,r=n?R:b;if((0,h.debugLog)("MBA2oinv5nd saveRateChanges called. Using ratesToSave:",r,"Source:",n?"occurrenceEdits":"editedRates"),r)try{B(!0),A(null),(0,h.debugLog)("MBA66777 Saving rate changes:",r),(0,h.debugLog)("MBA66777 Using bookingId:",o),(0,h.debugLog)("MBA2oinv5nd Detailed ratesToSave breakdown:",{base_rate:r.base_rate,additional_animal_rate:r.additional_animal_rate,applies_after:r.applies_after,holiday_rate:r.holiday_rate,additional_rates:r.additional_rates});const n=Object.assign({},r,{additional_rates:r.additional_rates&&r.additional_rates.length>0?r.additional_rates.map((e=>({title:e.name||e.title,amount:""===e.amount?0:"string"===typeof e.amount?parseFloat(e.amount):e.amount,description:e.description||"Additional rate"}))):[]}),a=e.occurrences.map(((e,t)=>0===t?{occurrence_id:e.occurrence_id,rates:{base_rate:""===n.base_rate?0:"string"===typeof n.base_rate?parseFloat(n.base_rate):n.base_rate,additional_animal_rate:""===n.additional_animal_rate?0:"string"===typeof n.additional_animal_rate?parseFloat(n.additional_animal_rate):n.additional_animal_rate||0,applies_after:parseInt(n.applies_after||1),holiday_rate:""===n.holiday_rate?0:"string"===typeof n.holiday_rate?parseFloat(n.holiday_rate):n.holiday_rate||0,additional_rates:n.additional_rates}}:{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(e.rates.base_rate),additional_animal_rate:parseFloat(e.rates.additional_animal_rate||0),applies_after:parseInt(e.rates.applies_after||1),holiday_rate:parseFloat(e.rates.holiday_rate||0),additional_rates:(e.rates.additional_rates||[]).map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||""})))}}));(0,h.debugLog)("MBA66777 Sending all occurrences to API:",a),(0,h.debugLog)("MBA2oinv5nd First occurrence rates being sent to API:",a[0]?.rates);const i=await(0,bt.updateBookingDraftRates)(o,a);(0,h.debugLog)("MBA66777 Rate update API response:",i),i.draft_data&&t&&t(i.draft_data),f(!1),L(null),D({}),I(new Set),y(!1),P(null)}catch(a){(0,h.debugLog)("MBA66777 Error saving rate changes:",a),A("Failed to update rates. Please try again.")}finally{B(!1)}else(0,h.debugLog)("MBA2oinv5nd No ratesToSave found, returning early")},fe=async()=>{if(w.name&&(w.amount||""===w.amount))try{B(!0),A(null);w.name,""===w.amount||("string"===typeof w.amount?parseFloat(w.amount):w.amount),w.description;const n=Object.assign({},b);n.additional_rates||(n.additional_rates=[]),n.additional_rates.push({name:w.name,title:w.name,amount:""===w.amount?0:"string"===typeof w.amount?parseFloat(w.amount):w.amount,description:w.description||"Additional rate"});const r=e.occurrences.map(((e,t)=>0===t?{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(n.base_rate),additional_animal_rate:parseFloat(n.additional_animal_rate||0),applies_after:parseInt(n.applies_after||1),holiday_rate:parseFloat(n.holiday_rate||0),additional_rates:n.additional_rates.map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||"Additional rate"})))}}:{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(e.rates.base_rate),additional_animal_rate:parseFloat(e.rates.additional_animal_rate||0),applies_after:parseInt(e.rates.applies_after||1),holiday_rate:parseFloat(e.rates.holiday_rate||0),additional_rates:(e.rates.additional_rates||[]).map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||""})))}}));(0,h.debugLog)("MBA66777 Sending all occurrences with new rate to API:",r);const a=await(0,bt.updateBookingDraftRates)(o,r);(0,h.debugLog)("MBA66777 New rate added API response:",a),a.draft_data&&(a.draft_data.occurrences&&a.draft_data.occurrences[0]&&x(a.draft_data.occurrences[0].rates),t&&t(a.draft_data)),y(!1),C({name:"",amount:"",description:""})}catch(n){(0,h.debugLog)("MBA66777 Error adding new rate:",n),A("Failed to add new rate. Please try again.")}finally{B(!1)}},pe=e=>{const t=ue(e);x((e=>Object.assign({},e,{holiday_rate:t})))},ye=(e,t,o)=>{if((0,h.debugLog)("MBA2oinv5nd updateAdditionalRate called with index:",e,"field:",t,"value:",o),(0,h.debugLog)("MBA2oinv5nd Current editedRates:",b),!b?.additional_rates)return void(0,h.debugLog)("MBA2oinv5nd No additional_rates in editedRates, returning early");const n=[...b.additional_rates];if((0,h.debugLog)("MBA2oinv5nd Current additional_rates:",n),"amount"===t){const t=ue(o);(0,h.debugLog)("MBA2oinv5nd Updating amount from",n[e]?.amount,"to",t),n[e]=Object.assign({},n[e],{amount:""===t?"":t})}else"name"===t&&((0,h.debugLog)("MBA2oinv5nd Updating name from",n[e]?.name,"to",o),n[e]=Object.assign({},n[e],{name:o}));(0,h.debugLog)("MBA2oinv5nd Updated additional_rates:",n),x((e=>{const t=Object.assign({},e,{additional_rates:n});return(0,h.debugLog)("MBA2oinv5nd New editedRates after additional rate update:",t),t}))},be=async n=>{if(b?.additional_rates)try{B(!0),A(null);const r=Object.assign({},b),a=[...r.additional_rates];a.splice(n,1),r.additional_rates=a;const i=e.occurrences.map(((e,t)=>0===t?{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(r.base_rate),additional_animal_rate:parseFloat(r.additional_animal_rate||0),applies_after:parseInt(r.applies_after||1),holiday_rate:parseFloat(r.holiday_rate||0),additional_rates:r.additional_rates.map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||"Additional rate"})))}}:{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(e.rates.base_rate),additional_animal_rate:parseFloat(e.rates.additional_animal_rate||0),applies_after:parseInt(e.rates.applies_after||1),holiday_rate:parseFloat(e.rates.holiday_rate||0),additional_rates:(e.rates.additional_rates||[]).map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||""})))}}));(0,h.debugLog)("MBA66777 Sending all occurrences with updated rates to API:",i);const s=await(0,bt.updateBookingDraftRates)(o,i);(0,h.debugLog)("MBA66777 Rate deleted API response:",s),s.draft_data&&(s.draft_data.occurrences&&s.draft_data.occurrences[0]&&x(s.draft_data.occurrences[0].rates),t&&t(s.draft_data))}catch(r){(0,h.debugLog)("MBA66777 Error deleting rate:",r),A("Failed to delete rate. Please try again.")}finally{B(!1)}},xe=t=>{(0,h.debugLog)("MBA66777 Editing occurrence:",t),L(t.occurrence_id),1===e.occurrences.length?((0,h.debugLog)("MBA66777 Setting isEditMode for single occurrence booking"),f(!0),x({base_rate:t.rates.base_rate,additional_animal_rate:t.rates.additional_animal_rate||0,applies_after:t.rates.applies_after||1,holiday_rate:t.rates.holiday_rate||0,additional_rates:t.rates.additional_rates?.map((e=>({name:e.name||e.title,amount:e.amount,description:e.description||""})))||[]})):I(new Set([t.occurrence_id])),D({base_rate:t.rates.base_rate,additional_animal_rate:t.rates.additional_animal_rate||0,applies_after:t.rates.applies_after||1,holiday_rate:t.rates.holiday_rate||0,additional_rates:t.rates.additional_rates?.map((e=>({name:e.name||e.title,amount:e.amount,description:e.description||""})))||[]})},ve=()=>{L(null),D({}),1===e.occurrences.length&&f(!1),y(!1),P(null)},we=(e,t)=>{if("base_rate"===e||"additional_animal_rate"===e||"holiday_rate"===e){const o=ue(t);D((t=>Object.assign({},t,{[e]:o})))}else D((o=>Object.assign({},o,{[e]:t})))},Ce=(e,t,o)=>{(0,h.debugLog)("MBA66778 Changing additional rate at index ".concat(e,", field ").concat(t," to value: ").concat(o),{currentOccurrenceEdits:R,currentAdditionalRates:R.additional_rates}),D((n=>{const r=[...n.additional_rates||[]];if("amount"===t){const t=ue(o);r[e]=Object.assign({},r[e],{amount:""===t?"":t})}else"name"===t&&(r[e]=Object.assign({},r[e],{name:o}));return(0,h.debugLog)("MBA66778 Updated additional rate:",{updatedRate:r[e],allRates:r}),Object.assign({},n,{additional_rates:r})}))},Se=async(n,r)=>{try{B(!0),A(null);const a=Object.assign({},R);if(a.additional_rates&&a.additional_rates.length>r){a.additional_rates.splice(r,1),D(a);const i=e.occurrences.map((e=>e.occurrence_id===n.occurrence_id?{occurrence_id:n.occurrence_id,rates:{base_rate:parseFloat(a.base_rate),additional_animal_rate:parseFloat(a.additional_animal_rate||0),applies_after:parseInt(a.applies_after||1),holiday_rate:parseFloat(a.holiday_rate||0),additional_rates:a.additional_rates.map((e=>({title:e.name,amount:parseFloat(e.amount),description:e.description||""})))}}:{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(e.rates.base_rate),additional_animal_rate:parseFloat(e.rates.additional_animal_rate||0),applies_after:parseInt(e.rates.applies_after||1),holiday_rate:parseFloat(e.rates.holiday_rate||0),additional_rates:(e.rates.additional_rates||[]).map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||""})))}}));(0,h.debugLog)("MBA54321 - Sending all occurrences with rate deleted to API:",i);const s=await(0,bt.updateBookingDraftRates)(o,i);(0,h.debugLog)("MBA54321 - Rate deleted from occurrence API response:",s),s.draft_data&&t&&t(s.draft_data)}}catch(a){(0,h.debugLog)("MBA66777 Error deleting rate for occurrence:",a),A("Failed to delete rate. Please try again.")}finally{B(!1)}},je=(e,t,o)=>{if(M===e.occurrence_id&&R.additional_rates){const e=R.additional_rates[t]?.[o];return"amount"===o&&0===e?"":e||""}if(g&&b?.additional_rates){const e=b.additional_rates[t]?.[o];return"amount"===o&&0===e?"":e||""}const n=(e.rates?.additional_rates||[])[t]||{},r="name"===o?n.name||n.title:n[o];return"amount"===o&&0===r?"":r||""};return(0,h.debugLog)("MBA2394jv340 ReviewAndRatesCard main render called"),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(X.default,{style:nn.container,contentContainerStyle:nn.contentContainer,children:[(0,j.jsx)(on,{isProfessional:s,fromApprovalModal:d}),(0,j.jsxs)(r.default,{style:[nn.section,{marginTop:0,marginBottom:16}],children:[(0,j.jsx)(a.default,{style:nn.sectionHeader,children:"Service & Pets"}),(0,j.jsxs)(r.default,{style:[nn.card,{padding:16}],children:[(0,j.jsxs)(r.default,{style:nn.serviceContainer,children:[(0,j.jsx)(a.default,{style:nn.serviceLabel,children:"Service:"}),(0,j.jsx)(a.default,{style:nn.serviceValue,children:e.service_details?.service_type||"N/A"})]}),(0,j.jsx)(r.default,{style:nn.serviceDivider}),(0,j.jsxs)(r.default,{style:nn.petsContainer,children:[(0,j.jsx)(a.default,{style:nn.petsLabel,children:"Pets:"}),(0,j.jsx)(r.default,{style:nn.petsList,children:e.pets&&e.pets.length>0?e.pets.map(((e,t)=>{return(0,j.jsxs)(r.default,{style:nn.petItem,children:[(0,j.jsx)(a.default,{style:nn.petName,children:e.name}),(0,j.jsxs)(a.default,{style:nn.petType,children:[(o=e.species,o?o.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join(" "):o)," | ",e.breed]})]},t);var o})):(0,j.jsx)(a.default,{style:nn.noPets,children:"No pets selected"})})]})]})]}),(()=>{if(!s&&!d)return null;if(d&&!J)return null;const e=d,t=d?"Notes from Professional":"Notes for Client";return(0,j.jsxs)(r.default,{style:nn.section,children:[(0,j.jsx)(r.default,{style:nn.sectionHeaderContainer,children:(0,j.jsx)(a.default,{style:nn.sectionHeader,children:t})}),(0,j.jsx)(r.default,{style:[nn.card,{paddingTop:16,marginBottom:16}],children:e?(0,j.jsx)(a.default,{style:nn.notesTextInputReadOnly,children:J}):(0,j.jsxs)(r.default,{children:[(0,j.jsx)(te.default,{style:nn.notesTextInput,value:J,onChangeText:e=>{$(e),ee(!1)},placeholder:"Enter notes for the client (optional)...",placeholderTextColor:m.theme.colors.placeHolderText,multiline:!0,numberOfLines:4,textAlignVertical:"top"}),(0,j.jsx)(r.default,{style:nn.notesSaveContainer,children:(0,j.jsx)(v.default,{style:[nn.notesSaveButton,Q&&nn.notesSaveButtonSaved],onPress:de,disabled:K,children:(0,j.jsx)(a.default,{style:[nn.notesSaveButtonText,Q&&nn.notesSaveButtonTextSaved],children:Q?"\u2713 Saved":K?"Saving...":"Save Notes"})})})]})})]})})(),(()=>{if((0,h.debugLog)("MBA2394jv340 renderServiceAdditionalRates called"),(0,h.debugLog)("MBA2394jv340 bookingData:",e),(0,h.debugLog)("MBA2394jv340 bookingData.service:",e?.service),(0,h.debugLog)("MBA2394jv340 service.is_overnight:",e?.service?.is_overnight),(0,h.debugLog)("MBA2394jv340 occurrences length:",e?.occurrences?.length),!e?.service)return(0,h.debugLog)("MBA2394jv340 No service found, returning null"),null;if(!0===e.service.is_overnight)return(0,h.debugLog)("MBA2394jv340 Service is overnight, returning null"),null;if(!e?.occurrences)return(0,h.debugLog)("MBA2394jv340 No occurrences found, returning null"),null;const n=U;return(0,h.debugLog)("MBA2394jv340 Using stored available rates:",n),0===n.length?((0,h.debugLog)("MBA2394jv340 No stored rates found, returning null"),null):((0,h.debugLog)("MBA2394jv340 Rendering service additional rates section with",n.length,"rates"),(0,j.jsxs)(r.default,{style:nn.section,children:[(0,j.jsx)(r.default,{style:nn.sectionHeaderContainer,children:(0,j.jsx)(a.default,{style:nn.sectionHeader,children:"Additional Rates"})}),(0,j.jsxs)(r.default,{style:[nn.card,{paddingTop:16}],children:[(0,j.jsxs)(a.default,{style:nn.additionalRatesDescription,children:["Toggle additional rates to apply or remove them from ",1===e.occurrences.length?"this booking":"all ".concat(e.occurrences.length," dates in this booking"),":"]}),n.map(((n,i)=>{const s=N[n.title]||!1;return(0,j.jsx)(r.default,{style:nn.serviceRateItem,children:(0,j.jsxs)(v.default,{style:nn.serviceRateCheckbox,onPress:()=>(async(n,r)=>{try{B(!0),A(null),(0,h.debugLog)("MBA77999 Toggling service additional rate:",{title:n.title,isEnabled:r,occurrencesCount:e.occurrences.length}),H((e=>Object.assign({},e,{[n.title]:r})));const a=e.occurrences.map((e=>{const t=[...e.rates.additional_rates||[]];if(r)t.some((e=>(e.title||e.name)===n.title))||t.push({title:n.title,amount:parseFloat(n.amount||n.rate||0),description:n.description||"Additional rate"});else{const e=t.filter((e=>(e.title||e.name)!==n.title));t.length=0,t.push(...e)}return{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(e.rates.base_rate),additional_animal_rate:parseFloat(e.rates.additional_animal_rate||0),applies_after:parseInt(e.rates.applies_after||1),holiday_rate:parseFloat(e.rates.holiday_rate||0),additional_rates:t}}}));(0,h.debugLog)("MBA77999 Sending updated occurrences to API:",a);const i=await(0,bt.updateBookingDraftRates)(o,a);(0,h.debugLog)("MBA77999 Service rate toggle API response:",i),i.draft_data&&t&&t(i.draft_data)}catch(a){(0,h.debugLog)("MBA77999 Error toggling service additional rate:",a),A("Failed to update rates. Please try again."),H((e=>Object.assign({},e,{[n.title]:!r})))}finally{B(!1)}})(n,!s),disabled:T,children:[(0,j.jsx)(r.default,{style:[nn.checkbox,s&&nn.checkboxChecked],children:s&&(0,j.jsx)(S.default,{name:"check",size:16,color:"white"})}),(0,j.jsxs)(r.default,{style:nn.serviceRateInfo,children:[(0,j.jsx)(a.default,{style:nn.serviceRateTitle,children:n.title}),(0,j.jsx)(a.default,{style:nn.serviceRateAmount,children:le(n.amount||n.rate)}),n.description&&(0,j.jsx)(a.default,{style:nn.serviceRateDescription,children:n.description})]})]})},i)}))]})]}))})(),(()=>{(0,h.debugLog)("MBAio3htg5uohg: Rendering booking breakdown with data:",e?.occurrences?.[0]);const s=e?.occurrences;if(!s||0===s.length)return null;const{timeSettings:l}=(0,n.useContext)(h.AuthContext),d=l?.timezone||"US/Mountain";(0,h.debugLog)("MBAio3htg5uohg: userTimezone: ",d);const c=s.length>1||1===s.length&&(s[0].end_date!==s[0].start_date&&"00:00"===s[0].end_time||s[0].start_date===s[0].end_date);if((0,h.debugLog)("MBAio3htg5uohg: isMultipleDates detection:",{isMultipleDates:c,count:s.length,firstOccurrence:s[0]?{start_date:s[0].start_date,end_date:s[0].end_date,end_time:s[0].end_time}:null}),c)return(0,j.jsxs)(r.default,{style:[nn.section],children:[(0,j.jsx)(r.default,{style:nn.sectionHeaderContainer,children:(0,j.jsx)(a.default,{style:nn.sectionHeader,children:"Booking Breakdown"})}),(0,j.jsx)(r.default,{style:[nn.card,{paddingTop:16}],children:s.map(((n,s)=>{const l=n.unit_of_time||n.rates&&n.rates.unit_of_time||"Per Visit",c=parseFloat(n.multiple)||1;return(0,h.debugLog)("MBAio3htg5uohg: Processing occurrence in UI:",{id:n.occurrence_id,unit_of_time:l,multiple:c,calculated_cost:n.calculated_cost}),(0,j.jsxs)(r.default,{style:nn.multipleDatesContainer,children:[(0,j.jsxs)(r.default,{style:nn.dateHeader,children:[(0,j.jsx)(r.default,{style:nn.dateTextContainer,children:(0,j.jsx)(a.default,{style:nn.dateText,children:(0,Wt.formatDateTimeRangeFromUTC)({startDate:n.start_date,startTime:n.start_time,endDate:n.end_date,endTime:n.end_time,userTimezone:d,includeTimes:!0,includeTimezone:!0})})}),(0,j.jsx)(a.default,{style:nn.occurrenceCost,children:le(n.calculated_cost)}),M===n.occurrence_id?(0,j.jsx)(v.default,{onPress:ve,children:(0,j.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.error})}):i&&(0,j.jsx)(v.default,{onPress:()=>xe(n),children:(0,j.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.mainColors.main})})]}),(0,j.jsxs)(v.default,{style:nn.ratesToggleButton,onPress:()=>{const e=new Set(_);e.has(n.occurrence_id)?e.delete(n.occurrence_id):e.add(n.occurrence_id),I(e)},children:[(0,j.jsx)(a.default,{style:nn.ratesToggleText,children:_.has(n.occurrence_id)?"Hide Rates":"Show Rates"}),(0,j.jsx)(S.default,{name:_.has(n.occurrence_id)?"chevron-up":"chevron-down",size:20,color:m.theme.colors.mainColors.main})]}),_.has(n.occurrence_id)&&(0,j.jsxs)(r.default,{style:nn.ratesBreakdown,children:[(0,j.jsxs)(r.default,{style:nn.rateItem,children:[M===n.occurrence_id?(0,j.jsxs)(r.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,j.jsxs)(a.default,{style:nn.rateLabel,children:["Base Rate (",l,")"]}),(0,j.jsx)(te.default,{style:{width:80,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,padding:8},keyboardType:"decimal-pad",value:R.base_rate?.toString()||"",onChangeText:e=>we("base_rate",e)})]}):(0,j.jsxs)(r.default,{children:[(0,j.jsx)(a.default,{style:nn.rateLabel,children:"Base Rate"}),(0,j.jsxs)(a.default,{style:nn.breakdownCalculation,children:[le(n.rates.base_rate)," (",l,") \xd7 ",c," = ",le(n.base_total)]})]}),M===n.occurrence_id?null:(0,j.jsx)(a.default,{style:nn.rateAmount,children:le(n.base_total)})]}),n.rates?.additional_animal_rate&&parseFloat(n.rates.additional_animal_rate)>0&&n.rates?.applies_after&&n.rates.applies_after<(e.pets?.length||1)&&(0,j.jsxs)(r.default,{style:nn.rateItem,children:[M===n.occurrence_id?(0,j.jsxs)(r.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,j.jsxs)(a.default,{style:nn.rateLabel,children:["Additional Pet Rate (after ",n.rates.applies_after," ",1!==n.rates.applies_after?"pets":"pet",")"]}),(0,j.jsx)(te.default,{style:{width:80,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,padding:8},keyboardType:"decimal-pad",value:R.additional_animal_rate?.toString()||"",onChangeText:e=>we("additional_animal_rate",e)})]}):(0,j.jsxs)(r.default,{children:[(0,j.jsxs)(a.default,{style:nn.rateLabel,children:["Additional Pet Rate (after ",n.rates.applies_after," ",1!==n.rates.applies_after?"pets":"pet",")"]}),(0,j.jsxs)(a.default,{style:nn.breakdownCalculation,children:[le(n.rates.additional_animal_rate)," / pet / ",n.unit_of_time||n.rates?.unit_of_time||"Per Visit"," \xd7 ",Math.max(0,(e.pets?.length||0)-n.rates.applies_after)," additional pets = ",le(n.rates.additional_animal_rate_total||0)]})]}),M===n.occurrence_id?null:(0,j.jsx)(a.default,{style:nn.rateAmount,children:le(n.rates.additional_animal_rate_total||0)})]}),n.rates?.holiday_rate&&parseFloat(n.rates.holiday_rate)>0&&(n.rates?.holiday_days>0||!("holiday_days"in n.rates))&&(0,j.jsxs)(r.default,{style:nn.rateItem,children:[M===n.occurrence_id?(0,j.jsxs)(r.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,j.jsx)(a.default,{style:nn.rateLabel,children:"Holiday Rate"}),(0,j.jsx)(te.default,{style:{width:80,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,padding:8},keyboardType:"decimal-pad",value:R.holiday_rate?.toString()||"",onChangeText:e=>we("holiday_rate",e)})]}):(0,j.jsx)(a.default,{style:nn.rateLabel,children:"Holiday Rate"}),M===n.occurrence_id?null:(0,j.jsx)(a.default,{style:nn.rateAmount,children:le(n.rates.holiday_rate)})]}),((g?b?.additional_rates:n.rates?.additional_rates)||[]).length>0?((g?b?.additional_rates:n.rates?.additional_rates)||[]).map(((e,t)=>(0,j.jsxs)(r.default,{style:nn.breakdownItem,children:[(0,j.jsx)(r.default,{style:nn.breakdownLabelContainer,children:g||M===n.occurrence_id?se<600?(0,j.jsxs)(r.default,{style:{width:"100%"},children:[(0,j.jsxs)(r.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,h.debugLog)("MBA66778 Rendering rate at index ".concat(t,":"),{isEditMode:g,editingOccurrenceId:M,occurrenceId:n.occurrence_id,rateName:e.name||e.title,rateAmount:e.amount,occurrenceEditsRate:R.additional_rates?.[t],valueToShow:M===n.occurrence_id?R.additional_rates&&R.additional_rates[t]?.amount?.toString()||"0":e.amount?.toString()||"0"}),(0,j.jsx)(te.default,{style:[nn.nameInput,{flex:1,marginRight:8}],value:je(n,t,"name"),onChangeText:e=>M===n.occurrence_id?Ce(t,"name",e):ye(t,"name",e),placeholder:"Rate Name"}),(0,j.jsx)(v.default,{style:nn.deleteButton,onPress:()=>M===n.occurrence_id?Se(n,t):be(t),children:(0,j.jsx)(S.default,{name:"trash-can-outline",size:22,color:m.theme.colors.error})})]}),(0,j.jsx)(r.default,{style:{marginTop:8},children:(0,j.jsxs)(r.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,j.jsx)(a.default,{style:{marginRight:8},children:"Amount: $"}),(0,j.jsx)(te.default,{style:{width:80,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,padding:8},keyboardType:"decimal-pad",value:""===je(n,t,"amount")?"":je(n,t,"amount").toString(),onChangeText:e=>M===n.occurrence_id?Ce(t,"amount",e):ye(t,"amount",e)})]})})]}):(0,j.jsxs)(r.default,{style:nn.editableAdditionalRateRow,children:[(0,j.jsxs)(r.default,{style:nn.rateNameAmountRowWithDelete,children:[(0,j.jsx)(te.default,{style:nn.nameInput,value:je(n,t,"name"),onChangeText:e=>M===n.occurrence_id?Ce(t,"name",e):ye(t,"name",e),placeholder:"Rate Name"}),(0,j.jsxs)(r.default,{style:nn.amountInputContainer,children:[(0,j.jsx)(a.default,{style:nn.currencySymbol,children:"$"}),(0,j.jsx)(te.default,{style:nn.rateInput,keyboardType:"decimal-pad",value:""===je(n,t,"amount")?"":je(n,t,"amount").toString(),onChangeText:e=>M===n.occurrence_id?Ce(t,"amount",e):ye(t,"amount",e)})]})]}),(0,j.jsx)(v.default,{style:nn.deleteButton,onPress:()=>M===n.occurrence_id?Se(n,t):be(t),children:(0,j.jsx)(S.default,{name:"trash-can-outline",size:22,color:m.theme.colors.error})})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(a.default,{style:nn.breakdownLabel,children:e.name||e.title}),(0,j.jsx)(a.default,{style:nn.breakdownCalculation,children:e.description||"Additional Rate"})]})}),!g&&M!==n.occurrence_id&&(0,j.jsxs)(a.default,{style:nn.breakdownAmount,children:["+",le(e.amount)]})]},t))):null]}),z===n.occurrence_id&&(0,j.jsxs)(r.default,{children:[(0,j.jsxs)(r.default,{style:nn.addRateContainer,children:[(0,j.jsx)(r.default,{style:nn.formDivider}),se<600?(0,j.jsxs)(r.default,{children:[(0,j.jsx)(te.default,{style:[nn.nameInput,{marginRight:0,marginBottom:12}],value:F.name,onChangeText:e=>E((t=>Object.assign({},t,{name:e}))),placeholder:"Rate Name",placeholderTextColor:m.theme.colors.placeHolderText}),(0,j.jsxs)(r.default,{style:[nn.amountInputContainer,{marginBottom:12}],children:[(0,j.jsx)(a.default,{style:nn.currencySymbol,children:"$"}),(0,j.jsx)(te.default,{style:nn.rateInput,keyboardType:"decimal-pad",value:F.amount,onChangeText:me,placeholder:"0.00",placeholderTextColor:m.theme.colors.placeHolderText})]}),(0,j.jsx)(te.default,{style:nn.descriptionInput,value:F.description,onChangeText:e=>E((t=>Object.assign({},t,{description:e}))),placeholder:"Description (optional)",placeholderTextColor:m.theme.colors.placeHolderText})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(r.default,{style:nn.rateNameAmountRow,children:[(0,j.jsx)(te.default,{style:nn.nameInput,value:F.name,onChangeText:e=>E((t=>Object.assign({},t,{name:e}))),placeholder:"Rate Name",placeholderTextColor:m.theme.colors.placeHolderText}),(0,j.jsxs)(r.default,{style:nn.amountInputContainer,children:[(0,j.jsx)(a.default,{style:nn.currencySymbol,children:"$"}),(0,j.jsx)(te.default,{style:nn.rateInput,keyboardType:"decimal-pad",value:F.amount,onChangeText:me,placeholder:"0.00",placeholderTextColor:m.theme.colors.placeHolderText})]})]}),(0,j.jsx)(te.default,{style:nn.descriptionInput,value:F.description,onChangeText:e=>E((t=>Object.assign({},t,{description:e}))),placeholder:"Description (optional)",placeholderTextColor:m.theme.colors.placeHolderText})]}),(0,j.jsx)(r.default,{style:nn.formDivider})]}),(0,j.jsxs)(r.default,{style:nn.buttonsContainer,children:[(0,j.jsx)(v.default,{style:nn.cancelButton,onPress:()=>P(null),children:(0,j.jsx)(a.default,{style:nn.cancelButtonText,children:"Cancel"})}),(0,j.jsx)(v.default,{style:nn.saveButton,onPress:()=>(async n=>{if(F.name&&(F.amount||""===F.amount))try{B(!0),A(null);const r=Object.assign({},R);r.additional_rates||(r.additional_rates=[]),r.additional_rates.push({name:F.name,title:F.name,amount:""===F.amount?0:"string"===typeof F.amount?parseFloat(F.amount):F.amount,description:F.description||"Additional rate"}),D(r);const a=e.occurrences.map((e=>e.occurrence_id===n.occurrence_id?{occurrence_id:n.occurrence_id,rates:{base_rate:parseFloat(r.base_rate),additional_animal_rate:parseFloat(r.additional_animal_rate||0),applies_after:parseInt(r.applies_after||1),holiday_rate:parseFloat(r.holiday_rate||0),additional_rates:r.additional_rates.map((e=>({title:e.name,amount:parseFloat(e.amount),description:e.description||""})))}}:{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(e.rates.base_rate),additional_animal_rate:parseFloat(e.rates.additional_animal_rate||0),applies_after:parseInt(e.rates.applies_after||1),holiday_rate:parseFloat(e.rates.holiday_rate||0),additional_rates:(e.rates.additional_rates||[]).map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||""})))}}));(0,h.debugLog)("MBA54321 - Sending all occurrences with new rate to API:",a);const i=await(0,bt.updateBookingDraftRates)(o,a);(0,h.debugLog)("MBA54321 - New rate added to occurrence API response:",i),i.draft_data&&t&&t(i.draft_data),P(null),E({name:"",amount:"",description:""})}catch(r){(0,h.debugLog)("MBA66777 Error adding new rate for occurrence:",r),A("Failed to add new rate. Please try again.")}finally{B(!1)}})(n),children:(0,j.jsx)(a.default,{style:nn.saveButtonText,children:"Save New Rate"})})]})]}),M===n.occurrence_id&&!z&&(0,j.jsxs)(r.default,{style:nn.buttonsContainer,children:[(0,j.jsx)(v.default,{style:nn.cancelButton,onPress:()=>{return e=n.occurrence_id,P(z===e?null:e),void E({name:"",amount:"",description:""});var e},children:(0,j.jsx)(a.default,{style:nn.cancelButtonText,children:"+ Add Rate"})}),(0,j.jsx)(v.default,{style:nn.saveButton,onPress:()=>(async n=>{try{B(!0),A(null);const r=Object.assign({},R,{additional_rates:(R.additional_rates||[]).map((e=>({title:e.name||e.title,amount:""===e.amount?0:"string"===typeof e.amount?parseFloat(e.amount):e.amount,description:e.description||""})))}),a=e.occurrences.map((e=>e.occurrence_id===n.occurrence_id?{occurrence_id:n.occurrence_id,rates:{base_rate:""===R.base_rate?0:"string"===typeof R.base_rate?parseFloat(R.base_rate):R.base_rate,additional_animal_rate:""===R.additional_animal_rate?0:"string"===typeof R.additional_animal_rate?parseFloat(R.additional_animal_rate):R.additional_animal_rate||0,applies_after:parseInt(R.applies_after||1),holiday_rate:""===R.holiday_rate?0:"string"===typeof R.holiday_rate?parseFloat(R.holiday_rate):R.holiday_rate||0,additional_rates:r.additional_rates}}:{occurrence_id:e.occurrence_id,rates:{base_rate:parseFloat(e.rates.base_rate),additional_animal_rate:parseFloat(e.rates.additional_animal_rate||0),applies_after:parseInt(e.rates.applies_after||1),holiday_rate:parseFloat(e.rates.holiday_rate||0),additional_rates:(e.rates.additional_rates||[]).map((e=>({title:e.name||e.title,amount:parseFloat(e.amount),description:e.description||""})))}}));(0,h.debugLog)("MBA54321 - Sending all occurrences to API:",a);const i=await(0,bt.updateBookingDraftRates)(o,a);i.draft_data&&(t&&t(i.draft_data),L(null),D({}),1===e.occurrences.length&&f(!1),I(new Set),y(!1),P(null))}catch(r){(0,h.debugLog)("MBA54321 - Error saving occurrence rates:",r),A("Failed to update rates. Please try again.")}finally{B(!1)}})(n),children:(0,j.jsx)(a.default,{style:nn.saveButtonText,children:"Save Changes"})})]})]},n.occurrence_id)}))})]});const u=s[0];if(!u)return null;const T=(0,Wt.formatDateTimeRangeFromUTC)({startDate:u.start_date,startTime:u.start_time,endDate:u.end_date,endTime:u.end_time,userTimezone:d,includeTimes:!0,includeTimezone:!0});return(0,h.debugLog)("MBA54321 Formatted date range:",T),u.rates||((0,h.debugLog)("MBA54321 occurrence.rates is undefined, initializing with defaults"),u.rates={base_rate:0,additional_animal_rate:0,applies_after:1,holiday_rate:0,holiday_days:0,additional_rates:[]}),(0,j.jsxs)(r.default,{style:[nn.section,{marginTop:i?24:0}],children:[(0,j.jsx)(r.default,{style:nn.sectionHeaderContainer,children:(0,j.jsx)(a.default,{style:nn.sectionHeader,children:"Booking Breakdown"})}),(0,j.jsx)(r.default,{style:[nn.card,{paddingTop:16}],children:(0,j.jsxs)(r.default,{style:nn.breakdownSection,children:[(0,j.jsxs)(r.default,{style:nn.dateHeader,children:[(0,j.jsx)(r.default,{style:nn.dateTextContainer,children:(0,j.jsx)(a.default,{style:nn.dateText,children:(0,Wt.formatDateTimeRangeFromUTC)({startDate:u.start_date,startTime:u.start_time,endDate:u.end_date,endTime:u.end_time,userTimezone:d,includeTimes:!0,includeTimezone:!0})})}),(0,j.jsx)(a.default,{style:nn.occurrenceCost,children:le(u.calculated_cost)}),M===u.occurrence_id?(0,j.jsx)(v.default,{onPress:ve,children:(0,j.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.error})}):i&&(0,j.jsx)(v.default,{onPress:()=>xe(u),children:(0,j.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.mainColors.main})})]}),(0,j.jsxs)(r.default,{style:nn.breakdownItem,children:[(0,j.jsxs)(r.default,{style:nn.breakdownLabelContainer,children:[(0,j.jsxs)(r.default,{style:nn.rateNameAmountRow,children:[(0,j.jsxs)(a.default,{style:nn.breakdownLabel,children:["Base Rate (",u.unit_of_time||u.rates&&u.rates.unit_of_time||"Per Visit",")"]}),g||M===u.occurrence_id?(0,j.jsxs)(r.default,{style:nn.amountInputContainer,children:[(0,j.jsx)(a.default,{style:nn.currencySymbol,children:"$"}),(0,j.jsx)(te.default,{style:nn.rateInput,keyboardType:"decimal-pad",value:M===u.occurrence_id?R.base_rate?.toString()||"0":b?.base_rate?.toString()||"0",onChangeText:M===u.occurrence_id?e=>we("base_rate",e):e=>{(0,h.debugLog)("MBA2oinv5nd Base rate TextInput onChange called with value:",e),(e=>{const t=ue(e);(0,h.debugLog)("MBA2oinv5nd updateBaseRate called with value:",e,"sanitized to:",t),(0,h.debugLog)("MBA2oinv5nd Current editedRates before update:",b),x((e=>{const o=Object.assign({},e,{base_rate:t});return(0,h.debugLog)("MBA2oinv5nd New editedRates after base rate update:",o),o}))})(e)}})]}):null]}),!g&&M!==u.occurrence_id&&(0,j.jsxs)(a.default,{style:nn.breakdownCalculation,children:[u.multiple||1," \xd7 ",le(u.rates?.base_rate||0)," = ",le(u.base_total||u.rates?.base_rate||0)]})]}),!g&&M!==u.occurrence_id&&(0,j.jsx)(a.default,{style:nn.breakdownAmount,children:le(u.base_total||u.rates?.base_rate||0)})]}),u.rates?.additional_animal_rate&&parseFloat(u.rates.additional_animal_rate)>0&&u.rates?.applies_after&&u.rates.applies_after<(e.pets?.length||1)?(0,j.jsxs)(r.default,{style:nn.breakdownItem,children:[(0,j.jsxs)(r.default,{style:nn.breakdownLabelContainer,children:[(0,j.jsxs)(r.default,{style:nn.rateNameAmountRow,children:[(0,j.jsxs)(a.default,{style:nn.breakdownLabel,children:["Additional Pet Rate (after ",u.rates?.applies_after||1," ",1!==u.rates?.applies_after?"pets":"pet",")"]}),g||M===u.occurrence_id?(0,j.jsxs)(r.default,{style:nn.amountInputContainer,children:[(0,j.jsx)(a.default,{style:nn.currencySymbol,children:"$"}),(0,j.jsx)(te.default,{style:nn.rateInput,keyboardType:"decimal-pad",value:(()=>{const e=M===u.occurrence_id?R.additional_animal_rate?.toString()||"0":b?.additional_animal_rate?.toString()||"0";return(0,h.debugLog)("MBA2oinv5nd Additional animal rate TextInput value:",e,"using editingMode:",M===u.occurrence_id),e})(),onChangeText:M===u.occurrence_id?e=>we("additional_animal_rate",e):e=>{(0,h.debugLog)("MBA2oinv5nd Additional animal rate TextInput onChange called with value:",e),(e=>{const t=ue(e);(0,h.debugLog)("MBA2oinv5nd updateAdditionalAnimalRate called with value:",e,"sanitized to:",t),(0,h.debugLog)("MBA2oinv5nd Current editedRates before update:",b),x((e=>{const o=Object.assign({},e,{additional_animal_rate:t});return(0,h.debugLog)("MBA2oinv5nd New editedRates after additional animal rate update:",o),o}))})(e)}}),(0,j.jsxs)(a.default,{style:nn.inputLabel,children:[" / pet / ",u.unit_of_time||u.rates&&u.rates.unit_of_time||"Per Visit"]})]}):null]}),!g&&M!==u.occurrence_id&&(0,j.jsxs)(a.default,{style:nn.breakdownCalculation,children:[le(u.rates?.additional_animal_rate||0)," / pet / ",u.unit_of_time||u.rates&&u.rates.unit_of_time||"Per Visit"," \xd7 ",Math.max(0,(e.pets?.length||0)-(u.rates?.applies_after||1))," additional pets = ",le(u.rates?.additional_animal_rate_total||0)]})]}),!g&&M!==u.occurrence_id&&(0,j.jsxs)(a.default,{style:nn.breakdownAmount,children:[u.rates?.applies_after&&u.rates.applies_after<(e.pets?.length||0)?"+":"",u.rates?.applies_after&&u.rates.applies_after<(e.pets?.length||0)?le(u.rates?.additional_animal_rate_total||0):"NA"]})]}):null,u.rates?.holiday_rate&&u.rates?.holiday_days&&u.rates.holiday_days>0?(0,j.jsxs)(r.default,{style:[nn.breakdownItem,{borderBottomWidth:u.rates?.additional_rates?.length>0||p?1:0}],children:[(0,j.jsxs)(r.default,{style:nn.breakdownLabelContainer,children:[(0,j.jsxs)(r.default,{style:nn.rateNameAmountRow,children:[(0,j.jsx)(a.default,{style:nn.breakdownLabel,children:"Holiday Rate"}),g||M===u.occurrence_id?(0,j.jsxs)(r.default,{style:nn.amountInputContainer,children:[(0,j.jsx)(a.default,{style:nn.currencySymbol,children:"$"}),(0,j.jsx)(te.default,{style:nn.rateInput,keyboardType:"decimal-pad",value:M===u.occurrence_id?R.holiday_rate?.toString()||"0":b?.holiday_rate?.toString()||"0",onChangeText:M===u.occurrence_id?e=>we("holiday_rate",e):pe}),(0,j.jsxs)(a.default,{style:nn.inputLabel,children:[" \xd7 ",u.rates?.holiday_days||0," ",1!==u.rates?.holiday_days?"holidays":"holiday"]})]}):null]}),!g&&M!==u.occurrence_id&&(0,j.jsxs)(a.default,{style:nn.breakdownCalculation,children:[le(u.rates?.holiday_rate||0)," \xd7 ",u.rates?.holiday_days||0," ",1!==u.rates?.holiday_days?"holidays":"holiday"]})]}),!g&&M!==u.occurrence_id&&(0,j.jsxs)(a.default,{style:nn.breakdownAmount,children:[u.rates?.holiday_days?"+":"",u.rates?.holiday_days?le(u.rates?.holiday_rate_total||u.rates?.holiday_rate||0):"NA"]})]}):null,((g?b?.additional_rates:u.rates?.additional_rates)||[]).length>0?((g?b?.additional_rates:u.rates?.additional_rates)||[]).map(((e,t)=>(0,j.jsxs)(r.default,{style:nn.breakdownItem,children:[(0,j.jsx)(r.default,{style:nn.breakdownLabelContainer,children:g||M===u.occurrence_id?se<600?(0,j.jsxs)(r.default,{style:{width:"100%"},children:[(0,j.jsxs)(r.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,h.debugLog)("MBA66778 Rendering rate at index ".concat(t,":"),{isEditMode:g,editingOccurrenceId:M,occurrenceId:u.occurrence_id,rateName:e.name||e.title,rateAmount:e.amount,occurrenceEditsRate:R.additional_rates?.[t],valueToShow:M===u.occurrence_id?R.additional_rates&&R.additional_rates[t]?.amount?.toString()||"0":e.amount?.toString()||"0"}),(0,j.jsx)(te.default,{style:[nn.nameInput,{flex:1,marginRight:8}],value:je(u,t,"name"),onChangeText:e=>M===u.occurrence_id?Ce(t,"name",e):ye(t,"name",e),placeholder:"Rate Name"}),(0,j.jsx)(v.default,{style:nn.deleteButton,onPress:()=>M===u.occurrence_id?Se(u,t):be(t),children:(0,j.jsx)(S.default,{name:"trash-can-outline",size:22,color:m.theme.colors.error})})]}),(0,j.jsx)(r.default,{style:{marginTop:8},children:(0,j.jsxs)(r.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,j.jsx)(a.default,{style:{marginRight:8},children:"Amount: $"}),(0,j.jsx)(te.default,{style:{width:80,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,padding:8},keyboardType:"decimal-pad",value:""===je(u,t,"amount")?"":je(u,t,"amount").toString(),onChangeText:e=>M===u.occurrence_id?Ce(t,"amount",e):ye(t,"amount",e)})]})})]}):(0,j.jsxs)(r.default,{style:nn.editableAdditionalRateRow,children:[(0,j.jsxs)(r.default,{style:nn.rateNameAmountRowWithDelete,children:[(0,j.jsx)(te.default,{style:nn.nameInput,value:je(u,t,"name"),onChangeText:e=>M===u.occurrence_id?Ce(t,"name",e):ye(t,"name",e),placeholder:"Rate Name"}),(0,j.jsxs)(r.default,{style:nn.amountInputContainer,children:[(0,j.jsx)(a.default,{style:nn.currencySymbol,children:"$"}),(0,j.jsx)(te.default,{style:nn.rateInput,keyboardType:"decimal-pad",value:""===je(u,t,"amount")?"":je(u,t,"amount").toString(),onChangeText:e=>M===u.occurrence_id?Ce(t,"amount",e):ye(t,"amount",e)})]})]}),(0,j.jsx)(v.default,{style:nn.deleteButton,onPress:()=>M===u.occurrence_id?Se(u,t):be(t),children:(0,j.jsx)(S.default,{name:"trash-can-outline",size:22,color:m.theme.colors.error})})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(a.default,{style:nn.breakdownLabel,children:e.name||e.title}),(0,j.jsx)(a.default,{style:nn.breakdownCalculation,children:e.description||"Additional Rate"})]})}),!g&&M!==u.occurrence_id&&(0,j.jsxs)(a.default,{style:nn.breakdownAmount,children:["+",le(e.amount)]})]},t))):null,p?(0,j.jsxs)(r.default,{children:[(0,j.jsxs)(r.default,{style:nn.addRateContainer,children:[(0,j.jsx)(r.default,{style:nn.formDivider}),se<600?(0,j.jsxs)(r.default,{children:[(0,j.jsx)(te.default,{style:[nn.nameInput,{marginRight:0,marginBottom:12}],value:w.name,onChangeText:e=>C((t=>Object.assign({},t,{name:e}))),placeholder:"Rate Name",placeholderTextColor:m.theme.colors.placeHolderText}),(0,j.jsxs)(r.default,{style:[nn.amountInputContainer,{marginBottom:12}],children:[(0,j.jsx)(a.default,{style:nn.currencySymbol,children:"$"}),(0,j.jsx)(te.default,{style:nn.rateInput,keyboardType:"decimal-pad",value:w.amount,onChangeText:ge,placeholder:"0.00",placeholderTextColor:m.theme.colors.placeHolderText})]}),(0,j.jsx)(te.default,{style:nn.descriptionInput,value:w.description,onChangeText:e=>C((t=>Object.assign({},t,{description:e}))),placeholder:"Description (optional)",placeholderTextColor:m.theme.colors.placeHolderText})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(r.default,{style:nn.rateNameAmountRow,children:[(0,j.jsx)(te.default,{style:nn.nameInput,value:w.name,onChangeText:e=>C((t=>Object.assign({},t,{name:e}))),placeholder:"Rate Name",placeholderTextColor:m.theme.colors.placeHolderText}),(0,j.jsxs)(r.default,{style:nn.amountInputContainer,children:[(0,j.jsx)(a.default,{style:nn.currencySymbol,children:"$"}),(0,j.jsx)(te.default,{style:nn.rateInput,keyboardType:"decimal-pad",value:w.amount,onChangeText:ge,placeholder:"0.00",placeholderTextColor:m.theme.colors.placeHolderText})]})]}),(0,j.jsx)(te.default,{style:nn.descriptionInput,value:w.description,onChangeText:e=>C((t=>Object.assign({},t,{description:e}))),placeholder:"Description (optional)",placeholderTextColor:m.theme.colors.placeHolderText})]}),(0,j.jsx)(r.default,{style:nn.formDivider})]}),(0,j.jsxs)(r.default,{style:nn.buttonsContainer,children:[(0,j.jsx)(v.default,{style:nn.cancelButton,onPress:ce,children:(0,j.jsx)(a.default,{style:nn.cancelButtonText,children:"Cancel"})}),(0,j.jsx)(v.default,{style:nn.saveButton,onPress:fe,children:(0,j.jsx)(a.default,{style:nn.saveButtonText,children:"Save New Rate"})})]})]}):null,g&&!p&&(0,j.jsxs)(r.default,{style:nn.buttonsContainer,children:[(0,j.jsx)(v.default,{style:nn.cancelButton,onPress:ce,children:(0,j.jsx)(a.default,{style:nn.cancelButtonText,children:"+ Add Rate"})}),(0,j.jsx)(v.default,{style:nn.saveButton,onPress:he,children:(0,j.jsx)(a.default,{style:nn.saveButtonText,children:"Save Changes"})})]})]})})]})})(),(()=>{(0,h.debugLog)("MBA54321 Rendering total amount with data:",e?.cost_summary);const t=e?.cost_summary||{subtotal:0,client_platform_fee:0,pro_platform_fee:0,taxes:0,tax_state:"",total_client_cost:0,total_sitter_payout:0,pro_subscription_plan:0};return(0,j.jsxs)(r.default,{style:nn.section,children:[(0,j.jsx)(a.default,{style:nn.sectionHeader,children:"Cost Summary"}),(0,j.jsxs)(r.default,{style:[nn.card,{paddingTop:16}],children:[(0,j.jsxs)(r.default,{style:nn.subtotalRow,children:[(0,j.jsx)(a.default,{style:nn.subtotalLabel,children:"Subtotal"}),(0,j.jsx)(a.default,{style:nn.subtotalAmount,children:le(t.subtotal)})]}),(0,j.jsxs)(r.default,{style:nn.feeRow,children:[(0,j.jsx)(a.default,{style:nn.feeLabel,children:"Service Fee"}),(0,j.jsx)(a.default,{style:nn.feeAmount,children:le(t.client_platform_fee)})]}),(0,j.jsxs)(r.default,{style:nn.feeRow,children:[(0,j.jsxs)(a.default,{style:nn.feeLabel,children:[t.tax_state,t.tax_state?" - ":"","Taxes"]}),(0,j.jsx)(a.default,{style:nn.feeAmount,children:le(t.taxes)})]}),(0,j.jsxs)(r.default,{style:[nn.totalAmountContainer,{paddingBottom:s?16:0,marginBottom:s?16:0}],children:[(0,j.jsx)(a.default,{style:nn.totalLabel,children:"Total Owner Cost"}),(0,j.jsx)(a.default,{style:nn.totalAmount,children:le(t.total_client_cost)})]}),s?(0,j.jsx)(r.default,{style:nn.divider}):null,s?(0,j.jsxs)(r.default,{style:nn.payoutContainer,children:[(0,j.jsx)(a.default,{style:nn.payoutLabel,children:"Professional Payout"}),(0,j.jsx)(a.default,{style:nn.payoutAmount,children:le(t.total_sitter_payout)}),(0,j.jsxs)(a.default,{style:nn.payoutBreakdown,children:["(Subtotal ",le(t.subtotal)," - Service Fee ",le(t.pro_platform_fee),")"]}),0===t.pro_platform_fee?(0,j.jsxs)(a.default,{style:nn.badge,children:[0===t.pro_subscription_plan?"Free Tier - ":1===t.pro_subscription_plan?"Beta Tier - ":2===t.pro_subscription_plan?"Commission Tier - ":3===t.pro_subscription_plan||4===t.pro_subscription_plan?"Pro Subscription - ":5===t.pro_subscription_plan?"Client Subscription - ":""," Saved ",le(.15*t.subtotal)]}):null]}):null]})]})})(),(()=>{const e=!0===re||!0!==re&&W,t=!0===re;return(0,h.debugLog)("MBA54321: Checkbox state calculation:",{currentTosStatus:re,termsAgreed:W,isChecked:e,hasAgreedTos:t,fromApprovalModal:d}),t?(0,j.jsx)(r.default,{style:nn.termsContainer,children:(0,j.jsxs)(r.default,{style:nn.checkboxContainer,children:[(0,j.jsx)(r.default,{style:[nn.checkbox,nn.checkboxChecked],children:(0,j.jsx)(S.default,{name:"check",size:16,color:"white"})}),(0,j.jsxs)(a.default,{style:nn.termsText,children:[(0,j.jsx)(a.default,{style:nn.termsAgreedText,children:"TERMS AGREED"})," -"," ",(0,j.jsx)(a.default,{style:nn.termsLink,onPress:()=>ie(!0),children:"view terms of service"})]})]})}):(0,j.jsx)(r.default,{style:nn.termsContainer,children:(0,j.jsxs)(v.default,{style:nn.checkboxContainer,onPress:()=>{if(!0!==re){const e=!W;O(e),l&&l(e),c&&((0,h.debugLog)("MBA54321: Notifying parent of TOS agreement change:",{newValue:e,isProfessional:s,fromApprovalModal:d,currentTosStatus:re}),c(e))}},children:[(0,j.jsx)(r.default,{style:[nn.checkbox,e&&nn.checkboxChecked],children:e&&(0,j.jsx)(S.default,{name:"check",size:16,color:"white"})}),(0,j.jsxs)(a.default,{style:nn.termsText,children:["I agree to the"," ",(0,j.jsx)(a.default,{style:nn.termsLink,onPress:()=>ie(!0),children:"terms of service"})," ","for this booking"]})]})})})(),(0,j.jsx)(go,{size:"compact",showTitle:!1,style:{marginTop:16}})]}),(0,j.jsx)(Ro,{visible:ae,onClose:()=>ie(!1)})]})},an=i.default.create({termsModalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",padding:20},termsModalContent:{backgroundColor:m.theme.colors.background,borderRadius:12,padding:24,maxWidth:400,width:"100%",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:8,elevation:5},termsModalHeader:{flexDirection:"row",alignItems:"center",marginBottom:16},termsModalTitle:{fontSize:18,fontFamily:m.theme.fonts.header.fontFamily,color:m.theme.colors.text,marginLeft:8,flex:1},termsModalText:{fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,color:m.theme.colors.text,lineHeight:22,marginBottom:24},termsModalButton:{backgroundColor:m.theme.colors.mainColors.main,borderRadius:8,paddingVertical:12,paddingHorizontal:24,alignItems:"center"},termsModalButtonText:{color:"white",fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"}}),sn=({visible:e,onClose:t,actionType:o="booking"})=>{const n=(()=>{switch(o){case"booking":return{title:"Terms of Service Required",message:"You must agree to the terms of service before requesting a booking. Please scroll down and check the agreement box to continue."};case"approval":return{title:"Terms of Service Required",message:"You must agree to the terms of service before approving this booking. Please scroll down and check the agreement box to continue."};default:return{title:"Terms of Service Required",message:"You must agree to the terms of service before continuing. Please scroll down and check the agreement box to continue."}}})();return(0,j.jsx)(k.default,{visible:e,animationType:"fade",onRequestClose:t,transparent:!0,children:(0,j.jsx)(r.default,{style:an.termsModalOverlay,children:(0,j.jsxs)(r.default,{style:an.termsModalContent,children:[(0,j.jsxs)(r.default,{style:an.termsModalHeader,children:[(0,j.jsx)(S.default,{name:"alert-circle",size:24,color:m.theme.colors.error}),(0,j.jsx)(a.default,{style:an.termsModalTitle,children:n.title})]}),(0,j.jsx)(a.default,{style:an.termsModalText,children:n.message}),(0,j.jsx)(v.default,{style:an.termsModalButton,onPress:t,children:(0,j.jsx)(a.default,{style:an.termsModalButtonText,children:"OK"})})]})})})},ln=i.default.create({safeArea:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center"},container:{flex:1,backgroundColor:m.theme.colors.background,margin:0,borderRadius:12,overflow:"hidden"},desktopContainer:{maxWidth:800,maxHeight:"90%",alignSelf:"center"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,backgroundColor:m.theme.colors.surface},title:{fontSize:20,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},closeButton:{padding:8},scrollContainer:{flex:1},scrollContent:{padding:16,paddingBottom:32},footerContainer:{flexDirection:"row",justifyContent:"space-between",padding:16,borderTopWidth:1,borderTopColor:m.theme.colors.border,backgroundColor:m.theme.colors.surface},button:{paddingVertical:12,paddingHorizontal:16,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.primary,alignItems:"center",justifyContent:"center",flex:1,marginRight:8},buttonText:{color:m.theme.colors.primary,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},approveButton:{paddingVertical:12,paddingHorizontal:16,borderRadius:8,backgroundColor:m.theme.colors.primary,alignItems:"center",justifyContent:"center",flex:1,marginLeft:8},approveText:{color:"white",fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:24},loadingText:{marginTop:16,fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:24},errorText:{marginTop:16,fontSize:16,color:m.theme.colors.error,textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily},retryButton:{marginTop:16,paddingVertical:8,paddingHorizontal:16,backgroundColor:m.theme.colors.primary,borderRadius:8},retryButtonText:{color:"white",fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:24},emptyText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},section:{marginTop:24,marginHorizontal:16},sectionHeader:{fontSize:20,marginBottom:8,color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},card:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,padding:16,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},changeRequestContainer:{padding:16},changeRequestInput:{backgroundColor:m.theme.colors.background,borderColor:m.theme.colors.border,borderWidth:1,borderRadius:8,padding:12,fontSize:16,color:m.theme.colors.text,minHeight:120,textAlignVertical:"top",fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:16},buttonWrapper:{alignItems:"center",width:"100%"},changeRequestButtons:{flexDirection:"row",width:300,justifyContent:"space-between",alignItems:"center",marginTop:16},cancelRequestButton:{width:140,height:45,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:m.theme.colors.border||"#E0E0E0",borderRadius:8,backgroundColor:"white"},cancelRequestButtonText:{color:m.theme.colors.text||"#333333",fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},submitRequestButton:{width:140,height:45,alignItems:"center",justifyContent:"center",backgroundColor:m.theme.colors.olive||"#707855",borderRadius:8},submitRequestButtonText:{color:"white",fontSize:16,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},changeButton:{paddingVertical:12,paddingHorizontal:16,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.primary,alignItems:"center",justifyContent:"center",flex:1,marginLeft:8},shortenedContainer:{flex:0,backgroundColor:m.theme.colors.background,margin:0,borderRadius:12,overflow:"hidden",alignSelf:"center",width:"90%",maxWidth:500,minHeight:320}}),dn=({visible:e,onClose:t,bookingId:o,onApproveSuccess:i,onApproveError:s,onRequestChangesSuccess:l,onRequestChangesError:d,initialData:c=null,isProfessional:u=!0,modalTitle:g="Booking Approval Request",hideButtons:f=!1,isReadOnly:p=!1})=>{const{screenWidth:y}=(0,n.useContext)(h.AuthContext),b=y>768,x=c||{booking_id:o,service_type:"Loading...",pets:[],occurrences:[],cost_summary:{subtotal:0,client_platform_fee:0,pro_platform_fee:0,taxes:0,tax_state:"",total_client_cost:0,total_sitter_payout:0,pro_subscription_plan:0}},[w,C]=(0,n.useState)(x),[T,B]=(0,n.useState)(!1),[_,I]=(0,n.useState)("Loading booking details..."),[M,L]=(0,n.useState)(null),[R,D]=(0,n.useState)(""),[z,P]=(0,n.useState)(!1),[F,E]=(0,n.useState)(!1),[W,O]=(0,n.useState)(!1),N=(0,n.useRef)(x),H=(0,n.useRef)(!1);(0,n.useEffect)((()=>{e&&o&&U()}),[e,o]);(0,n.useEffect)((()=>{c&&!H.current&&(C(c),N.current=c)}),[c]),(0,n.useEffect)((()=>{const t=setInterval((()=>{if(e&&H.current){const e=!w||!w.occurrences||0===w.occurrences.length,t=N.current&&N.current.occurrences&&N.current.occurrences.length>0;e&&t&&((0,h.debugLog)("MBAio3htg5uohg: Detected that bookingData was cleared unexpectedly, restoring from cache"),C(Object.assign({},N.current)))}}),1e3);return()=>{clearInterval(t)}}),[e,w]);const U=async()=>{if(o)try{B(!0),L(null),I("Loading booking details..."),(0,h.debugLog)("MBAio3htg5uohg: Fetching booking details for ID:",o);const e=await(0,bt.getBookingDetails)(o);(0,h.debugLog)("MBAio3htg5uohg: Booking details fetched:",e);const t=Object.assign({},e,{occurrences:e.occurrences||[],pets:e.pets||[],cost_summary:e.cost_summary||{subtotal:0,client_platform_fee:0,pro_platform_fee:0,taxes:0,tax_state:"",total_client_cost:0,total_sitter_payout:0,pro_subscription_plan:0},service_type:e.service_type||"N/A"});0===t.occurrences.length?t.occurrences=[{occurrence_id:"0",start_date:(new Date).toISOString().split("T")[0],end_date:(new Date).toISOString().split("T")[0],start_time:"09:00",end_time:"17:00",unit_of_time:"visit",multiple:1,base_total:0,rates:{base_rate:0,additional_animal_rate:0,applies_after:1,holiday_rate:0,holiday_days:0,additional_rates:[]}}]:t.occurrences=t.occurrences.map((e=>((0,h.debugLog)("MBAio3htg5uohg: Processing occurrence:",{id:e.occurrence_id,unit_of_time:e.unit_of_time,multiple:e.multiple}),Object.assign({},e,{unit_of_time:e.unit_of_time||"visit",multiple:parseFloat(e.multiple)||1,base_total:e.base_total||0,rates:e.rates||{base_rate:0,additional_animal_rate:0,applies_after:1,holiday_rate:0,holiday_days:0,additional_rates:[]}})))),C(t),N.current=t,H.current=!0,(0,h.debugLog)("MBAio3htg5uohg: Booking data processed and stored")}catch(e){(0,h.debugLog)("MBAio3htg5uohg: Error fetching booking details:",e),L("Failed to load booking details. Please try again.")}finally{B(!1)}};(0,n.useEffect)((()=>{if(H.current){const e=!w||!w.occurrences||0===w.occurrences.length,t=N.current&&N.current.occurrences&&N.current.occurrences.length>0;e&&t&&((0,h.debugLog)("MBAio3htg5uohg: Booking data was cleared unexpectedly, restoring from cache"),C(N.current))}}),[w]);const V=async()=>{const e=u?w?.pro_agreed_tos:w?.client_agreed_tos,n=e||F;if((0,h.debugLog)("MBA4321: TOS check for approval:",{isProfessional:u,existingTosAgreed:e,userTosAgreed:F,currentTosAgreed:n}),n)try{B(!0),I("Approving booking..."),L(null);let e=!1;if(!u){const t=w?.client_agreed_tos||F;e=t,(0,h.debugLog)("MBA4321: Client TOS agreement for approval:",{bookingDataClientAgreedTos:w?.client_agreed_tos,userTosAgreed:F,clientHasAgreedTos:t,tosValueToSend:e})}const n=await(0,bt.approveBooking)(o,e);i&&i(n),t()}catch(r){(0,h.debugLog)("MBA77788 Error approving booking:",r),L("Failed to approve booking. Please try again."),s&&s(r.response?.data?.error||"Failed to approve booking")}finally{B(!1)}else O(!0)},q=()=>{P(!0)},Y=()=>{P(!1),D("")},G=async()=>{if(R.trim())try{B(!0),I("Submitting change request..."),L(null);const e=await(0,bt.requestBookingChanges)(o,R);l&&((0,h.debugLog)("MBA77788 Notifying parent of successful change request submission"),l(e)),t()}catch(e){(0,h.debugLog)("MBA77788 Error requesting booking changes:",e),L("Failed to submit change request. Please try again."),d&&d(e.response?.data?.error||"Failed to submit change request")}finally{B(!1)}else L("Please provide details about your requested changes.")},J=()=>{P(!1),D(""),t()};return(0,j.jsxs)(k.default,{visible:e,transparent:!0,animationType:"slide",onRequestClose:J,children:[(0,j.jsx)(He.default,{style:ln.safeArea,children:(0,j.jsxs)(r.default,{style:[ln.container,b?ln.desktopContainer:{},z?ln.shortenedContainer:{}],children:[(0,j.jsxs)(r.default,{style:ln.header,children:[(0,j.jsx)(a.default,{style:ln.title,children:p?"Booking Details":g}),(0,j.jsx)(v.default,{style:ln.closeButton,onPress:J,children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),z?(0,j.jsxs)(r.default,{style:ln.changeRequestContainer,children:[(0,j.jsx)(te.default,{style:ln.changeRequestInput,placeholder:"Enter details about your requested changes...",value:R,onChangeText:D,multiline:!0,numberOfLines:3,placeholderTextColor:m.theme.colors.placeHolderText}),(0,j.jsx)(r.default,{style:ln.buttonWrapper,children:(0,j.jsxs)(r.default,{style:ln.changeRequestButtons,children:[(0,j.jsx)(v.default,{style:ln.cancelRequestButton,onPress:Y,children:(0,j.jsx)(a.default,{style:ln.cancelRequestButtonText,children:"Cancel"})}),(0,j.jsx)(v.default,{style:ln.submitRequestButton,onPress:G,disabled:!R.trim(),children:(0,j.jsx)(a.default,{style:ln.submitRequestButtonText,children:"Request Changes"})})]})})]}):(0,j.jsx)(X.default,{style:ln.scrollContainer,contentContainerStyle:ln.scrollContent,children:T?(0,j.jsxs)(r.default,{style:ln.loadingContainer,children:[(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:ln.loadingText,children:_})]}):M?(0,j.jsxs)(r.default,{style:ln.errorContainer,children:[(0,j.jsx)(S.default,{name:"alert-circle",size:48,color:m.theme.colors.error}),(0,j.jsx)(a.default,{style:ln.errorText,children:M}),(0,j.jsx)(v.default,{style:ln.retryButton,onPress:U,children:(0,j.jsx)(a.default,{style:ln.retryButtonText,children:"Retry"})})]}):w?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(on,{isProfessional:u,fromApprovalModal:!1}),w&&(0,j.jsx)(rn,{bookingData:w,bookingId:o,onRatesUpdate:e=>C(e),showEditControls:!1,isProfessional:u,fromApprovalModal:!0,onTosAgreementChange:E})]}):(0,j.jsx)(r.default,{style:ln.emptyContainer,children:(0,j.jsx)(a.default,{style:ln.emptyText,children:"No booking data available"})})}),!z&&(()=>{if(f)return null;if(p)return(0,j.jsx)(r.default,{style:ln.footerContainer,children:(0,j.jsx)(v.default,{style:[ln.button,ln.closeButton],onPress:J,children:(0,j.jsx)(a.default,{style:ln.buttonText,children:"Close"})})});if(z)return null;if(u)return(0,j.jsx)(r.default,{style:ln.footerContainer,children:(0,j.jsx)(v.default,{style:[ln.button,ln.closeButton],onPress:J,children:(0,j.jsx)(a.default,{style:ln.buttonText,children:"Close"})})});{const e="Booking Update"===g;return(0,j.jsxs)(r.default,{style:ln.footerContainer,children:[(0,j.jsx)(v.default,{style:[ln.button,ln.closeButton],onPress:J,children:(0,j.jsx)(a.default,{style:ln.buttonText,children:"Close"})}),(0,j.jsx)(v.default,{style:[ln.button,ln.changeButton],onPress:q,children:(0,j.jsx)(a.default,{style:ln.buttonText,children:"Request Changes"})}),(0,j.jsx)(v.default,{style:[ln.button,ln.approveButton],onPress:V,children:(0,j.jsx)(a.default,{style:ln.approveText,children:e?"Approve Update":"Approve"})})]})}})()]})}),(0,j.jsx)(sn,{visible:W,onClose:()=>O(!1),actionType:"approval"})]})},{width:cn,height:un}=C.default.get("window"),gn=i.default.create({mainContainer:{flex:1,height:"100vh",backgroundColor:"#f5f5f5",position:"fixed",top:0,right:0,bottom:0,left:0,overflow:"hidden"},scrollView:{flex:1,height:"100%",overflow:"auto"},scrollViewContent:{width:"100%",paddingBottom:40},headerContainer:{padding:24,paddingTop:24,flexDirection:"row",justifyContent:"flex-end",alignItems:"center"},headerRight:{flexDirection:"row",alignItems:"center",gap:16},notificationButton:{position:"relative",padding:8},notificationBadge:{position:"absolute",top:4,right:4,backgroundColor:m.theme.colors.error,borderRadius:10,minWidth:20,height:20,justifyContent:"center",alignItems:"center"},notificationCount:{color:m.theme.colors.whiteText,fontSize:12,fontWeight:"bold"},profileButton:{borderRadius:20,overflow:"hidden"},welcomeSection:{padding:24},welcomeContent:{maxWidth:1200,marginHorizontal:"auto",width:"100%"},welcomeCard:{backgroundImage:"linear-gradient(to right, #6B6C53, #86C5D9)",borderRadius:12,padding:24,marginBottom:24},welcomeHeader:{flexDirection:"row",flexWrap:"wrap"},welcomeTextContainer:{flex:1,minWidth:280},statsContainer:{padding:24,paddingTop:0,backgroundColor:"#f5f5f5"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:24,maxWidth:1200,marginHorizontal:"auto",width:"100%"},statCard:Object.assign({backgroundColor:m.theme.colors.surface,padding:16,borderRadius:12,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},void 0),statHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:12},statIconContainer:{width:48,height:48,borderRadius:12,justifyContent:"center",alignItems:"center"},bookingsContainer:{padding:24,paddingTop:0,backgroundColor:"#f5f5f5",maxWidth:1200,marginHorizontal:"auto",width:"100%"},bookingItem:{marginBottom:16,backgroundColor:m.theme.colors.surface,borderRadius:8,padding:16,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},bookingContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},bookingInfo:{flexDirection:"row",alignItems:"center",flex:1},bookingDetails:{marginLeft:12},bookingTitle:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,marginBottom:4},bookingTime:{fontSize:14,color:m.theme.colors.textSecondary},bookingStatus:{alignItems:"flex-end"},statusText:{fontSize:14,fontWeight:"500",marginBottom:8},progressBar:{width:100,height:4,backgroundColor:m.theme.colors.border,borderRadius:2,overflow:"hidden"},progress:{height:"100%",backgroundColor:m.theme.colors.primary},timeLeft:{fontSize:12,color:m.theme.colors.textSecondary,marginTop:4},emptyStateContainer:{padding:40,alignItems:"center",backgroundColor:m.theme.colors.surface,borderRadius:8,marginBottom:24},emptyStateTitle:{fontSize:m.theme.fontSizes.large,color:m.theme.colors.text,fontWeight:"600",marginTop:16,marginBottom:8,fontFamily:m.theme.fonts.header.fontFamily},emptyStateText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.textSecondary,textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:24},createServiceButton:{flexDirection:"row",alignItems:"center",backgroundColor:"#6B6C53",paddingVertical:12,paddingHorizontal:20,borderRadius:8,gap:8},createServiceButtonText:{color:m.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},filterContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16,paddingHorizontal:24,paddingVertical:8,borderRadius:30},filterButtons:{flexDirection:"row",backgroundColor:"rgb(238, 241, 245)",padding:4,borderRadius:5},filterButton:{paddingHorizontal:20,paddingVertical:10,borderRadius:5},activeFilterButton:{backgroundColor:m.theme.colors.surface,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:3,elevation:2},filterText:{color:"#6B7280",fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},activeFilterText:{color:"#111827",fontWeight:"600"},viewAllButton:{flexDirection:"row",alignItems:"center",gap:4,paddingRight:12},viewAllText:{color:m.theme.colors.primary,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},servicesContainer:{padding:24,paddingTop:0,paddingBottom:70},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},servicesGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:16},serviceCard:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:20,marginBottom:16,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:3,elevation:2,justifyContent:"space-between"},serviceContent:{marginBottom:20},serviceHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",marginBottom:4},serviceTitle:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily,maxWidth:"50%"},serviceCategory:{fontSize:14,color:m.theme.colors.textSecondary,fontFamily:m.theme.fonts.regular.fontFamily},serviceFooter:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},bookingsCount:{flexDirection:"row",alignItems:"center",gap:6},bookingsText:{fontSize:14,color:m.theme.colors.textSecondary,fontFamily:m.theme.fonts.regular.fontFamily},serviceRate:{fontSize:16,color:"#6B6C53",fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},viewButton:{paddingVertical:8,paddingHorizontal:16,borderRadius:6,backgroundColor:m.theme.colors.surface,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.05,shadowRadius:2,elevation:1},viewButtonText:{color:m.theme.colors.text,fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily}}),mn=({navigation:e})=>{const{colors:t}=(0,ne.useTheme)(),{signOut:o,firstName:i,is_prototype:s,screenWidth:l,is_DEBUG:d,isSignedIn:c,isCollapsed:u,userRole:f}=(0,n.useContext)(h.AuthContext),{isVisible:p,currentStep:y,totalSteps:x,stepData:w,handleNext:C,handlePrevious:T,handleSkip:k,completeTutorial:A}=(0,n.useContext)(M),_=E(),[I,L]=(0,n.useState)([]),[R,D]=(0,n.useState)([]),[z,P]=(0,n.useState)(!0),[F,W]=(0,n.useState)("upcoming"),[O,N]=(0,n.useState)({profile_complete:0,has_bank_account:!1,has_services:!1,subscription_plan:0}),[U,V]=(0,n.useState)(!1),[q,Y]=(0,n.useState)(null),G=l>900,J=l<=900,$="professional"===f,K=I.filter((e=>{const t=new Date;let o=null;if(e.start_date)try{if(o=new Date(e.start_date),isNaN(o.getTime()))return(0,h.debugLog)("MBA5677: Invalid booking date",e.start_date),!1}catch(zs){return(0,h.debugLog)("MBA5677: Error parsing booking date",{date:e.start_date,error:zs}),!1}switch((0,h.debugLog)("MBA5677: Filtering booking",{id:e.booking_id||e.id,date:e.start_date||e.date,parsedDate:o?o.toISOString():null,now:t.toISOString(),filter:F}),F){case"upcoming":return o&&o>t;case"active":return o&&o<=t&&!e.completed;case"past":return o&&o<t&&e.completed;default:return!0}})),Z=($||K.slice(0,3),{welcomeTitle:{fontSize:G?32:24,fontWeight:"600",color:m.theme.colors.whiteText,fontFamily:m.theme.fonts.header.fontFamily},bookingCount:{fontSize:G?16:14,color:m.theme.colors.whiteText,fontFamily:m.theme.fonts.regular.fontFamily,opacity:.8,marginTop:12},statValue:{fontSize:G?20:16,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},statLabel:{fontSize:G?16:14,color:m.theme.colors.textSecondary,fontFamily:m.theme.fonts.regular.fontFamily,marginTop:4},statChange:{fontSize:G?14:12,fontFamily:m.theme.fonts.regular.fontFamily,marginTop:4},sectionTitle:{fontSize:G?20:18,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily,marginBottom:16,marginTop:24}}),Q=async()=>{if(s){const e=[{service_name:"Dog Walking",description:"Professional dog walking service",unit_of_time:"30 minutes",base_rate:25,additional_animal_rate:10,holiday_rate:35,additional_rates:[]}];return L([{id:"56782",owner:"John Doe",pet:"Max (Dog)",date:"2023-05-15",time:"14:00",status:"upcoming"},{id:"5678",owner:"Jane Smith",pet:"Whiskers (Cat)",date:"2023-05-17",time:"10:00",status:"active"}]),D(e),N({profile_complete:.5,has_bank_account:!1,has_services:!0,subscription_plan:0}),void P(!1)}try{P(!0);const e=$?await(0,bt.getProfessionalDashboard)():await(0,bt.getClientDashboard)();if((0,h.debugLog)("MBA5677: Dashboard response data",e),e&&e.upcoming_bookings&&e.upcoming_bookings.length>0){const t=e.upcoming_bookings[0];(0,h.debugLog)("MBA5677: First booking complete structure",t),(0,h.debugLog)("MBA5677: First booking keys",Object.keys(t)),(0,h.debugLog)("MBA5677: First booking client_name field",{client_name:t.client_name,owner_name:t.owner_name,client_name_exists:"client_name"in t})}const t=(e.upcoming_bookings||[]).map((e=>{if((0,h.debugLog)("MBA5677: Processing booking",e),!e)return(0,h.debugLog)("MBA5677: Null booking received"),null;let t=e.start_date;return t&&t.includes(" ")&&(t=t.split(" ")[0]),Object.assign({},e,{start_date:t,client_name:e.client_name||e.owner_name})})).filter((e=>null!==e));if((0,h.debugLog)("MBA5677: Processed bookings",t),L(t),N(e.onboarding_progress||{profile_complete:0,has_bank_account:!1,has_services:!1,subscription_plan:0}),$)try{const e=await(0,bt.getProfessionalServices)();D(e||[])}catch(zs){console.error("Error fetching professional services:",zs)}}catch(zs){console.error("Error fetching dashboard data:",zs),401!==zs.response?.status&&(0,h.debugLog)("MBA5677: Non-auth error in dashboard fetch:",zs)}finally{P(!1)}};(0,n.useEffect)((()=>{Q()}),[f,s]),(0,b.useFocusEffect)((0,n.useCallback)((()=>((0,h.debugLog)("MBA5677: Dashboard screen focused, refreshing data"),Q(),()=>{})),[f,s])),(0,n.useEffect)((()=>{if(!z&&I.length>0){const e=new Date,t=I.some((t=>{try{const o=t.start_date?new Date(t.start_date):null;return o&&o<=e&&!t.completed}catch(zs){return!1}}));(0,h.debugLog)("MBA5677: Checking for active bookings",{hasActiveBookings:t,bookingsCount:I.length,currentActiveFilter:F}),t&&"active"!==F&&((0,h.debugLog)("MBA5677: Setting active filter to 'active' due to active bookings"),W("active"))}}),[I,z]);return(0,j.jsxs)(r.default,{style:gn.mainContainer,children:[(0,j.jsxs)(X.default,{style:[gn.scrollView,{marginLeft:!J&&c?u?70:250:0,marginTop:J?60:0}],contentContainerStyle:[gn.scrollViewContent,{maxWidth:1200,marginHorizontal:"auto",paddingTop:J?24:0}],children:[(0,j.jsx)(r.default,{style:gn.welcomeSection,children:(0,j.jsx)(r.default,{style:gn.welcomeContent,children:(0,j.jsx)(r.default,{style:gn.welcomeCard,children:(0,j.jsx)(r.default,{style:gn.welcomeHeader,children:(0,j.jsxs)(r.default,{style:gn.welcomeTextContainer,children:[(0,j.jsxs)(a.default,{style:Z.welcomeTitle,children:["Welcome back",i?", "+i:"","! \ud83d\udc4b"]}),(0,j.jsxs)(a.default,{style:Z.bookingCount,children:["You have ",I.filter((e=>!e.completed)).length," active bookings today and ",I.filter((e=>new Date(e.start_date)>new Date)).length," upcoming appointments."]})]})})})})}),(0,j.jsx)(r.default,{style:gn.statsContainer,children:(0,j.jsx)(r.default,{style:gn.statsGrid,children:$?(0,j.jsxs)(j.Fragment,{children:[O.profile_complete<1&&(0,j.jsxs)(v.default,{style:gn.statCard,onPress:()=>(0,g.navigateToFrom)(e,"MyProfile","Dashboard",{initialTab:"profile_info"}),children:[(0,j.jsxs)(r.default,{style:gn.statHeader,children:[(0,j.jsx)(r.default,{style:[gn.statIconContainer,{backgroundColor:"#F0F9E5"}],children:(0,j.jsx)(S.default,{name:"account-check",size:24,color:m.theme.colors.primary})}),(0,j.jsxs)(a.default,{style:[Z.statChange,{color:1===O.profile_complete?m.theme.colors.success:m.theme.colors.warning}],children:[Math.round(100*O.profile_complete),"% Complete"]})]}),(0,j.jsx)(a.default,{style:Z.statValue,children:"Profile"}),(0,j.jsx)(a.default,{style:Z.statLabel,children:"Add an address to get clients"})]}),!O.has_services&&(0,j.jsxs)(v.default,{style:gn.statCard,onPress:()=>(0,g.navigateToFrom)(e,"ServiceManager","Dashboard"),children:[(0,j.jsxs)(r.default,{style:gn.statHeader,children:[(0,j.jsx)(r.default,{style:[gn.statIconContainer,{backgroundColor:"#FEF0DA"}],children:(0,j.jsx)(S.default,{name:"briefcase",size:24,color:m.theme.colors.primary})}),(0,j.jsx)(a.default,{style:[Z.statChange,{color:O.has_services?m.theme.colors.success:m.theme.colors.warning}],children:O.has_services?"Active":"No Services"})]}),(0,j.jsx)(a.default,{style:Z.statValue,children:"Services"}),(0,j.jsx)(a.default,{style:Z.statLabel,children:"Add services to start accepting bookings"})]})]}):(0,j.jsxs)(j.Fragment,{children:[!O.marked_noreply_as_not_spam&&(0,j.jsxs)(r.default,{style:gn.statCard,children:[(0,j.jsxs)(r.default,{style:gn.statHeader,children:[(0,j.jsx)(r.default,{style:[gn.statIconContainer,{backgroundColor:"#FEF0DA"}],children:(0,j.jsx)(S.default,{name:"email",size:24,color:m.theme.colors.primary})}),(0,j.jsx)(v.default,{onPress:async()=>{try{const e=await(0,bt.markNoreplyAsNotSpam)();e&&((0,h.debugLog)("MBA5677: Marked noreply as not spam",e),N((e=>Object.assign({},e,{marked_noreply_as_not_spam:!0}))),_({message:"Success! You have marked our email as not spam and will receive emails about bookings and messages.",type:"success",duration:4e3}))}catch(zs){(0,h.debugLog)("MBA5677: Error marking noreply as not spam",zs),_({message:"Failed to mark email as not spam. Please try again.",type:"error",duration:4e3})}},children:(0,j.jsx)(S.default,{name:"close-circle",size:24,color:m.theme.colors.error})})]}),(0,j.jsx)(a.default,{style:Z.statValue,children:"Mark our email as not spam"}),(0,j.jsx)(a.default,{style:Z.statLabel,children:"We send you emails about your bookings/messsages and other important updates"})]}),O.profile_complete<1&&(0,j.jsxs)(v.default,{style:gn.statCard,onPress:()=>(0,g.navigateToFrom)(e,"MyProfile","Dashboard",{initialTab:"profile_info"}),children:[(0,j.jsxs)(r.default,{style:gn.statHeader,children:[(0,j.jsx)(r.default,{style:[gn.statIconContainer,{backgroundColor:"#F0F9E5"}],children:(0,j.jsx)(S.default,{name:"account-check",size:24,color:m.theme.colors.primary})}),(0,j.jsxs)(a.default,{style:[Z.statChange,{color:1===O.profile_complete?m.theme.colors.success:m.theme.colors.warning}],children:[Math.round(100*O.profile_complete),"% Complete"]})]}),(0,j.jsx)(a.default,{style:Z.statValue,children:"Profile"}),(0,j.jsx)(a.default,{style:Z.statLabel,children:"Add an address to find professionals"})]}),!O.has_pets&&(0,j.jsxs)(v.default,{style:gn.statCard,onPress:()=>(0,g.navigateToFrom)(e,"MyProfile","Dashboard",{initialTab:"pets_preferences"}),children:[(0,j.jsxs)(r.default,{style:gn.statHeader,children:[(0,j.jsx)(r.default,{style:[gn.statIconContainer,{backgroundColor:"#FEF0DA"}],children:(0,j.jsx)(S.default,{name:"paw",size:24,color:m.theme.colors.primary})}),(0,j.jsx)(a.default,{style:[Z.statChange,{color:O.has_pets?m.theme.colors.success:m.theme.colors.warning}],children:O.has_pets?"Added":"No Pets"})]}),(0,j.jsx)(a.default,{style:Z.statValue,children:"Pets"}),(0,j.jsx)(a.default,{style:Z.statLabel,children:"Add your pets to book services"})]})]})})}),(0,j.jsx)(r.default,{style:gn.filterContainer,children:(0,j.jsx)(r.default,{style:gn.filterButtons,children:["upcoming","active"].map((e=>(0,j.jsx)(v.default,{style:[gn.filterButton,F===e&&gn.activeFilterButton],onPress:()=>W(e),children:(0,j.jsx)(a.default,{style:[gn.filterText,F===e&&gn.activeFilterText],children:e.charAt(0).toUpperCase()+e.slice(1)})},e)))})}),(0,j.jsx)(r.default,{style:gn.bookingsContainer,children:z?(0,j.jsx)(r.default,{style:gn.loadingContainer,children:(0,j.jsx)(H.default,{size:"small",color:t.primary})}):K.length>0?K.map((e=>{(0,h.debugLog)("MBA5677: Rendering booking",{id:s?e.id:e.booking_id,date:s?e.date:e.start_date,time:s?e.time:e.start_time,client_name:s?e.owner:e.client_name,professional_name:s?e.professional:e.professional_name,status:e.status,client_profile_picture:e.client_profile_picture,professional_profile_picture:e.professional_profile_picture});const t=s?e.id:e.booking_id;let o;return $?(o=s?e.owner:e.client_name||e.owner_name||"Client",(0,h.debugLog)("MBA5677: Using client name",o)):(o=s?e.professional:e.professional_name||"Professional",(0,h.debugLog)("MBA5677: Using professional name",o)),(0,j.jsx)(en,{booking:{id:t,client_name:$?o:null,professional_name:$?null:o,client_profile_picture:$?e.client_profile_picture:null,professional_profile_picture:$?null:e.professional_profile_picture,serviceName:s?e.service:e.service_type,date:s?e.date:e.start_date,time:s?e.time:e.start_time,status:e.status,pets:s?[{name:e.pet}]:e.pets},type:$?"professional":"client",onViewDetails:()=>(e=>{Y(e),V(!0),(0,h.debugLog)("MBA5677: Opening booking modal for ID:",e)})(t)},t)})):(0,j.jsxs)(r.default,{style:gn.emptyStateContainer,children:[(0,j.jsx)(S.default,{name:"calendar",size:48,color:m.theme.colors.textSecondary}),(0,j.jsxs)(a.default,{style:gn.emptyStateTitle,children:["No ",F," bookings"]}),(0,j.jsx)(a.default,{style:gn.emptyStateText,children:$?"Create services to start receiving bookings from owners.":"Find professional services to book your first appointment."}),(0,j.jsxs)(v.default,{style:gn.createServiceButton,onPress:()=>(0,g.navigateToFrom)(e,$?"ServiceManager":"SearchProfessionalsListing","Dashboard"),children:[(0,j.jsx)(S.default,{name:$?"plus":"magnify",size:20,color:m.theme.colors.surface}),(0,j.jsx)(a.default,{style:gn.createServiceButtonText,children:$?"Create Service":"Find Professionals"})]})]})}),$?(0,j.jsxs)(r.default,{style:gn.servicesContainer,children:[(0,j.jsxs)(r.default,{style:gn.sectionHeader,children:[(0,j.jsx)(a.default,{style:Z.sectionTitle,children:"My Services"}),(0,j.jsxs)(v.default,{style:gn.viewAllButton,onPress:()=>(0,g.navigateToFrom)(e,"ServiceManager","Dashboard"),children:[(0,j.jsx)(a.default,{style:gn.viewAllText,children:"View All"}),(0,j.jsx)(S.default,{name:"chevron-right",size:20,color:m.theme.colors.primary})]})]}),(0,j.jsx)(r.default,{style:gn.servicesGrid,children:R.map((t=>(t=>(0,j.jsxs)(r.default,{style:gn.serviceCard,children:[(0,j.jsxs)(r.default,{style:gn.serviceContent,children:[(0,j.jsxs)(r.default,{style:gn.serviceHeader,children:[(0,j.jsx)(a.default,{style:gn.serviceTitle,numberOfLines:1,ellipsizeMode:"tail",children:t.service_name}),(0,j.jsxs)(a.default,{style:gn.serviceRate,children:["$",t.base_rate," ",t.unit_of_time||"Per Visit"]})]}),(0,j.jsx)(a.default,{style:gn.serviceCategory,children:t.category||"Exotic"})]}),(0,j.jsx)(r.default,{style:gn.serviceFooter,children:(0,j.jsx)(v.default,{style:gn.viewButton,onPress:()=>(0,g.navigateToFrom)(e,"ServiceManager","Dashboard",{serviceId:t.id}),children:(0,j.jsx)(a.default,{style:gn.viewButtonText,children:"View"})})})]},t.id))(t)))})]}):null]}),(0,j.jsx)(dn,{visible:U,onClose:()=>{V(!1),Y(null)},bookingId:q,isProfessional:$,modalTitle:"Review Details",hideButtons:!0}),p&&"Dashboard"===w?.screen&&(0,j.jsx)(B,{step:y,totalSteps:x,title:w.title,description:w.description,position:w.position,onNext:()=>C(e),onPrevious:T,onSkip:k,onClose:A})]})},hn=({navigation:e})=>{const{width:t}=(0,Ne.default)(),{screenWidth:o,isCollapsed:s,is_DEBUG:l}=(0,n.useContext)(h.AuthContext),[d,c]=(0,n.useState)(o<=900),[u,f]=(0,n.useState)({dog:!1,cat:!1,exotics:!1}),[p,y]=(0,n.useState)(""),[b,x]=(0,n.useState)([]),[w,C]=(0,n.useState)([]),[T,B]=(0,n.useState)(!1);(0,n.useEffect)((()=>{c(o<=900)}),[o]),(0,n.useEffect)((()=>{(async()=>{const t=sessionStorage.getItem("currentRoute");"BecomeProfessional"!==t?await(0,g.navigateToFrom)(e,"BecomeProfessional",t):l&&console.log("Error, currentRoute is BecomeProfessional")})()}),[]);const k=(e,t)=>i.default.create({mainContainer:{flex:1,backgroundColor:m.theme.colors.background,height:"100vh",overflow:"hidden",position:"fixed",top:0,left:0,right:0,bottom:0,marginLeft:e>900?t?70:250:0,transition:"margin-left 0.3s ease"},container:{flex:1,backgroundColor:m.theme.colors.background,paddingTop:0},scrollContent:{flexGrow:1,padding:e<=900?16:20,width:e>900?"60%":"90%",maxWidth:800,alignSelf:"center"},header:{flexDirection:"row",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,display:e<=900?"flex":"none"},backButton:{marginRight:16},headerText:{fontSize:20,fontWeight:"bold",color:m.theme.colors.primary},title:{fontSize:e<=900?24:32,color:m.theme.colors.text,textAlign:"center",marginBottom:e<=900?16:24,fontFamily:m.theme.fonts.header.fontFamily},label:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginBottom:e<=900?8:12,fontFamily:m.theme.fonts.regular.fontFamily},checkboxContainer:{flexDirection:"row",flexWrap:"wrap",justifyContent:e<=900?"space-between":"flex-start",gap:e<=900?8:16,marginBottom:e<=900?16:24},petButton:{flexDirection:"row",alignItems:"center",padding:e<=900?8:12,borderWidth:1,borderColor:m.theme.colors.primary,borderRadius:8,backgroundColor:m.theme.colors.surface,minWidth:e<=900?"45%":150},selectedPetButton:{backgroundColor:m.theme.colors.primary},petButtonText:{marginLeft:8,color:m.theme.colors.primary,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},selectedPetButtonText:{color:m.theme.colors.surface},textInput:{borderColor:m.theme.colors.border,borderWidth:1,borderRadius:8,padding:e<=900?12:16,marginBottom:e<=900?16:24,backgroundColor:m.theme.colors.inputBackground,minHeight:120,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},uploadButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:e<=900?12:16,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,borderStyle:"dashed",marginBottom:e<=900?12:16},uploadText:{marginLeft:8,color:m.theme.colors.text,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},uploadedFileContainer:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surfaceVariant,padding:e<=900?8:12,borderRadius:8,marginBottom:8},uploadedFilePreview:{width:40,height:40,borderRadius:4,marginRight:8},certificationText:{flex:1,fontSize:m.theme.fontSizes.small,color:m.theme.colors.text,marginRight:8,fontFamily:m.theme.fonts.regular.fontFamily},removeFileButton:{padding:4},submitButton:{backgroundColor:m.theme.colors.primary,padding:e<=900?12:16,borderRadius:8,alignItems:"center",marginTop:e<=900?20:32},submitButtonDisabled:{opacity:.6},submitButtonText:{color:m.theme.colors.surface,fontSize:m.theme.fontSizes.medium,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},loadingIndicator:{marginTop:16},formContainer:{width:"100%"}});return(0,j.jsx)(r.default,{style:k(o,s).mainContainer,children:(0,j.jsxs)(He.default,{style:k(o,s).container,children:[d&&(0,j.jsxs)(r.default,{style:k(o,s).header,children:[(0,j.jsx)(v.default,{onPress:()=>{(0,g.handleBack)(e)},style:k(o,s).backButton,children:(0,j.jsx)(S.default,{name:"arrow-left",size:24,color:m.theme.colors.primary})}),(0,j.jsx)(a.default,{style:k(o,s).headerText,children:"Become a Professional"})]}),(0,j.jsx)(X.default,{contentContainerStyle:k(o,s).scrollContent,children:(0,j.jsxs)(r.default,{style:k(o,s).formContainer,children:[(0,j.jsx)(a.default,{style:k(o,s).title,children:"Become a Professional"}),(0,j.jsx)(a.default,{style:k(o,s).label,children:"Select Pets You Can Sit:"}),(0,j.jsx)(r.default,{style:k(o,s).checkboxContainer,children:["dog","cat","exotics"].map((e=>(0,j.jsxs)(v.default,{style:[k(o,s).petButton,u[e]&&k(o,s).selectedPetButton],onPress:()=>(e=>{f(Object.assign({},u,{[e]:!u[e]}))})(e),children:[(0,j.jsx)(S.default,{name:"exotics"===e?"turtle":e,size:24,color:u[e]?m.theme.colors.surface:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:[k(o,s).petButtonText,u[e]&&k(o,s).selectedPetButtonText],children:e.charAt(0).toUpperCase()+e.slice(1)})]},e)))}),(0,j.jsx)(a.default,{style:k(o,s).label,children:"About You:"}),(0,j.jsx)(te.default,{style:k(o,s).textInput,multiline:!0,numberOfLines:4,placeholder:"Write a little about yourself...",value:p,onChangeText:y}),(0,j.jsx)(a.default,{style:k(o,s).label,children:"Upload Certifications/Resume:"}),(0,j.jsxs)(v.default,{style:k(o,s).uploadButton,onPress:async()=>{let e=await Mt.launchImageLibraryAsync({mediaTypes:Lt.MediaTypeOptions.Images,allowsEditing:!0,aspect:[4,3],quality:1,base64:!0});if(!e.canceled){const t={uri:e.assets[0].uri,base64:e.assets[0].base64,name:e.assets[0].uri.split("/").pop()};x([...b,t])}},children:[(0,j.jsx)(S.default,{name:"file-upload",size:24,color:m.theme.colors.text}),(0,j.jsx)(a.default,{style:k(o,s).uploadText,children:"Upload Documents"})]}),b.map(((e,t)=>(0,j.jsxs)(r.default,{style:k(o,s).uploadedFileContainer,children:[(0,j.jsx)(Q.default,{source:{uri:e.uri},style:k(o,s).uploadedFilePreview}),(0,j.jsx)(a.default,{style:k(o,s).certificationText,numberOfLines:1,children:e.name}),(0,j.jsx)(v.default,{style:k(o,s).removeFileButton,onPress:()=>(e=>{x(b.filter(((t,o)=>o!==e)))})(t),children:(0,j.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.error})})]},t))),(0,j.jsx)(a.default,{style:k(o,s).label,children:"Upload Insurance Proof:"}),(0,j.jsxs)(v.default,{style:k(o,s).uploadButton,onPress:async()=>{let e=await Mt.launchImageLibraryAsync({mediaTypes:Lt.MediaTypeOptions.Images,allowsEditing:!0,aspect:[4,3],quality:1,base64:!0});if(!e.canceled){const t={uri:e.assets[0].uri,base64:e.assets[0].base64,name:e.assets[0].uri.split("/").pop()};C([...w,t])}},children:[(0,j.jsx)(S.default,{name:"file-upload",size:24,color:m.theme.colors.text}),(0,j.jsx)(a.default,{style:k(o,s).uploadText,children:"Upload Insurance"})]}),w.map(((e,t)=>(0,j.jsxs)(r.default,{style:k(o,s).uploadedFileContainer,children:[(0,j.jsx)(Q.default,{source:{uri:e.uri},style:k(o,s).uploadedFilePreview}),(0,j.jsx)(a.default,{style:k(o,s).certificationText,numberOfLines:1,children:e.name}),(0,j.jsx)(v.default,{style:k(o,s).removeFileButton,onPress:()=>(e=>{C(w.filter(((t,o)=>o!==e)))})(t),children:(0,j.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.error})})]},t))),(0,j.jsx)(v.default,{style:[k(o,s).submitButton,T&&k(o,s).submitButtonDisabled],onPress:async()=>{B(!0),setTimeout((()=>{B(!1),f({dog:!1,cat:!1,exotics:!1}),y(""),x([]),C([]),window.confirm("Success: Your application has been submitted successfully!")&&e.navigate("More")}),2e3)},disabled:T,children:(0,j.jsx)(a.default,{style:k(o,s).submitButtonText,children:T?"Submitting...":"Submit Application"})}),T&&(0,j.jsx)(A.default,{style:k(o,s).loadingIndicator,size:"small",color:m.theme.colors.primary})]})})]})})};var fn=o(30336),pn=o(84268),yn=o(59793);const bn=(e,t)=>i.default.create({mainContainer:Object.assign({flex:1,backgroundColor:m.theme.colors.background},e>900&&{height:"100vh",overflow:"hidden",position:"fixed",top:0,left:0,right:0,bottom:0,marginLeft:t?70:250,transition:"margin-left 0.3s ease"}),container:{flex:1},scrollView:{flex:1},mobileHeader:{backgroundColor:m.theme.colors.surface,paddingHorizontal:20,paddingVertical:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},headerTitle:{fontSize:m.theme.fontSizes.extraLarge,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},content:{flex:1,backgroundColor:m.theme.colors.background,paddingTop:0},webContent:{width:"100%",maxWidth:e>900?800:600,alignSelf:"center",padding:16,paddingTop:16,paddingBottom:e<=900?100:16},roleToggleSection:{backgroundColor:m.theme.colors.surface,padding:16,marginBottom:16,borderRadius:12,borderWidth:1,borderColor:m.theme.colors.border},sectionTitle:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:12},roleButtons:{flexDirection:"row",gap:8},roleButton:{flex:1,padding:12,borderRadius:8,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:m.theme.colors.primary,backgroundColor:"transparent"},roleButtonActive:{backgroundColor:m.theme.colors.primary},roleButtonText:{fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily,color:m.theme.colors.primary,fontWeight:"500"},roleButtonTextActive:{color:m.theme.colors.surface},listSection:{backgroundColor:m.theme.colors.surface,borderRadius:8,marginBottom:16},webListItem:{borderBottomWidth:1,borderBottomColor:m.theme.colors.border,paddingVertical:e<=900?8:12},listItemTitle:{fontSize:e<=900?m.theme.fontSizes.medium:m.theme.fontSizes.large,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},buttonContainer:{marginBottom:16},switchRoleButton:{borderColor:m.theme.colors.primary},logoutButton:{backgroundColor:m.theme.colors.error},buttonText:{fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"}}),xn=({navigation:e})=>{const{isSignedIn:t,isApprovedProfessional:o,userRole:i,switchRole:s,signOut:l,screenWidth:d,isCollapsed:c,is_DEBUG:u}=(0,n.useContext)(h.AuthContext),[f,p]=(0,n.useState)(d<=900),y=bn(d,c);(0,n.useEffect)((()=>{p(d<=900)}),[d]),(0,n.useEffect)((()=>{(async()=>{try{const e=t?"Dashboard":"Home";sessionStorage.setItem("currentRoute",e),sessionStorage.setItem("previousRoute","More")}catch(zs){console.error("Error initializing routes:",zs)}})()}),[t,i]);const b=async(t,o)=>{try{await(0,g.navigateToFrom)(e,t,"More",o)}catch(zs){console.error("Error handling navigation:",zs),e.navigate(t)}},x=async()=>{if(o){await s();const t="Dashboard";sessionStorage.setItem("currentRoute",t),setTimeout((()=>{e.navigate(t)}),0)}else Et.default.alert("Not Approved","You are not approved as a professional yet."),b("BecomeProfessional","Overview")},w=[{title:"Sign In",icon:"login",route:"SignIn"},{title:"Sign Up",icon:"account-plus-outline",route:"SignUp"},{title:"Search Professionals",icon:"magnify",route:"SearchProfessionalsListing"},{title:"Privacy Policy",icon:"shield-account",route:"PrivacyPolicy"},{title:"Terms of Service",icon:"file-document",route:"TermsOfService"},{title:"Contact Us",icon:"email",route:"ContactUs"}],C=[{title:"My Profile",icon:"account-outline",route:"MyProfile"},{title:"Connections",icon:"account-group-outline",route:"Connections"},{title:"Become a Professional",icon:"account-tie",route:"BecomeProfessional"},{title:"Privacy Policy",icon:"shield-account",route:"PrivacyPolicy"},{title:"Terms of Service",icon:"file-document",route:"TermsOfService"},{title:"Contact Us",icon:"email",route:"ContactUs"}],T=[{title:"My Profile",icon:"account-outline",route:"MyProfile"},{title:"My Services",icon:"briefcase-outline",route:"ServiceManagerScreen"},{title:"Connections",icon:"account-group-outline",route:"Connections"},{title:"Privacy Policy",icon:"shield-account",route:"PrivacyPolicy"},{title:"Terms of Service",icon:"file-document",route:"TermsOfService"},{title:"Contact Us",icon:"email",route:"ContactUs"}];return(0,j.jsx)(r.default,{style:y.mainContainer,children:(0,j.jsxs)(He.default,{style:y.container,children:[f&&(0,j.jsx)(r.default,{style:y.mobileHeader,children:(0,j.jsx)(a.default,{style:y.headerTitle,children:"More"})}),(0,j.jsx)(X.default,{style:y.scrollView,showsVerticalScrollIndicator:!1,children:(0,j.jsx)(r.default,{style:y.content,children:(0,j.jsxs)(r.default,{style:y.webContent,children:[t&&o&&f&&(0,j.jsxs)(r.default,{style:y.roleToggleSection,children:[(0,j.jsx)(a.default,{style:y.sectionTitle,children:"Switch Role"}),(0,j.jsxs)(r.default,{style:y.roleButtons,children:[(0,j.jsx)(v.default,{style:[y.roleButton,"petOwner"===i&&y.roleButtonActive],onPress:()=>x(),children:(0,j.jsx)(a.default,{style:[y.roleButtonText,"petOwner"===i&&y.roleButtonTextActive],children:"Pet Owner"})}),(0,j.jsx)(v.default,{style:[y.roleButton,"professional"===i&&y.roleButtonActive],onPress:()=>x(),children:(0,j.jsx)(a.default,{style:[y.roleButtonText,"professional"===i&&y.roleButtonTextActive],children:"Professional"})})]})]}),(0,j.jsx)(pn.default,{style:y.listSection,children:(()=>{let e;return e=t?"professional"===i?T:C:w,e.map(((t,o)=>(0,j.jsxs)(n.Fragment,{children:[(0,j.jsx)(fn.default,{title:t.title,titleStyle:y.listItemTitle,left:e=>(0,j.jsx)(S.default,{name:t.icon,size:d<=900?20:24,color:m.theme.colors.primary}),onPress:()=>b(t.route,t.tab),style:[y.webListItem,{paddingHorizontal:d<=900?8:16}]}),o<e.length-1&&(0,j.jsx)(yn.default,{})]},o)))})()}),t&&(0,j.jsx)(r.default,{style:y.buttonContainer,children:(0,j.jsx)(Ue.default,{mode:"contained",onPress:async()=>{try{await l(),sessionStorage.removeItem("currentRoute"),sessionStorage.removeItem("previousRoute"),Et.default.alert("Logged Out","You have been successfully logged out."),e.navigate("Home")}catch(zs){console.error("Logout failed",zs),Et.default.alert("Logout Failed","An error occurred while logging out.")}},style:[y.logoutButton],labelStyle:y.buttonText,children:"Log Out"})})]})})})]})})};var vn=o(61171),wn=o(56662),Cn=(o(99164),o(59814)),Sn=o(32724),jn=o(54564);const Tn=i.default.create({container:{flexDirection:"row",alignItems:"center",paddingVertical:8,paddingHorizontal:10,backgroundColor:m.theme.colors.lightGrey,borderRadius:5,marginBottom:5},removeButton:{padding:5,marginRight:5},contentContainer:{flex:1,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},time:{fontSize:m.theme.fontSizes.small,fontWeight:"bold",flex:1},serviceContainer:{flex:2,flexDirection:"row",justifyContent:"flex-end",alignItems:"center"},reason:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.textSecondary,marginRight:8},seeMoreButton:{padding:4,borderRadius:4,backgroundColor:m.theme.colors.primary},seeMoreText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.small},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:m.theme.colors.background,borderRadius:8,padding:16,width:"80%",maxHeight:"80%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},modalTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"bold",color:m.theme.colors.text},modalTime:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginBottom:12},serviceItem:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,paddingVertical:4}}),Bn=({startTime:e,endTime:t,reason:o,onPress:i,onRemove:s})=>{const[l,d]=(0,n.useState)(!1),c="00:00"===e&&"24:00"===t,u=e=>{if(c)return"All Day";if("string"!==typeof e)return e instanceof Date?(0,jn.format)(e,"h:mm a"):(console.warn("Invalid time format: ".concat(e)),"Invalid Time");try{const t=(0,Sn.parse)(e,"HH:mm",new Date);return(0,jn.format)(t,"h:mm a")}catch(zs){return console.warn("Invalid time format: ".concat(e)),"Invalid Time"}};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(r.default,{style:Tn.container,children:[(0,j.jsx)(v.default,{style:Tn.removeButton,onPress:s,children:(0,j.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.error})}),(0,j.jsxs)(r.default,{style:Tn.contentContainer,children:[(0,j.jsx)(a.default,{style:Tn.time,children:c?"All Day":"".concat(u(e)," - ").concat(u(t))}),(0,j.jsxs)(r.default,{style:Tn.serviceContainer,children:[(0,j.jsx)(a.default,{style:Tn.reason,children:(()=>{const e=o?.replace("Unavailable for: ","").split(", ")||[];return 0===e.length?"No services specified":10===e.length?"All Services":"".concat(e.length," ").concat(1===e.length?"Service":"Services")})()}),o&&(0,j.jsx)(v.default,{onPress:()=>d(!0),style:Tn.seeMoreButton,children:(0,j.jsx)(a.default,{style:Tn.seeMoreText,children:"See All"})})]})]})]}),(0,j.jsx)(k.default,{visible:l,transparent:!0,animationType:"fade",onRequestClose:()=>d(!1),children:(0,j.jsx)(v.default,{style:Tn.modalOverlay,activeOpacity:1,onPress:()=>d(!1),children:(0,j.jsxs)(r.default,{style:Tn.modalContent,children:[(0,j.jsxs)(r.default,{style:Tn.modalHeader,children:[(0,j.jsx)(a.default,{style:Tn.modalTitle,children:"Unavailable Services"}),(0,j.jsx)(v.default,{onPress:()=>d(!1),children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,j.jsxs)(a.default,{style:Tn.modalTime,children:[u(e)," - ",u(t)]}),o?.replace("Unavailable for: ","").split(", ").map(((e,t)=>(0,j.jsxs)(a.default,{style:Tn.serviceItem,children:["\u2022 ",e]},t)))]})})})]})},kn=i.default.create({card:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:12,marginBottom:8,flexDirection:"row",justifyContent:"space-between",alignItems:"center",elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.2,shadowRadius:2},cardContent:{flex:1},timeContainer:{flexDirection:"row",alignItems:"center",marginBottom:4},timeText:{marginLeft:8,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontWeight:"500"},ownerName:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.textSecondary},editButton:{padding:8}}),An=({booking:e,onPress:t,onEdit:o})=>{(0,b.useNavigation)();const n=e=>{try{const t=(0,Sn.parse)(e,"HH:mm",new Date);return(0,jn.format)(t,"h:mm a")}catch(zs){return console.warn("Invalid time format: ".concat(e)),"Invalid Time"}},i=()=>{t&&t(e)};return(0,j.jsxs)(v.default,{style:kn.card,onPress:i,children:[(0,j.jsxs)(r.default,{style:kn.cardContent,children:[(0,j.jsxs)(r.default,{style:kn.timeContainer,children:[(0,j.jsx)(S.default,{name:"clock-outline",size:20,color:m.theme.colors.primary}),(0,j.jsxs)(a.default,{style:kn.timeText,children:[n(e.startTime)," - ",n(e.endTime)]})]}),(0,j.jsxs)(a.default,{style:kn.ownerName,children:["Booked with ",e.owner_name]})]}),(0,j.jsx)(v.default,{style:kn.editButton,onPress:i,children:(0,j.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.primary})})]})},_n=i.default.create({container:{},fullWidth:{width:"100%"},label:{fontSize:m.theme.fontSizes.smallMedium,color:m.theme.colors.placeholder,fontWeight:"500"},timeButton:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,padding:8,backgroundColor:m.theme.colors.background,minHeight:20},compactTimeButton:{width:150},timeText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text},webInputContainer:{position:"relative",borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,backgroundColor:m.theme.colors.background,overflow:"hidden",height:40,display:"flex",flexDirection:"row",alignItems:"center"},webInput:{fontSize:m.theme.fontSizes.medium,marginLeft:12,width:"90%",height:"100%",border:"none",outline:"none",backgroundColor:"transparent",color:m.theme.colors.text},webIcon:{position:"absolute",right:12,cursor:"pointer",pointerEvents:"auto"},errorBorder:{borderColor:m.theme.colors.error},errorText:{color:m.theme.colors.error},errorMessage:{color:m.theme.colors.error,fontSize:m.theme.fontSizes.small,marginTop:4},disabled:{backgroundColor:m.theme.colors.disabled,opacity:.7},disabledText:{color:m.theme.colors.placeholder}}),In=({label:e,value:t,onChange:o,fullWidth:i=!1,containerStyle:s,error:l,disabled:d=!1})=>{const[c,u]=n.useState(!1),{screenWidth:g}=(0,n.useContext)(h.AuthContext),f=g>400;{const c="undefined"!==typeof navigator&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),u=n.createElement("style",{},'\n      input[type="time"]::-webkit-calendar-picker-indicator {\n        display: '.concat(f&&c?"block":"none",';\n      }\n      input[type="time"]::-webkit-inner-spin-button,\n      input[type="time"]::-webkit-clear-button {\n        display: none;\n      }\n    ')),g=n.createElement("input",{type:"time",value:t.toTimeString().slice(0,5),onChange:e=>o(new Date("2000-01-01T".concat(e.target.value))),style:Object.assign({},_n.webInput,{paddingRight:"12px"}),disabled:d}),h=()=>{if(!d&&"undefined"!==typeof document){const e=document.querySelector('input[type="time"]');e&&"function"===typeof e.showPicker&&e.showPicker()}};return(0,j.jsxs)(r.default,{style:[_n.container,i&&_n.fullWidth,s],children:[e&&(0,j.jsx)(a.default,{style:[_n.label,l&&_n.errorText],children:e}),(0,j.jsxs)(r.default,{style:[_n.webInputContainer,!i&&_n.compactTimeButton,l&&_n.errorBorder,d&&_n.disabled],children:[u,g,f&&!c&&(0,j.jsx)(S.default,{name:"clock-outline",size:24,color:d?m.theme.colors.placeholder:m.theme.colors.text,style:_n.webIcon,onPress:d?null:h})]}),l&&(0,j.jsx)(a.default,{style:_n.errorMessage,children:l})]})}},{width:Mn,height:Ln}=C.default.get("window"),Rn=i.default.create({modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:m.theme.colors.background,padding:22,justifyContent:"center",alignItems:"center",borderRadius:17,maxHeight:.7*Ln,zIndex:1},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:15},modalTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"bold"},closeButton:{padding:5},switchContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginVertical:10,zIndex:1},buttonContainer:{flexDirection:"row",justifyContent:"space-between",width:"100%",marginTop:20,gap:10},availabilityButton:{padding:10,borderRadius:5,flex:1,alignItems:"center"},availableButton:{backgroundColor:m.theme.colors.primary},unavailableButton:{backgroundColor:m.theme.colors.danger},disabledButton:{opacity:.5},availabilityButtonText:{color:m.theme.colors.whiteText,fontWeight:"bold"},timePickerContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginVertical:10,zIndex:1},webTimePicker:{padding:5,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:5},unavailableTimesContainer:{marginTop:20,maxHeight:200},sectionTitle:{fontSize:m.theme.fontSizes.medium,fontWeight:"bold",marginBottom:10},inputWrapper:{position:"relative",width:"100%",marginBottom:15,zIndex:2},inputLabel:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.text,marginBottom:5,fontWeight:"500"},input:{borderColor:m.theme.colors.border,borderWidth:1,borderRadius:5,padding:10,backgroundColor:m.theme.colors.inputBackground},customDropdown:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",height:40},dropdownContainer:{position:"absolute",top:"95%",left:0,right:0,backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:5,marginTop:2,maxHeight:160,zIndex:1e3,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},dropdownScroll:{maxHeight:160},dropdownItem:{padding:10,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,height:40},dropdownText:{color:m.theme.colors.text,fontSize:m.theme.fontSizes.medium},selectedOption:{color:m.theme.colors.primary,fontWeight:"bold"},inputError:{borderColor:m.theme.colors.danger},dropdownItemContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingRight:10},toggleContainer:{flexDirection:"row",marginBottom:16,borderRadius:8,backgroundColor:m.theme.colors.surface,padding:4},toggleButton:{flex:1,paddingVertical:8,paddingHorizontal:16,borderRadius:6,borderColor:m.theme.colors.border,borderWidth:1,margin:2},activeToggle:{backgroundColor:m.theme.colors.primary},toggleText:{textAlign:"center",color:m.theme.colors.text,fontSize:m.theme.fontSizes.small},activeToggleText:{color:m.theme.colors.whiteText,fontWeight:"500"},bookingsList:{maxHeight:300},emptyState:{alignItems:"center",justifyContent:"center",padding:32},emptyStateText:{marginTop:16,color:m.theme.colors.textSecondary,fontSize:m.theme.fontSizes.medium,textAlign:"center"},contentScrollView:{flex:1,width:"100%"},availabilityControls:{marginTop:20,paddingTop:20,borderTopWidth:1,borderTopColor:m.theme.colors.border,width:"100%"},bookingsContainer:{maxHeight:200,marginBottom:16},unavailableTimesWrapper:{maxHeight:200,marginBottom:16},bookingsWrapper:{marginBottom:16},selectedDatesText:{marginVertical:8,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text}}),Dn=({isVisible:e,onClose:t,onSave:o,selectedDates:i,currentAvailability:s,bookings:l,onRemoveTimeSlot:d})=>{const[c,u]=(0,n.useState)(e),[g,h]=(0,n.useState)(!1),[f,p]=(0,n.useState)(new Date),[y,x]=(0,n.useState)(new Date),[w,T]=(0,n.useState)(!1),[B,A]=(0,n.useState)(!1),[_,I]=(0,n.useState)([]),[M,L]=(0,n.useState)(!1),[R,D]=(0,n.useState)(O()),[z,P]=(0,n.useState)("bookings"),[F,E]=(0,n.useState)(null),W=(0,b.useNavigation)();function O(){const{width:e}=C.default.get("window");return e<600?.9*e:.4*e}(0,n.useEffect)((()=>{u(e)}),[e]),(0,n.useEffect)((()=>{const e=C.default.addEventListener("change",(()=>{D(O())}));return()=>{e.remove()}}),[]);const N=()=>!(!f||!y||g)&&i.some((e=>(s[e]?.unavailableTimes||[]).some((e=>{const[t,o]=e.startTime.split(":").map(Number),[n,r]=e.endTime.split(":").map(Number),a=(0,jn.format)(f,"HH:mm"),i=(0,jn.format)(y,"HH:mm"),[s,l]=a.split(":").map(Number),[d,c]=i.split(":").map(Number);return s===t&&l===o&&d===n&&c===r}))));return(0,j.jsx)(k.default,{visible:c,animationType:"slide",transparent:!0,onRequestClose:t,children:(0,j.jsx)(r.default,{style:Rn.modalContainer,children:(0,j.jsxs)(r.default,{style:[Rn.modalContent,{width:R}],children:[(0,j.jsxs)(r.default,{style:Rn.modalHeader,children:[(0,j.jsx)(a.default,{style:Rn.modalTitle,children:i.length>1?"Edit Multiple Days":"Edit Availability"}),(0,j.jsx)(v.default,{style:Rn.closeButton,onPress:t,children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,j.jsxs)(a.default,{style:Rn.selectedDatesText,children:["Selected Dates: ",(()=>{if(!i||0===i.length)return"";const e=i[0],t=i[i.length-1];return e===t?e:"".concat(e," - ").concat(t)})()]}),(0,j.jsxs)(r.default,{style:Rn.toggleContainer,children:[(0,j.jsx)(v.default,{style:[Rn.toggleButton,"unavailable"===z&&Rn.activeToggle],onPress:()=>P("unavailable"),children:(0,j.jsx)(a.default,{style:[Rn.toggleText,"unavailable"===z&&Rn.activeToggleText],children:"Unavailable Times"})}),(0,j.jsx)(v.default,{style:[Rn.toggleButton,"bookings"===z&&Rn.activeToggle],onPress:()=>P("bookings"),children:(0,j.jsx)(a.default,{style:[Rn.toggleText,"bookings"===z&&Rn.activeToggleText],children:"Bookings"})})]}),(0,j.jsxs)(X.default,{style:Rn.contentScrollView,nestedScrollEnabled:!0,children:["unavailable"===z?(0,j.jsx)(r.default,{style:Rn.unavailableTimesWrapper,children:(()=>{if(0===i.length)return null;const e=i[0],t=s[e]?.unavailableTimes||[];return 0===t.length?null:(0,j.jsxs)(r.default,{style:Rn.unavailableTimesContainer,children:[(0,j.jsx)(a.default,{style:Rn.sectionTitle,children:"Unavailable Times:"}),(0,j.jsx)(X.default,{children:t.map(((t,o)=>(0,j.jsx)(Bn,{startTime:t.startTime,endTime:t.endTime,reason:t.reason,onRemove:()=>((e,t)=>{if(1===i.length)return void d(e,t);const o={};i.forEach((e=>{if(s[e]?.unavailableTimes){const n=s[e].unavailableTimes.filter((e=>e.startTime!==t.startTime||e.endTime!==t.endTime));o[e]=Object.assign({},s[e],{unavailableTimes:n})}})),d(e,t,o,i)})(e,t)},o)))})]})})()}):(0,j.jsx)(r.default,{style:Rn.bookingsWrapper,children:(()=>{const e=i.reduce(((e,t)=>(l[t]&&e.push(...l[t].map((e=>Object.assign({},e,{date:t})))),e)),[]);if(0===e.length)return(0,j.jsxs)(r.default,{style:Rn.emptyState,children:[(0,j.jsx)(S.default,{name:"calendar-blank",size:48,color:m.theme.colors.textSecondary}),(0,j.jsx)(a.default,{style:Rn.emptyStateText,children:"No bookings for selected dates"})]});const o=e=>{t(),setTimeout((()=>{W.navigate("BookingDetails",{bookingId:e.id})}),300)};return(0,j.jsx)(r.default,{style:Rn.bookingsContainer,children:(0,j.jsx)(X.default,{style:Rn.bookingsList,nestedScrollEnabled:!0,children:e.map(((e,t)=>(0,j.jsx)(An,{booking:e,onPress:()=>o(e),onEdit:()=>o(e)},t)))})})})()}),(0,j.jsxs)(r.default,{style:Rn.availabilityControls,children:[(0,j.jsxs)(r.default,{style:Rn.inputWrapper,children:[(0,j.jsx)(a.default,{style:Rn.inputLabel,children:"Service Type(s) *"}),(0,j.jsxs)(v.default,{style:[Rn.input,Rn.customDropdown,0===_.length&&Rn.inputError],onPress:()=>L(!M),children:[(0,j.jsx)(a.default,{style:{color:_.length>0?m.theme.colors.text:m.theme.colors.placeHolderText},children:_.length>0?_.includes(xe)?"All Services":_.length>1?"".concat(_.length," services selected"):_[0]:"Select service type(s)"}),(0,j.jsx)(S.default,{name:M?"chevron-up":"chevron-down",size:24,color:m.theme.colors.primary})]}),M&&(0,j.jsx)(r.default,{style:Rn.dropdownContainer,children:(0,j.jsx)(X.default,{style:Rn.dropdownScroll,children:ve.map((e=>(0,j.jsx)(v.default,{style:Rn.dropdownItem,onPress:()=>{I(e===xe?_.includes(xe)?[]:[xe]:t=>{const o=t.filter((e=>e!==xe));return t.includes(e)?o.filter((t=>t!==e)):[...o,e]})},children:(0,j.jsxs)(r.default,{style:Rn.dropdownItemContent,children:[(0,j.jsx)(a.default,{style:[Rn.dropdownText,_.includes(e)&&Rn.selectedOption],children:e}),_.includes(e)&&(0,j.jsx)(S.default,{name:"check",size:20,color:m.theme.colors.primary})]})},e)))})})]}),(0,j.jsxs)(r.default,{style:Rn.switchContainer,children:[(0,j.jsx)(a.default,{children:"All Day"}),(0,j.jsx)(st.default,{value:g,onValueChange:h})]}),!g&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(r.default,{style:Rn.timePickerContainer,children:[(0,j.jsx)(a.default,{children:"Start Time:"}),(0,j.jsx)(In,{value:f,onChange:p,showPicker:w,setShowPicker:T,fullWidth:!0})]}),(0,j.jsxs)(r.default,{style:Rn.timePickerContainer,children:[(0,j.jsx)(a.default,{children:"End Time:"}),(0,j.jsx)(In,{value:y,onChange:x,showPicker:B,setShowPicker:A,fullWidth:!0})]})]}),(0,j.jsxs)(r.default,{style:Rn.buttonContainer,children:[(0,j.jsx)(v.default,{style:[Rn.availabilityButton,Rn.availableButton,(0===_.length||!N())&&Rn.disabledButton],onPress:()=>{if(0===_.length||!N())return;const e=(0,jn.format)(f,"HH:mm"),t=(0,jn.format)(y,"HH:mm"),o={};i.forEach((n=>{if(s[n]?.unavailableTimes){const r=s[n].unavailableTimes.filter((o=>o.startTime!==e||o.endTime!==t));o[n]=Object.assign({},s[n],{unavailableTimes:r})}})),d(i[0],{startTime:e,endTime:t},o,i)},disabled:0===_.length||!N(),children:(0,j.jsx)(a.default,{style:Rn.availabilityButtonText,children:"Mark Available"})}),(0,j.jsx)(v.default,{style:[Rn.availabilityButton,Rn.unavailableButton,(0===_.length||N())&&Rn.disabledButton],onPress:()=>{if(0===_.length||N())return;const e=_.includes(xe)?ve.filter((e=>e!==xe)):_;o({dates:i,isAllDay:g,startTime:g?null:(0,jn.format)(f,"HH:mm"),endTime:g?null:(0,jn.format)(y,"HH:mm"),isUnavailable:!0,serviceTypes:e,reason:"Unavailable for: ".concat(e.join(", "))})},disabled:0===_.length||N(),children:(0,j.jsx)(a.default,{style:Rn.availabilityButtonText,children:"Mark Unavailable"})})]})]})]})]})})})},zn=({format:e=[["months","days","years"],["hours","minutes","am/pm"]],value:t,onChange:o,disabled:a=!1,isInModal:i=!1,error:s=!1})=>{const[l,d]=(0,n.useState)({months:"",days:"",years:"",hours:"",minutes:"",ampm:"AM"});const c=e=>{const{months:t,days:o,years:n,hours:r,minutes:a,ampm:i}=e;if(!t||!o||!n)return null;let s=parseInt(r||"12");return"PM"===i&&12!==s&&(s+=12),"AM"===i&&12===s&&(s=0),new Date(parseInt(n),parseInt(t)-1,parseInt(o),s,parseInt(a||"0"))},u=e=>{let t=[];switch(e){case"months":t=Array.from({length:12},((e,t)=>({value:(t+1).toString(),label:new Date(2e3,t).toLocaleString("default",{month:"long"})})));break;case"days":t=Array.from({length:31},((e,t)=>({value:(t+1).toString(),label:(t+1).toString()})));break;case"years":const e=(new Date).getFullYear();t=Array.from({length:100},((t,o)=>({value:(e-50+o).toString(),label:(e-50+o).toString()})));break;case"hours":t=Array.from({length:12},((e,t)=>({value:(t+1).toString(),label:(t+1).toString()})));break;case"minutes":t=Array.from({length:60},((e,t)=>({value:t.toString().padStart(2,"0"),label:t.toString().padStart(2,"0")})));break;case"am/pm":t=[{value:"AM",label:"AM"},{value:"PM",label:"PM"}]}const r=Object.assign({},Pn.select,s?Pn.errorSelect:{},"months"===e?Pn.monthSelect:{},"years"===e?Pn.yearSelect:{},"days"===e?Pn.daySelect:{});return n.createElement("select",{value:l["am/pm"===e?"ampm":e],onChange:t=>{i&&t.stopPropagation(),((e,t)=>{if(a)return;const n=Object.assign({},l,{[e]:t});if(d(n),o){const e=c(n);o(e)}})("am/pm"===e?"ampm":e,t.target.value)},style:r,disabled:a},[n.createElement("option",{key:"default",value:""},e.charAt(0).toUpperCase()+e.slice(1)),...t.map((e=>n.createElement("option",{key:e.value,value:e.value},e.label)))])};return(0,j.jsx)(r.default,{style:Pn.container,children:e.map(((e,t)=>(0,j.jsx)(r.default,{style:Pn.row,children:e.map(((e,t)=>(0,j.jsx)(r.default,{style:Pn.selectContainer,children:u(e)},e)))},t)))})},Pn=i.default.create({container:{width:"100%"},row:{flexDirection:"row",marginBottom:8,gap:8},selectContainer:{flex:1},select:{width:"100%",padding:8,borderRadius:4,borderWidth:1,borderColor:m.theme.colors.border,backgroundColor:m.theme.colors.background,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,appearance:"none",WebkitAppearance:"none",MozAppearance:"none",paddingRight:8,cursor:"pointer"},monthSelect:{flex:1.5},daySelect:{flex:.8},yearSelect:{flex:1.2},errorSelect:{borderColor:m.theme.colors.danger}}),{width:Fn}=C.default.get("window"),En="All Days",Wn=[En,"Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],On=i.default.create({modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:m.theme.colors.background,padding:22,borderRadius:17,maxHeight:"80%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},closeButton:{padding:8},modalTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"bold",marginBottom:15,fontFamily:m.theme.fonts.header.fontFamily},settingContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginVertical:10},sectionTitle:{fontSize:m.theme.fontSizes.medium,fontWeight:"bold",marginTop:20,marginBottom:10,fontFamily:m.theme.fonts.header.fontFamily},dayContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",marginVertical:5},buttonContainer:{flexDirection:"row",justifyContent:"space-between",gap:12,marginTop:20},button:{flex:1,padding:12,borderRadius:8,alignItems:"center"},availableButton:{backgroundColor:m.theme.colors.primary},unavailableButton:{backgroundColor:m.theme.colors.error},buttonText:{color:m.theme.colors.whiteText,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},tabContainer:{flexDirection:"row",marginBottom:15},tab:{paddingHorizontal:15,paddingVertical:10,borderBottomWidth:2,borderBottomColor:"transparent"},selectedTab:{borderBottomColor:m.theme.colors.primary},tabText:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},selectedTabText:{color:m.theme.colors.primary,fontFamily:m.theme.fonts.regular.fontFamily},daySettingsContainer:{marginBottom:15},settingRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:15,gap:12},webTimePicker:{padding:5,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:5},webDatePicker:{padding:5,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:5},inputWrapper:{position:"relative",width:"100%",marginBottom:15,zIndex:2},inputLabel:{marginBottom:5,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},input:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:5,padding:10,backgroundColor:m.theme.colors.surface},customDropdown:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},dropdownContainer:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:5,maxHeight:200,zIndex:1e3},dropdownScroll:{maxHeight:200},dropdownItem:{padding:10,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},dropdownItemContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},dropdownText:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},selectedOption:{color:m.theme.colors.primary,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},inputError:{borderColor:m.theme.colors.danger},disabledButton:{opacity:.5},disabledText:{color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily},enabledText:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},timePickerContainer:{flex:1,maxWidth:150},datePickerContainer:{flex:1,maxWidth:200},datePickerWrapper:{width:"100%"},validationErrorText:{color:m.theme.colors.danger,fontSize:m.theme.fontSizes.small,marginTop:4,fontFamily:m.theme.fonts.regular.fontFamily}}),Nn=({isVisible:e,onClose:t,onSave:o,defaultSettings:i})=>{const{screenWidth:s}=(0,n.useContext)(h.AuthContext),[l,d]=(0,n.useState)([]),[c,u]=(0,n.useState)(i||{Monday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null},Tuesday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null},Wednesday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null},Thursday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null},Friday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null},Saturday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null},Sunday:{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null}}),[g,f]=(0,n.useState)({visible:!1,type:"",value:""}),[p,y]=(0,n.useState)(!1),[b,x]=(0,n.useState)(!1),[C,T]=(0,n.useState)(!1),[B,A]=(0,n.useState)("Please select day(s) first"),_=(0,n.useRef)(new w.default.Value(0)).current,I=(0,n.useRef)(new w.default.Value(600)).current,M=()=>{w.default.parallel([w.default.timing(_,{toValue:0,duration:300,useNativeDriver:!0}),w.default.timing(I,{toValue:600,duration:300,useNativeDriver:!0})]).start((()=>{t()}))};(0,n.useEffect)((()=>{e&&(w.default.timing(_,{toValue:1,duration:300,useNativeDriver:!0}).start(),w.default.spring(I,{toValue:0,tension:50,friction:8,useNativeDriver:!0}).start())}),[e]),(0,n.useEffect)((()=>{const e=e=>{const t=document.getElementById("dropdown-button"),o=document.getElementById("dropdown-container");C&&o&&!o.contains(e.target)&&!t.contains(e.target)&&T(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[C]);const L=e=>{if(console.log("Selected days:",l),0===l.length)return;const t=l.includes(En)?Wn.filter((e=>e!==En)):l;console.log("Days to update:",t),console.log("Current settings:",c),console.log("Making available:",e);const n=Object.assign({},c);t.forEach((t=>{console.log("Updating ".concat(t)),n[t]=Object.assign({},c[t],{isUnavailable:!e,startTime:c[l[0]].startTime,endTime:c[l[0]].endTime,isAllDay:c[l[0]].isAllDay,endDate:c[l[0]].endDate})})),console.log("New settings:",n),u(n),o(n),x(!e)};(0,n.useEffect)((()=>{0===l.length?A("Please select day(s) first"):A("")}),[l]);const R=(e,t,o)=>(0,j.jsx)(In,{value:new Date("2000-01-01T".concat(t)),onChange:e=>{const t=e.toTimeString().slice(0,5);o(t)},fullWidth:!1,disabled:0===l.length,error:B}),D=()=>{if(!l||0===l.length)return(0,j.jsxs)(r.default,{style:On.datePickerWrapper,children:[(0,j.jsx)(r.default,{style:[On.datePickerContainer],onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),children:(0,j.jsx)(zn,{format:[["months","days","years"]],disabled:!0,isInModal:!0,error:!0})}),(0,j.jsx)(a.default,{style:On.validationErrorText,children:B})]});const e=c[l[0]];return(0,j.jsx)(r.default,{style:On.datePickerWrapper,children:(0,j.jsx)(r.default,{style:On.datePickerContainer,onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),children:(0,j.jsx)(zn,{format:[["months","days","years"]],value:e.endDate?new Date(e.endDate):null,onChange:e=>{return t=l[0],o={endDate:e.toISOString().split("T")[0]},void u((e=>Object.assign({},e,{[t]:Object.assign({},e[t],o)})));var t,o},disabled:!1,isInModal:!0,error:!1})})})};(0,n.useEffect)((()=>{if(l.length>0){const e=((e,t)=>!(!e||0===e.length)&&e.some((e=>t[e]?.isUnavailable)))(l,c);x(e)}else x(!1)}),[l,c]);return(0,j.jsx)(k.default,{visible:e,transparent:!0,onRequestClose:M,children:(0,j.jsx)(w.default.View,{style:[On.modalContainer,{opacity:_}],children:(0,j.jsxs)(w.default.View,{style:[On.modalContent,{width:s<600?"90%":600,transform:[{translateY:I}]}],children:[(0,j.jsxs)(r.default,{style:On.modalHeader,children:[(0,j.jsx)(a.default,{style:On.modalTitle,children:"Default Settings"}),(0,j.jsx)(v.default,{onPress:M,style:On.closeButton,children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,j.jsxs)(r.default,{style:On.inputWrapper,children:[(0,j.jsx)(a.default,{style:On.inputLabel,children:"Day(s) *"}),(0,j.jsxs)(v.default,{id:"dropdown-button",style:[On.input,On.customDropdown,0===l.length&&On.inputError],onPress:()=>T(!C),children:[(0,j.jsx)(a.default,{style:{color:l.length>0?m.theme.colors.text:m.theme.colors.placeHolderText},children:0===l.length?"Select Days":l.includes(En)?"All Days":l.length>2?"".concat(l.length," Days Selected"):l.join(", ")}),(0,j.jsx)(S.default,{name:C?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})]}),C&&(0,j.jsx)(r.default,{id:"dropdown-container",style:On.dropdownContainer,children:(0,j.jsx)(X.default,{style:On.dropdownScroll,children:Wn.map((e=>(0,j.jsx)(v.default,{style:On.dropdownItem,onPress:()=>(e=>{d((t=>{if(e===En)return t.includes(En)?[]:Wn.filter((e=>e!==En));const o=t.filter((e=>e!==En));return o.includes(e)?o.filter((t=>t!==e)):o.length+1===Wn.length-1?Wn.filter((e=>e!==En)):[...o,e]}))})(e),children:(0,j.jsxs)(r.default,{style:On.dropdownItemContent,children:[(0,j.jsx)(a.default,{style:[On.dropdownText,l.includes(e)&&On.selectedOption],children:e}),l.includes(e)&&(0,j.jsx)(S.default,{name:"check",size:20,color:m.theme.colors.primary})]})},e)))})})]}),(()=>{const e=c[l[0]]||{isAllDay:!1,startTime:"09:00",endTime:"17:00",endDate:null};return(0,j.jsxs)(r.default,{style:On.daySettingsContainer,children:[(0,j.jsxs)(r.default,{style:On.settingRow,children:[(0,j.jsx)(a.default,{style:0===l.length?On.disabledText:On.enabledText,children:"All Day:"}),(0,j.jsx)(st.default,{value:e.isAllDay,onValueChange:e=>{if(0===l.length)return;const t=Object.assign({},c);l.forEach((o=>{t[o]=Object.assign({},t[o],{isAllDay:e})})),u(t)},disabled:0===l.length})]}),!e.isAllDay&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(r.default,{style:On.settingRow,children:[(0,j.jsx)(a.default,{style:0===l.length?On.disabledText:On.enabledText,children:"Start Time:"}),(0,j.jsx)(r.default,{style:On.timePickerContainer,children:R(0,e.startTime,(e=>{if(0===l.length)return;const t=Object.assign({},c);l.forEach((o=>{t[o]=Object.assign({},t[o],{startTime:e})})),u(t)}))})]}),(0,j.jsxs)(r.default,{style:On.settingRow,children:[(0,j.jsx)(a.default,{style:0===l.length?On.disabledText:On.enabledText,children:"End Time:"}),(0,j.jsx)(r.default,{style:On.timePickerContainer,children:R(0,e.endTime,(e=>{if(0===l.length)return;const t=Object.assign({},c);l.forEach((o=>{t[o]=Object.assign({},t[o],{endTime:e})})),u(t)}))})]})]}),(0,j.jsxs)(r.default,{style:On.settingRow,children:[(0,j.jsx)(a.default,{style:0===l.length?On.disabledText:On.enabledText,children:"End Date:"}),(0,j.jsx)(r.default,{pointerEvents:0===l.length?"none":"auto",children:D()})]})]})})(),(0,j.jsxs)(r.default,{style:On.buttonContainer,children:[(0,j.jsx)(v.default,{style:[On.button,On.availableButton],onPress:()=>L(!0),disabled:0===l.length,children:(0,j.jsx)(a.default,{style:On.buttonText,children:"Mark Available"})}),(0,j.jsx)(v.default,{style:[On.button,On.unavailableButton],onPress:()=>L(!1),disabled:0===l.length,children:(0,j.jsx)(a.default,{style:On.buttonText,children:"Mark Unavailable"})})]})]})})})},Hn=i.default.create({overlay:{width:"100%",pointerEvents:"box-none"},container:{backgroundColor:m.theme.colors.surface,borderTopLeftRadius:20,borderTopRightRadius:20,padding:16,paddingBottom:16,maxWidth:600,width:"100%",alignSelf:"center",shadowColor:"#000",shadowOffset:{width:0,height:-2},shadowOpacity:.25,shadowRadius:3.84,elevation:5},handleContainer:{width:"100%",height:24,alignItems:"center",justifyContent:"center",marginBottom:4},handle:{width:40,height:4,backgroundColor:m.theme.colors.border,borderRadius:2},header:{flexDirection:"row",alignItems:"center",marginBottom:12,paddingRight:8,marginTop:4},headerMinimized:{marginBottom:8,paddingBottom:12,justifyContent:"space-between"},headerCenter:{flex:1,alignItems:"center"},closeButton:{width:60,height:40,justifyContent:"center",alignItems:"center"},dateText:{fontSize:m.theme.fontSizes.medium,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},statusText:{fontSize:m.theme.fontSizes.medium,marginTop:4,fontFamily:m.theme.fonts.regular.fontFamily},actionButton:{width:60,alignItems:"center"},actionButtonText:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.primary,marginTop:4,textAlign:"center",lineHeight:16,fontFamily:m.theme.fonts.regular.fontFamily},content:{gap:12},timeToggleContainer:{},customToggle:{flexDirection:"row",backgroundColor:m.theme.colors.background,borderRadius:8,padding:4,gap:8},toggleButton:{flex:1,paddingVertical:12,paddingHorizontal:16,borderRadius:6,alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border},toggleButtonActive:{backgroundColor:m.theme.colors.primary,borderColor:m.theme.colors.primary},toggleButtonInactive:{backgroundColor:"transparent"},toggleButtonText:{color:m.theme.colors.text,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},toggleButtonTextActive:{color:m.theme.colors.whiteText,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},timeSection:{flexDirection:"row",gap:16},timeContainer:{flex:1},label:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginBottom:4,fontFamily:m.theme.fonts.regular.fontFamily},serviceSection:{position:"relative",zIndex:1},serviceSelector:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,padding:12,backgroundColor:m.theme.colors.background},serviceSelectorText:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},dropdownContainer:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,maxHeight:200,zIndex:1e3},dropdownScroll:{maxHeight:200},dropdownItem:{padding:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},dropdownItemContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},dropdownText:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},selectedOption:{color:m.theme.colors.primary,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},buttonContainer:{flexDirection:"row",gap:12},button:{flex:1,padding:12,borderRadius:8,alignItems:"center"},availableButton:{backgroundColor:m.theme.colors.primary},unavailableButton:{backgroundColor:m.theme.colors.error},buttonText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.medium,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},serviceSelectorError:{borderColor:m.theme.colors.error,borderWidth:1},errorText:{color:m.theme.colors.error,fontSize:m.theme.fontSizes.small,marginTop:4,fontFamily:m.theme.fonts.regular.fontFamily}}),Un=({selectedDates:e,currentAvailability:t,onClose:o,onViewUnavailableTimes:i,onSave:s,onMinimize:l})=>{const{screenWidth:d}=(0,n.useContext)(h.AuthContext),[c,u]=(0,n.useState)(new Date),[g,f]=(0,n.useState)(new Date),[p,y]=(0,n.useState)([]),[b,x]=(0,n.useState)(!1),[C,T]=(0,n.useState)(!1),[B,k]=(0,n.useState)(null),[A,_]=(0,n.useState)(!1),I=(0,n.useRef)(new w.default.Value(1)).current,M=(0,n.useRef)(new w.default.Value(1)).current,L=(0,n.useRef)(new w.default.Value(0)).current;(0,n.useEffect)((()=>{w.default.spring(L,{toValue:1,useNativeDriver:!0,tension:50,friction:8}).start()}),[]);const R=()=>{if(!e||0===e.length)return"Unknown";const o=e[0],n=t[o];return n?n.isAvailable?n.unavailableTimes?.length>0?"Partially Available":"Available":"Unavailable":"Available"},D=e=>{0!==p.length?(k(null),s({startTime:C?"00:00":(0,jn.format)(c,"HH:mm"),endTime:C?"24:00":(0,jn.format)(g,"HH:mm"),services:p,isAvailable:e,isAllDay:C})):k("Please select at least one service type")},z=()=>{const e=A?1:0,t=!A;l?.(t),w.default.parallel([w.default.timing(I,{toValue:e,duration:300,useNativeDriver:!1}),w.default.timing(M,{toValue:e,duration:300,useNativeDriver:!1})]).start((()=>{_(t)}))},P=C?364:445,F=I.interpolate({inputRange:[0,1],outputRange:[96,P]});return(0,j.jsx)(r.default,{style:[Hn.overlay,{pointerEvents:A?"box-none":"auto"}],children:(0,j.jsxs)(w.default.View,{style:[Hn.container,{height:F,transform:[{translateY:L.interpolate({inputRange:[0,1],outputRange:[600,0]})}]}],children:[(0,j.jsx)(v.default,{onPress:z,style:Hn.handleContainer,children:(0,j.jsx)(S.default,{name:A?"chevron-up":"chevron-down",size:24,color:m.theme.colors.text})}),(0,j.jsxs)(r.default,{style:[Hn.header,A&&Hn.headerMinimized],children:[!A&&(0,j.jsx)(v.default,{onPress:()=>{w.default.timing(L,{toValue:0,duration:300,useNativeDriver:!0}).start((()=>{o()}))},style:Hn.closeButton,children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})}),(0,j.jsxs)(r.default,{style:Hn.headerCenter,children:[(0,j.jsx)(a.default,{style:Hn.dateText,children:e&&0!==e.length?1===e.length?(0,jn.format)((0,Sn.parse)(e[0],"yyyy-MM-dd",new Date),"MMM dd, yyyy"):"".concat((0,jn.format)((0,Sn.parse)(e[0],"yyyy-MM-dd",new Date),"MMM dd")," - ").concat((0,jn.format)((0,Sn.parse)(e[e.length-1],"yyyy-MM-dd",new Date),"MMM dd, yyyy")):""}),(0,j.jsx)(a.default,{style:[Hn.statusText,{color:(()=>{switch(R()){case"Available":return m.theme.colors.success;case"Partially Available":return m.theme.colors.warning;case"Unavailable":return m.theme.colors.error;default:return m.theme.colors.text}})()}],children:R()})]}),!A&&(0,j.jsx)(w.default.View,{style:{opacity:M},children:(0,j.jsxs)(v.default,{style:Hn.actionButton,onPress:i,children:[(0,j.jsx)(S.default,{name:"clock-outline",size:24,color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:Hn.actionButtonText,children:"Unavailable\nTimes"})]})})]}),(0,j.jsxs)(w.default.View,{style:[Hn.content,{opacity:M}],children:[(0,j.jsxs)(r.default,{style:Hn.serviceSection,children:[(0,j.jsx)(a.default,{style:[Hn.label,{textAlign:"center"}],children:"Change Availability for Services"}),(0,j.jsxs)(v.default,{style:[Hn.serviceSelector,B&&p.length<=0&&Hn.serviceSelectorError],onPress:()=>x(!b),children:[(0,j.jsx)(a.default,{style:Hn.serviceSelectorText,children:p.length>0?p.includes(xe)?"All Services":p.length>1?"".concat(p.length," services selected"):p[0]:"Select one or more service types"}),(0,j.jsx)(S.default,{name:b?"chevron-up":"chevron-down",size:24,color:m.theme.colors.primary})]}),B&&p.length<=0&&!b&&(0,j.jsx)(a.default,{style:Hn.errorText,children:B}),b&&(0,j.jsx)(r.default,{style:Hn.dropdownContainer,children:(0,j.jsx)(X.default,{style:Hn.dropdownScroll,children:ve.map((e=>(0,j.jsx)(v.default,{style:Hn.dropdownItem,onPress:()=>{y(e===xe?p.includes(xe)?[]:[xe]:t=>{const o=t.filter((e=>e!==xe));return t.includes(e)?o.filter((t=>t!==e)):[...o,e]})},children:(0,j.jsxs)(r.default,{style:Hn.dropdownItemContent,children:[(0,j.jsx)(a.default,{style:[Hn.dropdownText,p.includes(e)&&Hn.selectedOption],children:e}),p.includes(e)&&(0,j.jsx)(S.default,{name:"check",size:20,color:m.theme.colors.primary})]})},e)))})})]}),(0,j.jsxs)(r.default,{style:Hn.timeToggleContainer,children:[(0,j.jsx)(a.default,{style:[Hn.label,{marginBottom:0}],children:"Time Selection"}),(0,j.jsxs)(r.default,{style:Hn.customToggle,children:[(0,j.jsx)(v.default,{style:[Hn.toggleButton,C?Hn.toggleButtonActive:Hn.toggleButtonInactive],onPress:()=>T(!0),children:(0,j.jsx)(a.default,{style:[Hn.toggleButtonText,C&&Hn.toggleButtonTextActive],children:"All Day"})}),(0,j.jsx)(v.default,{style:[Hn.toggleButton,C?Hn.toggleButtonInactive:Hn.toggleButtonActive],onPress:()=>T(!1),children:(0,j.jsx)(a.default,{style:[Hn.toggleButtonText,!C&&Hn.toggleButtonTextActive],children:"Custom Hours"})})]})]}),!C&&(0,j.jsxs)(r.default,{style:Hn.timeSection,children:[(0,j.jsxs)(r.default,{style:Hn.timeContainer,children:[(0,j.jsx)(a.default,{style:[Hn.label,{marginBottom:0}],children:"Start Time"}),(0,j.jsx)(In,{value:c,onChange:u,fullWidth:!0})]}),(0,j.jsxs)(r.default,{style:Hn.timeContainer,children:[(0,j.jsx)(a.default,{style:[Hn.label,{marginBottom:0}],children:"End Time"}),(0,j.jsx)(In,{value:g,onChange:f,fullWidth:!0})]})]}),(0,j.jsxs)(r.default,{style:Hn.buttonContainer,children:[(0,j.jsx)(v.default,{style:[Hn.button,Hn.availableButton],onPress:()=>D(!0),children:(0,j.jsx)(a.default,{style:Hn.buttonText,children:"Mark Available"})}),(0,j.jsx)(v.default,{style:[Hn.button,Hn.unavailableButton],onPress:()=>D(!1),children:(0,j.jsx)(a.default,{style:Hn.buttonText,children:"Mark Unavailable"})})]})]})]})})},Vn=i.default.create({modalContainer:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:m.theme.colors.surface,borderRadius:20,padding:20,width:"90%",maxWidth:500,maxHeight:"80%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},modalTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},closeButton:{padding:5},timesList:{maxHeight:"90%"},timeSlotContainer:{marginBottom:15},dateHeader:{marginBottom:8},dateText:{fontSize:m.theme.fontSizes.medium,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},timeSlotContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",backgroundColor:m.theme.colors.background,padding:12,borderRadius:8},bookingContent:{borderWidth:1,borderColor:m.theme.colors.border,backgroundColor:m.theme.colors.surface,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},timeAndReason:{flex:1},timeText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginBottom:4,fontFamily:m.theme.fonts.regular.fontFamily},reasonText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.textSecondary,fontFamily:m.theme.fonts.regular.fontFamily},removeButton:{padding:5,marginLeft:10},bookingButton:{padding:5,marginLeft:10,backgroundColor:m.theme.colors.surface,borderRadius:20,width:34,height:34,alignItems:"center",justifyContent:"center",shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:1,elevation:2},emptyText:{textAlign:"center",color:m.theme.colors.textSecondary,fontSize:m.theme.fontSizes.medium,marginTop:20,fontFamily:m.theme.fonts.regular.fontFamily}}),qn=({visible:e,onClose:t,selectedDates:o,currentAvailability:i,onRemoveTimeSlot:s,bookings:l})=>{const d=(0,b.useNavigation)(),c=(0,n.useRef)(new w.default.Value(0)).current,u=(0,n.useRef)(new w.default.Value(600)).current;(0,n.useEffect)((()=>{e&&(w.default.timing(c,{toValue:1,duration:300,useNativeDriver:!0}).start(),w.default.spring(u,{toValue:0,tension:50,friction:8,useNativeDriver:!0}).start())}),[e]);const h=()=>{w.default.parallel([w.default.timing(c,{toValue:0,duration:300,useNativeDriver:!0}),w.default.timing(u,{toValue:600,duration:300,useNativeDriver:!0})]).start((()=>{t()}))},f=e=>{const[t,o]=e.split(":"),n=new Date;return n.setHours(parseInt(t),parseInt(o)),(0,jn.format)(n,"h:mm a")},p=()=>{if(!o||0===o.length)return[];const e=[],t=new Set;return o.forEach((o=>{const n=l[o]||[],r=i[o];n.forEach((n=>{const r="".concat(o,"-").concat(n.startTime,"-").concat(n.endTime);t.has(r)||(e.push({date:o,startTime:n.startTime,endTime:n.endTime,reason:"".concat(n.service_type,"\nBooked with ").concat(n.owner_name),isBooking:!0,ownerId:n.ownerId}),t.add(r))})),r?.unavailableTimes&&r.unavailableTimes.filter((e=>!e.ownerId)).forEach((n=>{const r="".concat(o,"-").concat(n.startTime,"-").concat(n.endTime);t.has(r)||(e.push({date:o,startTime:n.startTime,endTime:n.endTime,reason:n.reason,isBooking:!1}),t.add(r))}))})),e.sort(((e,t)=>e.date!==t.date?e.date.localeCompare(t.date):e.startTime.localeCompare(t.startTime)))},y=e=>e.isBooking?(0,j.jsx)(v.default,{style:Vn.bookingButton,onPress:()=>(async e=>{t(),await(0,g.navigateToFrom)(d,"BookingDetails","AvailabilitySettings",{bookingId:e})})(e.ownerId),children:(0,j.jsx)(S.default,{name:"arrow-right",size:24,color:m.theme.colors.primary})}):(0,j.jsx)(v.default,{style:Vn.removeButton,onPress:()=>s(e.date,e),children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.error})});return(0,j.jsx)(k.default,{visible:e,transparent:!0,onRequestClose:h,children:(0,j.jsx)(w.default.View,{style:[Vn.modalContainer,{opacity:c}],children:(0,j.jsxs)(w.default.View,{style:[Vn.modalContent,{transform:[{translateY:u}]}],children:[(0,j.jsxs)(r.default,{style:Vn.modalHeader,children:[(0,j.jsx)(a.default,{style:Vn.modalTitle,children:"Unavailable Times"}),(0,j.jsx)(v.default,{onPress:h,style:Vn.closeButton,children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,j.jsxs)(X.default,{style:Vn.timesList,children:[p().map(((e,t)=>((e,t)=>{const o=(0,jn.format)((0,Sn.parse)(e.date,"yyyy-MM-dd",new Date),"MMM d, yyyy"),n=f(e.startTime),i=f(e.endTime);return(0,j.jsxs)(r.default,{style:Vn.timeSlotContainer,children:[(0,j.jsx)(r.default,{style:Vn.dateHeader,children:(0,j.jsx)(a.default,{style:Vn.dateText,children:o})}),(0,j.jsxs)(r.default,{style:[Vn.timeSlotContent,e.isBooking&&Vn.bookingContent],children:[(0,j.jsxs)(r.default,{style:Vn.timeAndReason,children:[(0,j.jsxs)(a.default,{style:Vn.timeText,children:[n," - ",i]}),(0,j.jsx)(a.default,{style:Vn.reasonText,children:e.reason})]}),y(e)]})]},t)})(e,t))),0===p().length&&(0,j.jsx)(a.default,{style:Vn.emptyText,children:"No unavailable times for selected date(s)"})]})]})})})},Yn=(e,t)=>i.default.create({mainContainer:{flex:1,backgroundColor:m.theme.colors.background,height:"100vh",overflow:"hidden",position:"fixed",top:0,left:0,right:0,bottom:0,marginLeft:e>900?t?70:250:0,transition:"margin-left 0.3s ease"},container:{flex:1},scrollView:{flex:1},scrollContent:{flexGrow:1},bottomSheetOverlay:{position:"absolute",bottom:0,left:0,right:0},centeredContainer:{maxWidth:e>900?1e3:"100%",width:"100%",alignSelf:"center",flex:1,padding:e<=900?10:20},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:e<=900?10:16,flexWrap:e<=600?"wrap":"nowrap",gap:e<=600?10:0},title:{fontSize:e<=600?m.theme.fontSizes.medium:m.theme.fontSizes.large,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily,width:e<=600?"100%":"auto"},addButton:{position:"absolute",right:20,bottom:20,width:56,height:56,borderRadius:28,backgroundColor:m.theme.colors.primary,justifyContent:"center",alignItems:"center",elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},defaultSettingsButton:{flexDirection:"row",alignItems:"center",padding:8},defaultSettingsText:{marginRight:8,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},colorKeyContainer:{marginTop:20,padding:e<=600?15:10,backgroundColor:"white",borderRadius:5,elevation:2,flexDirection:e<=600?"column":"row",flexWrap:"wrap",gap:10},colorKeyTitle:{fontSize:16,fontWeight:"bold",marginBottom:10,fontFamily:m.theme.fonts.header.fontFamily},colorKeyItem:{flexDirection:"row",alignItems:"center",marginVertical:e<=600?2:5,flex:e<=600?0:1},colorBox:{width:20,height:20,borderRadius:3,marginRight:10},colorKeyText:{fontSize:14,color:"black",fontFamily:m.theme.fonts.regular.fontFamily},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingText:{marginTop:10,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},errorText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.error,textAlign:"center",marginBottom:20,fontFamily:m.theme.fonts.regular.fontFamily},retryButton:{backgroundColor:m.theme.colors.primary,padding:10,borderRadius:5},retryButtonText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},overlay:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"black"},bottomSheetContainer:{position:"absolute",bottom:0,left:0,right:0},calendar:{paddingBottom:20,paddingLeft:10,paddingRight:10}}),Gn=()=>{const{screenWidth:e,isCollapsed:t,is_DEBUG:o}=(0,n.useContext)(h.AuthContext),[i,s]=(0,n.useState)(e<=900),l=Yn(e,t),[d,c]=(0,n.useState)({}),[u,g]=(0,n.useState)([]),[f,p]=(0,n.useState)(!1),[y,x]=(0,n.useState)(!1),[C,T]=(0,n.useState)("available"),[B,k]=(0,n.useState)({}),[_,I]=(0,n.useState)({}),[M,L]=(0,n.useState)({Monday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null},Tuesday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null},Wednesday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null},Thursday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null},Friday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null},Saturday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null},Sunday:{isAllDay:!1,isUnavailable:!1,startTime:"09:00",endTime:"17:00",endDate:null}}),[R,D]=(0,n.useState)(!0),[z,P]=(0,n.useState)(null),[F,E]=(0,n.useState)(!1),[W,O]=(0,n.useState)(!1),[N,H]=(0,n.useState)(!1),[U,V]=(0,n.useState)(!1),q=(0,b.useNavigation)(),Y=(0,n.useRef)(new w.default.Value(0)).current;(0,n.useEffect)((()=>{s(e<=900)}),[e]),(0,n.useEffect)((()=>{(async()=>{try{D(!0);const e=await new Promise((e=>{setTimeout((()=>{e({availableDates:{"2025-02-01":{startTime:"09:00",endTime:"17:00"},"2025-02-02":{startTime:"10:00",endTime:"18:00"},"2025-02-03":{startTime:"09:00",endTime:"17:00"}},unavailableDates:{"2025-02-04":{startTime:"00:00",endTime:"24:00"},"2025-02-05":{startTime:"10:00",endTime:"18:00"}},bookings:{"2025-02-06":[{id:"bk1",startTime:"14:00",endTime:"16:00",owner_name:"Charlie",service_type:"Dog Walking"},{id:"bk2",startTime:"16:00",endTime:"18:00",owner_name:"Bob",service_type:"Dog Walking"},{id:"bk3",startTime:"18:00",endTime:"20:00",owner_name:"Nick",service_type:"Pet Boarding"},{id:"bk4",startTime:"20:00",endTime:"22:00",owner_name:"Alfred",service_type:"Drop-In Visits (30 min)"}],"2025-02-07":[{id:"bk5",startTime:"10:00",endTime:"12:00",owner_name:"Uhtred",service_type:"Dog Walking"}]}})}),1e3)}));G(e.availableDates,e.unavailableDates,e.bookings);const t={};Object.keys(e.availableDates).forEach((e=>{t[e]={isAvailable:!0,unavailableTimes:[]}})),Object.keys(e.unavailableDates).forEach((o=>{t[o]={isAvailable:!1,unavailableTimes:[{startTime:e.unavailableDates[o].startTime,endTime:e.unavailableDates[o].endTime,reason:" Personal Time"}]}})),Object.keys(e.bookings).forEach((o=>{t[o]||(t[o]={isAvailable:!0,unavailableTimes:[]}),t[o].unavailableTimes=[...t[o].unavailableTimes,...e.bookings[o].map((e=>({startTime:e.startTime,endTime:e.endTime,reason:" Booked with ".concat(e.owner_name),ownerId:e.ownerId})))]})),k(t),I(e.bookings)}catch(e){P("Failed to load availability data"),console.error(e)}finally{D(!1)}})()}),[]);const G=(e,t,o)=>{const n={};Object.entries(t).forEach((([e,t])=>{const o="00:00"===t.startTime&&"24:00"===t.endTime,r=!!(a=t.reason)&&a.replace("Unavailable for: ","").split(", ").length===ve.length-1;var a;n[e]={customStyles:{container:{backgroundColor:o&&r?"lightgrey":m.theme.colors.calendarColor,width:35,height:35,borderRadius:17.5,alignItems:"center",justifyContent:"center"},text:{color:"white"}}}})),Object.entries(e).forEach((([e,t])=>{n[e]||(n[e]={customStyles:{container:{backgroundColor:"white",width:35,height:35,borderRadius:17.5,alignItems:"center",justifyContent:"center"},text:{color:"black"}}})})),Object.entries(o).forEach((([e,t])=>{const o=t.some((e=>"00:00"===e.startTime&&"24:00"===e.endTime));n[e]={marked:!0,dotColor:m.theme.colors.primary,customStyles:{container:{backgroundColor:o?m.theme.colors.primary:m.theme.colors.calendarColorYellowBrown,width:35,height:35,borderRadius:17.5,alignItems:"center",justifyContent:"center"},text:{color:"white"}}}})),c(n)},J=e=>{e?(H(!1),E(!0),w.default.timing(Y,{toValue:.5,duration:300,useNativeDriver:!0}).start()):(H(!0),w.default.timing(Y,{toValue:0,duration:300,useNativeDriver:!0}).start((()=>{E(!1),H(!1)})))},$=e=>{const t=Object.assign({},d),o=Object.assign({},B);e.dates.forEach((n=>{const r=e.serviceTypes.includes(xe)||e.serviceTypes.length===ve.length-1;e.isAvailable?(o[n]={isAvailable:!0,unavailableTimes:[]},t[n]={customStyles:{container:{backgroundColor:"white",width:35,height:35,borderRadius:17.5,alignItems:"center",justifyContent:"center"},text:{color:"black"}}}):(o[n]={isAvailable:!1,unavailableTimes:[{startTime:e.startTime,endTime:e.endTime,reason:e.reason}]},t[n]={customStyles:{container:{backgroundColor:e.isAllDay&&r?"lightgrey":m.theme.colors.calendarColor,width:35,height:35,borderRadius:17.5,alignItems:"center",justifyContent:"center"},text:{color:"white"}}})})),c(t),k(o),p(!1),g([])},K=S.default;return R?(0,j.jsx)(vn.SafeAreaView,{style:l.container,children:(0,j.jsxs)(r.default,{style:l.loadingContainer,children:[(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:l.loadingText,children:"Loading availability..."})]})}):z?(0,j.jsx)(vn.SafeAreaView,{style:l.container,children:(0,j.jsxs)(r.default,{style:l.errorContainer,children:[(0,j.jsx)(a.default,{style:l.errorText,children:z}),(0,j.jsx)(v.default,{style:l.retryButton,onPress:()=>{P(null),loadAvailabilityData()},children:(0,j.jsx)(a.default,{style:l.retryButtonText,children:"Retry"})})]})}):(0,j.jsxs)(r.default,{style:Yn(e,t).mainContainer,children:[(0,j.jsxs)(r.default,{style:Yn(e,t).container,children:[(0,j.jsx)(X.default,{style:Yn(e,t).scrollView,contentContainerStyle:Yn(e,t).scrollContent,showsVerticalScrollIndicator:!1,children:(0,j.jsxs)(r.default,{style:Yn(e,t).centeredContainer,children:[(0,j.jsxs)(r.default,{style:Yn(e,t).header,children:[(0,j.jsx)(a.default,{style:Yn(e,t).title,children:"Availability Settings"}),(0,j.jsxs)(v.default,{style:Yn(e,t).defaultSettingsButton,onPress:()=>x(!0),children:[(0,j.jsx)(a.default,{style:Yn(e,t).defaultSettingsText,children:"Default Settings"}),(0,j.jsx)(K,{name:"cog",size:24,color:m.theme.colors.text})]})]}),(0,j.jsx)(wn.Calendar,{style:[Yn(e,t).calendar,{width:e<=900?"100%":"auto"}],markedDates:d,onDayPress:e=>{const{dateString:t}=e,o=new Date(t);if(o.setDate(o.getDate()+1),o.setHours(0,0,0,0),0===u.length)g([t]),J(!0);else if(u.length>=1){const e=new Date(u[0]);if(e.setDate(e.getDate()+1),e.setHours(0,0,0,0),o.getTime()===e.getTime())return;if(o<e)return g([t]),void J(!0);const n=[],r=new Date(e),a=new Date(o);for(;r<=a;)n.push((0,jn.format)(r,"yyyy-MM-dd")),r.setDate(r.getDate()+1);g(n)}},theme:{backgroundColor:"transparent",calendarBackground:"transparent",textSectionTitleColor:m.theme.colors.text,selectedDayBackgroundColor:m.theme.colors.primary,selectedDayTextColor:"#ffffff",todayTextColor:m.theme.colors.primary,dayTextColor:m.theme.colors.text,textDisabledColor:"#d9e1e8",dotColor:m.theme.colors.primary,monthTextColor:m.theme.colors.text,arrowColor:m.theme.colors.primary,indicatorColor:m.theme.colors.primary}}),(0,j.jsxs)(r.default,{style:Yn(e,t).colorKeyContainer,children:[(0,j.jsx)(a.default,{style:Yn(e,t).colorKeyTitle,children:"Color Key"}),(0,j.jsxs)(r.default,{style:Yn(e,t).colorKeyItem,children:[(0,j.jsx)(r.default,{style:[Yn(e,t).colorBox,{backgroundColor:m.theme.colors.calendarColor}]}),(0,j.jsx)(a.default,{style:Yn(e,t).colorKeyText,children:"Unavailable"})]}),(0,j.jsxs)(r.default,{style:Yn(e,t).colorKeyItem,children:[(0,j.jsx)(r.default,{style:[Yn(e,t).colorBox,{backgroundColor:m.theme.colors.calendarColorYellowBrown}]}),(0,j.jsx)(a.default,{style:Yn(e,t).colorKeyText,children:"Partially Available"})]})]})]})}),(0,j.jsx)(v.default,{style:Yn(e,t).addButton,onPress:()=>p(!0),children:(0,j.jsx)(Cn.default,{name:"add",size:24,color:m.theme.colors.whiteText})})]}),f&&(0,j.jsx)(Dn,{visible:f,onClose:()=>p(!1),onSave:$,selectedDate:u.length>0?u[0]:null}),y&&(0,j.jsx)(Nn,{isVisible:y,onClose:()=>x(!1),onSave:e=>{console.log("Before updating defaultSettings:",M),console.log("New settings to be applied:",e),L(e),setTimeout((()=>{console.log("After updating defaultSettings:",M)}),0),(e=>{const t=Object.assign({},d),o=Object.assign({},B),n=new Date,r=new Date(n.getFullYear()+1,n.getMonth(),n.getDate()),a={Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6};Object.entries(e).forEach((([e,i])=>{let s=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate()));const l=a[e];for(;s<=(i.endDate?new Date(i.endDate):r);){const e=s.getUTCDay(),n=s.toISOString().split("T")[0];e===l&&(i.isUnavailable?i.isAllDay?(t[n]={customStyles:{container:{backgroundColor:"lightgrey"},text:{color:"white"}}},o[n]={isAvailable:!1,unavailableTimes:[{startTime:"00:00",endTime:"24:00",reason:"Default Setting"}]}):(t[n]={customStyles:{container:{backgroundColor:m.theme.colors.calendarColor},text:{color:"white"}}},o[n]={isAvailable:!0,unavailableTimes:[{startTime:i.startTime,endTime:i.endTime,reason:"Default Setting"}]}):(delete t[n],delete o[n])),s.setUTCDate(s.getUTCDate()+1)}})),c(t),k(o)})(e),x(!1)},defaultSettings:M}),(F||N)&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(w.default.View,{style:[l.overlay,{opacity:Y,backgroundColor:"black",pointerEvents:U?"none":"auto"}]}),(0,j.jsx)(r.default,{style:[l.bottomSheetContainer,{pointerEvents:"box-none"}],children:(0,j.jsx)(Un,{selectedDates:u,currentAvailability:B,onClose:()=>{J(!1),g([])},onViewUnavailableTimes:()=>{O(!0)},onSave:e=>{const{startTime:t,endTime:o,services:n,isAvailable:r}=e;$({dates:u,isAllDay:"00:00"===t&&"24:00"===o,startTime:t,endTime:o,isUnavailable:!r,serviceTypes:n,reason:"Unavailable for: ".concat(n.join(", "))}),J(!1),g([])},onViewBookings:()=>{u.length>0&&q.navigate("MyBookings",{selectedDates:u,initialTab:"Upcoming"})},onMinimize:e=>{V(e),w.default.timing(Y,{toValue:e?0:.5,duration:300,useNativeDriver:!0}).start()}})})]}),(0,j.jsx)(qn,{visible:W,onClose:()=>O(!1),selectedDates:u,currentAvailability:B,onRemoveTimeSlot:(e,t,o,n)=>{if(o&&n){k((e=>Object.assign({},e,o)));const e=Object.assign({},d);n.forEach((t=>{0===o[t]?.unavailableTimes.length&&(e[t]={customStyles:{container:{backgroundColor:"white"},text:{color:"black"}}})})),c(e)}else k((o=>{const n=o[e];if(!n)return o;const r=n.unavailableTimes.filter((e=>!(e.startTime===t.startTime&&e.endTime===t.endTime))),a=Object.assign({},d);return 0===r.length&&(a[e]={customStyles:{container:{backgroundColor:"white"},text:{color:"black"}}},c(a)),Object.assign({},o,{[e]:Object.assign({},n,{unavailableTimes:r})})}))},bookings:_})]})};var Jn=o(26318),$n=o(21055),Kn=o(29299),Zn=o(91808);const Xn=i.default.create({container:{flex:1,backgroundColor:m.theme.colors.background},androidContainer:{paddingTop:zt.default.currentHeight},scrollView:{flex:1},scrollViewContent:{padding:16,paddingBottom:16},card:{marginBottom:16,maxWidth:600,alignSelf:"center",width:"100%"},messageButtonContainer:{maxWidth:600,alignSelf:"center",width:"100%",marginTop:16},messageButton:{width:"100%"}}),Qn=({route:e,navigation:t})=>{const{ownerId:o}=e.params,{colors:n}=(0,ne.useTheme)(),a={id:o,name:"John Doe",email:"john.doe@example.com",phone:"(123) 456-7890",contracts:[{id:"1",date:"2023-05-01",status:"Completed"},{id:"2",date:"2023-04-15",status:"Pending"}],invoices:[{id:"1",date:"2023-05-02",amount:"$100",status:"Paid"},{id:"2",date:"2023-04-16",amount:"$75",status:"Unpaid"}],upcomingBookings:[{id:"1",date:"2023-06-01",service:"Dog Walking"},{id:"2",date:"2023-06-15",service:"Cat Sitting"}]},i=()=>(0,j.jsxs)(X.default,{style:Xn.scrollView,contentContainerStyle:Xn.scrollViewContent,children:[(0,j.jsx)(Jn.default,{style:Xn.card,children:(0,j.jsxs)(Jn.default.Content,{children:[(0,j.jsx)($n.default,{children:a.name}),(0,j.jsxs)(Kn.default,{children:["Email: ",a.email]}),(0,j.jsxs)(Kn.default,{children:["Phone: ",a.phone]})]})}),(0,j.jsx)(Jn.default,{style:Xn.card,children:(0,j.jsxs)(Jn.default.Content,{children:[(0,j.jsx)($n.default,{children:"Upcoming Bookings"}),a.upcomingBookings.map((e=>(0,j.jsx)(fn.default,{title:"Booking ".concat(e.id),description:"Date: ".concat(e.date," - Service: ").concat(e.service),left:e=>(0,j.jsx)(Zn.default,Object.assign({},e,{icon:"calendar"}))},e.id)))]})}),(0,j.jsxs)(Jn.default,{style:Xn.card,children:[(0,j.jsxs)(Jn.default.Content,{children:[(0,j.jsx)($n.default,{children:"Contracts"}),a.contracts.map((e=>(0,j.jsx)(fn.default,{title:"Contract ".concat(e.id),description:"Date: ".concat(e.date," - Status: ").concat(e.status),left:e=>(0,j.jsx)(Zn.default,Object.assign({},e,{icon:"file-document-outline"}))},e.id)))]}),(0,j.jsx)(Jn.default.Actions,{children:(0,j.jsx)(Ue.default,{onPress:()=>(0,g.navigateToFrom)(t,"Contracts","OwnerHistory",{ownerId:o}),children:"View All Contracts"})})]}),(0,j.jsxs)(Jn.default,{style:Xn.card,children:[(0,j.jsxs)(Jn.default.Content,{children:[(0,j.jsx)($n.default,{children:"Invoices"}),a.invoices.map((e=>(0,j.jsx)(fn.default,{title:"Invoice ".concat(e.id),description:"Date: ".concat(e.date," - Amount: ").concat(e.amount," - Status: ").concat(e.status),left:e=>(0,j.jsx)(Zn.default,Object.assign({},e,{icon:"file-document-outline"}))},e.id)))]}),(0,j.jsx)(Jn.default.Actions,{children:(0,j.jsx)(Ue.default,{onPress:()=>(0,g.navigateToFrom)(t,"Invoices","OwnerHistory",{ownerId:o}),children:"View All Invoices"})})]}),(0,j.jsx)(r.default,{style:Xn.messageButtonContainer,children:(0,j.jsx)(Ue.default,{mode:"contained",onPress:()=>(0,g.navigateToFrom)(t,"MessageHistory","OwnerHistory",{ownerId:o}),style:Xn.messageButton,children:"View Messages"})})]});return(0,j.jsx)(r.default,{style:Xn.container,children:(0,j.jsx)(i,{})})};o(69574),o(35708);i.default.create({container:{position:"relative"},dateTimeContainer:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.background,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,paddingHorizontal:12,height:40,width:"100%",justifyContent:"space-between"},dateInputGroup:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingHorizontal:4},timeInputGroup:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingHorizontal:4},numberInput:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,width:24,textAlign:"center",padding:0},yearInput:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,width:42,textAlign:"center",padding:0},separator:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginHorizontal:2},divider:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.border,marginHorizontal:8},periodButton:{backgroundColor:m.theme.colors.surface,borderRadius:4,paddingHorizontal:8,paddingVertical:4,marginLeft:8},periodText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontWeight:"500"},errorBorder:{borderColor:m.theme.colors.error},errorText:{color:m.theme.colors.error,fontSize:m.theme.fontSizes.small,marginTop:4},disabled:{backgroundColor:m.theme.colors.disabled,opacity:.7},icon:{marginLeft:8},pickerContainer:{position:"absolute",top:"100%",left:0,right:0,zIndex:1e3},calendar:{backgroundColor:m.theme.colors.surface,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,marginTop:4,padding:12,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},calendarHeader:{alignItems:"center",marginBottom:12},calendarHeaderText:{fontSize:m.theme.fontSizes.medium,fontWeight:"500"},calendarWeekDays:{flexDirection:"row",justifyContent:"space-around",marginBottom:8},calendarWeekDay:{width:36,textAlign:"center",fontSize:m.theme.fontSizes.small,color:m.theme.colors.placeholder},calendarWeek:{flexDirection:"row",justifyContent:"space-around",marginBottom:4},calendarDay:{width:36,height:36,justifyContent:"center",alignItems:"center",borderRadius:18},calendarDayText:{fontSize:m.theme.fontSizes.medium},selectedDay:{backgroundColor:m.theme.colors.primary},selectedDayText:{color:m.theme.colors.surface},timeSelector:{flexDirection:"row",backgroundColor:m.theme.colors.surface,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,marginTop:4,padding:12,gap:12,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},timeSelectorColumn:{flex:1,alignItems:"center"},timeSelectorLabel:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.placeholder,marginBottom:8},timeSelectorScroll:{height:200,width:"100%"},timeSelectorItem:{padding:12,alignItems:"center",borderRadius:4,width:"100%"},timeSelectorText:{fontSize:m.theme.fontSizes.medium},selectedTime:{backgroundColor:m.theme.colors.primary},selectedTimeText:{color:m.theme.colors.surface},periodContainer:{width:"100%"},disabledDay:{opacity:.3}});var er=o(62914);i.default.create({modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:m.theme.colors.background,borderRadius:8,padding:20,width:"95%",maxWidth:500},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},modalTitle:{fontSize:m.theme.fontSizes.largeLarge,fontWeight:"bold",fontFamily:m.theme.fonts.header.fontFamily},section:{position:"relative",marginBottom:16},label:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginBottom:2,fontFamily:m.theme.fonts.header.fontFamily},inputContainer:{position:"relative",zIndex:200,marginBottom:16},dollarSign:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginRight:4,fontFamily:m.theme.fonts.regular.fontFamily},input:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,padding:8,backgroundColor:m.theme.colors.background},buttonContainer:{flexDirection:"row",justifyContent:"space-between",gap:10,marginTop:16},button:{flex:1,paddingVertical:6},rateSection:{},rateContainer:{flexDirection:"row",alignItems:"flex-end",justifyContent:"space-between",gap:12},baseRateInput:{flex:1},timeUnitInput:{flex:1,marginTop:-32},picker:{backgroundColor:m.theme.colors.surface,borderRadius:8,height:39,borderWidth:1,borderColor:m.theme.colors.border,fontFamily:m.theme.fonts.regular.fontFamily},totalSection:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginTop:20,paddingTop:20,borderTopWidth:1,borderTopColor:m.theme.colors.border},totalLabel:{fontSize:m.theme.fontSizes.medium,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},totalAmount:{fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"bold",color:m.theme.colors.primary,fontFamily:m.theme.fonts.regular.fontFamily},errorText:{color:m.theme.colors.error,fontSize:m.theme.fontSizes.small,marginTop:8,marginBottom:8,fontFamily:m.theme.fonts.regular.fontFamily},rateRow:{flexDirection:"row",alignItems:"center",gap:10,marginBottom:10,width:"100%",flexWrap:"nowrap"},rateInput:{flex:2,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,height:39,padding:12,fontFamily:m.theme.fonts.regular.fontFamily,minWidth:0},rateAmountContainer:{flex:1,minWidth:0},rateAmountInput:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,height:39,padding:12,fontFamily:m.theme.fonts.regular.fontFamily,width:"100%"},addRateButton:{padding:10,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,alignItems:"center"},addRateButtonText:{color:m.theme.colors.primary,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},rateLabelContainer:{flexDirection:"row",marginTop:10,marginBottom:5},rateTitleLabel:{flex:2,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},rateAmountLabel:{flex:1,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginLeft:10,fontFamily:m.theme.fonts.regular.fontFamily},scrollView:{flex:1},scrollViewContent:{flexGrow:1},errorMessage:{color:m.theme.colors.error,fontSize:14,textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily,marginTop:8},loadingContainer:{minWidth:80,alignItems:"center",justifyContent:"center"}}),i.default.create({modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:m.theme.colors.background,borderRadius:8,padding:20,width:"90%",maxWidth:500,maxHeight:"80%"},modalTitle:{fontSize:m.theme.fontSizes.largeLarge,fontWeight:"bold",marginBottom:20,textAlign:"center"},scrollView:{maxHeight:"70%"},label:{fontSize:m.theme.fontSizes.medium,fontWeight:"500",marginTop:15,marginBottom:10},serviceOptions:{flexDirection:"row",flexWrap:"wrap",gap:10},serviceButton:{marginBottom:10},petOptions:{flexDirection:"row",flexWrap:"wrap",gap:10},petButton:{marginBottom:10},dateContainer:{gap:10},timeContainer:{flexDirection:"row",justifyContent:"space-between",gap:10},buttonContainer:{flexDirection:"row",justifyContent:"space-between",marginTop:20,gap:10},button:{flex:1},timePickerWrapper:{flex:1},dropdownContainer:{position:"relative",marginBottom:20,zIndex:3},dropdownInput:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,padding:12,backgroundColor:m.theme.colors.surface},dropdownList:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,maxHeight:200,zIndex:1e3,elevation:5},dropdownItem:{padding:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},dropdownText:{color:m.theme.colors.text},selectedOption:{color:m.theme.colors.primary,fontWeight:"bold"},petItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},petInfo:{flex:1},petName:{fontSize:m.theme.fontSizes.medium,fontWeight:"500",marginBottom:4},petDetails:{fontSize:m.theme.fontSizes.smallMedium,color:m.theme.colors.placeholder},addPetButton:{flexDirection:"row",alignItems:"center",padding:12,marginTop:8,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,justifyContent:"center"},addPetText:{marginLeft:8,color:m.theme.colors.primary,fontSize:m.theme.fontSizes.medium},occurrenceCard:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:15,backgroundColor:m.theme.colors.surface,borderRadius:8,marginBottom:10,borderWidth:1,borderColor:m.theme.colors.border},occurrenceDetails:{flex:1},dateText:{fontSize:m.theme.fontSizes.medium,fontWeight:"500",marginBottom:4},timeText:{fontSize:m.theme.fontSizes.smallMedium,color:m.theme.colors.placeholder},addOccurrenceButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:16,borderWidth:1,borderColor:m.theme.colors.primary,borderRadius:8,marginTop:12},addOccurrenceText:{marginLeft:8,color:m.theme.colors.primary,fontSize:m.theme.fontSizes.medium},occurrenceActions:{flexDirection:"row",alignItems:"center",gap:10},actionButton:{padding:8,borderWidth:1,borderColor:m.theme.colors.error,borderRadius:4},bookingRequestCard:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:16,margin:8,borderWidth:1,borderColor:m.theme.colors.primary},bookingRequestHeader:{flexDirection:"row",alignItems:"center",marginBottom:12,gap:8},bookingRequestTitle:{fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"bold",color:m.theme.colors.primary},bookingRequestDetails:{gap:8},detailLabel:{fontSize:m.theme.fontSizes.smallMedium,fontWeight:"500",color:m.theme.colors.placeholder},detailText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text},acceptButton:{backgroundColor:m.theme.colors.primary,padding:12,borderRadius:8,alignItems:"center",marginTop:16},acceptButtonText:{color:m.theme.colors.surface,fontSize:m.theme.fontSizes.medium,fontWeight:"500"},occurrenceCardError:{borderColor:m.theme.colors.error},errorText:{color:m.theme.colors.error,fontSize:m.theme.fontSizes.small,marginTop:4},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20}});const tr=i.default.create({container:{flex:1,backgroundColor:m.theme.colors.background},section:{padding:16},sectionTitle:{fontSize:18,fontFamily:m.theme.fonts.header.fontFamily,marginBottom:16,color:m.theme.colors.text},servicesGrid:{flexDirection:"row",flexWrap:"wrap",gap:12,justifyContent:"flex-start",width:"100%"},serviceCard:{width:"31%",minWidth:100,maxWidth:150,aspectRatio:1.2,backgroundColor:m.theme.colors.surface,borderRadius:12,padding:12,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:m.theme.colors.border,marginBottom:8},selectedServiceCard:{backgroundColor:"".concat(m.theme.colors.mainColors.main,"10"),borderColor:m.theme.colors.mainColors.main},serviceText:{marginTop:8,fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center",width:"100%"},selectedServiceText:{color:m.theme.colors.mainColors.main,fontWeight:"600"},petsContainer:{gap:12,flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start"},petCard:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surface,borderRadius:12,padding:12,borderWidth:1,borderColor:m.theme.colors.border,width:"calc(50% - 6px)",minWidth:250,maxWidth:400},selectedPetCard:{backgroundColor:"".concat(m.theme.colors.mainColors.main,"10"),borderColor:m.theme.colors.mainColors.main},petImageContainer:{marginRight:12},petImage:{width:48,height:48,borderRadius:24},defaultPetImage:{width:48,height:48,borderRadius:24,backgroundColor:m.theme.colors.surface,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:m.theme.colors.border},petInfo:{flex:1},petName:{fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:4,color:m.theme.colors.text},petDetails:{fontSize:14,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily},checkIcon:{marginLeft:12},selectedItemsContainer:{backgroundColor:"rgba(0, 0, 0, 0.03)",padding:16,borderRadius:8},selectedItemsTitle:{fontSize:14,fontFamily:m.theme.fonts.header.fontFamily,marginBottom:16,color:m.theme.colors.text},selectedItemsContent:{flexDirection:"row",flexWrap:"wrap",gap:8},selectedTag:{flexDirection:"row",alignItems:"center",backgroundColor:"".concat(m.theme.colors.mainColors.main,"10"),borderRadius:20,paddingVertical:6,paddingHorizontal:12,gap:8},selectedTagText:{color:m.theme.colors.mainColors.main,fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},errorText:{color:m.theme.colors.error,textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily},serviceCheckIcon:{position:"absolute",top:8,right:8},createServiceButton:{backgroundColor:m.theme.colors.mainColors.main,padding:16,borderRadius:8,alignItems:"center"},createServiceButtonText:{color:m.theme.colors.surface,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily}}),or=({bookingId:e,onServiceSelect:t,onPetSelect:i,onBatchPetSelect:s,selectedService:l,selectedPets:d,isLoading:c,error:u,onNext:f,currentBookingId:y,navigation:b,onClose:x,shouldFetchServices:w,shouldFetchPets:C,markServicesInitialized:T,markPetsInitialized:B,availableServices:k=[],availablePets:_=[],onServicesData:I,onPetsData:M})=>{const{is_DEBUG:L}=(0,n.useContext)(h.AuthContext);L&&console.log("MBA2ou09hv595: ServiceAndPetsCard component rendered/re-rendered",{bookingId:e,timestamp:(new Date).toISOString()});const[R,D]=(0,n.useState)([]),[z,P]=(0,n.useState)([]),F=k.length>0?k:R,E=_.length>0?_:z;(0,n.useEffect)((()=>{(0,h.debugLog)("MBA2ou09hv595","availableServices state changed",{bookingId:e,count:F.length,services:F.map((e=>({id:e.service_id,name:e.service_name}))),source:k.length>0?"parent":"local"})}),[F,k]),(0,n.useEffect)((()=>{(0,h.debugLog)("MBA2ou09hv595","availablePets state changed",{bookingId:e,count:E.length,pets:E.map((e=>({id:e.pet_id,name:e.name}))),source:_.length>0?"parent":"local"})}),[E,_]);const[W,O]=(0,n.useState)(!1),[N,H]=(0,n.useState)(!1),[U,V]=(0,n.useState)(null),[q,Y]=(0,n.useState)(null);(0,n.useEffect)((()=>{(0,h.debugLog)("MBA2ou09hv595","useEffect triggered",{bookingId:e,selectedService:l,selectedPetsCount:d.length,selectedPetIds:d.map((e=>e.pet_id)),currentAvailableServicesCount:F.length,currentAvailablePetsCount:E.length,timestamp:(new Date).toISOString()}),w&&w()?((0,h.debugLog)("MBA2ou09hv595","Parent says should fetch services",{bookingId:e,timestamp:(new Date).toISOString()}),G()):(0,h.debugLog)("MBA2ou09hv595","Parent says skip services fetch",{bookingId:e,timestamp:(new Date).toISOString()}),C&&C()?((0,h.debugLog)("MBA2ou09hv595","Parent says should fetch pets",{bookingId:e,timestamp:(new Date).toISOString()}),J()):(0,h.debugLog)("MBA2ou09hv595","Parent says skip pets fetch",{bookingId:e,timestamp:(new Date).toISOString()})}),[e]);const G=async()=>{try{L&&console.log("MBA2ou09hv595: fetchAvailableServices started",{bookingId:e,timestamp:(new Date).toISOString()}),O(!0),V(null);const t=await(0,bt.getBookingAvailableServices)(e);L&&console.log("MBA2ou09hv595: fetchAvailableServices completed",{bookingId:e,servicesCount:t.services?.length,timestamp:(new Date).toISOString()}),(0,h.debugLog)("MBA2ou09hv595","Setting available services in state",{bookingId:e,services:t.services,servicesCount:t.services?.length,responseKeys:Object.keys(t),timestamp:(new Date).toISOString()}),t.services&&Array.isArray(t.services)?I?I(t.services,t.selected_service_id):D(t.services):(0,h.debugLog)("MBA2ou09hv595","WARNING: Invalid services response",{bookingId:e,response:t,responseType:typeof t,servicesType:typeof t.services}),T&&T()}catch(u){L&&console.error("MBA12345 Error fetching services:",u),V("Failed to load available services"),T&&T(!0)}finally{O(!1)}},J=async()=>{try{L&&console.log("MBA2ou09hv595: fetchAvailablePets started",{bookingId:e,currentSelectedPets:d.map((e=>({id:e.pet_id,name:e.name}))),timestamp:(new Date).toISOString()}),H(!0),Y(null);const t=await(0,bt.getBookingAvailablePets)(e);L&&console.log("MBA2ou09hv595: fetchAvailablePets completed",{bookingId:e,petsCount:t.pets?.length,selectedPetIds:t.selected_pet_ids,timestamp:(new Date).toISOString()}),(0,h.debugLog)("MBA2ou09hv595","Setting available pets in state",{bookingId:e,pets:t.pets,petsCount:t.pets?.length,responseKeys:Object.keys(t),timestamp:(new Date).toISOString()}),t.pets&&Array.isArray(t.pets)?M?M(t.pets,t.selected_pet_ids):P(t.pets):(0,h.debugLog)("MBA2ou09hv595","WARNING: Invalid pets response",{bookingId:e,response:t,responseType:typeof t,petsType:typeof t.pets}),B&&B()}catch(u){L&&console.error("MBAio4wo4nou: Error fetching pets:",u),Y("Failed to load available pets"),B&&B(!0)}finally{L&&console.log("MBAio4wo4nou: fetchAvailablePets completed"),H(!1)}},$=e=>{switch(e.toLowerCase()){case"dog walking":default:return"paw";case"house sitting":return"home";case"drop-in visits":return"food-variant";case"boarding":return"home-city"}};return c?(0,j.jsx)(r.default,{style:tr.loadingContainer,children:(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.mainColors.main})}):u?(0,j.jsx)(r.default,{style:tr.errorContainer,children:(0,j.jsx)(a.default,{style:tr.errorText,children:u})}):((0,h.debugLog)("MBA2ou09hv595","ServiceAndPetsCard rendering with state",{bookingId:e,availableServicesCount:F.length,availablePetsCount:E.length,isLoadingServices:W,isLoadingPets:N,serviceError:U,petsError:q,selectedServiceId:l?.service_id,selectedPetsCount:d.length,timestamp:(new Date).toISOString()}),(0,j.jsxs)(X.default,{style:tr.container,children:[(0,j.jsxs)(r.default,{style:tr.section,children:[(0,j.jsx)(a.default,{style:tr.sectionTitle,children:"Select Service"}),U?(0,j.jsx)(a.default,{style:tr.errorText,children:U}):W?(0,j.jsx)(A.default,{size:"small",color:m.theme.colors.mainColors.main}):F.length>0?(0,j.jsx)(r.default,{style:tr.servicesGrid,children:F.map((e=>(e=>{const o=l?.service_id===e.service_id;return(0,j.jsxs)(v.default,{style:[tr.serviceCard,o&&tr.selectedServiceCard],onPress:()=>t(Object.assign({},e,{isOvernightForced:e.is_overnight})),children:[(0,j.jsx)(S.default,{name:$(e.service_name),size:24,color:o?m.theme.colors.mainColors.main:m.theme.colors.text}),(0,j.jsx)(a.default,{style:[tr.serviceText,o&&tr.selectedServiceText],children:e.service_name}),o&&(0,j.jsx)(S.default,{name:"check",size:24,color:m.theme.colors.mainColors.main,style:tr.serviceCheckIcon})]},e.service_id)})(e)))}):(0,j.jsxs)(r.default,{style:tr.noServicesContainer,children:[(0,j.jsx)(a.default,{style:tr.errorText,children:"No services available. Please add services to create a booking."}),(0,j.jsx)(v.default,{style:tr.createServiceButton,onPress:()=>{x(),(0,g.navigateToFrom)(b,"ServiceManager","MessageHistory")},children:(0,j.jsx)(a.default,{style:tr.createServiceButtonText,children:"Create Services"})})]})]}),(0,j.jsxs)(r.default,{style:tr.section,children:[(0,j.jsx)(a.default,{style:tr.sectionTitle,children:"Select Pets"}),q?(0,j.jsx)(a.default,{style:tr.errorText,children:q}):N?(0,j.jsx)(A.default,{size:"small",color:m.theme.colors.mainColors.main}):E.length>0?(0,j.jsx)(r.default,{style:tr.petsContainer,children:E.map((e=>(e=>{const t=d.some((t=>t.pet_id===e.pet_id));return L&&console.log("MBAio4wo4nou: Rendering pet card for ".concat(e.name),{petId:e.pet_id,isSelected:t,selectedPetsCount:d.length}),(0,j.jsxs)(v.default,{style:[tr.petCard,t&&tr.selectedPetCard],onPress:()=>{L&&console.log("MBAio4wo4nou: Pet card clicked:",{id:e.pet_id,name:e.name}),i(e)},children:[(0,j.jsx)(r.default,{style:tr.petImageContainer,children:e.profile_photo?(0,j.jsx)(Q.default,{source:{uri:(0,p.getMediaUrl)(e.profile_photo)},style:tr.petImage,defaultSource:o(65460)}):(0,j.jsx)(r.default,{style:tr.defaultPetImage,children:(0,j.jsx)(S.default,{name:"paw",size:24,color:m.theme.colors.placeHolderText})})}),(0,j.jsxs)(r.default,{style:tr.petInfo,children:[(0,j.jsx)(a.default,{style:tr.petName,children:e.name.toLowerCase().charAt(0).toUpperCase()+e.name.toLowerCase().slice(1)}),(0,j.jsxs)(a.default,{style:tr.petDetails,children:[e.species?e.species.toLowerCase().charAt(0).toUpperCase()+e.species.toLowerCase().slice(1):"No species"," \u2022 ",e.breed?e.breed.toLowerCase().charAt(0).toUpperCase()+e.breed.toLowerCase().slice(1):"No breed"]})]}),t&&(0,j.jsx)(S.default,{name:"check",size:24,color:m.theme.colors.mainColors.main,style:tr.checkIcon})]},e.pet_id)})(e)))}):(0,j.jsx)(a.default,{style:tr.errorText,children:"Please instruct client to add pets to their account so you can create a booking for their pets."})]})]}))},{width:nr,height:rr}=C.default.get("window"),ar=.4*rr,ir=nr>480,sr=i.default.create({container:{flex:1,backgroundColor:m.theme.colors.background,padding:12,minHeight:ir?600:"auto"},bookingTypeContainer:{flexDirection:"row",marginBottom:12,borderRadius:8,overflow:"hidden"},bookingTypeButton:{flex:1,paddingVertical:12,alignItems:"center",justifyContent:"center",backgroundColor:"#e8e8e8"},selectedBookingTypeButton:{backgroundColor:m.theme.colors.mainColors.main},bookingTypeText:{fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,color:m.theme.colors.text},selectedBookingTypeText:{color:m.theme.colors.surface,fontWeight:"600"},dateRangeTypeContainer:{flexDirection:"row",marginBottom:12,borderRadius:8,overflow:"hidden"},dateRangeTypeButton:{flex:1,paddingVertical:12,alignItems:"center",justifyContent:"center",backgroundColor:"#e8e8e8"},selectedDateRangeTypeButton:{backgroundColor:m.theme.colors.mainColors.main},dateRangeTypeText:{fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,color:m.theme.colors.text},selectedDateRangeTypeText:{color:m.theme.colors.surface,fontWeight:"600"},calendarContainer:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:12,marginBottom:12,maxHeight:ir?nr>700?600:500:ar,overflow:"visible",minHeight:ir?nr>700?500:400:350,display:"flex",flexDirection:"column"},calendarHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},calendarTitle:{fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",color:m.theme.colors.text},calendarNavButton:{padding:6},calendarNavButtonText:{fontSize:18,color:m.theme.colors.text},weekdaysContainer:{flexDirection:"row",justifyContent:"space-around",marginBottom:ir?8:4,paddingHorizontal:4},weekdayText:{flex:1,textAlign:"center",fontSize:12,color:m.theme.colors.text,opacity:.7,fontFamily:m.theme.fonts.regular.fontFamily},weekRow:{flexDirection:"row",justifyContent:"space-around",marginBottom:ir?12:4,minHeight:ir?nr>700?70:50:40,flex:1,paddingHorizontal:4},dateCell:{flex:1,aspectRatio:1,alignItems:"center",justifyContent:"center",borderRadius:4,padding:ir?4:2,minHeight:ir?nr>700?60:40:"auto"},dateText:{fontSize:ir&&nr>700?16:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},otherMonthDate:{opacity:.3},otherMonthDateText:{color:m.theme.colors.placeHolderText},selectedDate:{backgroundColor:m.theme.colors.mainColors.main},dateInRange:{backgroundColor:"".concat(m.theme.colors.mainColors.main,"80")},selectedDateText:{color:m.theme.colors.surface,fontWeight:"600"},selectedDatesContainer:{marginTop:12},selectedDatesTitle:{fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:6,color:m.theme.colors.text},selectedDatesList:{flexDirection:"row",flexWrap:"wrap",gap:6},selectedDateChip:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.backgroundContrast,borderRadius:16,paddingVertical:6,paddingLeft:10,paddingRight:6,marginRight:6,marginBottom:6},selectedDateChipText:{color:m.theme.colors.mainColors.main,fontFamily:m.theme.fonts.regular.fontFamily,fontSize:12,marginRight:2},removeButton:{marginLeft:4,padding:2},removeButtonText:{fontSize:16,color:m.theme.colors.mainColors.main,fontWeight:"bold"},dateRangeText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:8},recurringOptionsContainer:{marginTop:8},sectionTitle:{fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:8,color:m.theme.colors.text},daysOfWeekContainer:{flexDirection:"row",justifyContent:"space-between",marginBottom:16},dayOfWeekButton:{width:40,height:40,borderRadius:20,alignItems:"center",justifyContent:"center",backgroundColor:"#e8e8e8"},selectedDayOfWeekButton:{backgroundColor:m.theme.colors.mainColors.main},dayOfWeekText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},selectedDayOfWeekText:{color:m.theme.colors.surface,fontWeight:"600"},dateRangeSection:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:12,marginBottom:16,borderWidth:1,borderColor:m.theme.colors.modernBorder},dateRangeRow:{flexDirection:"row",justifyContent:"space-between"},dateRangeColumn:{flex:1,backgroundColor:m.theme.colors.surface,padding:8,borderRadius:8},dateRangeLabel:{fontSize:14,color:m.theme.colors.text,opacity:.7,marginBottom:4,fontFamily:m.theme.fonts.regular.fontFamily},dateRangeValue:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},frequencyContainer:{flexDirection:"row",marginBottom:16},frequencyButton:{flex:1,paddingVertical:10,paddingHorizontal:8,alignItems:"center",justifyContent:"center",backgroundColor:"#e8e8e8",borderRadius:8,marginRight:8},selectedFrequencyButton:{backgroundColor:m.theme.colors.mainColors.main},frequencyText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},selectedFrequencyText:{color:m.theme.colors.surface,fontWeight:"600"},recurrencePatternContainer:{backgroundColor:m.theme.colors.backgroundContrast,borderRadius:8,padding:12,marginBottom:16},recurrencePatternTitle:{fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:4,color:m.theme.colors.text},recurrencePatternText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,marginBottom:2},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:16,width:"90%",maxWidth:400},modalTitle:{fontSize:18,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:16,textAlign:"center",color:m.theme.colors.text},modalCloseButton:{marginTop:16,paddingVertical:12,alignItems:"center",backgroundColor:m.theme.colors.backgroundContrast,borderRadius:8},modalCloseButtonText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},previewButton:{marginTop:8,paddingVertical:8,paddingHorizontal:12,backgroundColor:m.theme.colors.mainColors.main,borderRadius:8,alignSelf:"flex-start"},previewButtonText:{color:m.theme.colors.surface,fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily},previewModalContent:{maxHeight:"80%"},previewCalendarContainer:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:12,marginVertical:16},recurringDate:{backgroundColor:m.theme.colors.mainColors.main},recurringDateText:{color:m.theme.colors.surface,fontWeight:"600"},previewDateCell:{flex:1,aspectRatio:1,alignItems:"center",justifyContent:"center",borderRadius:4,padding:2},dateRangeChip:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",backgroundColor:m.theme.colors.backgroundContrast,borderRadius:16,paddingVertical:8,paddingLeft:12,paddingRight:8},removeRangeButton:{marginLeft:8,padding:4},selectedDateChip:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.backgroundContrast,borderRadius:16,paddingVertical:6,paddingLeft:10,paddingRight:6,marginRight:6,marginBottom:6},removeButton:{marginLeft:4,padding:2},removeButtonText:{fontSize:16,color:m.theme.colors.mainColors.main,fontWeight:"bold"},oneTimeOptionsContainer:{marginTop:8},dateSelectionTitle:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:16,paddingHorizontal:4}}),lr=({selectedDates:e=[],onDateSelect:t,bookingType:o="one-time",dateRangeType:i="date-range",initialDateRange:s=null,isOvernightForced:l=!1})=>{const{is_DEBUG:d,screenWidth:c}=(0,n.useContext)(h.AuthContext),[u,g]=(0,n.useState)(new Date),[m,f]=(0,n.useState)(e),[p,y]=(0,n.useState)(l?"one-time":o),[b,x]=(0,n.useState)("date-range"),[w,C]=(0,n.useState)(s?s.startDate:null),[S,T]=(0,n.useState)([1,3]),[B,A]=(0,n.useState)("weekly"),[_,I]=(0,n.useState)(s?s.endDate:null),[M,L]=(0,n.useState)(!1),[R,D]=(0,n.useState)(new Date),[z,P]=(0,n.useState)((()=>{const e=new Date;return e.setMonth(e.getMonth()+1),e})),[F,E]=(0,n.useState)(!0),[W,O]=(0,n.useState)(!1),[N,H]=(0,n.useState)(!1),[U,V]=(0,n.useState)(null),[q,Y]=(0,n.useState)(null),[G,J]=(0,n.useState)(!1),[$,K]=(0,n.useState)(null);(0,n.useEffect)((()=>{if((0,h.debugLog)("MBA54321 DateSelectionCard initialized with dates:",e),(0,h.debugLog)("MBA54321 Current booking type:",o),(0,h.debugLog)("MBA54321 Current date range type:",i),(0,h.debugLog)("MBA54321 Initial date range:",s),(0,h.debugLog)("MBA54321 isOvernightForced:",l),y(l?"one-time":o),x(l?"date-range":"multiple-days"),e&&e.length>0){const n=e.map((e=>e instanceof Date?e:"object"===typeof e&&e.date?new Date(e.date):new Date(e)));f(n);const r=Z(n);if(("date-range"===i||l)&&n.length>0&&r){const e=[...n].sort(((e,t)=>e-t));C(e[0]),I(e[e.length-1]),J(!0)}else n.length>0&&J(!1);if(t){const e={type:o,dates:n,rangeType:l?"date-range":"multiple-days",isValid:!0};if(("date-range"===i||l)&&n.length>0&&r){const t=[...n].sort(((e,t)=>e-t));e.startDate=t[0],e.endDate=t[t.length-1]}t(e)}}}),[]);const Z=e=>{if(!e||e.length<=1)return!0;const t=[...e].sort(((e,t)=>e-t));for(let o=1;o<t.length;o++){const e=new Date(t[o-1]),n=new Date(t[o]);if(e.setDate(e.getDate()+1),e.getTime()!==n.getTime())return(0,h.debugLog)("MBA54321 Non-consecutive dates found:",{prev:t[o-1].toISOString().split("T")[0],current:t[o].toISOString().split("T")[0]}),!1}return!0};(0,n.useEffect)((()=>{if(s&&s.startDate&&s.endDate&&!G){if(m.length>0&&!Z(m))return(0,h.debugLog)("MBA54321 Non-consecutive dates already loaded, not converting to range"),void(t&&t({type:o,dates:m,rangeType:"multiple-days",isValid:m.length>0}));const e=[],n=new Date(s.startDate),r=new Date(s.endDate);for(;n<=r;)e.push(new Date(n)),n.setDate(n.getDate()+1);f(e),C(new Date(s.startDate)),I(new Date(s.endDate)),J(!0),t&&t({type:o,dates:e,rangeType:"date-range",startDate:new Date(s.startDate),endDate:new Date(s.endDate),isValid:!0})}}),[s,G]);const Q=e=>{d&&console.log("MBA54321 Frequency selected:",e),A(e)},ee=()=>{const e=new Date(u);e.setMonth(e.getMonth()-1),g(e)},te=()=>{const e=new Date(u);e.setMonth(e.getMonth()+1),g(e)},oe=e=>m.some((t=>{if(!(t instanceof Date))if("string"===typeof t)t=new Date(t);else{if(!t||"string"!==typeof t.date)return!1;t=new Date(t.date)}return t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()})),ne=e=>{if(d&&(console.log("MBA19ynkiy34b handleDateRangeSelection - date:",e),console.log("MBA19ynkiy34b handleDateRangeSelection - current state:",{rangeStartDate:w,dateRangeEnd:_,selectedDatesList:m.length})),m.length>1&&!Z(m))return(0,h.debugLog)("MBA19ynkiy34b handleDateRangeSelection - clearing non-consecutive dates for date range"),f([e]),C(e),I(null),J(!1),void(t&&t({type:"one-time",dates:[e],rangeType:"date-range",startDate:e,isValid:!1}));if(m.length>1&&!Z(m))return"multiple-days"!==b&&((0,h.debugLog)("MBA19ynkiy34b Non-consecutive dates exist, forcing multiple-days mode"),x("multiple-days")),void re(e);if(w)if(_)C(e),f([e]),I(null),K(null),d&&console.log("MBA19ynkiy34b handleDateRangeSelection - resetting selection"),t&&t({type:"one-time",dates:[e],rangeType:"date-range",startDate:e,isValid:!1});else{let o=new Date(w),n=new Date(e);e<w&&(o=new Date(e),n=new Date(w)),I(n);const r=[],a=new Date(o);for(;a<=n;)r.push(new Date(a)),a.setDate(a.getDate()+1);if(f(r),K({startDate:o,endDate:n,dates:r}),t){const e={type:"one-time",dates:r,rangeType:"date-range",startDate:o,endDate:n,isValid:!0};d&&console.log("MBA19ynkiy34b handleDateRangeSelection - complete range selected, sending data:",e),t(e)}}else C(e),f([e]),I(null),K(null),d&&console.log("MBA19ynkiy34b handleDateRangeSelection - first date selected"),t&&t({type:"one-time",dates:[e],rangeType:"date-range",startDate:e,isValid:!1})},re=e=>{d&&(console.log("MBA19ynkiy34b toggleDateSelection - date:",e),console.log("MBA19ynkiy34b toggleDateSelection - current selected dates:",m.length));let o;if(o=oe(e)?m.filter((t=>{if(!(t instanceof Date))if("string"===typeof t)t=new Date(t);else{if(!t||"string"!==typeof t.date)return!0;t=new Date(t.date)}return!(t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear())})):[...m,e].sort(((e,t)=>e-t)),f(o),t){const e={type:"one-time",dates:o,rangeType:"multiple-days",isValid:o.length>0};d&&(console.log("MBA19ynkiy34b toggleDateSelection - sending data:",e),console.log("MBA19ynkiy34b toggleDateSelection - newSelectedDates length:",o.length)),t(e)}},ae=()=>{const e=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t=S.map((t=>e[t]));if(0===t.length)return"No days selected";let o="";if(1===t.length)o=t[0];else if(2===t.length)o="".concat(t[0]," and ").concat(t[1]);else{const e=t.pop();o="".concat(t.join(", "),", and ").concat(e)}switch(B){case"bi-weekly":return"every other ".concat(o);case"monthly":const e=ie(R);return"the ".concat(e," ").concat(o," of each month");default:return"every ".concat(o)}},ie=e=>{const t=Math.ceil((e.getDate()+(0===e.getDay()?6:e.getDay()-1))/7);return["first","second","third","fourth","last"][Math.min(t-1,4)]},se=()=>{const e=new Date(u.getFullYear(),u.getMonth(),1),o=new Date(u.getFullYear(),u.getMonth()+1,0),n=new Date(e),i=new Date(o);n.setDate(n.getDate()-n.getDay()),i.setDate(i.getDate()+(6-i.getDay()));const s=[];let c=[],g=new Date(n);for(;g<=i;){for(let e=0;e<7;e++)c.push(new Date(g)),g.setDate(g.getDate()+1);s.push(c),c=[]}const m=u.toLocaleString("default",{month:"long"}),h=u.getFullYear();return(0,j.jsxs)(r.default,{style:sr.calendarContainer,children:[(0,j.jsxs)(r.default,{style:sr.calendarHeader,children:[(0,j.jsx)(v.default,{onPress:ee,style:sr.calendarNavButton,children:(0,j.jsx)(a.default,{style:sr.calendarNavButtonText,children:"<"})}),(0,j.jsx)(a.default,{style:sr.calendarTitle,children:"".concat(m," ").concat(h)}),(0,j.jsx)(v.default,{onPress:te,style:sr.calendarNavButton,children:(0,j.jsx)(a.default,{style:sr.calendarNavButtonText,children:">"})})]}),(0,j.jsx)(r.default,{style:sr.weekdaysContainer,children:["S","M","T","W","T","F","S"].map(((e,t)=>(0,j.jsx)(a.default,{style:sr.weekdayText,children:e},"weekday-".concat(t))))}),s.map(((e,o)=>(0,j.jsx)(r.default,{style:sr.weekRow,children:e.map(((e,n)=>{const r=(e=>{const t=new Date;return t.setHours(0,0,0,0),e.getMonth()<u.getMonth()?e.getMonth()===(u.getMonth()-1+12)%12&&e>=t:e.getMonth()>u.getMonth()?e.getMonth()===(u.getMonth()+1)%12&&e>=t:e>=t})(e),i=oe(e),s="date-range"===b&&(e=>!(!w||!_)&&e>=w&&e<=_)(e),c=N&&(e=>!(!U||!e)&&(q?e>=U&&e<=q:e.getTime()===U.getTime()))(e);return(0,j.jsx)(v.default,{style:[sr.dateCell,!r&&sr.otherMonthDate,i&&sr.selectedDate,s&&sr.dateInRange,c&&sr.dateInRange],onPress:()=>r&&(N?(e=>{if(d&&(console.log("MBA19ynkiy34b handleRecurringDateSelect - date:",e),console.log("MBA19ynkiy34b handleRecurringDateSelect - current state:",{tempRangeStart:U,selectedDaysOfWeek:S.length,frequency:B})),U){let o=U,n=e;if(e<U&&(o=e,n=U),D(o),P(n),V(null),Y(null),H(!1),t){const e={type:"recurring",daysOfWeek:S,frequency:B,startDate:o,endDate:n,isValid:S.length>0};d&&(console.log("MBA19ynkiy34b handleRecurringDateSelect - complete selection, sending data:",e),console.log("MBA19ynkiy34b handleRecurringDateSelect - selectedDaysOfWeek:",S)),t(e)}}else V(e),D(e),d&&console.log("MBA19ynkiy34b handleRecurringDateSelect - first date selected"),t&&t({type:"recurring",startDate:e,daysOfWeek:S,frequency:B,isValid:!1})})(e):(e=>{d&&console.log("MBA54321 Date selected:",e),l||"date-range"===b?ne(e):re(e)})(e)),disabled:!r,children:(0,j.jsx)(a.default,{style:[sr.dateText,!r&&sr.otherMonthDateText,(i||s||c)&&sr.selectedDateText],children:e.getDate()})},"date-".concat(o,"-").concat(n))}))},"week-".concat(o))))]})},le=e=>{const t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()],o=e.getDate(),n=e.getFullYear();return"".concat(t," ").concat(o,", ").concat(n)},de=()=>{d&&console.log("MBA54321 Clearing date range"),f([]),C(null),I(null),J(!1),K(null),t&&t({type:"one-time",dates:[],rangeType:b,startDate:null,endDate:null,isValid:!1})};return(0,n.useEffect)((()=>{d&&console.log("MBA19ynkiy34b Component mounted with:",{selectedDates:e,bookingType:o,dateRangeType:i})}),[]),(0,j.jsxs)(X.default,{style:sr.container,children:[l||"one-time"===p?(0,j.jsxs)(r.default,{style:sr.oneTimeOptionsContainer,children:[(0,j.jsx)(a.default,{style:[sr.dateSelectionTitle,{fontSize:c>768?24:18}],children:l?"Select a date range":"Select one or more dates"}),se(),(()=>{if(0===m.length)return null;if("date-range"===b&&(_||G&&s)){const e=w||s?.startDate||m[0],t=_||s?.endDate||m[m.length-1];return(0,j.jsxs)(r.default,{style:sr.selectedDatesContainer,children:[(0,j.jsx)(a.default,{style:sr.selectedDatesTitle,children:"Selected Range:"}),(0,j.jsxs)(r.default,{style:sr.dateRangeChip,children:[(0,j.jsxs)(a.default,{style:sr.dateRangeText,children:["From ",le(e)," to ",le(t)]}),(0,j.jsx)(v.default,{onPress:de,style:sr.removeRangeButton,children:(0,j.jsx)(a.default,{style:sr.removeButtonText,children:"\xd7"})})]})]})}return(0,j.jsxs)(r.default,{style:sr.selectedDatesContainer,children:[(0,j.jsx)(a.default,{style:sr.selectedDatesTitle,children:"Selected Dates:"}),(0,j.jsx)(r.default,{style:sr.selectedDatesList,children:m.map(((e,t)=>(0,j.jsxs)(r.default,{style:sr.selectedDateChip,children:[(0,j.jsx)(a.default,{style:sr.selectedDateChipText,children:le(e)}),(0,j.jsx)(v.default,{onPress:()=>re(e),style:sr.removeButton,children:(0,j.jsx)(a.default,{style:sr.removeButtonText,children:"\xd7"})})]},"selected-date-".concat(t))))})]})})()]}):"recurring"!==p?null:(0,j.jsxs)(r.default,{style:sr.recurringOptionsContainer,children:[(0,j.jsx)(a.default,{style:sr.sectionTitle,children:"Repeat on"}),(0,j.jsx)(r.default,{style:sr.daysOfWeekContainer,children:["M","T","W","T","F","S","S"].map(((e,t)=>{const o=6===t?0:t+1,n=S.includes(o);return(0,j.jsx)(v.default,{style:[sr.dayOfWeekButton,n&&sr.selectedDayOfWeekButton],onPress:()=>(e=>{d&&console.log("MBA54321 Day of week toggled:",e),T((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))})(o),children:(0,j.jsx)(a.default,{style:[sr.dayOfWeekText,n&&sr.selectedDayOfWeekText],children:e})},"day-".concat(t))}))}),(0,j.jsxs)(r.default,{style:sr.dateRangeSection,children:[(0,j.jsxs)(r.default,{style:sr.dateRangeRow,children:[(0,j.jsxs)(v.default,{style:sr.dateRangeColumn,onPress:()=>H(!0),children:[(0,j.jsx)(a.default,{style:sr.dateRangeLabel,children:"From"}),(0,j.jsx)(a.default,{style:sr.dateRangeValue,children:le(R)})]}),(0,j.jsxs)(v.default,{style:sr.dateRangeColumn,onPress:()=>H(!0),children:[(0,j.jsx)(a.default,{style:sr.dateRangeLabel,children:"To"}),(0,j.jsx)(a.default,{style:sr.dateRangeValue,children:le(z)})]})]}),N?(0,j.jsx)(r.default,{style:sr.dropdownCalendar,children:(0,j.jsxs)(r.default,{style:sr.dropdownCalendarContent,children:[se(),(0,j.jsx)(v.default,{style:sr.dropdownCloseButton,onPress:()=>{H(!1),V(null),Y(null)},children:(0,j.jsx)(a.default,{style:sr.dropdownCloseButtonText,children:"Cancel"})})]})}):null]}),(0,j.jsx)(a.default,{style:sr.sectionTitle,children:"Frequency"}),(0,j.jsxs)(r.default,{style:sr.frequencyContainer,children:[(0,j.jsx)(v.default,{style:[sr.frequencyButton,"weekly"===B&&sr.selectedFrequencyButton],onPress:()=>Q("weekly"),children:(0,j.jsx)(a.default,{style:[sr.frequencyText,"weekly"===B&&sr.selectedFrequencyText],children:"Weekly"})}),(0,j.jsx)(v.default,{style:[sr.frequencyButton,"bi-weekly"===B&&sr.selectedFrequencyButton],onPress:()=>Q("bi-weekly"),children:(0,j.jsx)(a.default,{style:[sr.frequencyText,"bi-weekly"===B&&sr.selectedFrequencyText],children:"Bi-weekly"})}),(0,j.jsx)(v.default,{style:[sr.frequencyButton,"monthly"===B&&sr.selectedFrequencyButton],onPress:()=>Q("monthly"),children:(0,j.jsx)(a.default,{style:[sr.frequencyText,"monthly"===B&&sr.selectedFrequencyText],children:"Monthly"})})]}),(0,j.jsxs)(r.default,{style:sr.recurrencePatternContainer,children:[(0,j.jsx)(a.default,{style:sr.recurrencePatternTitle,children:"Recurrence Pattern:"}),(0,j.jsx)(a.default,{style:sr.recurrencePatternText,children:ae()}),(0,j.jsxs)(a.default,{style:sr.recurrencePatternText,children:["From ",le(R)," to ",le(z)]}),(0,j.jsx)(v.default,{style:sr.previewButton,onPress:()=>O(!0),children:(0,j.jsx)(a.default,{style:sr.previewButtonText,children:"View on Calendar"})})]})]}),(0,j.jsx)((()=>{const[e,t]=(0,n.useState)(new Date(R)),o=()=>{const o=new Date(e);o.setMonth(o.getMonth()-1),t(o)},i=()=>{const o=new Date(e);o.setMonth(o.getMonth()+1),t(o)};return(0,j.jsx)(k.default,{visible:W,transparent:!0,animationType:"fade",onRequestClose:()=>O(!1),children:(0,j.jsx)(r.default,{style:sr.modalOverlay,children:(0,j.jsxs)(r.default,{style:[sr.modalContent,sr.previewModalContent],children:[(0,j.jsx)(a.default,{style:sr.modalTitle,children:"Recurring Dates Preview"}),(()=>{const t=new Date(e.getFullYear(),e.getMonth(),1),n=new Date(e.getFullYear(),e.getMonth()+1,0),s=new Date(t),l=new Date(n);s.setDate(s.getDate()-s.getDay()),l.setDate(l.getDate()+(6-l.getDay()));const d=[];let c=[],u=new Date(s);const g=(()=>{if(!R||!z||0===S.length)return new Set;const e=new Set,t=new Date(R),o=new Date(z);for(;t<=o;)S.includes(t.getDay())&&("weekly"===B?e.add(new Date(t).getTime()):"bi-weekly"===B?Math.floor((t-R)/6048e5)%2===0&&e.add(new Date(t).getTime()):"monthly"===B&&ie(R)===ie(t)&&e.add(new Date(t).getTime())),t.setDate(t.getDate()+1);return e})();for(;u<=l;){for(let e=0;e<7;e++)c.push(new Date(u)),u.setDate(u.getDate()+1);d.push(c),c=[]}const m=e.toLocaleString("default",{month:"long"}),h=e.getFullYear();return(0,j.jsxs)(r.default,{style:sr.previewCalendarContainer,children:[(0,j.jsxs)(r.default,{style:sr.calendarHeader,children:[(0,j.jsx)(v.default,{onPress:o,style:sr.calendarNavButton,children:(0,j.jsx)(a.default,{style:sr.calendarNavButtonText,children:"<"})}),(0,j.jsx)(a.default,{style:sr.calendarTitle,children:"".concat(m," ").concat(h)}),(0,j.jsx)(v.default,{onPress:i,style:sr.calendarNavButton,children:(0,j.jsx)(a.default,{style:sr.calendarNavButtonText,children:">"})})]}),(0,j.jsx)(r.default,{style:sr.weekdaysContainer,children:["S","M","T","W","T","F","S"].map(((e,t)=>(0,j.jsx)(a.default,{style:sr.weekdayText,children:e},"weekday-".concat(t))))}),d.map(((t,o)=>(0,j.jsx)(r.default,{style:sr.weekRow,children:t.map(((t,n)=>{const i=t.getMonth()===e.getMonth(),s=g.has(t.getTime());return(0,j.jsx)(r.default,{style:[sr.previewDateCell,!i&&sr.otherMonthDate,s&&sr.recurringDate],children:(0,j.jsx)(a.default,{style:[sr.dateText,!i&&sr.otherMonthDateText,s&&sr.recurringDateText],children:t.getDate()})},"date-".concat(o,"-").concat(n))}))},"week-".concat(o))))]})})(),(0,j.jsx)(v.default,{style:sr.modalCloseButton,onPress:()=>O(!1),children:(0,j.jsx)(a.default,{style:sr.modalCloseButtonText,children:"Close"})})]})})})}),{})]})},dr=Array.from({length:12},((e,t)=>0===t?12:t)),cr=Array.from({length:60},((e,t)=>t)).filter((e=>e%5===0)),ur=["AM","PM"],gr=i.default.create({timeDisplay:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",backgroundColor:m.theme.colors.surface,padding:10,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.modernBorder,marginVertical:5},timeText:{flex:1,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontSize:m.theme.fontSizes.medium,marginLeft:8},dropdownContainer:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:m.theme.colors.background,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.modernBorder,marginTop:4,zIndex:1e3,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},inlineContainer:{backgroundColor:m.theme.colors.background,borderRadius:8,padding:4},label:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontSize:m.theme.fontSizes.small,marginBottom:8},dropdownContent:{flexDirection:"row",padding:4},column:{flex:1,height:160},option:{padding:8,alignItems:"center",height:40,justifyContent:"center"},selectedOption:{backgroundColor:"".concat(m.theme.colors.mainColors.main,"20"),borderRadius:4},optionText:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontSize:m.theme.fontSizes.medium},selectedOptionText:{color:m.theme.colors.mainColors.main,fontWeight:"600"},buttonRow:{flexDirection:"row",justifyContent:"space-between",marginTop:8,paddingHorizontal:4},button:{paddingVertical:8,paddingHorizontal:16,borderRadius:6,flex:1,marginHorizontal:4,alignItems:"center"},confirmButton:{backgroundColor:m.theme.colors.mainColors.main},cancelButton:{backgroundColor:m.theme.colors.modernBorder},confirmButtonText:{color:"white",fontFamily:m.theme.fonts.medium.fontFamily,fontSize:m.theme.fontSizes.small},cancelButtonText:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontSize:m.theme.fontSizes.small},errorContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#FFEBEE",padding:8,marginHorizontal:4,marginTop:4,borderRadius:4},errorText:{color:m.theme.colors.error||"#D32F2F",fontSize:m.theme.fontSizes.small,fontFamily:m.theme.fonts.regular.fontFamily,marginLeft:4,flex:1}}),mr=({initialTime:e,onTimeSelect:t,isOpen:o,onClose:i,label:s="Time",uniqueId:l="default",showInlinePicker:d=!1})=>{const c=(0,n.useRef)(null),u=(0,n.useRef)(null),g=(0,n.useRef)(null),f=JSON.parse(JSON.stringify(e||{hours:9,minutes:0})),p=()=>{const e=f.hours,t=5*Math.round(f.minutes/5);return{hour:e%12===0?12:e%12,minute:t>=60?0:t,period:e>=12?"PM":"AM"}},[y,b]=(0,n.useState)(p()),[x,w]=(0,n.useState)(p()),[C,S]=(0,n.useState)(null);(0,n.useEffect)((()=>{if(e){const e=p();b(e),w(e),S(null)}}),[e?.hours,e?.minutes]),(0,n.useEffect)((()=>{if(C){const e=setTimeout((()=>{S(null)}),5e3);return()=>clearTimeout(e)}}),[C]),(0,n.useEffect)((()=>{o&&setTimeout((()=>{k()}),50)}),[o,y]);const T=()=>{(e=>{const{hour:o,minute:n,period:r}=e;let a=o;"PM"===r&&12!==o&&(a+=12),"AM"===r&&12===o&&(a=0);const s={hours:a,minutes:n};(0,h.debugLog)("MBAoi9uv43d: TimePickerDropdown selected time (".concat(l,"):"),{time12h:e,time24h:s}),w(e),!1===t(s)?(Et.default.alert("Invalid Time Selection",l.includes("start")?"Start time cannot be later than end time.":"End time cannot be earlier than start time.",[{text:"OK"}]),S(l.includes("start")?"Start time cannot be later than end time.":"End time cannot be earlier than start time.")):i()})(y)},B=()=>{b(x),S(null),i()},k=()=>{if(c.current){const e=40*dr.indexOf(y.hour);c.current.scrollTo({y:Math.max(0,e-40),animated:!0})}if(u.current){const e=40*cr.indexOf(y.minute);u.current.scrollTo({y:Math.max(0,e-40),animated:!0})}if(g.current){const e=40*ur.indexOf(y.period);g.current.scrollTo({y:Math.max(0,e-20),animated:!0})}},A=()=>(0,j.jsxs)(r.default,{children:[(0,j.jsxs)(r.default,{style:gr.dropdownContent,children:[(0,j.jsx)(X.default,{ref:c,style:gr.column,showsVerticalScrollIndicator:!1,children:dr.map((e=>(0,j.jsx)(v.default,{style:[gr.option,y.hour===e&&gr.selectedOption],onPress:()=>(e=>{b((t=>Object.assign({},t,{hour:e}))),S(null)})(e),children:(0,j.jsx)(a.default,{style:[gr.optionText,y.hour===e&&gr.selectedOptionText],children:e})},"hour-".concat(e))))}),(0,j.jsx)(X.default,{ref:u,style:gr.column,showsVerticalScrollIndicator:!1,children:cr.map((e=>(0,j.jsx)(v.default,{style:[gr.option,y.minute===e&&gr.selectedOption],onPress:()=>(e=>{b((t=>Object.assign({},t,{minute:e}))),S(null)})(e),children:(0,j.jsx)(a.default,{style:[gr.optionText,y.minute===e&&gr.selectedOptionText],children:e.toString().padStart(2,"0")})},"minute-".concat(e))))}),(0,j.jsx)(X.default,{ref:g,style:gr.column,showsVerticalScrollIndicator:!1,children:ur.map((e=>(0,j.jsx)(v.default,{style:[gr.option,y.period===e&&gr.selectedOption],onPress:()=>(e=>{b((t=>Object.assign({},t,{period:e}))),S(null)})(e),children:(0,j.jsx)(a.default,{style:[gr.optionText,y.period===e&&gr.selectedOptionText],children:e})},"period-".concat(e))))})]}),C&&(0,j.jsxs)(r.default,{style:gr.errorContainer,children:[(0,j.jsx)(de.default,{name:"error",size:16,color:m.theme.colors.error||"#D32F2F"}),(0,j.jsx)(a.default,{style:gr.errorText,children:C})]}),(0,j.jsxs)(r.default,{style:gr.buttonRow,children:[(0,j.jsx)(v.default,{style:[gr.button,gr.cancelButton],onPress:B,children:(0,j.jsx)(a.default,{style:gr.cancelButtonText,children:"Cancel"})}),(0,j.jsx)(v.default,{style:[gr.button,gr.confirmButton],onPress:T,children:(0,j.jsx)(a.default,{style:gr.confirmButtonText,children:"Confirm"})})]})]});return d?(0,j.jsxs)(r.default,{style:gr.inlineContainer,children:[s&&(0,j.jsx)(a.default,{style:gr.label,children:s}),A()]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(v.default,{style:gr.timeDisplay,onPress:o?i:()=>{},children:[(0,j.jsx)(de.default,{name:"access-time",size:18,color:m.theme.colors.mainColors.main}),(0,j.jsx)(a.default,{style:gr.timeText,children:(_=y.hour,I=y.minute,M=y.period,"".concat(_,":").concat(I.toString().padStart(2,"0")," ").concat(M))}),(0,j.jsx)(de.default,{name:o?"keyboard-arrow-up":"keyboard-arrow-down",size:20,color:m.theme.colors.text})]}),o&&(0,j.jsx)(r.default,{style:gr.dropdownContainer,children:A()})]});var _,I,M},hr=i.default.create({container:{backgroundColor:m.theme.colors.background,borderRadius:8,padding:16,marginBottom:16},title:{fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.medium.fontFamily,color:m.theme.colors.text,marginBottom:16},timeSelectionContainer:{flexDirection:"row",justifyContent:"space-between",marginBottom:16},timePickerContainer:{flex:1,marginHorizontal:4,position:"relative",zIndex:10},dateLabel:{fontSize:m.theme.fontSizes.small,fontFamily:m.theme.fonts.medium.fontFamily,color:m.theme.colors.textSecondary,marginBottom:4},timeLabel:{fontSize:m.theme.fontSizes.smallMedium,fontFamily:m.theme.fonts.regular.fontFamily,color:m.theme.colors.text,marginBottom:8},timeButton:{borderWidth:1,borderColor:m.theme.colors.modernBorder,borderRadius:8,backgroundColor:m.theme.colors.surface,position:"relative"},timeButtonContent:{flexDirection:"row",alignItems:"center",padding:12},timeText:{flex:1,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily,color:m.theme.colors.text,marginLeft:8},durationContainer:{flexDirection:"row",alignItems:"center",marginTop:4,padding:12,backgroundColor:m.theme.colors.bgColorModern,borderRadius:8},durationText:{fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily,color:m.theme.colors.text,marginLeft:8},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.2)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:m.theme.colors.background,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.modernBorder,width:"80%",padding:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.2,shadowRadius:4,elevation:5},startModalContent:{alignSelf:"flex-start",marginLeft:"10%"},endModalContent:{alignSelf:"flex-end",marginRight:"10%"}}),fr=({title:e,onTimeSelect:t,initialTimes:o={},is_overnight:i=!1,uniqueId:s="default",dateRange:l=null,selectedDates:d=[],isIndividualDaySelector:c=!1})=>{const{is_DEBUG:u}=(0,n.useContext)(h.AuthContext),[g,f]=(0,n.useState)((()=>{const e={startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0},isOvernightForced:o?.isOvernightForced||i||!1};return o?{startTime:o.startTime?JSON.parse(JSON.stringify(o.startTime)):e.startTime,endTime:o.endTime?JSON.parse(JSON.stringify(o.endTime)):e.endTime,isOvernightForced:o.isOvernightForced||i||!1}:e})),[p,y]=(0,n.useState)(null);(0,n.useEffect)((()=>{if(!o)return;(0,h.debugLog)("MBAoi9uv43d: NewTimeRangeSelector (".concat(s,") initialTimes update:"),o);const e={startTime:o.startTime?JSON.parse(JSON.stringify(o.startTime)):g.startTime,endTime:o.endTime?JSON.parse(JSON.stringify(o.endTime)):g.endTime,isOvernightForced:o.isOvernightForced||i||g.isOvernightForced};f(e)}),[o?.startTime?.hours,o?.startTime?.minutes,o?.endTime?.hours,o?.endTime?.minutes,o?.isOvernightForced,i]),(0,n.useEffect)((()=>()=>{}),[p]);const b=e=>{if(!e)return"";const t="number"===typeof e.hours?e.hours:0,o="number"===typeof e.minutes?e.minutes:0,n=Math.max(0,Math.min(23,t)),r=Math.max(0,Math.min(59,o)),a=n>=12?"PM":"AM";return"".concat(n%12===0?12:n%12,":").concat(r.toString().padStart(2,"0")," ").concat(a)},x=e=>{if(!e)return"";try{return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch(zs){return(0,h.debugLog)("MBAoi9uv43d: Error formatting date: ".concat(zs.message)),""}},w=(()=>{if(l&&l.startDate)return l.startDate;if(d&&d.length>0){return[...d].sort(((e,t)=>new Date(e)-new Date(t)))[0]}return null})(),C=(()=>{if(l&&l.endDate)return l.endDate;if(d&&d.length>0){const e=[...d].sort(((e,t)=>new Date(e)-new Date(t)));return e[e.length-1]}return null})();return(0,j.jsxs)(r.default,{style:hr.container,children:[e&&(0,j.jsx)(a.default,{style:hr.title,children:e}),(0,j.jsxs)(r.default,{style:hr.timeSelectionContainer,children:[(0,j.jsxs)(r.default,{style:hr.timePickerContainer,children:[w&&(c||g.isOvernightForced||i)?(0,j.jsx)(a.default,{style:hr.dateLabel,children:x(w)}):(0,j.jsx)(a.default,{style:hr.dateLabel,children:"Applies to all individual days"}),(0,j.jsx)(a.default,{style:hr.timeLabel,children:"Start Time"}),(0,j.jsx)(v.default,{style:hr.timeButton,onPress:()=>y("start"===p?null:"start"),children:(0,j.jsxs)(r.default,{style:hr.timeButtonContent,children:[(0,j.jsx)(de.default,{name:"access-time",size:18,color:m.theme.colors.mainColors.main}),(0,j.jsx)(a.default,{style:hr.timeText,children:b(g.startTime)}),(0,j.jsx)(de.default,{name:"start"===p?"keyboard-arrow-up":"keyboard-arrow-down",size:20,color:m.theme.colors.text})]})})]}),(0,j.jsxs)(r.default,{style:hr.timePickerContainer,children:[C&&(c||g.isOvernightForced||i)?(0,j.jsx)(a.default,{style:hr.dateLabel,children:x(C)}):(0,j.jsx)(a.default,{style:hr.dateLabel,children:"Applies to all individual days"}),(0,j.jsx)(a.default,{style:hr.timeLabel,children:"End Time"}),(0,j.jsx)(v.default,{style:hr.timeButton,onPress:()=>y("end"===p?null:"end"),children:(0,j.jsxs)(r.default,{style:hr.timeButtonContent,children:[(0,j.jsx)(de.default,{name:"access-time",size:18,color:m.theme.colors.mainColors.main}),(0,j.jsx)(a.default,{style:hr.timeText,children:b(g.endTime)}),(0,j.jsx)(de.default,{name:"end"===p?"keyboard-arrow-up":"keyboard-arrow-down",size:20,color:m.theme.colors.text})]})})]})]}),(0,j.jsxs)(r.default,{style:hr.durationContainer,children:[(0,j.jsx)(de.default,{name:"timelapse",size:18,color:m.theme.colors.mainColors.main}),(0,j.jsxs)(a.default,{style:hr.durationText,children:["Duration: ",(()=>{const{isOvernightForced:e}=g;if((e||i)&&(l||d&&d.length>0)){let e,t;if(l&&l.startDate&&l.endDate)e=new Date(l.startDate),t=new Date(l.endDate);else{if(!(d&&d.length>=2))return d&&1===d.length?"Same day":"1 night";{const o=[...d].sort(((e,t)=>new Date(e)-new Date(t)));e=new Date(o[0]),t=new Date(o[o.length-1])}}Math.abs(t-e);let o;const n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),r=new Date(t.getFullYear(),t.getMonth(),t.getDate());o=Math.round(Math.abs(r-n)/864e5)+1;const a=o>1?o-1:0;return 0===a?"Same day":1===a?"1 night":"".concat(a," nights")}const{startTime:t,endTime:o}=g,n=60*t.hours+t.minutes;let r=60*o.hours+o.minutes;0===o.hours&&0===o.minutes&&(r=1440);let a=r-n;a<0&&(0!==o.hours||0!==o.minutes)&&(a+=1440);const s=Math.floor(a/60),c=a%60;let u="";return s>0&&(u+="".concat(s," hour").concat(1!==s?"s":"")),c>0&&(u.length>0&&(u+=" "),u+="".concat(c," minute").concat(1!==c?"s":"")),u||"0 minutes"})()]})]}),p&&(0,j.jsx)(k.default,{transparent:!0,animationType:"none",visible:!!p,onRequestClose:()=>y(null),children:(0,j.jsx)(mt.default,{onPress:()=>y(null),children:(0,j.jsx)(r.default,{style:hr.modalOverlay,children:(0,j.jsx)(mt.default,{children:(0,j.jsx)(r.default,{style:[hr.modalContent,"start"===p?hr.startModalContent:hr.endModalContent],children:(0,j.jsx)(mr,{initialTime:"start"===p?g.startTime:g.endTime,onTimeSelect:"start"===p?e=>{const o=0===g.endTime.hours&&0===g.endTime.minutes,n=60*e.hours+e.minutes,r=60*g.endTime.hours+g.endTime.minutes;if(!(o||n<r))return(0,h.debugLog)("MBAoi9uv43d: NewTimeRangeSelector (".concat(s,") invalid start time - would be after end time:"),{attemptedStart:e,currentEnd:g.endTime,startMinutes:n,endMinutes:r}),!1;const a=Object.assign({},g,{startTime:JSON.parse(JSON.stringify(e))});return f(a),t(a),(0,h.debugLog)("MBAoi9uv43d: NewTimeRangeSelector (".concat(s,") startTime changed:"),{newTime:e,updatedTimes:a}),!0}:e=>{const o=0===e.hours&&0===e.minutes,n=60*g.startTime.hours+g.startTime.minutes,r=60*e.hours+e.minutes;if(!(o||r>n))return(0,h.debugLog)("MBAoi9uv43d: NewTimeRangeSelector (".concat(s,") invalid end time - would be before start time:"),{currentStart:g.startTime,attemptedEnd:e,startMinutes:n,endMinutes:r}),!1;const a=Object.assign({},g,{endTime:JSON.parse(JSON.stringify(e))});return f(a),t(a),(0,h.debugLog)("MBAoi9uv43d: NewTimeRangeSelector (".concat(s,") endTime changed:"),{newTime:e,updatedTimes:a}),!0},isOpen:!0,onClose:()=>y(null),uniqueId:"".concat(s,"-").concat(p),showInlinePicker:!0})})})})})})]})},pr=i.default.create({container:{marginBottom:16,borderWidth:1,borderColor:m.theme.colors.modernBorder,borderRadius:8,backgroundColor:m.theme.colors.surface,overflow:"visible"},dateLabel:{fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.medium.fontFamily,color:m.theme.colors.text,backgroundColor:m.theme.colors.bgColorModern,padding:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.modernBorder},timeSlotContainer:{borderBottomWidth:1,borderBottomColor:m.theme.colors.modernBorder},timeSlotHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingHorizontal:12,paddingVertical:8,backgroundColor:m.theme.colors.bgColorModern},timeSlotTitle:{fontSize:m.theme.fontSizes.small,fontFamily:m.theme.fonts.medium.fontFamily,color:m.theme.colors.secondary},removeButton:{padding:4},addTimeButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",gap:8,paddingVertical:12,paddingHorizontal:16,margin:12,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.mainColors.main,backgroundColor:"transparent"},addTimeButtonText:{color:m.theme.colors.mainColors.main,fontSize:m.theme.fontSizes.small,fontFamily:m.theme.fonts.regular.fontFamily}}),yr=({date:e,initialTimes:t={},onTimeChange:o,is_overnight:i=!1})=>{const{is_DEBUG:s}=(0,n.useContext)(h.AuthContext),[l,d]=(0,n.useState)((()=>Array.isArray(t)?t.map(((e,t)=>({id:"slot-".concat(t),startTime:e.startTime||{hours:9,minutes:0},endTime:e.endTime||{hours:17,minutes:0},isOvernightForced:e.isOvernightForced||!1}))):t&&(t.startTime||t.endTime)?[{id:"slot-0",startTime:t.startTime||{hours:9,minutes:0},endTime:t.endTime||{hours:17,minutes:0},isOvernightForced:t.isOvernightForced||!1}]:[{id:"slot-0",startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0},isOvernightForced:!1}])),c=(()=>{if(!e)return"day-unknown";try{if(e instanceof Date)return"day-".concat(e.toISOString().split("T")[0]);if("string"===typeof e&&e.match(/^\d{4}-\d{2}-\d{2}$/))return"day-".concat(e);const t=new Date(e);return isNaN(t.getTime())?"day-unknown-".concat(Date.now()):"day-".concat(t.toISOString().split("T")[0])}catch(zs){return(0,h.debugLog)("MBAoi9uv43d: Error generating unique ID for date:",zs),"day-unknown-".concat(Date.now())}})(),u=(()=>{if(!e)return null;try{if(e instanceof Date)return e.toISOString().split("T")[0];if("string"===typeof e&&e.match(/^\d{4}-\d{2}-\d{2}$/))return e;const t=new Date(e);return isNaN(t.getTime())?((0,h.debugLog)("MBAoi9uv43d: Could not parse date:",e),null):t.toISOString().split("T")[0]}catch(zs){return(0,h.debugLog)("MBAoi9uv43d: Error generating date key:",zs),null}})();return(0,j.jsxs)(r.default,{style:pr.container,children:[(0,j.jsx)(a.default,{style:pr.dateLabel,children:(e=>{if(!e)return"";return new Date(e).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})(e)}),l.map(((t,n)=>(0,j.jsxs)(r.default,{style:pr.timeSlotContainer,children:[l.length>1&&(0,j.jsxs)(r.default,{style:pr.timeSlotHeader,children:[(0,j.jsxs)(a.default,{style:pr.timeSlotTitle,children:["Time Slot ",n+1]}),(0,j.jsx)(v.default,{style:pr.removeButton,onPress:()=>(e=>{if(l.length<=1)return void(0,h.debugLog)("MBAoi9uv43d: Cannot remove last time slot");const t=l.filter((t=>t.id!==e));d(t),(0,h.debugLog)("MBAoi9uv43d: Removed time slot ".concat(e," for date ").concat(u,":"),t),o(t,u)})(t.id),activeOpacity:.7,children:(0,j.jsx)(de.default,{name:"close",size:20,color:m.theme.colors.error})})]}),(0,j.jsx)(fr,{onTimeSelect:e=>((e,t)=>{if(!u)return void(0,h.debugLog)("MBAoi9uv43d: Cannot handle time selection - invalid date key");(0,h.debugLog)("MBAoi9uv43d: DayTimeSelector handleTimeSlotSelect called:",{dateKey:u,slotId:t,timesData:e,currentTimeSlots:l});const n=l.map((o=>{if(o.id===t){const n=Object.assign({},o,{startTime:e.startTime,endTime:e.endTime,isOvernightForced:e.isOvernightForced});return(0,h.debugLog)("MBAoi9uv43d: Updated slot ".concat(t,":"),n),n}return o}));d(n),(0,h.debugLog)("MBAoi9uv43d: DayTimeSelector (".concat(c,") time slot ").concat(t," changed:"),{dateKey:u,updatedTimeSlots:n,previousTimeSlots:l}),o(n,u)})(e,t.id),initialTimes:t,is_overnight:i,uniqueId:"".concat(c,"-").concat(t.id),selectedDates:[e],isIndividualDaySelector:!0})]},t.id))),(0,j.jsxs)(v.default,{style:pr.addTimeButton,onPress:()=>{const e={id:"slot-".concat(l.length),startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0},isOvernightForced:!1},t=[...l,e];d(t),(0,h.debugLog)("MBAoi9uv43d: Added new time slot for date ".concat(u,":"),t),o(t,u)},activeOpacity:.7,children:[(0,j.jsx)(de.default,{name:"add",size:20,color:m.theme.colors.mainColors.main}),(0,j.jsx)(a.default,{style:pr.addTimeButtonText,children:"Add another time for this date"})]})]})},br=e=>{if(!e)return null;if("string"===typeof e&&e.includes(":")){const[t,o]=e.split(":").map((e=>parseInt(e,10)));return{hours:t,minutes:o}}return"object"!==typeof e||null===e||void 0===e.hours&&void 0===e.minutes?null:{hours:e.hours||0,minutes:e.minutes||0}},xr=i.default.create({container:{flex:1,padding:16},card:{backgroundColor:m.theme.colors.background,borderRadius:12},customizeButtonContainer:{marginBottom:24,paddingHorizontal:16},customizeButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",gap:8,paddingVertical:12,paddingHorizontal:16,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.mainColors.main},customizeButtonText:{color:m.theme.colors.mainColors.main,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center"},individualDaysContainer:{gap:12,marginBottom:16},sectionHeader:{fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily,color:m.theme.colors.text,marginBottom:12,paddingHorizontal:16}}),vr=({onTimeSelect:e,initialTimes:t={},dateRange:o=null,selectedService:i=null,isOvernightForced:s=!1})=>{const{is_DEBUG:l}=(0,n.useContext)(h.AuthContext),[d,c]=(0,n.useState)((()=>{if(i?.is_overnight||s)return!1;const e=t&&!0===t.hasIndividualTimes;return(0,h.debugLog)("MBAoi9uv43d: Initial showIndividualDays value:",e),e})),[u,g]=(0,n.useState)({}),[f,p]=(0,n.useState)((()=>{try{return t&&"object"===typeof t?t:((0,h.debugLog)("MBAoi9uv43d: Invalid initialTimes, using defaults:",t),{startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0},isOvernightForced:!1})}catch(zs){return(0,h.debugLog)("MBAoi9uv43d: Error initializing times:",zs),{startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0},isOvernightForced:!1}}})),y=(0,n.useRef)(!0);(0,n.useEffect)((()=>{(0,h.debugLog)("MBAoi9uv43d: TimeSelectionCard received initialTimes:",t);try{if(!t||"object"!==typeof t){const e={startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0},isOvernightForced:i?.is_overnight||s||!1};return(0,h.debugLog)("MBAoi9uv43d: Using default times:",e),p(e),void c(!1)}const e=!0===t.hasIndividualTimes;(0,h.debugLog)("MBAoi9uv43d: hasIndividualTimes flag is",e),y.current?((0,h.debugLog)("MBAoi9uv43d: Initial render - setting showIndividualDays to",e),c(e),y.current=!1):(0,h.debugLog)("MBAoi9uv43d: Not initial render - preserving showIndividualDays state");const n=br(t.startTime),r={startTime:n||{hours:9,minutes:0},endTime:br(t.endTime)||{hours:17,minutes:0},isOvernightForced:i?.is_overnight||s||!1};(0,h.debugLog)("MBAoi9uv43d: CRITICAL FIX - Setting formatted times:",{formattedTimes:r,selectedServiceIsOvernight:i?.is_overnight,isOvernightForcedProp:s,initialTimesIsOvernightForced:t.isOvernightForced,message:"isOvernightForced now prioritizes current service over previous state"}),p(r);const a=t&&Object.keys(t).some((e=>e.match(/^\d{4}-\d{2}-\d{2}$/)));if((0,h.debugLog)("MBAoi9uv43d: Time selection setup:",{hasDatesInDraft:a,hasIndividualTimesFlag:e,hasDateRange:!!(o&&o.startDate&&o.endDate),hasDates:!!(t&&t.dates&&t.dates.length>0)}),o&&o.startDate&&o.endDate||a){const n={};if(o&&o.startDate&&o.endDate){const e=new Date(o.startDate),t=new Date(o.endDate),a=new Date(e);for(;a<=t;){const e=a.toISOString().split("T")[0];n[e]=JSON.parse(JSON.stringify(r)),a.setDate(a.getDate()+1)}}t.dates&&t.dates.length>0&&!o&&((0,h.debugLog)("MBAoi9uv43d: Creating time ranges from multiple days selection"),t.dates.forEach((e=>{let t;t="string"===typeof e?new Date(e):e&&e.date?new Date(e.date):new Date(e);const o=t.toISOString().split("T")[0];n[o]||(n[o]=JSON.parse(JSON.stringify(r)))}))),(e||a)&&Object.keys(t).forEach((e=>{if(e.match(/^\d{4}-\d{2}-\d{2}$/)&&t[e]){const o=t[e],r=br(o.startTime),a=br(o.endTime);(r||a)&&(n[e]={startTime:r||{hours:9,minutes:0},endTime:a||{hours:17,minutes:0},isOvernightForced:i?.is_overnight||s||!1})}})),t.individualTimeRanges&&Object.keys(t.individualTimeRanges).forEach((e=>{if(e.match(/^\d{4}-\d{2}-\d{2}$/)){const o=t.individualTimeRanges[e],r=br(o.startTime),a=br(o.endTime);(r||a)&&(n[e]={startTime:r||{hours:9,minutes:0},endTime:a||{hours:17,minutes:0},isOvernightForced:i?.is_overnight||s||!1})}})),(0,h.debugLog)("MBAoi9uv43d: Setting individual time ranges:",n),g(n)}}catch(zs){(0,h.debugLog)("MBAoi9uv43d: Error processing initialTimes:",zs),p({startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0},isOvernightForced:i?.is_overnight||s||!1})}}),[t,o,i]);const b=(o,n)=>{if((0,h.debugLog)("MBAoi9uv43d: Individual day time selection for card:",{dateKey:n,timeSlotsData:o}),(0,h.debugLog)("MBAoi9uv43d: Received time slots data structure:",o),(0,h.debugLog)("MBAoi9uv43d: Is timeSlotsData an array?",Array.isArray(o)),(0,h.debugLog)("MBAoi9uv43d: Time slots count:",Array.isArray(o)?o.length:"Not an array"),!n)return void(0,h.debugLog)("MBAoi9uv43d: No dateKey provided, returning");const r=JSON.parse(JSON.stringify(u));r[n]=JSON.parse(JSON.stringify(o)),(0,h.debugLog)("MBAoi9uv43d: TimeSelectionCard updating only date:",n),(0,h.debugLog)("MBAoi9uv43d: Current individualTimeRanges keys:",Object.keys(u)),(0,h.debugLog)("MBAoi9uv43d: New updatedRanges keys:",Object.keys(r)),(0,h.debugLog)("MBAoi9uv43d: Updated time slots for date:",n,r[n]),g(r);const a={};Object.keys(r).forEach((e=>{const t=r[e];(0,h.debugLog)("MBAoi9uv43d: Formatting time data for date:",e,t),(0,h.debugLog)("MBAoi9uv43d: Is timeData an array?",Array.isArray(t)),Array.isArray(t)?(a[e]=t.map(((t,o)=>((0,h.debugLog)("MBAoi9uv43d: Formatting slot",o,"for date",e,":",t),{startTime:"".concat(String(t.startTime.hours).padStart(2,"0"),":").concat(String(t.startTime.minutes).padStart(2,"0")),endTime:"".concat(String(t.endTime.hours).padStart(2,"0"),":").concat(String(t.endTime.minutes).padStart(2,"0")),isOvernightForced:!!t.isOvernightForced}))),(0,h.debugLog)("MBAoi9uv43d: Formatted multiple time slots for date",e,":",a[e])):((0,h.debugLog)("MBAoi9uv43d: Formatting single time slot for date",e,":",t),a[e]=[{startTime:"".concat(String(t.startTime.hours).padStart(2,"0"),":").concat(String(t.startTime.minutes).padStart(2,"0")),endTime:"".concat(String(t.endTime.hours).padStart(2,"0"),":").concat(String(t.endTime.minutes).padStart(2,"0")),isOvernightForced:!!t.isOvernightForced}],(0,h.debugLog)("MBAoi9uv43d: Formatted single time slot for date",e,":",a[e]))}));const i={startTime:JSON.parse(JSON.stringify(f.startTime)),endTime:JSON.parse(JSON.stringify(f.endTime)),isOvernightForced:f.isOvernightForced,hasIndividualTimes:!0,dates:t.dates?[...t.dates]:[],individualTimeRanges:a};i[n]=a[n],(0,h.debugLog)("MBAoi9uv43d: TimeSelectionCard sending updated data to parent:"),(0,h.debugLog)("MBAoi9uv43d: Updated data structure:",i),(0,h.debugLog)("MBAoi9uv43d: Date-specific data for",n,":",i[n]),(0,h.debugLog)("MBAoi9uv43d: Individual time ranges:",i.individualTimeRanges),e(i)};return(0,j.jsx)(r.default,{style:xr.container,children:(0,j.jsxs)(r.default,{style:xr.card,children:[!d&&(0,j.jsx)(fr,{onTimeSelect:t=>{(0,h.debugLog)("MBAoi9uv43d: handleDefaultTimeSelect called with:",t);const o=JSON.parse(JSON.stringify(t));if(p(o),d){const t={};Object.keys(u).forEach((e=>{t[e]={startTime:o.startTime,endTime:o.endTime,isOvernightForced:o.isOvernightForced}})),g(t),e(Object.assign({},o,t,{hasIndividualTimes:!0}))}else e(Object.assign({},o,{hasIndividualTimes:!1}))},initialTimes:f,is_overnight:i?.is_overnight||f.isOvernightForced||s||!1,uniqueId:"default-time-range",dateRange:o,selectedDates:t.dates||[]}),!i?.is_overnight&&!s&&(0,j.jsx)(r.default,{style:xr.customizeButtonContainer,children:(0,j.jsxs)(v.default,{style:xr.customizeButton,onPress:()=>{if((0,h.debugLog)("MBAoi9uv43d: TOGGLE button pressed"),(0,h.debugLog)("MBAoi9uv43d: Current showIndividualDays state:",d),d){(0,h.debugLog)("MBAoi9uv43d: Switching FROM individual days TO default time range"),c(!1);const o={startTime:f.startTime,endTime:f.endTime,isOvernightForced:f.isOvernightForced,hasIndividualTimes:!1,dates:t.dates||[]};(0,h.debugLog)("MBAoi9uv43d: Sending default time data to parent:",o),e(o)}else{(0,h.debugLog)("MBAoi9uv43d: Switching FROM default time range TO individual days"),c(!0);let n={};if(t&&t.dates&&t.dates.length>0)(0,h.debugLog)("MBAoi9uv43d: Creating time ranges for multiple individual dates"),t.dates.forEach((e=>{let t;t="string"===typeof e?new Date(e):e&&e.date?new Date(e.date):new Date(e);const o=t.toISOString().split("T")[0];n[o]={startTime:JSON.parse(JSON.stringify(f.startTime)),endTime:JSON.parse(JSON.stringify(f.endTime)),isOvernightForced:f.isOvernightForced}}));else if(o&&o.startDate&&o.endDate){(0,h.debugLog)("MBAoi9uv43d: Creating time ranges from dateRange");const e=new Date(o.startDate),t=new Date(o.endDate),r=new Date(e);for(;r<=t;){const e=r.toISOString().split("T")[0];n[e]={startTime:JSON.parse(JSON.stringify(f.startTime)),endTime:JSON.parse(JSON.stringify(f.endTime)),isOvernightForced:f.isOvernightForced},r.setDate(r.getDate()+1)}}else Object.keys(u).length>0&&(n=JSON.parse(JSON.stringify(u)));(0,h.debugLog)("MBAoi9uv43d: Setting individual time ranges:",n),g(n),e(Object.assign({},f,n,{hasIndividualTimes:!0}))}},activeOpacity:.7,children:[(0,j.jsx)(de.default,{name:"schedule",size:20,color:m.theme.colors.mainColors.main}),(0,j.jsx)(a.default,{style:xr.customizeButtonText,children:d?"Set Default Time Range":"Customize Individual Day Schedules"})]})}),d&&!i?.is_overnight&&!s&&(0,j.jsxs)(r.default,{style:xr.individualDaysContainer,children:[(0,j.jsx)(a.default,{style:xr.sectionHeader,children:"Individual Day Schedules"}),(0,j.jsx)(X.default,{children:(()=>{let e=[];if(t&&t.dates&&t.dates.length>0)(0,h.debugLog)("MBAoi9uv43d: Using multiple individual dates from initialTimes:",t.dates),e=t.dates.map((e=>"string"===typeof e?new Date(e):e&&e.date?new Date(e.date):new Date(e)));else if(o&&o.startDate&&o.endDate){(0,h.debugLog)("MBAoi9uv43d: Generating dates from dateRange:",o);const t=new Date(o.startDate),n=new Date(o.endDate),r=new Date(t);for(;r<=n;)e.push(new Date(r)),r.setDate(r.getDate()+1)}return e})().map((e=>{const o=e.toISOString().split("T")[0];let n;if(t&&t[o]){if(Array.isArray(t[o]))n=t[o].map((e=>({startTime:br(e.startTime)||JSON.parse(JSON.stringify(f.startTime)),endTime:br(e.endTime)||JSON.parse(JSON.stringify(f.endTime)),isOvernightForced:i?.is_overnight||s||!1})));else{const e=br(t[o].startTime),r=br(t[o].endTime);n={startTime:e||JSON.parse(JSON.stringify(f.startTime)),endTime:r||JSON.parse(JSON.stringify(f.endTime)),isOvernightForced:i?.is_overnight||s||!1}}(0,h.debugLog)("MBAoi9uv43d: Found specific time data for date ".concat(o," in initialTimes"))}else u&&u[o]?(n=JSON.parse(JSON.stringify(u[o])),(0,h.debugLog)("MBAoi9uv43d: Using time from individualTimeRanges for date ".concat(o))):(n={startTime:JSON.parse(JSON.stringify(f.startTime)),endTime:JSON.parse(JSON.stringify(f.endTime)),isOvernightForced:f.isOvernightForced},(0,h.debugLog)("MBAoi9uv43d: Using default times for date ".concat(o)));return(0,j.jsx)(yr,{date:e,initialTimes:n,onTimeChange:b,is_overnight:i?.is_overnight||!1},"day-".concat(o))}))})]})]})})},wr={SERVICES_AND_PETS:{id:0,name:"Services & Pets"},DATE_SELECTION:{id:1,name:"Date Selection"},TIME_SELECTION:{id:2,name:"Time Selection"},REVIEW_AND_RATES:{id:3,name:"Review & Rates"}},Cr=i.default.create({modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",width:"100%"},modalContent:{width:"95%",maxWidth:600,maxHeight:"90%",backgroundColor:m.theme.colors.background,borderRadius:12,overflow:"hidden",display:"flex",flexDirection:"column"},stepIndicatorContainer:{width:"100%",paddingVertical:12,backgroundColor:m.theme.colors.background,borderBottomWidth:1,borderBottomColor:m.theme.colors.modernBorder},scrollContent:{flex:1},scrollContentContainer:{flexGrow:1},content:{flex:1,backgroundColor:m.theme.colors.background},footer:{flexDirection:"row",padding:16,justifyContent:"space-between",alignItems:"center",backgroundColor:m.theme.colors.background,borderTopWidth:1,borderTopColor:m.theme.colors.modernBorder},spacer:{width:16,flexGrow:1},smallMargin:{width:8},backButton:{minWidth:100,backgroundColor:m.theme.colors.surface,paddingVertical:12,paddingHorizontal:16,borderRadius:8,alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border},smallScreenButton:{minWidth:80,paddingVertical:8,paddingHorizontal:10},backButtonText:{color:m.theme.colors.text,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},cancelButton:{flex:1,backgroundColor:m.theme.colors.surface,paddingVertical:12,borderRadius:8,alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border},cancelButtonSmall:{minWidth:100,backgroundColor:m.theme.colors.surface,paddingVertical:12,paddingHorizontal:16,borderRadius:8,alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border},cancelButtonText:{color:m.theme.colors.text,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},nextButton:{flex:1,backgroundColor:m.theme.colors.mainColors.main,paddingVertical:12,borderRadius:8,alignItems:"center"},nextButtonSmall:{minWidth:100,backgroundColor:m.theme.colors.mainColors.main,paddingVertical:12,paddingHorizontal:16,borderRadius:8,alignItems:"center"},disabledButton:{backgroundColor:m.theme.colors.placeHolderText},nextButtonText:{color:m.theme.colors.surface,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600"},disabledButtonText:{color:m.theme.colors.surface},errorText:{color:m.theme.colors.error,textAlign:"center",marginBottom:16,fontFamily:m.theme.fonts.regular.fontFamily},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:16},loadingText:{color:m.theme.colors.text,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},stepContent:{flex:1,backgroundColor:m.theme.colors.background},divider:{height:1,backgroundColor:m.theme.colors.modernBorder,marginVertical:16},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:16},confirmButtonColumn:{flexDirection:"column",alignItems:"center",justifyContent:"center"}}),Sr=({visible:e,onClose:t,bookingId:o,onComplete:i,initialData:s={},navigation:l})=>{(0,h.debugLog)("MBA2ou09hv595","BookingStepModal component rendered/re-rendered",{visible:e,bookingId:o,timestamp:(new Date).toISOString()});const{is_DEBUG:d,screenWidth:c,timeSettings:u}=(0,n.useContext)(h.AuthContext),g=c<600,[m,f]=(0,n.useState)(wr.SERVICES_AND_PETS.id),[p,y]=(0,n.useState)({service:s?.service||null,pets:s?.pets||[],dates:s?.dates||[],bookingType:s?.bookingType||"one-time",dateRangeType:s?.dateRangeType||"date-range",times:s?.times||{startTime:"09:00",endTime:"17:00",isOvernightForced:!1,hasIndividualTimes:!1},rates:s?.rates||{},dateSelectionData:null,dateRange:null,hasFetchedDates:!1}),[b,x]=(0,n.useState)(null),[w,C]=(0,n.useState)(!1),[S,T]=(0,n.useState)(!1),[B,A]=(0,n.useState)(!1),_=()=>{if(p)return p.pro_agreed_tos},[I,M]=(0,n.useState)(!1),[L,R]=(0,n.useState)(!1),[D,z]=(0,n.useState)(null),[P,F]=(0,n.useState)([]),[E,W]=(0,n.useState)([]),O=(0,n.useRef)({lastBookingId:null,servicesInitialized:!1,petsInitialized:!1,servicesInProgress:!1,petsInProgress:!1});(0,n.useEffect)((()=>{(0,h.debugLog)("MBA12345 Initial data received:",s),(0,h.debugLog)("MBA12345 Initial booking data state:",p)}),[s]),(0,n.useEffect)((()=>{(async()=>{if(o&&e)if(p.hasFetchedDates)(0,h.debugLog)("MBA2j3kbr9hve4: Skipping fetch as hasFetchedDates is true");else try{C(!0),x(null),(0,h.debugLog)("MBA2j3kbr9hve4: Fetching draft dates and times for booking ID:",o);const e=await(0,bt.getBookingDraftDatesAndTimes)(o);if((0,h.debugLog)("MBA2j3kbr9hve4: Received draft dates and times:",e),e){const o=u?.timezone||"US/Mountain";(0,h.debugLog)("MBA2j3kbr9hve4: Using timezone for parsing occurrences:",{userTimezone:o,timeSettings:u,fallbackUsed:!u?.timezone});const n=(0,Wt.parseOccurrencesForBookingSteps)(e.occurrences||[],o);(0,h.debugLog)("MBA2j3kbr9hve4: Parsed draft dates and times:",n);const r=(e.service_details?.service_type||"").toLowerCase(),a=!0===e.service_details?.is_overnight;(0,h.debugLog)("MBA2j3kbr9hve4: Is overnight service from response:",a),(0,h.debugLog)("MBA2j3kbr9hve4: Service name:",r),(0,h.debugLog)("MBA2j3kbr9hve4: Full service details from response:",e.service_details);let i=null;if(e.service_details&&(i=Object.assign({},e.service_details,{service_id:e.service_details.service_id,service_name:e.service_details.service_type,is_overnight:a}),(0,h.debugLog)("MBA2j3kbr9hve4: Setting service data with overnight status:",i)),e.occurrences&&e.occurrences.length>0){const t=e.occurrences[0],o=e.occurrences[e.occurrences.length-1];if(t.start_date!==o.end_date){const e=new Date(t.start_date),n=new Date(o.end_date),r=Math.ceil((n-e)/864e5);r>=1&&((0,h.debugLog)("MBA2j3kbr9hve4: DETECTED OVERNIGHT from date range:",{startDate:t.start_date,endDate:o.end_date,daysDifference:r}),i&&(i.is_overnight=!0))}}if(2===e.occurrences?.length)try{const t=new Date(e.occurrences[0].start_date),o=new Date(e.occurrences[1].start_date),n=Math.abs(Math.round((o-t)/864e5));n>1&&((0,h.debugLog)("MBA2j3kbr9hve4: DETECTED POTENTIAL OVERNIGHT from date distance:",{date1:e.occurrences[0].start_date,date2:e.occurrences[1].start_date,daysBetween:n}),i&&(i.is_overnight=!0))}catch(t){(0,h.debugLog)("MBA2j3kbr9hve4: Error checking occ dates:",t)}let s=e.date_range_type||"date-range";a||i&&i.is_overnight?(s="date-range",(0,h.debugLog)("MBA2j3kbr9hve4: Forcing date-range type for overnight service")):n.dates&&n.dates.length>1&&!n.dateRange&&(s="multiple-days",(0,h.debugLog)("MBA2j3kbr9hve4: Non-consecutive dates detected, forcing multiple-days mode"));const l=a||i&&i.is_overnight;(0,h.debugLog)("MBA2j3kbr9hve4: Final overnight determination:",{initialCheck:a,afterOccurrenceChecks:i?.is_overnight,finalIsOvernightForced:l}),y((t=>Object.assign({},t,{dates:n.dates||[],dateRange:n.dateRange,times:Object.assign({},n.defaultTimes||{},n.individualTimes,{individualTimeRanges:n.individualTimes||{},allTimesAreTheSame:n.allTimesAreTheSame,hasIndividualTimes:!n.allTimesAreTheSame,isOvernightForced:l}),dateRangeType:s,bookingType:e.booking_type||t.bookingType||"one-time",hasFetchedDates:!0,service:i||t.service})))}}catch(b){(0,h.debugLog)("MBA2j3kbr9hve4: Error fetching draft dates and times:",b),m>wr.SERVICES_AND_PETS.id?x("Failed to load booking details. Please try again."):(0,h.debugLog)("MBA2j3kbr9hve4: Suppressing error on first step:",b.message)}finally{C(!1)}})()}),[o,e,m,p.hasFetchedDates]),(0,n.useEffect)((()=>{p.service?.is_overnight&&((0,h.debugLog)("MBA2j3kbr9hve4: Detected overnight service, ensuring dateRangeType is date-range"),"date-range"!==p.dateRangeType&&((0,h.debugLog)("MBA2j3kbr9hve4: Updating dateRangeType from",p.dateRangeType,"to date-range"),y((e=>Object.assign({},e,{dateRangeType:"date-range"})))))}),[p.service?.is_overnight]);const N=e=>{(0,h.debugLog)("MBA12345 Selected service:",e);const t=(e?.service_name||"").toLowerCase(),o=!0===e?.is_overnight;(0,h.debugLog)("MBA2j3kbr9hve4: Service overnight status:",{isOvernight:o,serviceData:e,serviceName:t}),y((t=>{const n={startTime:"09:00",endTime:"17:00",isOvernightForced:o,hasIndividualTimes:!o&&(t.times?.hasIndividualTimes||!1)};(0,h.debugLog)("MBA2j3kbr9hve4: CRITICAL FIX - Reset times with clean defaults:",{previousTimes:t.times,newCleanTimes:n,serviceIsOvernight:o});const r=Object.assign({},e,{is_overnight:o});return Object.assign({},t,{service:r,times:n,dateRangeType:o?"date-range":t.dateRangeType})}))},H=e=>{(0,h.debugLog)("MBA12345 Selected/deselected pet:",e);const t=p.pets.find((t=>t.pet_id===e.pet_id))?p.pets.filter((t=>t.pet_id!==e.pet_id)):[...p.pets,e];y((e=>Object.assign({},e,{pets:t})))},U=e=>{(0,h.debugLog)("MBA12345 Batch selecting pets:",e.map((e=>({id:e.pet_id,name:e.name})))),y((t=>Object.assign({},t,{pets:e})))},V=()=>{if(!o)return!1;const e=O.current;o!==e.lastBookingId&&(e.lastBookingId=o,e.servicesInitialized=!1,e.petsInitialized=!1,e.servicesInProgress=!1,e.petsInProgress=!1,z(o),M(!1),R(!1),F([]),W([]));const t=!e.servicesInitialized&&!e.servicesInProgress;return t&&(e.servicesInProgress=!0),t},q=()=>{if(!o)return!1;const e=O.current,t=!e.petsInitialized&&!e.petsInProgress;return t&&(e.petsInProgress=!0),t},Y=(e=!1)=>{(0,h.debugLog)("MBA2ou09hv595","Marking services as initialized",{bookingId:o,isError:e}),e?O.current.servicesInProgress=!1:(O.current.servicesInitialized=!0,O.current.servicesInProgress=!1,M(!0))},G=(e=!1)=>{(0,h.debugLog)("MBA2ou09hv595","Marking pets as initialized",{bookingId:o,isError:e}),e?O.current.petsInProgress=!1:(O.current.petsInitialized=!0,O.current.petsInProgress=!1,R(!0))},J=(e,t)=>{if((0,h.debugLog)("MBA2ou09hv595","Parent handling services data",{bookingId:o,services:e,servicesCount:e?.length,selectedServiceId:t}),F(e||[]),t&&e){const o=p.service?.service_id;if(o!==t){const n=e.find((e=>e.service_id===t));n&&((0,h.debugLog)("MBA2ou09hv595","Parent auto-selecting service",{currentSelectedId:o,selectedServiceId:t,serviceToSelect:{id:n.service_id,name:n.service_name}}),N(Object.assign({},n,{isOvernightForced:n.is_overnight})))}}},$=(e,t)=>{if((0,h.debugLog)("MBA2ou09hv595","Parent handling pets data",{bookingId:o,pets:e,petsCount:e?.length,selectedPetIds:t}),W(e||[]),t&&t.length>0&&e){const t=e.filter((e=>!0===e.is_selected));t.length>0&&((0,h.debugLog)("MBA2ou09hv595","Parent auto-selecting pets",{petsToSelect:t.map((e=>({id:e.pet_id,name:e.name})))}),U(t))}},K=e=>{(0,h.debugLog)("MBA12345 Selected dates:",e),(0,h.debugLog)("MBA2j3kbr9hve4: CRITICAL handleDateSelect rangeType:",{rangeType:e.rangeType,currentDateRangeType:p.dateRangeType,isServiceOvernight:p.service?.is_overnight,isTimesOvernightForced:p.times?.isOvernightForced}),y((t=>{let o=t.dateRange;return"date-range"===e.rangeType&&e.startDate&&e.endDate?o={startDate:e.startDate,endDate:e.endDate}:"multiple-days"===e.rangeType?o=t.dateRange:e.dates&&0!==e.dates.length||(o=null),Object.assign({},t,{dates:e.dates||[],dateSelectionData:e,dateRange:o,dateRangeType:e.rangeType||t.dateRangeType})}))},Z=e=>{(0,h.debugLog)("MBAoi1h34ghnvo: TimeSelectionCard sent time data:",e);const t=!0===p.service?.is_overnight;(0,h.debugLog)("MBAoi1h34ghnvo: CRITICAL FIX - Overnight status determination:",{hasServiceOvernight:t,timeDataIsOvernightForced:e.isOvernightForced,message:"Using service.is_overnight as source of truth"}),y((o=>{if(e.hasIndividualTimes){(0,h.debugLog)("MBAoi1h34ghnvo: Processing individual times");const n=Object.assign({},o.times,{hasIndividualTimes:!0,isOvernightForced:t,dates:e.dates||o.times.dates||[],individualTimeRanges:e.individualTimeRanges||{}});return Object.keys(e).forEach((t=>{t.match(/^\d{4}-\d{2}-\d{2}$/)&&((0,h.debugLog)("MBAoi1h34ghnvo: Processing date key:",t,e[t]),Array.isArray(e[t])?(n[t]=[...e[t]],(0,h.debugLog)("MBAoi1h34ghnvo: Preserved array of time slots for date:",t,n[t])):(n[t]=[{startTime:e[t].startTime,endTime:e[t].endTime,isOvernightForced:e[t].isOvernightForced}],(0,h.debugLog)("MBAoi1h34ghnvo: Converted single time slot to array for date:",t,n[t])))})),(0,h.debugLog)("MBAoi1h34ghnvo: Final individual times object:",n),Object.assign({},o,{times:n})}{(0,h.debugLog)("MBAoi1h34ghnvo: Using default time range mode");const n=Object.assign({},o.times,{startTime:e.startTime?"".concat(String(e.startTime.hours).padStart(2,"0"),":").concat(String(e.startTime.minutes||0).padStart(2,"0")):o.times.startTime,endTime:e.endTime?"".concat(String(e.endTime.hours).padStart(2,"0"),":").concat(String(e.endTime.minutes||0).padStart(2,"0")):o.times.endTime,isOvernightForced:t,hasIndividualTimes:!1,dates:e.dates||o.times.dates||[]});return(0,h.debugLog)("MBAoi1h34ghnvo: Updated default times:",n),Object.assign({},o,{times:n})}}))},Q=()=>{switch(m){case wr.SERVICES_AND_PETS.id:return p.service&&p.pets.length>0;case wr.DATE_SELECTION.id:return!(!p.dateSelectionData||!p.dateSelectionData.isValid)||(!!(p.dates&&p.dates.length>0)||!!(p.dateRange&&p.dateRange.startDate&&p.dateRange.endDate));case wr.TIME_SELECTION.id:case wr.REVIEW_AND_RATES.id:return!0;default:return!1}},ee=async()=>{if(Q())if(x(null),(0,h.debugLog)("MBA2j3kbr9hve4: Moving to next step:",{currentStep:m,nextStep:m+1,hasValidDates:p.dates&&p.dates.length>0,hasValidDateRange:p.dateRange&&p.dateRange.startDate&&p.dateRange.endDate,hasValidDateSelectionData:p.dateSelectionData&&p.dateSelectionData.isValid,dateRangeType:p.dateRangeType,bookingType:p.bookingType}),m<wr.REVIEW_AND_RATES.id){if(m===wr.SERVICES_AND_PETS.id)try{(0,h.debugLog)("MBA2j3kbr9hve4: Updating booking draft with service and pets"),await(0,bt.updateBookingDraftPetsAndServices)(o,{service_id:p.service?.service_id,pets:p.pets}),(0,h.debugLog)("MBA2j3kbr9hve4: Successfully updated booking draft with service and pets"),y((e=>Object.assign({},e,{hasFetchedDates:!1})))}catch(b){return(0,h.debugLog)("MBA2j3kbr9hve4: Error updating booking draft:",b),void x("Failed to save service and pet selections")}if(m===wr.TIME_SELECTION.id)try{(0,h.debugLog)("MBA5asdt3f4321 Original booking data:",p);const t=!0===p.service?.is_overnight,n=!0===p.times?.isOvernightForced,r=t||n;if((0,h.debugLog)("MBA5asdt3f4321 DIRECT OVERNIGHT CHECK AT START:",{isServiceOvernightFlag:t,isTimeOvernightFlag:n,isAnyOvernightFlag:r,dateRangeType:p.dateRangeType}),r&&p.dateRange){(0,h.debugLog)("MBA53212co2v3nvoub5 DIRECT OVERRIDE: Forcing overnight mode for any overnight service");const e=(0,Wt.formatDateForAPI)(p.dateRange.startDate),t=(0,Wt.formatDateForAPI)(p.dateRange.endDate),n=(0,Wt.formatTimeForAPI)(p.times.startTime),r=(0,Wt.formatTimeForAPI)(p.times.endTime);(0,h.debugLog)("MBA53212co2v3nvoub5 DIRECT OVERRIDE: Using time-and-date endpoint with dates:",{startDate:e,endDate:t,startTime:n,endTime:r});const a=u?.timezone||"US/Mountain";(0,h.debugLog)("MBA53212co2v3nvoub5 Using user timezone for UTC conversion:",a);const{date:i,time:s}=(0,Wt.convertToUTC)(e,n,a),{date:l,time:d}=(0,Wt.convertToUTC)(t,r,a),c=await(0,bt.updateBookingDraftTimeAndDate)(o,i,l,s,d);return(0,h.debugLog)("MBA53212co2v3nvoub5 DIRECT OVERRIDE: Response from updateBookingDraftTimeAndDate:",c),c?.draft_data&&y((e=>Object.assign({},e,c.draft_data,{times:Object.assign({},c.draft_data.times||e.times,{isOvernightForced:!0}),service:Object.assign({},c.draft_data.service||e.service,{is_overnight:!0}),dateRangeType:"date-range"}))),void f((e=>e+1))}if("date-range"===p.dateRangeType){const t=!0===p.service?.is_overnight,n=!0===p.times?.isOvernightForced&&!("00:00"===p.times.endTime&&!t);let r=!1;if(p.dateRange&&p.dateRange.startDate&&p.dateRange.endDate)try{const e=new Date(p.dateRange.startDate),t=new Date(p.dateRange.endDate),o=Math.ceil((t-e)/864e5);o>1&&(r=!0,(0,h.debugLog)("MBA53212co2v3nvoub5 DETECTED multi-day date range:",{startDate:p.dateRange.startDate,endDate:p.dateRange.endDate,daysDifference:o}))}catch(e){(0,h.debugLog)("MBA53212co2v3nvoub5 Error checking date range:",e)}if((0,h.debugLog)("MBA53212co2v3nvoub5 CRITICAL FIX - Checking overnight status:",{dateRangeType:p.dateRangeType,serviceIsOvernight:t,timesIsOvernightForced:p.times?.isOvernightForced,endTime:p.times?.endTime,endTimeIsMidnight:"00:00"===p.times?.endTime,isMidnightEndTimeButNotForced:"00:00"===p.times?.endTime&&!t,isTimeOvernight:n,isMultiDayRange:r,willTreatAsOvernight:t||n,message:"Multi-day ranges no longer automatically force overnight mode",service:p.service,times:p.times}),t||n){const e=Object.assign({},p,{service:Object.assign({},p.service,{is_overnight:t||n}),times:Object.assign({},p.times,{isOvernightForced:t||n})});y(e),(0,h.debugLog)("MBA53212co2v3nvoub5 Using overnight endpoint for truly overnight service");const r=(0,Wt.formatDateForAPI)(p.dateRange.startDate),a=(0,Wt.formatDateForAPI)(p.dateRange.endDate),i=(0,Wt.formatTimeForAPI)(p.times.startTime),s=(0,Wt.formatTimeForAPI)(p.times.endTime),l=u?.timezone||"US/Mountain";(0,h.debugLog)("MBA53212co2v3nvoub5 Using user timezone for UTC conversion:",l);const{date:d,time:c}=(0,Wt.convertToUTC)(r,i,l),{date:g,time:m}=(0,Wt.convertToUTC)(a,s,l),b=await(0,bt.updateBookingDraftTimeAndDate)(o,d,g,c,m);return(0,h.debugLog)("MBA53212co2v3nvoub5 Received response from updateBookingDraftTimeAndDate (overnight override):",b),b?.draft_data&&y((e=>Object.assign({},e,b.draft_data,{times:Object.assign({},b.draft_data.times||e.times,{isOvernightForced:t||n}),service:Object.assign({},b.draft_data.service||e.service,{is_overnight:t||n})}))),void f((e=>e+1))}const a="date-range"===p.dateRangeType&&!t&&!n;if((0,h.debugLog)("MBA53212co2v3nvoub5 CRITICAL FIX - Decision:",{isNonOvernightDateRange:a,isMultiDayRange:r,willUseEndpoint:a?"updateBookingDraftMultipleDays":"updateBookingDraftTimeAndDate",message:"Multi-day ranges for non-overnight services now use multiple days endpoint"}),a){(0,h.debugLog)("MBA53212co2v3nvoub5 CRITICAL FIX - Handling non-overnight date range as individual occurrences:",{isMultiDay:r,message:"Multi-day ranges for non-overnight services handled correctly"});const e=new Date(p.dateRange.startDate),t=new Date(p.dateRange.endDate),n=[],a=new Date(e);for(;a<=t;)n.push(new Date(a)),a.setDate(a.getDate()+1);(0,h.debugLog)("MBA53212co2v3nvoub5 Generated dates from range:",n.map((e=>e.toISOString().split("T")[0]))),(0,h.debugLog)("MBA53212co2v3nvoub5 Time settings:",p.times);const i=[];n.forEach((e=>{const t=e.toISOString().split("T")[0];(0,h.debugLog)("MBA53212co2v3nvoub5 Processing date:",t);let o=p.times;p.times[t]&&p.times.hasIndividualTimes?(o=p.times[t],(0,h.debugLog)("MBA53212co2v3nvoub5 Using individual times for date:",t,o)):(0,h.debugLog)("MBA53212co2v3nvoub5 Using default times for date:",t,o);const n=Array.isArray(o)?o:[o];(0,h.debugLog)("MBA53212co2v3nvoub5 Time slots for date:",t,n),n.forEach(((o,n)=>{let r,a;r="string"===typeof o.startTime?o.startTime:void 0!==o.startTime?.hours?"".concat(String(o.startTime.hours).padStart(2,"0"),":").concat(String(o.startTime.minutes||0).padStart(2,"0")):"09:00",a="string"===typeof o.endTime?o.endTime:void 0!==o.endTime?.hours?"".concat(String(o.endTime.hours).padStart(2,"0"),":").concat(String(o.endTime.minutes||0).padStart(2,"0")):"17:00",(0,h.debugLog)("MBA53212co2v3nvoub5 Formatted times for slot",n,"on date:",t,{startTime:r,endTime:a});const s=(0,Wt.formatDateForAPI)(e);(0,h.debugLog)("MBA53212co2v3nvoub5 Formatted date:",s);const l="00:00"===a||parseInt(a.split(":")[0],10)<parseInt(r.split(":")[0],10)||parseInt(a.split(":")[0],10)===parseInt(r.split(":")[0],10)&&parseInt(a.split(":")[1],10)<parseInt(r.split(":")[1],10),d=l?new Date(e.getTime()+864e5):new Date(e),c=(0,Wt.formatDateForAPI)(d);(0,h.debugLog)("MBA53212co2v3nvoub5 End date calculation for slot",n,":",{needsNextDayDate:l,startTime:r,endTime:a,originalDate:s,calculatedEndDate:c});const g=u?.timezone||"US/Mountain";(0,h.debugLog)("MBA53212co2v3nvoub5 Using user timezone for UTC conversion in forEach function:",g);const{date:m,time:f}=(0,Wt.convertToUTC)(s,r,g),{date:p,time:y}=(0,Wt.convertToUTC)(c,a,g);(0,h.debugLog)("MBA53212co2v3nvoub5 Converted UTC times for slot",n,":",{utcStartDate:m,utcStartTime:f,utcEndDate:p,utcEndTime:y,isDifferentDates:m!==p}),i.push({date:m,startTime:f,endDate:p,endTime:y,is_overnight:l})}))})),(0,h.debugLog)("MBA53212co2v3nvoub5 - Converted UTC dates:",i);const s=await(0,bt.updateBookingDraftMultipleDays)(o,{dates:i,times:{}},u);(0,h.debugLog)("MBA53212co2v3nvoub5 Received response from updateBookingDraftMultipleDays:",s),s?.draft_data&&y((e=>Object.assign({},e,s.draft_data)))}else{const e=(0,Wt.formatDateForAPI)(p.dateRange.startDate),t=(0,Wt.formatDateForAPI)(p.dateRange.endDate),n=(0,Wt.formatTimeForAPI)(p.times.startTime),r=(0,Wt.formatTimeForAPI)(p.times.endTime);(0,h.debugLog)("MBA53212co2v3nvoub5 Using update-time-and-date endpoint for OVERNIGHT service with dates:",{startDate:e,endDate:t,startTime:n,endTime:r,service:{id:p.service?.service_id,name:p.service?.service_name,is_overnight:p.service?.is_overnight},times:{isOvernightForced:p.times?.isOvernightForced}});const{date:a,time:i}=(0,Wt.convertToUTC)(e,n,userTz),{date:s,time:l}=(0,Wt.convertToUTC)(t,r,userTz);(0,h.debugLog)("MBA53212co2v3nvoub5 UTC dates and times:",{utcStartDate:a,utcStartTime:i,utcEndDate:s,utcEndTime:l});const d=await(0,bt.updateBookingDraftTimeAndDate)(o,a,s,i,l);(0,h.debugLog)("MBA53212co2v3nvoub5 Received response from updateBookingDraftTimeAndDate:",d),d?.draft_data?y((e=>Object.assign({},e,d.draft_data))):(0,h.debugLog)("MBA53212co2v3nvoub5 No draft_data in response:",d)}}else if("multiple-days"===p.dateRangeType){(0,h.debugLog)("MBA53212co2v3nvoub5 Multiple days selection:",{dates:p.dates,times:p.times});const e=[];p.dates&&p.dates.length>0&&p.dates.forEach((t=>{let o;o="string"===typeof t?new Date(t):t&&t.date?new Date(t.date):new Date(t);const n=o.toISOString().split("T")[0];(0,h.debugLog)("MBA53212co2v3nvoub5 Processing individual date:",n);let r=p.times;p.times[n]&&p.times.hasIndividualTimes?(r=p.times[n],(0,h.debugLog)("MBA53212co2v3nvoub5 Using individual times for date:",n,r)):(0,h.debugLog)("MBA53212co2v3nvoub5 Using default times for date:",n,r);const a=Array.isArray(r)?r:[r];(0,h.debugLog)("MBA53212co2v3nvoub5 Time slots for individual date:",n,a),a.forEach(((t,r)=>{let a,i;a="string"===typeof t.startTime?t.startTime:void 0!==t.startTime?.hours?"".concat(String(t.startTime.hours).padStart(2,"0"),":").concat(String(t.startTime.minutes||0).padStart(2,"0")):"09:00",i="string"===typeof t.endTime?t.endTime:void 0!==t.endTime?.hours?"".concat(String(t.endTime.hours).padStart(2,"0"),":").concat(String(t.endTime.minutes||0).padStart(2,"0")):"17:00",(0,h.debugLog)("MBA53212co2v3nvoub5 Formatted times for slot",r,"on individual date:",n,{startTime:a,endTime:i});const s=(0,Wt.formatDateForAPI)(o),l="00:00"===i||parseInt(i.split(":")[0],10)<parseInt(a.split(":")[0],10)||parseInt(i.split(":")[0],10)===parseInt(a.split(":")[0],10)&&parseInt(i.split(":")[1],10)<parseInt(a.split(":")[1],10),d=l?new Date(o.getTime()+864e5):new Date(o),c=(0,Wt.formatDateForAPI)(d),g=u?.timezone||"US/Mountain",{date:m,time:f}=(0,Wt.convertToUTC)(s,a,g),{date:p,time:y}=(0,Wt.convertToUTC)(c,i,g);(0,h.debugLog)("MBA53212co2v3nvoub5 Converted UTC times for individual date slot",r,":",{utcStartDate:m,utcStartTime:f,utcEndDate:p,utcEndTime:y}),e.push({date:m,startTime:f,endDate:p,endTime:y,is_overnight:l})}))})),(0,h.debugLog)("MBA53212co2v3nvoub5 Formatted dates for multiple individual days:",e);const t=await(0,bt.updateBookingDraftMultipleDays)(o,{dates:e,times:{}},u);(0,h.debugLog)("MBA53212co2v3nvoub5 Received response from updateBookingDraftMultipleDays:",t),t?.draft_data&&y((e=>Object.assign({},e,t.draft_data)))}else if("recurring"===p.bookingType){(0,h.debugLog)("MBA53212co2v3nvoub5 Recurring dates selection:",{startDate:p.recurringStartDate,endDate:p.recurringEndDate,daysOfWeek:p.selectedDaysOfWeek,frequency:p.selectedFrequency,times:p.times});const e=await(0,bt.updateBookingDraftRecurring)(o,{startDate:p.recurringStartDate,endDate:p.recurringEndDate,daysOfWeek:p.selectedDaysOfWeek,frequency:p.selectedFrequency,startTime:p.times.startTime,endTime:p.times.endTime});(0,h.debugLog)("MBA53212co2v3nvoub5 Received response from updateBookingDraftRecurring:",e),e?.draft_data&&y((t=>Object.assign({},t,e.draft_data)))}}catch(b){return(0,h.debugLog)("MBA53212co2v3nvoub5 Error calculating booking totals:",b),(0,h.debugLog)("MBA53212co2v3nvoub5 Error stack:",b.stack),(0,h.debugLog)("MBA53212co2v3nvoub5 Error details:",{message:b.message,name:b.name,response:b.response?.data}),void x("Failed to calculate booking totals")}f((e=>e+1))}else{const e=_(),t=!0===e||!0!==e&&S;if((0,h.debugLog)("MBA54321: BookingStepModal TOS validation:",{currentTosStatus:e,termsAgreed:S,hasAgreedToTerms:t,bookingData:!!p}),!t)return(0,h.debugLog)("MBA54321: Terms not agreed, showing TOS modal"),void A(!0);try{if(x(null),!p.conversation_id)return void x("Missing conversation information");(0,h.debugLog)("MBA66777 Creating booking from draft with conversation ID:",p.conversation_id);const e=await(0,bt.createBookingFromDraft)(p.conversation_id,t);(0,h.debugLog)("MBA66777 Booking created successfully:",e);const o=e.message||{},n=e.booking_id,r={id:Date.now().toString(),type_of_message:"send_approved_message",metadata:{booking_id:n,service_type:o.service_type||p.service?.service_name,occurrences:o.occurrences||[],cost_summary:o.cost_summary||{total_client_cost:o.occurrences?.[0]?.cost_summary?.total_client_cost,total_sitter_payout:o.occurrences?.[0]?.cost_summary?.total_sitter_payout}},content:"Approval Request",sent_by_other_user:!1,timestamp:(new Date).toISOString()};i(Object.assign({},p,{booking_id:n,status:"Pending Client Approval",message:r})),te()}catch(b){(0,h.debugLog)("MBA66777 Error creating booking:",b),x("Failed to create booking. Please try again."),setTimeout((()=>{i(Object.assign({},p,{error:!0,errorMessage:b.message}))}),3e3)}}else x("Please complete all required fields before proceeding")},te=()=>{(0,h.debugLog)("MBA2j3kbr9hve4: Resetting booking step modal state"),f(wr.SERVICES_AND_PETS.id),y({service:s?.service||null,pets:s?.pets||[],dates:s?.dates||[],bookingType:s?.bookingType||"one-time",dateRangeType:s?.dateRangeType||"date-range",times:s?.times||{startTime:"09:00",endTime:"17:00",isOvernightForced:!1,hasIndividualTimes:!1},rates:s?.rates||{},dateSelectionData:null,dateRange:null,hasFetchedDates:!1}),x(null),C(!1);!0!==_()&&T(!1),A(!1)},oe=()=>{(0,h.debugLog)("MBA66777: Closing booking step modal and resetting state"),te(),t()};(0,n.useEffect)((()=>()=>{(0,h.debugLog)("MBA2j3kbr9hve4: BookingStepModal unmounting, cleaning up state")}),[]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(k.default,{visible:e,animationType:"fade",onRequestClose:oe,transparent:!0,children:(0,j.jsx)(r.default,{style:Cr.modalOverlay,children:(0,j.jsxs)(He.default,{style:Cr.modalContent,children:[(0,j.jsx)(r.default,{style:Cr.stepIndicatorContainer,children:(0,j.jsx)(qe,{steps:Object.values(wr).map((e=>e.name)),currentStep:m})}),(0,j.jsxs)(X.default,{style:Cr.scrollContent,contentContainerStyle:Cr.scrollContentContainer,children:[(0,j.jsx)(r.default,{style:Cr.content,children:w?(0,j.jsx)(r.default,{style:Cr.loadingContainer,children:(0,j.jsx)(a.default,{style:Cr.loadingText,children:"Loading booking information..."})}):(()=>{switch(m){case wr.SERVICES_AND_PETS.id:return(0,h.debugLog)("MBA2ou09hv595","BookingStepModal rendering ServiceAndPetsCard",{bookingId:o,currentStep:m,selectedServiceId:p.service?.service_id,selectedPetsCount:p.pets?.length,timestamp:(new Date).toISOString()}),(0,j.jsx)(or,{bookingId:o,onServiceSelect:N,onPetSelect:H,onBatchPetSelect:U,selectedService:p.service,selectedPets:p.pets,navigation:l,onClose:t,shouldFetchServices:V,shouldFetchPets:q,markServicesInitialized:Y,markPetsInitialized:G,availableServices:P,availablePets:E,onServicesData:J,onPetsData:$},"services-pets-".concat(o));case wr.DATE_SELECTION.id:(0,h.debugLog)("MBA2j3kbr9hve4: Rendering date selection with:",{dates:p.dates,dateRange:p.dateRange,bookingType:p.bookingType,dateRangeType:p.dateRangeType,hasFetchedDates:p.hasFetchedDates});const e=p.service?.is_overnight||!1;return(0,h.debugLog)("MBA2j3kbr9hve4: Date selection overnight status:",{serviceIsOvernight:p.service?.is_overnight,timesIsOvernightForced:p.times?.isOvernightForced,combinedMode:e}),(0,j.jsx)(lr,{selectedDates:p.dates||[],onDateSelect:K,bookingType:p.bookingType||"one-time",dateRangeType:p.dateRangeType||"date-range",initialDateRange:p.dateRange||null,isOvernightForced:e});case wr.TIME_SELECTION.id:if(!p.dates||0===p.dates.length)return(0,j.jsx)(r.default,{style:Cr.errorContainer,children:(0,j.jsx)(a.default,{style:Cr.errorText,children:"Please select dates first"})});(0,h.debugLog)("MBA66777: CURRENT STATE Before rendering time selection:",{service:{id:p.service?.service_id,name:p.service?.service_name,is_overnight:p.service?.is_overnight},times:{isOvernightForced:p.times?.isOvernightForced,hasIndividualTimes:p.times?.hasIndividualTimes},dateRange:p.dateRange,dateRangeType:p.dateRangeType});const n=p.service?.is_overnight||!1;(0,h.debugLog)("MBA66777: CRITICAL FIX - Overnight mode calculation:",{serviceIsOvernight:p.service?.is_overnight,previousTimesIsOvernightForced:p.times?.isOvernightForced,calculatedCurrentServiceIsOvernight:n,message:"isOvernightForced now based ONLY on current service, not previous state"});const i=Object.assign({},p.times,{dates:p.dates||[],occurrences:p.occurrences||[],hasIndividualTimes:!n&&(p.times?.hasIndividualTimes||!1),isOvernightForced:n}),s=n;return(0,h.debugLog)("MBA66777: Passing initialTimes to TimeSelectionCard:",{hasIndividualTimes:i.hasIndividualTimes,dateCount:i.dates?.length||0,isOvernightService:p.service?.is_overnight,isOvernightForced:p.times?.isOvernightForced,combinedOvernight:s}),(0,j.jsx)(vr,{onTimeSelect:Z,initialTimes:i,dateRange:p.dateRange,selectedService:Object.assign({},p.service,{is_overnight:s}),isOvernightForced:s});case wr.REVIEW_AND_RATES.id:return(0,j.jsx)(rn,{bookingData:p,bookingId:o,onRatesUpdate:e=>{(0,h.debugLog)("MBA2j3kbr9hve4: Rates updated:",e),y((t=>Object.assign({},t,{occurrences:e.occurrences,cost_summary:e.cost_summary})))},isProfessional:!0,fromApprovalModal:!1,onTermsAgreed:e=>{(0,h.debugLog)("MBA54321: BookingStepModal received onTermsAgreed:",e),T(e)},onTosAgreementChange:e=>{(0,h.debugLog)("MBA54321: BookingStepModal received onTosAgreementChange:",e),T(e)}});default:return null}})()}),b&&(0,j.jsx)(a.default,{style:Cr.errorText,children:b})]}),(0,j.jsx)(r.default,{style:Cr.footer,children:m===wr.SERVICES_AND_PETS.id?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(v.default,{style:Cr.cancelButton,onPress:oe,children:(0,j.jsx)(a.default,{style:Cr.cancelButtonText,children:"Cancel"})}),(0,j.jsx)(v.default,{style:[Cr.nextButton,(!Q()||w)&&Cr.disabledButton],onPress:ee,disabled:!Q()||w,children:(0,j.jsx)(a.default,{style:[Cr.nextButtonText,(!Q()||w)&&Cr.disabledButtonText],children:"Next"})})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(v.default,{style:[Cr.backButton,g&&Cr.smallScreenButton],onPress:()=>{m>wr.SERVICES_AND_PETS.id?f((e=>e-1)):oe()},children:(0,j.jsx)(a.default,{style:Cr.backButtonText,children:"Back"})}),(0,j.jsx)(r.default,{style:Cr.spacer}),(0,j.jsx)(v.default,{style:[Cr.cancelButtonSmall,g&&Cr.smallScreenButton],onPress:oe,children:(0,j.jsx)(a.default,{style:Cr.cancelButtonText,children:"Cancel"})}),(0,j.jsx)(r.default,{style:g?Cr.smallMargin:null}),(0,j.jsx)(v.default,{style:[Cr.nextButtonSmall,g&&Cr.smallScreenButton,(!Q()||w)&&Cr.disabledButton],onPress:ee,disabled:!Q()||w,children:m===wr.REVIEW_AND_RATES.id&&g?(0,j.jsxs)(r.default,{style:Cr.confirmButtonColumn,children:[(0,j.jsx)(a.default,{style:[Cr.nextButtonText,(!Q()||w)&&Cr.disabledButtonText],children:"Request"}),(0,j.jsx)(a.default,{style:[Cr.nextButtonText,(!Q()||w)&&Cr.disabledButtonText],children:"Booking"})]}):(0,j.jsx)(a.default,{style:[Cr.nextButtonText,(!Q()||w)&&Cr.disabledButtonText],children:m===wr.REVIEW_AND_RATES.id?"Request Booking":"Next"})})]})})]})})}),(0,j.jsx)(sn,{visible:B,onClose:()=>A(!1),actionType:"booking"})]})},jr=i.default.create({card:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:0,margin:8,borderWidth:1,borderColor:m.theme.colors.border,maxWidth:"80%",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,overflow:"hidden",position:"relative"},sentCard:{alignSelf:"flex-end",marginLeft:"20%"},receivedCard:{alignSelf:"flex-start",marginRight:"20%"},approvalCard:{borderColor:m.theme.colors.border,borderWidth:1},confirmedCard:{borderColor:m.theme.colors.success,borderWidth:2},colorBar:{width:4,backgroundColor:m.theme.colors.primary,position:"absolute",top:0,bottom:0,zIndex:1},colorBarLeft:{left:0},colorBarRight:{right:0},cardContent:{padding:12},header:{flexDirection:"row",alignItems:"center",marginBottom:8,paddingBottom:8,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,gap:8},requestHeader:{borderBottomColor:m.theme.colors.border+"40"},approvalHeader:{borderBottomColor:m.theme.colors.border+"40"},confirmedHeader:{borderBottomColor:m.theme.colors.success},title:{fontSize:16,fontWeight:"bold",fontFamily:m.theme.fonts.header.fontFamily},requestTitle:{color:m.theme.colors.primary},approvalTitle:{color:m.theme.colors.primary},changeRequestTitle:{color:m.theme.colors.warning},content:{gap:8},infoSection:{gap:4,paddingBottom:8,borderBottomWidth:1,borderBottomColor:m.theme.colors.border+"40"},row:{flexDirection:"row",alignItems:"center",gap:8},label:{fontSize:14,fontWeight:"500",color:m.theme.colors.text,minWidth:80,fontFamily:m.theme.fonts.regular.fontFamily},value:{fontSize:14,color:m.theme.colors.text,flex:1,fontFamily:m.theme.fonts.regular.fontFamily},datesSection:{gap:4},datesSectionHeader:{flexDirection:"row",alignItems:"center"},datesCount:{fontSize:14,color:m.theme.colors.placeholder,marginLeft:8,fontFamily:m.theme.fonts.regular.fontFamily},occurrenceContainer:{borderBottomWidth:1,borderBottomColor:m.theme.colors.border+"40",paddingBottom:8,marginBottom:4},occurrenceItem:{gap:2,marginLeft:4},dateTimeText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontStyle:"italic"},durationText:{fontSize:14,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily},dstMessage:{fontSize:12,color:m.theme.colors.error,fontFamily:m.theme.fonts.regular.fontFamily},buttonContainer:{flexDirection:"row",justifyContent:"space-between",marginTop:8,gap:8},detailsButton:{flex:1,padding:8,borderRadius:8,alignItems:"center"},detailsButtonText:{fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},approveButton:{flex:1,padding:8,borderRadius:8,alignItems:"center",backgroundColor:m.theme.colors.primary},approveButtonText:{color:m.theme.colors.whiteText,fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},editButton:{flex:1,padding:8,borderRadius:8,alignItems:"center",backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border},editButtonText:{color:m.theme.colors.text,fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},disabledButton:{backgroundColor:m.theme.colors.border,opacity:.6},disabledButtonText:{color:m.theme.colors.placeHolderText},statusOverlay:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.4)",alignItems:"center",justifyContent:"center",zIndex:2},statusText:{color:"white",fontSize:16,fontWeight:"bold",padding:8,backgroundColor:"rgba(0, 0, 0, 0.6)",borderRadius:4,fontFamily:m.theme.fonts.header.fontFamily},changeMessageContainer:{backgroundColor:m.theme.colors.background,borderRadius:8,padding:8,marginTop:4,marginBottom:4,borderLeftWidth:3,borderLeftColor:m.theme.colors.warning},changeMessageLabel:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginBottom:4,fontFamily:m.theme.fonts.regular.fontFamily},changeMessageText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},showMoreButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingVertical:8,marginTop:8,marginBottom:4,backgroundColor:m.theme.colors.surface,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.primary+"40",paddingHorizontal:12,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:1,elevation:1},showMoreText:{fontSize:14,color:m.theme.colors.primary,marginRight:5,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},confirmationContainerClickable:{flex:1,width:"100%",borderRadius:8},confirmationContainer:{backgroundColor:m.theme.colors.primary+"15",padding:12,borderRadius:8,marginBottom:8},confirmationText:{fontSize:14,color:m.theme.colors.text,textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},confirmedTitle:{color:m.theme.colors.primary},confirmationBorder:{position:"absolute",top:0,left:0,right:0,height:4,backgroundColor:m.theme.colors.primary},completeButton:{flex:1,padding:8,borderRadius:8,alignItems:"center",backgroundColor:m.theme.colors.primary,borderWidth:1,borderColor:m.theme.colors.primary},completeButtonText:{color:"white",fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily}}),Tr=({type:e,displayType:t,data:o,isFromMe:i,onPress:s,isProfessional:l,onApproveSuccess:d,onApproveError:c,onEditDraft:u,bookingStatus:g,hasChangeRequest:f,isNewestMessage:p=!1,messageCreatedAt:y,hasNewerApprovalRequests:b=!1,isAfterConfirmation:x=!1,onMarkCompletedSuccess:w,onMarkCompletedError:C,isBookingCompleted:T=!1})=>{const{timeSettings:B}=(0,n.useContext)(h.AuthContext),k=B?.timezone||"US/Mountain",[A,_]=(0,n.useState)(!1),[I,M]=(0,n.useState)(null),[L,R]=(0,n.useState)(!1),[D,z]=(0,n.useState)(!1),[F,E]=(0,n.useState)(!1),[W,O]=(0,n.useState)(""),[N,H]=(0,n.useState)("error");(0,n.useEffect)((()=>{const e=Object.assign({},o,{occurrences:o.occurrences?.map((e=>Object.assign({},e,{rates:e.rates||{base_rate:0,additional_animal_rate:0,applies_after:1,holiday_rate:0,holiday_days:0,additional_rates:[]}})))});M(e)}),[o]);const U="Confirmed"===g,V="request_changes"===e,q="booking_confirmed"===e,Y="approval"===e||V,G=T||U&&!q&&"approval"!==e&&!x&&!(V&&p)||"approval"===e&&f&&!p||V&&!p||q&&b||"booking_update"===t&&f&&!p||"approval"===e&&x&&!p,J=T?"Booking Completed":q&&b||"booking_update"===t&&f&&!p||"approval"===e&&x&&!p?"Booking Updated":"approval"===e&&x&&p||V&&p?"":!U||q||x||V&&p?"approval"===e&&f&&!p?"Changes Requested":V&&!p?"Booking Updated":"":"Booking Confirmed",$=()=>{if(!I){const e=Object.assign({},o,{occurrences:o.occurrences?.map((e=>Object.assign({},e,{rates:e.rates||{base_rate:0,additional_animal_rate:0,applies_after:1,holiday_rate:0,holiday_days:0,additional_rates:[]}})))||[]});M(e)}(0,h.debugLog)("MBA9876 Opening approval modal with booking ID:",o.booking_id),_(!0)},K=e=>{if(e.start_date&&e.end_date&&e.start_time&&e.end_time){const t=(0,Wt.formatDateTimeRangeFromUTC)({startDate:e.start_date,startTime:e.start_time,endDate:e.end_date,endTime:e.end_time,userTimezone:k,includeTimes:!0,includeTimezone:!0});return((e,t,o,n,r)=>{try{const a=ho().utc("".concat(e,"T").concat(t,":00Z")).tz(r),i=ho().utc("".concat(o,"T").concat(n,":00Z")).tz(r);return a.utcOffset()!==i.utcOffset()}catch(zs){return(0,h.debugLog)("MBA9876DST Error checking DST change:",zs),!1}})(e.start_date,e.start_time,e.end_date,e.end_time,k)&&!e.dst_message&&((0,h.debugLog)("MBA9876DST Detected DST change for occurrence:",{start:"".concat(e.start_date," ").concat(e.start_time),end:"".concat(e.end_date," ").concat(e.end_time),timezone:k}),e.dst_message="Elapsed time may be different than expected due to Daylight Savings Time."),t}return e.formatted_start&&e.formatted_end?"".concat(e.formatted_start," to ").concat(e.formatted_end):"Date information unavailable"},Z=e=>{if(e.duration)return e.duration;if(e.start_date&&e.end_date&&e.start_time&&e.end_time)try{const t=ho().utc("".concat(e.start_date,"T").concat(e.start_time,":00Z")),o=ho().utc("".concat(e.end_date,"T").concat(e.end_time,":00Z")),n=o.diff(t,"hours"),r=o.diff(t,"days");return r>0?"".concat(r," ").concat(1===r?"day":"days",", ").concat(n%24," ").concat(n%24===1?"hour":"hours"):"".concat(n," ").concat(1===n?"hour":"hours")}catch(zs){(0,h.debugLog)("MBA9876DST Error calculating duration:",zs)}return"N/A"},X=o.occurrences||[],Q=X.length>3,ee=L?X:X.slice(0,3),te=Math.max(0,X.length-3);return(0,j.jsxs)(r.default,{style:(()=>{const e=[jr.card,i?jr.sentCard:jr.receivedCard];return Y&&e.push(jr.approvalCard),q&&e.push(jr.confirmedCard),e})(),children:[Y&&(0,j.jsx)(r.default,{style:[jr.colorBar,i?jr.colorBarLeft:jr.colorBarRight]}),q&&(0,j.jsx)(r.default,{style:jr.confirmationBorder}),(0,j.jsxs)(r.default,{style:jr.cardContent,children:[(0,j.jsxs)(r.default,{style:q?[jr.header,jr.confirmedHeader]:[jr.header,Y?jr.approvalHeader:jr.requestHeader],children:[(0,j.jsx)(S.default,{name:(()=>{switch(e){case"request":return"calendar-plus";case"approval":return"calendar-check";case"request_changes":return"calendar-edit";case"booking_confirmed":return"check-circle-outline";default:return"calendar"}})(),size:24,color:V?m.theme.colors.warning:q?m.theme.colors.success:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:[jr.title,V?jr.changeRequestTitle:q?jr.confirmedTitle:Y?jr.approvalTitle:jr.requestTitle],children:(()=>{if("booking_update"===t)return"Booking Update";if("request_changes"===e&&x)return"Update Change Request";switch(e){case"request":return"Booking Request";case"approval":return"Approval Request";case"request_changes":return"Request Changes";case"booking_confirmed":return"Booking Confirmed";default:return"Booking"}})()})]}),(0,j.jsx)(r.default,{style:jr.content,children:q?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(v.default,{style:jr.confirmationContainerClickable,onPress:$,activeOpacity:.7,children:[(0,j.jsx)(r.default,{style:jr.confirmationContainer,children:(0,j.jsx)(a.default,{style:jr.confirmationText,children:"This booking has been confirmed and is ready to go!"})}),(0,j.jsxs)(r.default,{style:jr.infoSection,children:[(0,j.jsxs)(r.default,{style:jr.row,children:[(0,j.jsx)(a.default,{style:jr.label,children:"Booking ID:"}),(0,j.jsx)(a.default,{style:jr.value,children:o.booking_id||"N/A"})]}),(0,j.jsxs)(r.default,{style:jr.row,children:[(0,j.jsx)(a.default,{style:jr.label,children:"Service:"}),(0,j.jsx)(a.default,{style:jr.value,children:o.service_type||"N/A"})]}),(0,j.jsxs)(r.default,{style:jr.row,children:[(0,j.jsx)(a.default,{style:jr.label,children:l?"Your Payout:":"Total Cost:"}),(0,j.jsxs)(a.default,{style:jr.value,children:["$",l?o.cost_summary?.total_sitter_payout||"0.00":o.cost_summary?.total_client_cost||"0.00"]})]})]})]}),(0,j.jsxs)(r.default,{style:[jr.buttonContainer,l?{flexDirection:"column",gap:8}:{}],children:[(0,j.jsx)(v.default,{style:[jr.detailsButton,{flex:1,backgroundColor:m.theme.colors.surfaceContrast,borderColor:m.theme.colors.black,borderWidth:1}],onPress:$,children:(0,j.jsx)(a.default,{style:[jr.detailsButtonText,{color:m.theme.colors.black,textColor:m.theme.colors.black}],children:"View Details"})}),l&&u&&(0,j.jsx)(v.default,{style:[jr.editButton,{flex:1}],onPress:u,disabled:T,children:(0,j.jsx)(a.default,{style:[jr.editButtonText],children:"Edit Details"})}),l&&q&&U&&(0,j.jsx)(v.default,{style:[jr.completeButton,{flex:1},D?jr.disabledButton:{}],onPress:async()=>{try{z(!0),(0,h.debugLog)("MBA8675309: Marking booking as completed:",o.booking_id);const e=await(0,bt.markBookingCompleted)(o.booking_id);(0,h.debugLog)("MBA8675309: Booking marked as completed successfully:",e),w&&w(e)}catch(zs){(0,h.debugLog)("MBA8675309: Error marking booking as completed:",zs);let t="Failed to mark booking as completed";zs.response?.data?.error&&(t=zs.response.data.error),O(t),H("error"),E(!0),C&&C(zs)}finally{z(!1)}},disabled:T||D,children:(0,j.jsx)(a.default,{style:[jr.completeButtonText,D?jr.disabledButtonText:{}],children:D?"Marking...":"Mark as Completed"})})]})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(r.default,{style:jr.infoSection,children:[(0,j.jsxs)(r.default,{style:jr.row,children:[(0,j.jsx)(a.default,{style:jr.label,children:"Booking ID:"}),(0,j.jsx)(a.default,{style:jr.value,children:o.booking_id||"N/A"})]}),(0,j.jsxs)(r.default,{style:jr.row,children:[(0,j.jsx)(a.default,{style:jr.label,children:"Service:"}),(0,j.jsx)(a.default,{style:jr.value,children:o.service_type||"N/A"})]}),(0,j.jsxs)(r.default,{style:jr.row,children:[(0,j.jsx)(a.default,{style:jr.label,children:l?"Your Payout:":"Total Cost:"}),(0,j.jsxs)(a.default,{style:jr.value,children:["$",(()=>{if(o.cost_summary){if(l){const e=o.cost_summary.total_sitter_payout||"0.00";return"number"===typeof e?e.toFixed(2):parseFloat(e).toFixed(2)}{const e=o.cost_summary.total_client_cost||"0.00";return"number"===typeof e?e.toFixed(2):parseFloat(e).toFixed(2)}}if(l){const e=o.total_sitter_payout||"0.00";return"number"===typeof e?e.toFixed(2):parseFloat(e).toFixed(2)}{const e=o.total_owner_cost||"0.00";return"number"===typeof e?e.toFixed(2):parseFloat(e).toFixed(2)}})()]})]})]}),(0,j.jsxs)(r.default,{style:jr.datesSection,children:["request_changes"!==e?(0,j.jsxs)(r.default,{style:jr.datesSectionHeader,children:[(0,j.jsx)(a.default,{style:jr.label,children:"Dates:"}),Q&&(0,j.jsxs)(a.default,{style:jr.datesCount,children:["(",X.length," total)"]})]}):null,ee.map(((e,t)=>{const o=t===ee.length-1,n=!(!L&&o&&Q);return(0,j.jsx)(r.default,{style:[jr.occurrenceContainer,n?null:{borderBottomWidth:0}],children:(0,j.jsxs)(r.default,{style:jr.occurrenceItem,children:[(0,j.jsx)(a.default,{style:jr.dateTimeText,children:K(e)}),(0,j.jsxs)(a.default,{style:jr.durationText,children:["Event Duration: ",Z(e)," (",e.timezone||k.split("/")[1]||k,")"]}),e.dst_message?(0,j.jsx)(a.default,{style:jr.dstMessage,children:e.dst_message}):null]})},t)})),Q&&(0,j.jsxs)(v.default,{style:jr.showMoreButton,onPress:()=>{R(!L)},children:[(0,j.jsx)(a.default,{style:jr.showMoreText,children:L?"Show Fewer Dates":"Show ".concat(te," More Date").concat(1!==te?"s":"")}),(0,j.jsx)(S.default,{name:L?"chevron-up":"chevron-down",size:18,color:m.theme.colors.primary})]})]}),V&&(0,j.jsxs)(r.default,{style:jr.changeMessageContainer,children:[(0,j.jsx)(a.default,{style:jr.changeMessageLabel,children:"Change Request Message:"}),(0,j.jsx)(a.default,{style:jr.changeMessageText,children:o.content||"No details provided"})]}),(0,j.jsxs)(r.default,{style:jr.buttonContainer,children:[(0,j.jsx)(v.default,{style:[jr.detailsButton,{borderColor:m.theme.colors.black,borderWidth:1},U&&!x&&"booking_update"!==t&&jr.disabledButton],onPress:$,disabled:U&&!x&&"booking_update"!==t,children:(0,j.jsx)(a.default,{style:[jr.detailsButtonText,U&&!x&&"booking_update"!==t&&jr.disabledButtonText],children:l||U&&!x&&"booking_update"!==t?"View Details":"View to Approve"})}),"request"===e&&l&&u&&!U&&(0,j.jsx)(v.default,{style:jr.editButton,onPress:u,children:(0,j.jsx)(a.default,{style:jr.editButtonText,children:"Edit Draft"})}),V&&l&&u&&(0,j.jsx)(v.default,{style:jr.editButton,onPress:u,children:(0,j.jsx)(a.default,{style:jr.editButtonText,children:"Edit Details"})})]})]})})]}),G&&(0,j.jsx)(r.default,{style:jr.statusOverlay,children:(0,j.jsx)(a.default,{style:jr.statusText,children:J})}),(0,j.jsx)(dn,{visible:A,onClose:()=>_(!1),bookingId:o.booking_id,onApproveSuccess:e=>{d&&d(e)},onApproveError:e=>{c&&c(e)},onRequestChangesSuccess:e=>{(0,h.debugLog)("MBA9999 Change request submitted successfully:",e),d&&d(e)},onRequestChangesError:e=>{(0,h.debugLog)("MBA9999 Error submitting change request:",e),c&&c(e)},initialData:I,isProfessional:l,isReadOnly:(U||q)&&"booking_update"!==t&&!x,hideButtons:(U||q)&&"booking_update"!==t&&!x,modalTitle:"booking_update"===t||x?"Booking Update":q||U?"Booking Details":"Booking Approval Request"}),(0,j.jsx)(P,{visible:F,message:W,type:N,onDismiss:()=>E(!1),duration:7e3})]})};var Br=o(98055);const kr=i.default.create({modalContainer:{backgroundColor:m.theme.colors.surface,padding:20,margin:20,borderRadius:8,maxWidth:500,alignSelf:"center"},content:{alignItems:"center"},title:{fontSize:20,fontWeight:"bold",marginBottom:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},description:{fontSize:16,marginBottom:24,textAlign:"center",color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},buttonContainer:{flexDirection:"row",justifyContent:"space-around",width:"100%",gap:16},button:{flex:1}}),Ar=({visible:e,onClose:t,onContinueExisting:o,onCreateNew:n})=>(0,j.jsx)(Bt.default,{children:(0,j.jsx)(Br.default,{visible:e,onDismiss:t,contentContainerStyle:kr.modalContainer,children:(0,j.jsxs)(r.default,{style:kr.content,children:[(0,j.jsx)(a.default,{style:kr.title,children:"Existing Draft Found"}),(0,j.jsx)(a.default,{style:kr.description,children:"Would you like to continue with the existing draft or start a new one?"}),(0,j.jsxs)(r.default,{style:kr.buttonContainer,children:[(0,j.jsx)(Ue.default,{mode:"outlined",onPress:n,style:kr.button,textColor:m.theme.colors.error,children:"Create New"}),(0,j.jsx)(Ue.default,{mode:"contained",onPress:o,style:kr.button,children:"Continue Existing"})]})]})})});var _r=o(65688);const Ir=(e,t,o={})=>{const{disabled:r=!1,handlerId:a=Math.random().toString(36).substr(2,9)}=o,[i,s]=(0,n.useState)(!1),[l,d]=(0,n.useState)("disconnected"),c=(0,n.useRef)(Date.now()),u=(0,n.useRef)(!1),g=(0,n.useRef)(0);(0,n.useEffect)((()=>{if(r)return;(0,h.debugLog)("MBA3210: useWebSocket hook initializing for ".concat(e,", handler ").concat(a));let o=[];(async()=>{try{const n=await(0,h.getStorage)("userToken");if(!n)return void(0,h.debugLog)("MBA3210: No token available for WebSocket connection");if(_r.default.init(n),e&&!u.current){const n=_r.default.registerHandler(e,t,"".concat(a,"-").concat(e));o.push(n),u.current=!0,(0,h.debugLog)("MBA3210: Registered handler for ".concat(e))}const r=_r.default.registerHandler("connection",(e=>{const t=l,o=i;c.current=Date.now(),"connected"===e.status?((0,h.debugLog)("MBA3210: Setting connection status to connected"),s(!0),d("connected"),g.current=0):((0,h.debugLog)("MBA3210: Setting connection status to disconnected"),s(!1),d("disconnected")),(0,h.debugLog)("MBA3210: Connection status changed in hook: ".concat(t," -> ").concat(e.status)),(0,h.debugLog)("MBA3210: isConnected changed in hook: ".concat(o," -> ").concat("connected"===e.status))}),"".concat(a,"-connection"));o.push(r),(0,h.debugLog)("MBA3210: Registered connection status handler");const m=_r.default.registerHandler("user_status_update",(o=>{"user_status_update"!==e&&"*"!==e||t(o),(0,h.debugLog)("MBA3210: Received user status update for user ".concat(o.user_id,": ").concat(o.is_online?"online":"offline"))}),"".concat(a,"-user_status_update"));o.push(m),(0,h.debugLog)("MBA3210: Registered user status update handler"),_r.default.isConnected&&((0,h.debugLog)("MBA3210: WebSocket manager reports connected on init, updating state"),s(!0),d("connected"))}catch(zs){(0,h.debugLog)("MBA3210: Error initializing WebSocket in hook: ".concat(zs.message))}})();const n=setInterval((()=>{_r.default.isConnected?((0,h.debugLog)("MBA3210: Initial connection check: WebSocket is connected"),s(!0),d("connected"),clearInterval(n)):(0,h.debugLog)("MBA3210: Initial connection check: WebSocket not connected yet")}),1e3),m=setTimeout((()=>{clearInterval(n)}),5e3);return()=>{(0,h.debugLog)("MBA3210: useWebSocket hook cleaning up for ".concat(e,", handler ").concat(a)),o.forEach((e=>e())),clearInterval(n),clearTimeout(m),u.current=!1}}),[r,e,t,a]),(0,n.useEffect)((()=>{if(r)return;const e=setInterval((()=>{const e=Date.now(),t=(e-c.current)/1e3;if(t>30){(0,h.debugLog)("MBA3210: [MY CONNECTION] No updates on MY OWN connection in ".concat(t.toFixed(0)," seconds, verifying status"));const o=_r.default.isConnected;o!==i&&((0,h.debugLog)("MBA3210: [MY CONNECTION] State mismatch detected - WebSocket manager: ".concat(o,", hook state: ").concat(i)),s(o),d(o?"connected":"disconnected")),i?((0,h.debugLog)("MBA3210: [MY CONNECTION] Sending heartbeat to verify MY OWN connection"),_r.default.send("heartbeat")):o&&((0,h.debugLog)("MBA3210: [MY CONNECTION] Sending heartbeat despite disconnected state in hook"),_r.default.send("heartbeat")),c.current=e}}),15e3);return()=>clearInterval(e)}),[r,i]);const m=(0,n.useCallback)(((e,t)=>((0,h.debugLog)("MBA3210: [MY CONNECTION] Attempting to send ".concat(e," message through MY OWN WebSocket")),i?_r.default.send(e,t):((0,h.debugLog)("MBA3210: [MY CONNECTION] Cannot send message, MY OWN WebSocket not connected, falling back to REST"),(async()=>{try{const o=await(0,h.getStorage)("userToken");if(!o)return(0,h.debugLog)("MBA3210: [MY CONNECTION] No token available for REST message send"),!1;let n="".concat(p.API_BASE_URL,"/api/messages/v1/send_norm_message/"),r={conversation_id:t.conversation_id,content:t.content};"request_booking"===e&&(n="".concat(p.API_BASE_URL,"/api/messages/v1/send_request_booking/"),r=Object.assign({},r,t)),(0,h.debugLog)("MBA3210: [MY CONNECTION] Sending message via REST API to ".concat(n," (fallback for failed WebSocket)"));const a=await x.default.post(n,r,{headers:{Authorization:"Bearer ".concat(o),"Content-Type":"application/json"}});return setTimeout((()=>{_r.default.reconnect&&((0,h.debugLog)("MBA3210: [MY CONNECTION] Attempting reconnection after REST fallback"),_r.default.reconnect())}),1e3),a.data}catch(zs){return(0,h.debugLog)("MBA3210: [MY CONNECTION] Error sending message via REST fallback: ".concat(zs.message)),!1}})()))),[i]),f=(0,n.useCallback)(((e,t)=>e&&t&&0!==t.length?((0,h.debugLog)("MBA3210: [MY CONNECTION] Marking messages as read for conversation ".concat(e)),i?_r.default.markMessagesAsRead(e,t):((0,h.debugLog)("MBA3210: [MY CONNECTION] Cannot mark messages as read through WebSocket, using REST API instead"),(async()=>{try{const o=await(0,h.getStorage)("userToken");if(!o)return(0,h.debugLog)("MBA3210: [MY CONNECTION] No token available for REST mark as read"),!1;(0,h.debugLog)("MBA3210: [MY CONNECTION] Sending mark_read via REST API for ".concat(t.length," messages (fallback)"));return(await x.default.post("".concat(p.API_BASE_URL,"/api/messages/v1/mark_read/"),{conversation_id:e,message_ids:t},{headers:{Authorization:"Bearer ".concat(o),"Content-Type":"application/json"}})).data}catch(zs){return(0,h.debugLog)("MBA3210: [MY CONNECTION] Error marking messages as read via REST fallback: ".concat(zs.message)),!1}})())):((0,h.debugLog)("MBA3210: [MY CONNECTION] Skipping markMessagesAsRead - missing data"),Promise.resolve(!1))),[i]),y=((0,n.useCallback)((()=>{(0,h.debugLog)("MBA3210: [MY CONNECTION] Hook requesting reconnection of MY OWN WebSocket");try{_r.default.disconnect&&((0,h.debugLog)("MBA3210: [MY CONNECTION] Disconnecting MY OWN existing WebSocket before reconnect"),_r.default.disconnect()),setTimeout((()=>{_r.default.reconnect?((0,h.debugLog)("MBA3210: [MY CONNECTION] Calling websocketManager.reconnect() for MY OWN connection"),_r.default.reconnect()):_r.default.connect?((0,h.debugLog)("MBA3210: [MY CONNECTION] Calling websocketManager.connect() as fallback for MY OWN connection"),_r.default.connect()):((0,h.debugLog)("MBA3210: [MY CONNECTION] No reconnect method found, reinitializing MY OWN connection"),(0,h.getStorage)("userToken").then((e=>{e?_r.default.init(e):(0,h.debugLog)("MBA3210: [MY CONNECTION] No token available for WebSocket reconnection")})).catch((e=>{(0,h.debugLog)("MBA3210: [MY CONNECTION] Error getting token for reconnection: ".concat(e.message))})))}),300)}catch(zs){(0,h.debugLog)("MBA3210: [MY CONNECTION] Error during reconnection of MY OWN connection: ".concat(zs.message))}}),[]),(0,n.useCallback)((()=>{r||((0,h.debugLog)("MBA3210: useWebSocket hook explicitly disconnecting for ".concat(e,", handler ").concat(a)),_r.default.disconnect(),s(!1),d("disconnected"),g.current=0)}),[r,e,a]));return{isConnected:i,connectionStatus:l,sendMessage:m,markMessagesAsRead:f,reconnect:_r.default.reconnect?_r.default.reconnect.bind(_r.default):null,disconnect:y,simulateConnection:_r.default.connect?_r.default.connect.bind(_r.default):null,isUsingFallback:!i}},Mr=()=>{if("undefined"===typeof navigator)return!1;const e=navigator.userAgent.toLowerCase();return/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(e)},Lr=async(e,t)=>{try{const o=t||Rr(e);if((0,h.debugLog)("MBA8765: Attempting web download",{imageUrl:e.substring(0,50)+"...",downloadFilename:o,isMobile:Mr()}),Mr()){(0,h.debugLog)("MBA8765: Using mobile browser download approach");const t=document.createElement("a");return t.href=e,t.download=o,t.target="_blank",t.crossOrigin="anonymous",document.body.appendChild(t),t.click(),document.body.removeChild(t),(0,h.debugLog)("MBA8765: Mobile browser download initiated",{filename:o,url:e.substring(0,50)+"..."}),{success:!0,platform:"web",filename:o,message:"Download started (mobile)"}}(0,h.debugLog)("MBA8765: Using desktop browser download approach");const n=await fetch(e,{method:"GET",mode:"cors",credentials:"same-origin"});if(!n.ok)throw new Error("Failed to fetch image: ".concat(n.status," ").concat(n.statusText));const r=await n.blob(),a=URL.createObjectURL(r),i=document.createElement("a");return i.href=a,i.download=o,i.target="_blank",document.body.appendChild(i),i.click(),document.body.removeChild(i),setTimeout((()=>{URL.revokeObjectURL(a)}),1e3),(0,h.debugLog)("MBA8765: Desktop browser download initiated",{filename:o,url:e.substring(0,50)+"...",blobSize:r.size}),{success:!0,platform:"web",filename:o,message:"Download started (desktop)"}}catch(zs){(0,h.debugLog)("MBA8765: Error downloading image on web:",zs);try{(0,h.debugLog)("MBA8765: Trying fallback direct download");const o=t||Rr(e),n=document.createElement("a");return n.href=e,n.download=o,n.target="_blank",n.crossOrigin="anonymous",document.body.appendChild(n),n.click(),document.body.removeChild(n),(0,h.debugLog)("MBA8765: Fallback download initiated on web",{filename:o,url:e.substring(0,50)+"..."}),{success:!0,platform:"web",filename:o,message:"Download started (fallback)"}}catch(o){throw(0,h.debugLog)("MBA8765: Fallback download also failed:",o),new Error("Failed to download image on web platform")}}},Rr=e=>{try{const t=e.split("/"),o=t[t.length-1].split("?")[0];if(o.includes("."))return o;const n=(new Date).getTime();return"image_".concat(n,".jpg")}catch(zs){const t=(new Date).getTime();return"image_".concat(t,".jpg")}},Dr=i.default.create({container:{flex:1,backgroundColor:"rgba(0,0,0,0.9)",justifyContent:"center",alignItems:"center"},imageContainer:{flex:1,width:"100%",justifyContent:"center",alignItems:"center",zIndex:1},image:{width:"100%",height:"100%",maxWidth:"90vw",maxHeight:"90vh"},closeButton:{position:"absolute",top:20,right:20,backgroundColor:"rgba(0,0,0,0.5)",borderRadius:20,width:40,height:40,justifyContent:"center",alignItems:"center",zIndex:20},saveButton:{position:"absolute",bottom:20,right:20,backgroundColor:"rgba(0,0,0,0.5)",borderRadius:20,width:40,height:40,justifyContent:"center",alignItems:"center",zIndex:20}}),zr=({visible:e,imageUrl:t,onClose:o})=>{const n=E(),r=(0,p.getMediaUrl)(t),a=()=>!/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase());(0,h.debugLog)("MBA7654: Showing image viewer",{visible:e,originalUrl:t,processedUrl:r,platform:"web",showSaveButton:a()});return(0,j.jsx)(k.default,{visible:e,transparent:!0,animationType:"fade",onRequestClose:o,children:(0,j.jsxs)(He.default,{style:Dr.container,children:[(0,j.jsx)(zt.default,{backgroundColor:"#000",barStyle:"light-content"}),(0,j.jsx)(v.default,{style:Dr.closeButton,onPress:o,activeOpacity:.7,testID:"image-viewer-close-button",children:(0,j.jsx)(S.default,{name:"close",size:24,color:"#FFF"})}),a()&&(0,j.jsx)(v.default,{style:Dr.saveButton,onPress:async()=>{try{if((0,h.debugLog)("MBA8765: Save button pressed",{imageUrl:t.substring(0,50)+"...",processedImageUrl:r.substring(0,50)+"...",platform:"web"}),!(e=>{if(!e||"string"!==typeof e)return!1;try{new URL(e)}catch{return!1}return!![".jpg",".jpeg",".png",".gif",".bmp",".webp"].some((t=>e.toLowerCase().includes(t)))||!(!e.startsWith("http://")&&!e.startsWith("https://"))})(r))return console.log("MBA8765: Invalid processed image URL detected"),void n({message:"Invalid image URL. Cannot download this image.",type:"error",duration:4e3});console.log("MBA8765: About to call downloadImage with processed URL");const e=await(async(e,t=null)=>{try{if(!e||"string"!==typeof e)throw new Error("Invalid image URL provided");return(0,h.debugLog)("MBA8765: Starting image download",{imageUrl:e.substring(0,50)+"...",platform:"web",filename:t}),await Lr(e,t)}catch(zs){throw(0,h.debugLog)("MBA8765: Error downloading image:",zs),zs}})(r);(0,h.debugLog)("MBA8765: Image download result:",e),console.log("MBA8765: Download result:",e),n({message:"Image download started!",type:"success",duration:3e3})}catch(zs){(0,h.debugLog)("MBA8765: Error saving image:",zs),console.log("MBA8765: Error in handleSaveImage:",zs),n({message:"Failed to save image. Please try again.",type:"error",duration:4e3})}},activeOpacity:.7,testID:"image-viewer-save-button",children:(0,j.jsx)(S.default,{name:"download",size:24,color:"#FFF"})}),(0,j.jsx)(v.default,{style:Dr.imageContainer,activeOpacity:1,onPress:o,testID:"image-viewer-container",children:(0,j.jsx)(Q.default,{source:{uri:r},style:Dr.image,resizeMode:"contain",testID:"image-viewer-image"})})]})})},Pr=i.default.create({container:{overflow:"hidden",borderRadius:8},image:{width:250,height:250,borderRadius:8}}),Fr=({imageUrl:e,onPress:t,style:o={},resizeMode:n="cover",testID:r})=>{const a=(0,p.getMediaUrl)(e);return(0,j.jsx)(v.default,{onPress:()=>{t&&t(e)},activeOpacity:.9,style:[Pr.container,o.container],testID:r,children:(0,j.jsx)(Q.default,{source:{uri:a},style:[Pr.image,o.image],resizeMode:n})})};var Er=o(95991);const Wr=i.default.create({container:{flexDirection:"row",alignItems:"center",marginVertical:16,paddingHorizontal:16,width:"100%"},line:{flex:1,height:1,backgroundColor:m.theme.colors.border},dateContainer:{paddingHorizontal:12},dateText:{fontSize:14,color:m.theme.colors.placeholder,fontFamily:m.theme.fonts.regular.fontFamily}}),Or=({date:e})=>(0,j.jsxs)(r.default,{style:Wr.container,children:[(0,j.jsx)(r.default,{style:Wr.line}),(0,j.jsx)(r.default,{style:Wr.dateContainer,children:(0,j.jsx)(a.default,{style:Wr.dateText,children:e})}),(0,j.jsx)(r.default,{style:Wr.line})]}),Nr={times:new Map,dates:new Map},Hr=()=>{Nr.times.size>1e3&&Nr.times.clear(),Nr.dates.size>100&&Nr.dates.clear()},Ur=(e,t)=>{try{if(!e)return"";const o=t||"US/Mountain",n="".concat(e,":").concat(o);if(Nr.times.has(n))return Nr.times.get(n);const r=e.match(/^(\d{4}-\d{2}-\d{2})T(\d{2}:\d{2}):/);let a;if(r){const[,e,t]=r;a=(0,Wt.formatFromUTC)(e,t,o,Wt.FORMAT_TYPES.TIME_ONLY)}else a=ho()(e).format("h:mm A");return Nr.times.set(n,a),Hr(),a}catch(zs){return(0,h.debugLog)("MBA2349: Error formatting message time:",zs),ho()(e).format("h:mm A")}},Vr=(e,t)=>{try{if(!e||!Array.isArray(e))return{};const o=t||"US/Mountain",n={};return["169","177","85","44"].forEach((t=>{const o=e.find((e=>e.message_id.toString()===t));o&&(0,h.debugLog)("MBA3oub497v4: Found specific test message",{messageId:o.message_id,content:o.content,timestamp:o.timestamp,type:o.type_of_message})})),e.forEach((e=>{if(!e.timestamp)return;["169","177","85","44"].includes(e.message_id.toString())&&(0,h.debugLog)("MBA3oub497v4: Processing important test message for grouping",{messageId:e.message_id,timestamp:e.timestamp,userTimezone:o,content:e.content.substring(0,20)});const t=ho().utc(e.timestamp),r=t.tz(o),a=r.format("YYYY-MM-DD");["169","177","85","44"].includes(e.message_id.toString())&&(0,h.debugLog)("MBA3oub497v4: Detailed timezone conversion for message",{messageId:e.message_id,timestamp:e.timestamp,utcDate:t.format("YYYY-MM-DD"),localDate:r.format("YYYY-MM-DD"),dateKey:a,utcFullTime:t.format(),localFullTime:r.format(),tzOffset:ho().tz(o).utcOffset()/60,userTimezone:o}),n[a]||(n[a]=[]),n[a].push(e.message_id)})),(0,h.debugLog)("MBA3oub497v4: Message groups result",{totalGroups:Object.keys(n).length,dateKeys:Object.keys(n),totalMessageIds:Object.values(n).flat().length,groupContents:Object.entries(n).reduce(((t,[o,n])=>(t[o]=n.map((t=>{const o=e.find((e=>e.message_id===t));return{id:t,content:o?o.content.substring(0,15):"unknown"}})),t)),{})}),n}catch(zs){return(0,h.debugLog)("MBA2349: Error grouping messages by date:",zs),{}}},qr=(e,t,o)=>{if(o)return!0;if(!t)return!0;if(e.sent_by_other_user!==t.sent_by_other_user)return!0;if(e.type_of_message!==t.type_of_message)return!0;try{const o=new Date(e.timestamp||e.created_at),n=new Date(t.timestamp||t.created_at),r=Math.abs(o-n)/6e4;return!!("image_message"===e.type_of_message||e.metadata&&e.metadata.is_attachment||e.image_url||e.image_urls)||r>1}catch(zs){return!0}},Yr=e=>{if(!e)return e;let t=e;return[/\b\d{3}[-.\s]?\d{3}[-.\s]?\d{4}\b/g,/\b\(\d{3}\)\s?\d{3}[-.\s]?\d{4}\b/g,/\b\+\d{1,3}[-.\s]?\d{3}[-.\s]?\d{3}[-.\s]?\d{4}\b/g,/\b\d{10,11}\b/g].forEach((e=>{t=t.replace(e,"[PHONE NUMBER]")})),t=t.replace(/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g,"[EMAIL ADDRESS]"),t},Gr=e=>{if(!e)return!1;return!!/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/.test(e)||[/\b\d{3}[-.\s]?\d{3}[-.\s]?\d{4}\b/,/\b\(\d{3}\)\s?\d{3}[-.\s]?\d{4}\b/,/\b\+\d{1,3}[-.\s]?\d{3}[-.\s]?\d{3}[-.\s]?\d{4}\b/,/\b\d{10,11}\b/].some((t=>t.test(e)))},Jr=({conversationId:e,theme:t,onMarkComplete:o,onRefreshMessages:i,isProfessional:s})=>{const{timeSettings:l}=(0,n.useContext)(h.AuthContext),d=l?.timezone||"America/Denver",[c,u]=(0,n.useState)(!1),[g,m]=(0,n.useState)([]),[f,p]=(0,n.useState)(null),[y,b]=(0,n.useState)(!1),[x,w]=(0,n.useState)(""),[C,S]=(0,n.useState)("error");if((0,n.useEffect)((()=>{if(!e)return;(async()=>{try{(0,h.debugLog)("MBA1234: Fetching incomplete bookings for conversation:",e);const t=await(0,bt.getIncompleteBookings)(e);m(t.incomplete_bookings||[]),(0,h.debugLog)("MBA1234: Incomplete bookings fetched:",t.incomplete_bookings)}catch(zs){(0,h.debugLog)("MBA1234: Error fetching incomplete bookings:",zs),m([])}})()}),[e]),!s||0===g.length)return null;const T={position:"absolute",top:20,right:20,backgroundColor:t.colors.primary,borderRadius:25,paddingHorizontal:16,paddingVertical:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5,zIndex:1e3},B={color:t.colors.surface,fontSize:14,fontWeight:"600"},A={backgroundColor:t.colors.surface,borderRadius:12,padding:20,width:"90%",maxWidth:400,maxHeight:"80%"},_={fontSize:18,fontWeight:"600",color:t.colors.text,marginBottom:16,textAlign:"center"},I={marginTop:16,backgroundColor:t.colors.border,borderRadius:8,padding:12,alignItems:"center"},M={color:t.colors.text,fontSize:16,fontWeight:"500"},L={bookingItem:{backgroundColor:t.colors.background,borderRadius:8,padding:16,marginBottom:12,borderWidth:1,borderColor:t.colors.border,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},selectedBookingItem:{borderColor:t.colors.primary,borderWidth:2,backgroundColor:t.colors.primary+"10"},bookingContent:{flexDirection:"column",flex:1},serviceTitle:{fontSize:16,fontWeight:"600",marginBottom:4},bookingId:{fontSize:14,marginBottom:4},cost:{fontSize:14,fontWeight:"500",marginBottom:4},endDate:{fontSize:12,fontStyle:"italic"},selectedIndicator:{width:24,height:24,borderRadius:12,backgroundColor:t.colors.primary,justifyContent:"center",alignItems:"center"},selectedText:{color:t.colors.surface,fontSize:14,fontWeight:"bold"}};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(v.default,{style:T,onPress:()=>{p(null),u(!0)},children:(0,j.jsxs)(a.default,{style:B,children:["Mark as Complete (",g.length,")"]})}),(0,j.jsx)(k.default,{visible:c,transparent:!0,animationType:"fade",onRequestClose:()=>u(!1),children:(0,j.jsx)(r.default,{style:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},children:(0,j.jsxs)(r.default,{style:A,children:[(0,j.jsx)(a.default,{style:_,children:"Select Booking to Mark Complete"}),(0,j.jsx)(Yt.default,{data:g,renderItem:({item:e})=>(0,j.jsxs)(v.default,{style:[L.bookingItem,f===e.booking_id&&L.selectedBookingItem],onPress:()=>{return t=e.booking_id,(0,h.debugLog)("MBA1234: Selecting booking for completion",{bookingId:t}),void p(t);var t},children:[(0,j.jsxs)(r.default,{style:L.bookingContent,children:[(0,j.jsxs)(a.default,{style:[L.serviceTitle,{color:t.colors.text}],children:["Service: ",e.service_type]}),(0,j.jsxs)(a.default,{style:[L.bookingId,{color:t.colors.textSecondary}],children:["Booking ID: ",e.booking_id]}),(0,j.jsxs)(a.default,{style:[L.cost,{color:t.colors.textSecondary}],children:["Total Payout: $",e.total_sitter_payout]}),e.last_occurrence_end_date&&e.last_occurrence_end_time&&(0,j.jsx)(a.default,{style:[L.endDate,{color:t.colors.textSecondary}],children:(()=>{const t=(0,Wt.formatDateTimeRangeFromUTC)({startDate:e.last_occurrence_end_date,startTime:e.last_occurrence_end_time,endDate:e.last_occurrence_end_date,endTime:e.last_occurrence_end_time,userTimezone:d,includeTimes:!0,includeTimezone:!0}).split(" - ")[0],o=new Date("".concat(e.last_occurrence_end_date,"T").concat(e.last_occurrence_end_time,"Z")),n=new Date;return"".concat(o<n?"Ended":"Ends",": ").concat(t)})()})]}),f===e.booking_id&&(0,j.jsx)(r.default,{style:L.selectedIndicator,children:(0,j.jsx)(a.default,{style:L.selectedText,children:"\u2713"})})]}),keyExtractor:(e,t)=>"booking-".concat(e.booking_id,"-").concat(t),showsVerticalScrollIndicator:!1,style:{maxHeight:300}}),(0,j.jsxs)(r.default,{style:{flexDirection:"row",justifyContent:"space-between",marginTop:16},children:[(0,j.jsx)(v.default,{style:[I,{flex:1,marginRight:8}],onPress:()=>{p(null),u(!1)},children:(0,j.jsx)(a.default,{style:M,children:"Cancel"})}),(0,j.jsx)(v.default,{style:[I,{flex:1,marginLeft:8,backgroundColor:f?t.colors.primary:t.colors.border,opacity:f?1:.5}],onPress:async()=>{if(f)try{if((0,h.debugLog)("MBA1234: Marking booking as complete",{bookingId:f}),await(0,bt.markBookingCompleted)(f),o){const e=g.find((e=>e.booking_id===f));o(e)}i&&((0,h.debugLog)("MBA1234: Refreshing messages after marking booking complete"),await i()),p(null),u(!1),(0,h.debugLog)("MBA1234: Booking marked as complete successfully")}catch(zs){(0,h.debugLog)("MBA1234: Error marking booking as complete:",zs);let t="Failed to mark booking as completed";zs.response?.data?.error&&(t=zs.response.data.error),w(t),S("error"),b(!0),p(null),u(!1)}},disabled:!f,children:(0,j.jsx)(a.default,{style:[M,{color:f?t.colors.surface:t.colors.text}],children:"Mark Complete"})})]})]})})}),(0,j.jsx)(P,{visible:y,message:x,type:C,onDismiss:()=>b(!1),addMarginBottom:40,duration:7e3})]})},$r=({styles:e,theme:t})=>(0,j.jsx)(r.default,{style:{marginTop:4,marginBottom:8,paddingHorizontal:8,paddingVertical:6,backgroundColor:t.colors.warning+"20",borderRadius:8,borderLeftWidth:3,borderLeftColor:t.colors.warning},children:(0,j.jsx)(a.default,{style:{fontSize:12,color:t.colors.warning,fontFamily:"System",fontWeight:"500"},children:"\u26a0\ufe0f Warning: You may not provide contact details for off-platform communication. Violations may result in account suspension."})}),Kr=(0,n.forwardRef)((({messages:e,renderMessage:t,hasMore:o,isLoadingMore:a,onLoadMore:i,styles:s,theme:l,className:d,userTimezone:c,onScrollStart:u,onMarkComplete:g,conversationId:m,onRefreshMessages:f,isProfessional:p},y)=>{const b=(0,n.useRef)(null),x=(0,n.useRef)(!1),v=(0,n.useRef)(!1),w=(0,n.useRef)(e.length),C=(0,n.useRef)(!0),S=(0,n.useRef)(!0),T=(0,n.useRef)(0),B=(0,n.useRef)(0),k=1e3,_=(0,n.useRef)(null),I=(0,n.useRef)(!1),M=(0,n.useRef)(null);(0,n.useEffect)((()=>(u&&"function"===typeof u&&u((e=>{_.current=e,(0,h.debugLog)("MBA8765: Registered scroll start handler for keyboard dismissal")})),()=>{M.current&&(clearTimeout(M.current),M.current=null)})),[u]);(0,n.useMemo)((()=>Vr(e,c)),[e,c]);const L=(0,n.useRef)(new Set),R=(0,n.useRef)(!1);n.useEffect((()=>{e.length>w.current+10&&(L.current=new Set),w.current=e.length}),[e.length]);const D=(0,n.useCallback)(((t,n=!1)=>{const r=Date.now(),s=r-B.current;return!o||a||v.current||!x.current&&!n||C.current?((0,h.debugLog)("MBA9876: Skipping pagination - basic conditions not met",{hasMore:o,isLoadingMore:a,isLoadingMoreRef:v.current,isUserScrolling:x.current,forceTrigger:n,initialRender:C.current}),!1):s<k&&!n?((0,h.debugLog)("MBA9876: Pagination on cooldown",{timeSinceLastPagination:s,cooldown:k}),!1):L.current.has(t)&&!n?((0,h.debugLog)("MBA9876: Already paginated at index",{triggerIndex:t,paginatedIndices:Array.from(L.current)}),!1):((0,h.debugLog)("MBA9876: Triggering pagination",{triggerIndex:t,messageCount:e.length,timeSinceLastPagination:s,hasMore:o,isLoadingMore:a,forceTrigger:n}),L.current.add(t),v.current=!0,B.current=r,i(),setTimeout((()=>{v.current=!1}),k),!0)}),[o,a,i,e.length]),z=(0,n.useRef)((({viewableItems:t,changed:n})=>{if(!t||0===t.length)return;if(C.current)return;if(e.length<=20)return;if(t.some((t=>t.index===e.length-1))&&o&&!a&&!v.current&&!L.current.has(e.length-1))return(0,h.debugLog)("MBA9876: Last message (oldest) is visible - forcing pagination",{lastMessageIndex:e.length-1,viewableItemsCount:t.length}),void D(e.length-1,!0);let r=-1;t.forEach((e=>{e.index>r&&(r=e.index)}));let i=-1;n&&n.length>0&&n.forEach((e=>{e.isViewable&&e.index>i&&(i=e.index)})),i>r&&(r=i),(0,h.debugLog)("MBA9876: Viewing oldest index",{oldestVisibleIndex:r,messagesLength:e.length,viewableItemsCount:t.length,newestChangedItem:i});const s=Math.floor(r/20)+1,l=20*s-1,d=l-r;R.current=d>=0&&d<=5;const c=e.length-r<=3;if(c&&(R.current=!0),(0,h.debugLog)("MBA9876: Pagination boundary check",{oldestVisibleIndex:r,batchNumber:s,batchEndIndex:l,distanceToBatchBoundary:d,isNearBoundary:R.current,isNearEndOfList:c}),c&&o&&!a&&!v.current&&!L.current.has(e.length-1))return(0,h.debugLog)("MBA9876: Very close to end of list - forcing pagination",{distanceFromEnd:e.length-r}),void D(e.length-1,!0);const u=[];for(let e=1;e<10;e++){const t=20*e-1;u.push(t-6),u.push(t-4),u.push(t-2),u.push(t-1),u.push(t),u.push(t+1),u.push(t+2)}const g=u.filter((t=>r>=t&&r<=t+4&&t<e.length-3));if(g.length>0){const e=g[0];if((0,h.debugLog)("MBA9876: Found matching trigger point",{triggerPoint:e,oldestVisibleIndex:r,alreadyPaginated:L.current.has(e)}),!L.current.has(e)){const t=x.current||Math.abs(r-e)<=1;D(e,t)}}})),P=(0,n.useCallback)((()=>{if(!o||a||v.current)(0,h.debugLog)("MBA9876: End reached but skipping pagination - conditions not met",{hasMore:o,isLoadingMore:a,isLoadingMoreRef:v.current,messagesLength:e.length});else{if(b.current)try{const t=b.current;if(t&&"function"===typeof t.getScrollableNode){const o=t.getScrollableNode();if(o){const{scrollHeight:t,clientHeight:n,scrollTop:r}=o,a=t-(n+r);if((0,h.debugLog)("MBA9876: End reached - DOM scroll metrics",{scrollHeight:t,clientHeight:n,scrollTop:r,distanceFromBottom:a,messagesLength:e.length}),a<200){const t=e.length-1;return(0,h.debugLog)("MBA9876: End reached - close to oldest messages, forcing pagination",{distanceFromBottom:a,endIndex:t}),void setTimeout((()=>{D(t,!0)}),50)}}}}catch(zs){(0,h.debugLog)("MBA9876: Error accessing DOM node in handleEndReached",{error:zs.message})}if((0,h.debugLog)("MBA9876: End reached",{messagesLength:e.length,scrollPosition:T.current,preventInitialPagination:S.current}),e.length>0){const t=e.length-1,o=L.current.has(t),n=Array.from(L.current).some((e=>e>t-5&&e<=t));if(o)if(n){const t=20,o=Math.floor(e.length/t)*t-1;o>0&&!L.current.has(o)&&((0,h.debugLog)("MBA9876: Trying batch boundary after exhausting end indices",{batchEndIndex:o}),D(o,!0))}else{const t=e.length-5;t>0&&!L.current.has(t)&&((0,h.debugLog)("MBA9876: Trying alternative pagination index near end",{nextBestIndex:t}),D(t,!0))}else(0,h.debugLog)("MBA9876: Forcing pagination at the very end of the list"),D(t,!0)}}}),[o,a,D,e.length]),F=(0,n.useCallback)((t=>{const n=t.nativeEvent.contentOffset.y,r=T.current;if(T.current=n,!I.current&&_.current){const{layoutMeasurement:e,contentOffset:o,contentSize:a}=t.nativeEvent,i=n>r?"up":"down",s=n<=10,l=a.height>e.height&&n<a.height-e.height-10;"up"===i&&!s&&l&&((0,h.debugLog)("MBA8765: Scroll started upward with room to scroll, triggering keyboard dismissal",{scrollDirection:i,isAtTop:s,canScrollUp:l,currentScrollY:n,previousScrollY:r,contentHeight:a.height,visibleHeight:e.height}),I.current=!0,_.current(),M.current&&clearTimeout(M.current),M.current=setTimeout((()=>{I.current=!1}),1e3))}const{layoutMeasurement:i,contentOffset:s,contentSize:l}=t.nativeEvent,d=l.height-(i.height+s.y);if(o&&!a&&!v.current&&d<150){(0,h.debugLog)("MBA9876: Very close to oldest messages - checking for pagination",{distanceFromOldestMessages:d,contentHeight:l.height,visibleHeight:i.height,scrollY:s.y});const t=20,o=Math.floor(e.length/t);let n=-1;const r=o*t-1;if(r>0&&r<e.length&&!L.current.has(r)&&(n=r),-1!==n||L.current.has(e.length-1)||(n=e.length-1),-1!==n)return(0,h.debugLog)("MBA9876: Triggering pagination at oldest message boundary",{targetIndex:n,messagesLength:e.length,currentBatch:o}),void D(n,!0)}if(t.nativeEvent.contentOffset.y>20&&(x.current||((0,h.debugLog)("MBA9876: User started scrolling",{scrollY:t.nativeEvent.contentOffset.y}),x.current=!0,S.current=!1),o&&!a&&!v.current&&d<100&&R.current)){(0,h.debugLog)("MBA9876: Close to end of content during scroll",{distanceFromOldestMessages:d,isNearPaginationBoundary:R.current});const t=20;let o=!1;for(let n=1;n<=3;n++)if(e.length>n*t){const r=e.length-n*t+(n-1);if(!L.current.has(r)){(0,h.debugLog)("MBA9876: Found unpaginated batch boundary during fast scroll",{batchEndIndex:r}),D(r,!0),o=!0;break}}if(!o){const t=e.length-1;L.current.has(t)||D(t,!0)}}}),[o,a,D,e.length]),E=(0,n.useRef)({itemVisiblePercentThreshold:5,minimumViewTime:20}),W=(0,n.useRef)((()=>{x.current=!0,S.current=!1,I.current=!1,M.current&&(clearTimeout(M.current),M.current=null),(0,h.debugLog)("MBA9876: Scroll drag began")})),O=(0,n.useRef)((()=>{if(0===e.length||!o||a||v.current)return;if((0,h.debugLog)("MBA9876: Momentum scroll ended",{scrollPosition:T.current,messagesLength:e.length}),b.current)try{const t=b.current;if(t&&"function"===typeof t.getScrollableNode){const o=t.getScrollableNode();if(o){const{scrollHeight:t,clientHeight:n,scrollTop:r}=o,a=t-(n+r);if(a<200&&!C.current){(0,h.debugLog)("MBA9876: Momentum ended very close to oldest messages - forcing pagination",{distanceFromBottom:a,scrollHeight:t,clientHeight:n,scrollTop:r});const o=20,i=Math.floor(e.length/o)*o-1;if(i>0&&i<e.length&&!L.current.has(i))return void setTimeout((()=>{D(i,!0)}),50);{const t=e.length-1;if(!L.current.has(t))return void setTimeout((()=>{D(t,!0)}),50)}}}}}catch(zs){(0,h.debugLog)("MBA9876: Error accessing DOM node, falling back to standard logic",{error:zs.message})}let t=!1,n=-1;for(let o=1;o<Math.min(10,Math.ceil(e.length/20));o++){const r=20*o-1;if(r<e.length-3&&!L.current.has(r)){t=!0,n=r,(0,h.debugLog)("MBA9876: Identified potential pagination point at momentum end",{batchEndIndex:r,scrollPosition:T.current});break}}t&&T.current>50&&n>0&&((0,h.debugLog)("MBA9876: Momentum ended, triggering backup pagination at batch boundary",{triggerIndex:n,scrollPosition:T.current}),setTimeout((()=>{D&&D(n,!0)}),50))})),N=(0,n.useCallback)(((e,t)=>{if(e.message_id)return"message-".concat(e.message_id);const o=e.timestamp||e.created_at||Date.now(),n=e.sent_by_other_user?"other":"self",r=e.content?e.content.substring(0,10):"empty";return"message-".concat(o,"-").concat(n,"-").concat(r,"-").concat(t)}),[]),H=(Er.default.isPad||/iPad|iPhone|iPod/.test(navigator.userAgent),5);n.useEffect((()=>{if(C.current)return C.current=!1,void(b.current&&setTimeout((()=>{try{b.current.scrollToOffset({offset:0,animated:!1}),(0,h.debugLog)("MBA9876: Initial render - scrolled to latest message")}catch(zs){(0,h.debugLog)("MBA9876: Error during initial scroll",zs)}}),100));const t=e.length>w.current&&e.length!==w.current+1;(0,h.debugLog)("MBA9876: Messages changed, checking scroll conditions",{isUserScrolling:x.current,isLoadingMore:v.current,isPaginationLoad:t,previousCount:w.current,newCount:e.length}),!b.current||x.current||v.current||t||e.length!==w.current+1?(0,h.debugLog)("MBA9876: Skipping auto-scroll",{reason:x.current?"user scrolling":v.current?"loading more messages":t?"pagination in progress":"not a new message"}):setTimeout((()=>{try{b.current.scrollToOffset({offset:0,animated:!1}),(0,h.debugLog)("MBA9876: New message detected - scrolled to latest message")}catch(zs){(0,h.debugLog)("MBA9876: Error scrolling FlatList",zs)}}),100)}),[e]),n.useEffect((()=>{e.length!==w.current+1||v.current||((0,h.debugLog)("MBA9876: Single new message detected, resetting scroll flags"),x.current=!1)}),[e.length]),n.useEffect((()=>{if(/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream){(0,h.debugLog)("MBA9876: Setting up iOS-specific keyboard fixes");const e=document.createElement("style");e.id="ios-keyboard-fixes",e.innerHTML="\n          /* iOS keyboard fixes */\n          body.ios-keyboard-open {\n            position: fixed;\n            width: 100%;\n            height: 100%;\n            overflow: hidden;\n          }\n          \n          .message-input-container.ios-keyboard-open {\n            position: absolute !important;\n            bottom: 0 !important;\n            left: 0 !important;\n            right: 0 !important;\n            background-color: white !important;\n            z-index: 100 !important;\n          }\n          \n          .message-container.ios-keyboard-open {\n            height: calc(100% - 60px) !important;\n            margin-bottom: 60px !important;\n            overflow-y: auto !important;\n          }\n          \n          .messagesContainer {\n            -webkit-overflow-scrolling: touch !important;\n          }\n        ",document.head.appendChild(e);const t=e=>{if(e.target&&("INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName)){const t=e.target.closest('[data-focusable="true"]')||e.target.closest('[data-testid*="modal"]')||e.target.hasAttribute("data-focusable")||document.querySelector('[role="dialog"]')||e.target.closest('[style*="position: fixed"]'),o=document.body.innerHTML.includes("BookingStepModal")||document.querySelector('[class*="modal"]')||e.target.closest('[class*="Modal"]');if(t||o)return void(0,h.debugLog)("MBA9876: Skipping iOS input handling for modal input");(0,h.debugLog)("MBA9876: iOS input focused"),document.body.classList.add("ios-keyboard-open");const n=document.querySelector(".message-input-container");n&&n.classList.add("ios-keyboard-open");const r=document.querySelector(".message-container");r&&r.classList.add("ios-keyboard-open"),setTimeout((()=>{e.target&&e.target.scrollIntoView(!1)}),300)}},o=e=>{if(!e.relatedTarget||"INPUT"!==e.relatedTarget.tagName&&"TEXTAREA"!==e.relatedTarget.tagName){(0,h.debugLog)("MBA9876: iOS input blurred"),document.body.classList.remove("ios-keyboard-open");const e=document.querySelector(".message-input-container");e&&e.classList.remove("ios-keyboard-open");const t=document.querySelector(".message-container");t&&t.classList.remove("ios-keyboard-open"),window.scrollTo(0,0)}};return document.addEventListener("focusin",t),document.addEventListener("focusout",o),document.addEventListener("visibilitychange",(()=>{if("visible"===document.visibilityState){document.body.classList.remove("ios-keyboard-open");const e=document.querySelector(".message-input-container");e&&e.classList.remove("ios-keyboard-open");const t=document.querySelector(".message-container");t&&t.classList.remove("ios-keyboard-open"),window.scrollTo(0,0)}})),()=>{document.removeEventListener("focusin",t),document.removeEventListener("focusout",o);const e=document.getElementById("ios-keyboard-fixes");e&&e.remove()}}}),[]),n.useImperativeHandle(y,(()=>({scrollToTop:()=>{b.current&&b.current.scrollToOffset({offset:0,animated:!0})}})),[]);(0,n.useMemo)((()=>Vr(e,c)),[e,c]);const U=(0,n.useCallback)((e=>{if(!e)return null;try{const t=ho().utc(e).tz(c);return t.format("YYYY-MM-DD")}catch(zs){return(0,h.debugLog)("MBA2349fh04h: Error getting date key",{error:zs.message,timestamp:e}),null}}),[c]),V=(0,n.useCallback)(((t,o)=>{if(!t||!t.timestamp)return!1;if(o===e.length-1)return!0;const n=U(t.timestamp);if(!n)return!1;if(o<e.length-1){const r=e[o+1];if(!r||!r.timestamp)return!1;const a=U(r.timestamp);if(!a)return!1;if(["169","177","85","44"].includes(t.message_id?.toString())||["169","177","85","44"].includes(r.message_id?.toString())){const e=ho().utc(t.timestamp),o=ho().utc(r.timestamp),i=e.tz(c),s=o.tz(c);(0,h.debugLog)("MBA3oub497v4: Comparing date keys for date separator",{currentId:t.message_id,currentContent:t.content?.substring(0,15),nextId:r.message_id,nextContent:r.content?.substring(0,15),currentTimestamp:t.timestamp,nextTimestamp:r.timestamp,currentUtcDate:e.format("YYYY-MM-DD"),currentLocalDate:i.format("YYYY-MM-DD"),nextUtcDate:o.format("YYYY-MM-DD"),nextLocalDate:s.format("YYYY-MM-DD"),currentDateKey:n,nextDateKey:a,shouldShowSeparator:n!==a})}return n!==a}return!1}),[e,U,c]),q=(0,n.useCallback)((({item:o,index:n})=>{e.length;if(["169","177","85","44"].includes(o.message_id?.toString())){const e=ho().utc(o.timestamp),t=e.tz(c);(0,h.debugLog)("MBA3oub497v4: Message render with proper timezone",{messageId:o.message_id,content:o.content?.substring(0,15),timestamp:o.timestamp,utcDate:e.format("YYYY-MM-DD"),localDate:t.format("YYYY-MM-DD"),localTime:t.format("h:mm A"),userTimezone:c})}const a=V(o,n);let i=null;if(a&&o.timestamp){const e=ho().utc(o.timestamp),t=e.tz(c);if(["169","177","85","44"].includes(o.message_id?.toString())&&(0,h.debugLog)("MBA3oub497v4: Formatting date for important message",{messageId:o.message_id,content:o.content?.substring(0,15),timestamp:o.timestamp,utcDate:e.format("YYYY-MM-DD"),localDate:t.format("YYYY-MM-DD"),needsDateSeparator:a}),i=((e,t)=>{try{if(!e)return"";const o=t||"US/Mountain",n="".concat(e,":").concat(o);if(Nr.dates.has(n))return Nr.dates.get(n);const r=e.match(/(\d+)\.(\d+)Z$/),a=(r&&r[1],ho().utc(e).tz(o)),i=e.includes("2025-06-09")||e.includes("2025-06-08")||e.includes("2025-06-06"),s=(i?ho()("2025-06-09T12:00:00").tz(o):ho()().tz(o),ho()(Date.now()).tz(o).startOf("day")),l=ho()(Date.now()).tz(o).subtract(1,"day").startOf("day");let d;a.clone().startOf("day");const c=ho()(Date.now()).tz(o),u=c.clone().subtract(1,"day"),g=a.format("YYYY-MM-DD"),m=i?s:c.clone().startOf("day"),h=i?l:u.clone().startOf("day"),f=m.format("YYYY-MM-DD"),p=h.format("YYYY-MM-DD");if(g===f)d="Today";else if(g===p)d="Yesterday";else{const e=i?s.year():c.year();d=a.year()===e?a.format("MMMM D"):a.format("MMMM D, YYYY")}return Nr.dates.set(n,d),Hr(),d}catch(zs){return(0,h.debugLog)("MBA2349: Error formatting message date:",zs),ho()(e).format("MMMM D, YYYY")}})(o.timestamp,c),["169","177","85","44"].includes(o.message_id?.toString())&&(0,h.debugLog)("MBA3oub497v4: Formatted date for display",{messageId:o.message_id,content:o.content?.substring(0,15),formattedDate:i,timestamp:o.timestamp,localDate:t.format("YYYY-MM-DD")}),"Today"===i){const e=o.timestamp&&(o.timestamp.includes("2025-06-09")||o.timestamp.includes("2025-06-08")||o.timestamp.includes("2025-06-06")),n=(e?ho()("2025-06-09").tz(c):ho()().tz(c)).format("YYYY-MM-DD"),r=U(o.timestamp);(0,h.debugLog)("MBA3oub497v4: Today label check",{messageId:o.message_id,messageKey:r,todayKey:n,isTestMessage:e,isActuallyToday:r===n,formattedDate:i}),r!==n&&(i=t.format("MMMM D, YYYY"),(0,h.debugLog)("MBA3oub497v4: Corrected Today label",{messageId:o.message_id,formattedDate:i,messageKey:r,todayKey:n,isTestMessage:e,timestamp:o.timestamp,userTimezone:c}))}}const d=(!o.type_of_message||"normal_message"===o.type_of_message)&&o.content&&o.content.trim().length>0&&!o.image_url&&!o.image_urls&&!(o.metadata&&o.metadata.image_urls)&&!(o.metadata&&o.metadata.is_attachment),u="image_message"===o.type_of_message&&o.content&&o.content.trim().length>0,g=(d||u)&&Gr(o.content),m=!o.sent_by_other_user&&g;let f=o;if(g){const e=Yr(o.content);e!==o.content&&(f=Object.assign({},o,{content:e}))}const p=t({item:f,index:n});return p?a?(0,j.jsxs)(r.default,{children:[i&&(0,j.jsx)(Or,{date:i}),p,m&&(0,j.jsx)($r,{styles:s,theme:l})]}):(0,j.jsxs)(r.default,{children:[p,m&&(0,j.jsx)($r,{styles:s,theme:l})]}):a&&i?(0,j.jsx)(r.default,{children:(0,j.jsx)(Or,{date:i})}):null}),[t,V,c,U,e.length,s,l]);return(0,j.jsxs)(r.default,{style:{flex:1,position:"relative"},children:[(0,j.jsx)(Yt.default,{ref:b,data:e,renderItem:q,keyExtractor:N,style:[s.messageList,{minHeight:"100%"}],onEndReached:P,onEndReachedThreshold:.5,scrollEventThrottle:8,onScroll:F,onViewableItemsChanged:z.current,viewabilityConfig:E.current,onScrollBeginDrag:W.current,onMomentumScrollEnd:O.current,inverted:!0,maintainVisibleContentPosition:{minIndexForVisible:0,autoscrollToTopThreshold:10},contentContainerStyle:{flexGrow:1,justifyContent:"flex-end",paddingTop:H},ListFooterComponent:a&&(0,j.jsx)(A.default,{size:"small",color:l.colors.primary,style:s.loadingMore}),initialNumToRender:20,maxToRenderPerBatch:10,windowSize:15,removeClippedSubviews:!1,className:d||"message-list-component"}),(0,j.jsx)(Jr,{conversationId:m,theme:l,onMarkComplete:g,onRefreshMessages:f,isProfessional:p})]})})),Zr=Kr,Xr=({profilePicture:e,style:t={},size:o=40,fallbackIconName:n="account",fallbackIconSize:a=24,testID:i})=>{const s=Object.assign({width:o,height:o,borderRadius:o/2},t);return e?(0,j.jsx)(Q.default,{source:{uri:(0,p.getMediaUrl)(e)},style:s,testID:i}):(0,j.jsx)(r.default,{style:Object.assign({},s,{backgroundColor:m.theme.colors.background,justifyContent:"center",alignItems:"center"}),testID:i||"profile-photo-fallback",children:(0,j.jsx)(S.default,{name:n,size:a,color:m.theme.colors.primary})})},Qr=({conversations:e,selectedConversation:t,onSelectConversation:o,searchQuery:i,onSearchChange:s,styles:l,CURRENT_USER_ID:d,getConversationUnreadCount:c,markConversationAsRead:u})=>((0,n.useEffect)((()=>{if((0,h.debugLog)("MBA2o3uihf48hv: ConversationList component mounted",{conversationsCount:e?.length||0,selectedConversation:t,hasGetConversationUnreadCount:!!c,hasMarkConversationAsRead:!!u}),c&&e?.length>0){const t=e.map((e=>({conversationId:e.conversation_id,unreadCount:c(String(e.conversation_id))})));(0,h.debugLog)("MBA2o3uihf48hv: Current conversation unread counts",{conversationUnreadCounts:t})}}),[e,t,c,u]),(0,j.jsxs)(r.default,{style:l.conversationListContainer,children:[(0,j.jsx)(r.default,{style:l.searchContainer,children:(0,j.jsxs)(r.default,{style:l.searchInputContainer,children:[(0,j.jsx)(S.default,{name:"magnify",size:20,color:m.theme.colors.placeholder,style:l.searchIcon}),(0,j.jsx)(te.default,{style:l.searchInput,placeholder:"Search conversations...",placeholderTextColor:m.theme.colors.placeholder,value:i,onChangeText:s}),i.length>0&&(0,j.jsx)(v.default,{style:l.clearButton,onPress:()=>s(""),children:(0,j.jsx)(S.default,{name:"close-circle",size:16,color:m.theme.colors.placeholder})})]})}),e.map((e=>{const n=e.participant1_id===d?e.participant2_name:e.participant1_name,i=String(e.conversation_id)===String(t),s=c?c(String(e.conversation_id)):0;return s>0&&(0,h.debugLog)("MBA2o3uihf48hv: Conversation ".concat(e.conversation_id," has ").concat(s," unread messages"),{conversationId:e.conversation_id,unreadCount:s,isSelected:i,convUnreadFlag:e.unread,name:n}),(0,j.jsxs)(v.default,{style:[l.conversationItem,i&&l.selectedConversation],onPress:()=>{if((0,h.debugLog)("MBA2o3uihf48hv: Conversation ".concat(e.conversation_id," clicked"),{previouslySelected:i,unreadCount:s,willCallMarkAsRead:u&&s>0}),window.selectedConversationId=e.conversation_id,u&&s>0){(0,h.debugLog)("MBA2o3uihf48hv: Marking conversation ".concat(e.conversation_id," as read when clicked"),{unreadCount:s});try{u(e.conversation_id),(0,h.debugLog)("MBA2o3uihf48hv: Forcing message state reset for conversation",{conversationId:e.conversation_id,hasUnread:s>0}),o(e.conversation_id,{forceRefresh:!0})}catch(zs){(0,h.debugLog)("MBA2o3uihf48hv: Error marking conversation as read",{error:zs.message}),o(e.conversation_id,{forceRefresh:!0})}}else o(e.conversation_id,{forceRefresh:!0})},children:[(0,j.jsx)(Xr,{profilePicture:e.profile_picture,style:l.conversationProfilePhoto}),(0,j.jsxs)(r.default,{style:l.conversationContent,children:[(0,j.jsxs)(r.default,{style:l.conversationHeader,children:[(0,j.jsx)(r.default,{style:{flexDirection:"row",alignItems:"center",flex:1},children:(0,j.jsx)(a.default,{style:l.conversationName,children:n||e.name||e.other_user_name||"Unknown"})}),(0,j.jsx)(a.default,{style:l.conversationTime,children:new Date(e.last_message_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,j.jsxs)(r.default,{style:l.conversationLastMessageContainer,children:[(0,j.jsx)(a.default,{style:[l.conversationLastMessage,i&&l.activeConversationText,(e.unread||s>0)&&!i&&l.unreadMessage],numberOfLines:1,children:Gr(e.last_message)?Yr(e.last_message):e.last_message}),s>0&&!i&&(0,j.jsx)(r.default,{style:l.unreadBadge,children:(0,j.jsx)(a.default,{style:l.unreadBadgeText,children:s})})]}),e.bookingStatus&&(0,j.jsx)(r.default,{style:[l.bookingStatusContainer,l["booking".concat(e.bookingStatus,"Status")]||l.bookingPendingStatus],children:(0,j.jsx)(a.default,{style:l.bookingStatus,children:e.bookingStatus})})]})]},e.conversation_id)}))]})),ea=n.forwardRef((({onSendMessage:e,onShowDropdown:t,showDropdown:o,styles:i,screenWidth:s,selectedConversation:l,onScrollStart:d},c)=>{const[u,g]=(0,n.useState)(""),[f,p]=(0,n.useState)([]),[y,b]=(0,n.useState)(!1),x=(0,n.useRef)(null),w=E(),C=(0,n.useCallback)((()=>{!document.activeElement||"INPUT"!==document.activeElement.tagName&&"TEXTAREA"!==document.activeElement.tagName||((0,h.debugLog)("MBA8765: Dismissing keyboard by blurring active element"),document.activeElement.blur()),x.current&&x.current.blur()}),[]);(0,n.useEffect)((()=>{if(d){let e=null;return d((()=>{s<=900&&(e&&clearTimeout(e),e=setTimeout((()=>{(0,h.debugLog)("MBA8765: Scroll started on mobile browser, dismissing keyboard after delay"),C()}),100))})),()=>{e&&clearTimeout(e)}}}),[d,s,C]),n.useImperativeHandle(c,(()=>({dismissKeyboard:C})),[C]);const T=(0,n.useCallback)((()=>{x.current&&(x.current.style.height="auto",x.current.style.height="".concat(40,"px"))}),[]);(0,n.useEffect)((()=>{x.current&&(x.current.style.height="".concat(40,"px"))}),[]);const B=(0,n.useCallback)((async()=>{try{t(!1);const e=await Mt.launchImageLibraryAsync({mediaTypes:Lt.MediaTypeOptions.Images,allowsEditing:!1,aspect:[4,3],quality:.8,base64:!0,allowsMultipleSelection:!0});!e.canceled&&e.assets&&e.assets.length>0&&((0,h.debugLog)("MBA5678: Images selected:",{count:e.assets.length,details:e.assets.map((e=>({uri:e.uri,type:e.type,fileName:e.fileName,fileSize:e.fileSize})))}),p((t=>[...t,...e.assets])))}catch(zs){(0,h.debugLog)("MBA5678: Error picking images:",zs)}}),[t]),k=((0,n.useCallback)((()=>{p([])}),[]),(0,n.useCallback)((e=>{p((t=>t.filter(((t,o)=>o!==e))))}),[])),_=(0,n.useCallback)((async()=>{try{if(y)return void(0,h.debugLog)("MBA5511: Send operation already in progress, ignoring duplicate click");if(0===f.length&&!u.trim())return;let t="";if(u.trim()&&(t=u.trim(),(0,h.debugLog)("MBA5511: Using sanitized message content",{message:t,length:t.length})),b(!0),(0,h.debugLog)("MBA5511: Message sending started - showing loading indicator"),0===f.length&&t)await e(t,[]);else if(f.length>0&&l)try{const o=f.reduce(((e,t)=>t.base64?e+.75*t.base64.length:t.size?e+t.size:e+1e6),0);(0,h.debugLog)("MBA5511: Total estimated image size before compression:",{totalSizeBytes:o,totalSizeMB:(o/1048576).toFixed(2)+"MB",imageCount:f.length}),o>4194304&&(0,h.debugLog)("MBA5511: Large image upload detected, compression will be applied");const n=await(0,bt.uploadAndSendImageMessage)(l,f,t);e(n.content,[],n,!0),(0,h.debugLog)("MBA5511: Image message sent and added to UI:",{messageId:n.message_id,imageCount:f.length,hasCaption:!!t,captionText:t,messageObjectContent:n.content})}catch(zs){if((0,h.debugLog)("MBA5511: Failed to send image message",zs),zs.response&&zs.response.data){const t=zs.response.data;"Cannot send messages to a deleted user account."===t.error?w({message:t.detail||"This user has deleted their account and is no longer receiving messages.",type:"error",duration:4e3}):t.error?w({message:t.error,type:"error",duration:3e3}):t.detail&&w({message:t.detail,type:"error",duration:3e3})}else zs.message&&zs.message.includes("Network Error")?w({message:"Network error occurred. Please check your connection and try again.",type:"error",duration:3e3}):w({message:"Failed to upload images. Please try again.",type:"error",duration:3e3});return void b(!1)}g(""),p([]),b(!1),(0,h.debugLog)("MBA5511: Message sending complete - hiding loading indicator"),x.current&&(x.current.clear(),T(),setTimeout((()=>{x.current&&((0,h.debugLog)("MBA9876: Refocusing input after send"),x.current.focus())}),0))}catch(zs){b(!1),(0,h.debugLog)("MBA5511: Error in handleSend, loading indicator stopped:",zs)}}),[u,e,T,f,l,y]),I=(0,n.useCallback)((()=>{if(x.current){const e=x.current.scrollHeight;if(e>50){const t=Math.min(e,120);x.current.style.height="".concat(t,"px")}else x.current.style.height="".concat(40,"px")}}),[]),M=(0,n.useCallback)((e=>{(0,h.debugLog)("MBA7777: Message input change:",e);const t=Ke(e,"message"),o=e.length>0?(e.length-t.length)/e.length*100:0;o>50&&e.length>10&&(0,h.debugLog)("MBA7777: Potentially malicious message input detected:",{original:e,sanitized:t,removalPercentage:o}),g(t),I()}),[I]),L=(0,n.useCallback)((e=>{"Enter"!==e.nativeEvent.key||e.nativeEvent.shiftKey||(e.preventDefault(),y||_())}),[_,y]);return(0,j.jsx)(r.default,{style:i.inputSection,className:"message-input-container",children:(0,j.jsxs)(r.default,{style:i.inputContainerOuter,children:[f.length>0&&(0,j.jsxs)(r.default,{style:i.selectedImagesWrapper,children:[(0,j.jsx)(X.default,{horizontal:!0,style:i.selectedImagesScrollView,contentContainerStyle:i.selectedImagesContainer,children:f.map(((e,t)=>(0,j.jsxs)(r.default,{style:i.selectedImageContainer,children:[(0,j.jsx)(Q.default,{source:{uri:e.uri},style:i.selectedImagePreview}),(0,j.jsx)(v.default,{style:i.removeImageButton,onPress:()=>k(t),children:(0,j.jsx)(S.default,{name:"close-circle",size:20,color:m.theme.colors.error})})]},"".concat(e.uri,"-").concat(t))))}),y&&(0,j.jsx)(r.default,{style:i.uploadingOverlay,children:(0,j.jsx)(A.default,{size:"small",color:m.theme.colors.primary})})]}),(0,j.jsxs)(r.default,{style:i.inputContainer,children:[(0,j.jsxs)(r.default,{style:i.attachButtonContainer,children:[(0,j.jsx)(v.default,{style:i.attachButton,onPress:()=>t(!o),children:(0,j.jsx)(S.default,{name:o?"close":"plus",size:24,color:m.theme.colors.primary})}),o&&(0,j.jsx)(r.default,{style:i.dropdownMenu,children:(0,j.jsxs)(v.default,{style:i.dropdownItem,onPress:B,children:[(0,j.jsx)(S.default,{name:"image",size:20,color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:[i.dropdownText,{color:m.theme.colors.text}],children:"Add Images"})]})})]}),(0,j.jsxs)(r.default,{style:i.inputInnerContainer,children:[(0,j.jsx)(te.default,{ref:x,style:[i.textInput,{maxHeight:120,minHeight:40,fontSize:22}],placeholder:f.length>0?"Add a caption...":"Type a Message...",placeholderTextColor:m.theme.colors.placeholder,value:u,onChangeText:M,multiline:!0,onKeyPress:L}),(0,j.jsx)(v.default,{style:[i.sendButton,u.trim()||f.length>0?Object.assign({},i.sendButtonActive,{backgroundColor:m.theme.colors.primary}):i.sendButtonInactive],onPress:_,disabled:!u.trim()&&0===f.length||y,children:y?(0,j.jsx)(A.default,{size:"small",color:m.theme.colors.surfaceContrast||"white"}):(0,j.jsx)(S.default,{name:"send",size:20,color:u.trim()||f.length>0?m.theme.colors.surfaceContrast||"white":m.theme.colors.surfaceContrast})})]})]})]})})})),ta=ea,oa=({selectedConversationData:e,hasDraft:t,draftData:o,onEditDraft:i,onBackPress:s,styles:l,isMobile:d=!1,onCreateBooking:c,onViewPets:u})=>{const[g,h]=(0,n.useState)(!1),f=(0,n.useRef)(null),p=(0,n.useRef)(null),y=e?.is_professional;return(0,n.useEffect)((()=>{if(g){const e=e=>{f.current&&!f.current.contains(e.target)&&p.current&&!p.current.contains(e.target)&&h(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}}),[g]),d?(0,j.jsx)(r.default,{style:[l.mobileHeader,{backgroundColor:m.theme.colors.surfaceContrast}],children:(0,j.jsxs)(r.default,{style:l.mobileHeaderContent,children:[(0,j.jsx)(v.default,{style:l.backArrow,onPress:s,children:(0,j.jsx)(S.default,{name:"arrow-left",size:24,color:m.theme.colors.primary})}),(0,j.jsxs)(r.default,{style:l.mobileHeaderNameContainer,children:[(0,j.jsx)(r.default,{style:[l.mobileProfilePhotoContainer,{alignSelf:"center"}],children:(0,j.jsx)(Xr,{profilePicture:e?.profile_picture,size:60,fallbackIconSize:30,style:l.mobileProfilePhoto})}),(0,j.jsx)(a.default,{style:[l.mobileHeaderName,{textAlign:"center",fontSize:16}],children:e?.name||e?.other_user_name})]}),y&&(0,j.jsx)(v.default,{ref:p,style:[l.backArrow,{right:16,left:"auto"}],onPress:()=>h(!g),children:(0,j.jsx)(S.default,{name:g?"chevron-up":"chevron-down",size:24,color:m.theme.colors.primary})}),g&&y&&(0,j.jsxs)(r.default,{ref:f,style:[l.headerDropdownMenu,{top:"100%",width:"90%",alignSelf:"center",right:16}],children:[(0,j.jsxs)(v.default,{style:l.headerDropdownItem,onPress:()=>{h(!1),c&&c()},children:[(0,j.jsx)(S.default,{name:"calendar-plus",size:20,color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:l.headerDropdownText,children:"Create Booking"})]}),(0,j.jsxs)(v.default,{style:l.headerDropdownItem,onPress:()=>{h(!1),u&&u()},children:[(0,j.jsx)(S.default,{name:"paw",size:20,color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:l.headerDropdownText,children:"View Profile"})]}),t&&o?.draft_id&&(0,j.jsxs)(v.default,{style:l.headerDropdownItem,onPress:()=>{h(!1),i&&i(o.draft_id)},children:[(0,j.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:l.headerDropdownText,children:"Edit Draft"})]})]})]})}):(0,j.jsx)(r.default,{style:l.messageHeader,children:(0,j.jsxs)(r.default,{style:l.messageHeaderContent,children:[(0,j.jsx)(Xr,{profilePicture:e?.profile_picture,style:l.profilePhoto}),(0,j.jsx)(a.default,{style:l.messageHeaderName,children:e?.other_user_name}),y&&(0,j.jsx)(v.default,{ref:p,style:{marginLeft:"auto"},onPress:()=>h(!g),children:(0,j.jsx)(S.default,{name:g?"chevron-up":"chevron-down",size:20,color:m.theme.colors.primary})}),g&&y&&(0,j.jsxs)(r.default,{ref:f,style:l.headerDropdownMenu,children:[(0,j.jsxs)(v.default,{style:l.headerDropdownItem,onPress:()=>{h(!1),c&&c()},children:[(0,j.jsx)(S.default,{name:"calendar-plus",size:20,color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:l.headerDropdownText,children:"Create Booking"})]}),(0,j.jsxs)(v.default,{style:l.headerDropdownItem,onPress:()=>{h(!1),u&&u()},children:[(0,j.jsx)(S.default,{name:"paw",size:20,color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:l.headerDropdownText,children:"View Profile"})]}),t&&o?.draft_id&&(0,j.jsxs)(v.default,{style:l.headerDropdownItem,onPress:()=>{h(!1),i&&i(o.draft_id)},children:[(0,j.jsx)(S.default,{name:"pencil",size:20,color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:l.headerDropdownText,children:"Edit Draft"})]})]})]})})},na=i.default.create({modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",padding:20},petListImageContainer:{marginRight:12},petListImage:{width:50,height:50,borderRadius:25},petListImagePlaceholder:{width:50,height:50,borderRadius:25,backgroundColor:m.theme.colors.background,justifyContent:"center",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border},petItemContent:{flexDirection:"row",alignItems:"center"},petTextContainer:{flex:1},modalContainer:{backgroundColor:m.theme.colors.surface,borderRadius:12,width:"90%",maxWidth:800,maxHeight:"80%",overflow:"hidden"},modalContainerSmallMobile:{width:"calc(100% - 10px)",height:"calc(100% - 10px)",maxWidth:"none",maxHeight:"none",borderRadius:8},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:20,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},headerLeft:{flex:1,flexDirection:"row",alignItems:"center"},headerTextContainer:{flex:1},clientProfilePhoto:{width:50,height:50,borderRadius:25,marginRight:15},clientProfilePhotoPlaceholder:{width:50,height:50,borderRadius:25,backgroundColor:m.theme.colors.background,justifyContent:"center",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border,marginRight:15},clientName:{fontSize:20,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},clientSubtitleContainer:{flexDirection:"row",alignItems:"center",marginTop:4},clientSubtitle:{fontSize:14,color:m.theme.colors.textSecondary},reviewBadge:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.background,paddingVertical:2,borderRadius:12},reviewBadgeText:{fontSize:16,color:m.theme.colors.text,marginLeft:4,fontWeight:"500"},closeButton:{padding:8},loadingContainer:{padding:40,alignItems:"center"},loadingText:{marginTop:16,color:m.theme.colors.textSecondary},errorContainer:{padding:40,alignItems:"center"},errorText:{color:m.theme.colors.error,textAlign:"center",marginBottom:16},retryButton:{backgroundColor:m.theme.colors.primary,paddingHorizontal:20,paddingVertical:10,borderRadius:8},retryText:{color:m.theme.colors.whiteText,fontWeight:"500"},content:{flexDirection:"row",flex:1},contentMobile:{flexDirection:"column"},mobilePetsView:{flex:1,padding:20},mobilePetItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},mobilePetContent:{flex:1,flexDirection:"row",alignItems:"center"},mobilePetName:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginBottom:4},mobilePetType:{fontSize:14,color:m.theme.colors.textSecondary},mobileDetailsView:{flex:1},mobileDetailsHeader:{flexDirection:"row",alignItems:"center",padding:20,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},backButton:{padding:8,marginRight:12},mobileDetailsTitle:{fontSize:18,fontWeight:"600",color:m.theme.colors.text,flex:1},mobileDetailsScrollView:{flex:1,padding:20},petsList:{width:"40%",borderRightWidth:1,borderRightColor:m.theme.colors.border,padding:20},sectionTitle:{fontSize:18,fontWeight:"600",color:m.theme.colors.text,marginBottom:16,fontFamily:m.theme.fonts.header.fontFamily},petsScrollView:{flex:1},petItem:{padding:12,borderRadius:8,marginBottom:8,backgroundColor:m.theme.colors.background,borderWidth:1,borderColor:m.theme.colors.border},petItemSelected:{backgroundColor:m.theme.colors.primary,borderColor:m.theme.colors.primary},petName:{fontSize:14,fontWeight:"500",color:m.theme.colors.text,marginBottom:4},petNameSelected:{color:m.theme.colors.whiteText},petType:{fontSize:12,color:m.theme.colors.textSecondary},petTypeSelected:{color:m.theme.colors.whiteText},petDetails:{flex:1,padding:20},detailsScrollView:{flex:1},detailsTitle:{fontSize:24,fontWeight:"600",color:m.theme.colors.text,marginBottom:20,fontFamily:m.theme.fonts.header.fontFamily},detailSection:{marginBottom:20},detailLabel:{fontSize:14,fontWeight:"600",color:m.theme.colors.text,marginBottom:8},detailText:{fontSize:14,color:m.theme.colors.textSecondary,lineHeight:20},detailsSection:{marginBottom:24},sectionHeader:{fontSize:18,fontWeight:"600",color:m.theme.colors.text,marginBottom:16,fontFamily:m.theme.fonts.header.fontFamily,paddingBottom:8,borderBottomWidth:1,borderBottomColor:m.theme.colors.border+"40"},petImageContainer:{alignItems:"center",marginBottom:20},petImage:{width:150,height:150,borderRadius:75},petImagePlaceholder:{width:150,height:150,borderRadius:75,backgroundColor:m.theme.colors.background,justifyContent:"center",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border},noSelectionContainer:{flex:1,justifyContent:"center",alignItems:"center"},noSelectionText:{color:m.theme.colors.textSecondary,fontSize:16},footer:{padding:20,borderTopWidth:1,borderTopColor:m.theme.colors.border},createBookingButton:{backgroundColor:m.theme.colors.primary,paddingVertical:16,borderRadius:8,alignItems:"center"},createBookingButtonText:{color:m.theme.colors.whiteText,fontSize:16,fontWeight:"600"},emptyStateContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:30},emptyStateTitle:{fontSize:20,fontWeight:"600",color:m.theme.colors.text,marginTop:16,marginBottom:8},emptyStateText:{fontSize:14,color:m.theme.colors.textSecondary,textAlign:"center",lineHeight:20},reviewSection:{marginBottom:20},reviewSummary:{flexDirection:"row",alignItems:"center",marginBottom:8},ratingContainer:{flexDirection:"row",alignItems:"center",marginRight:8},ratingText:{fontSize:18,fontWeight:"600",color:m.theme.colors.text},reviewCountText:{fontSize:14,color:m.theme.colors.textSecondary},reviewsScrollView:{flex:1},reviewCard:{padding:12,borderRadius:8,marginRight:8,backgroundColor:m.theme.colors.background,borderWidth:1,borderColor:m.theme.colors.border},reviewHeader:{flexDirection:"row",alignItems:"center",marginBottom:8},reviewerName:{fontSize:14,fontWeight:"500",color:m.theme.colors.text},reviewRating:{flexDirection:"row",alignItems:"center",marginBottom:4},reviewText:{fontSize:14,color:m.theme.colors.textSecondary},reviewDate:{fontSize:12,color:m.theme.colors.textSecondary}}),ra=({visible:e,onClose:t,conversation:o,otherUserName:i,onCreateBooking:s,otherUserProfilePhoto:l})=>{const[d,c]=(0,n.useState)([]),[u,g]=(0,n.useState)([]),[f,y]=(0,n.useState)(0),[b,x]=(0,n.useState)(0),[w,T]=(0,n.useState)(null),[B,_]=(0,n.useState)(!1),[I,M]=(0,n.useState)(null),[L,R]=(0,n.useState)("pets"),[D,z]=(0,n.useState)(!1),{userRole:P}=(0,n.useContext)(h.AuthContext),{width:F}=C.default.get("window"),E=F<=768,W=F<=600;(0,n.useEffect)((()=>{e&&o?.id&&((0,h.debugLog)("MBA3456","ClientPetsModal became visible with conversation ID:",o.id),O(),N())}),[e,o?.id]);const O=async()=>{_(!0),M(null);try{(0,h.debugLog)("MBA3456","Fetching pets for conversation:",o.id);const e=await(0,bt.getClientPets)(o.id);(0,h.debugLog)("MBA3456","Successfully fetched pets:",e.length),c(e),e.length>0&&T(e[0])}catch(e){(0,h.debugLog)("MBA3456","Error fetching client pets:",e.response?.data||e.message),M("Failed to load pets")}finally{_(!1)}},N=async()=>{try{(0,h.debugLog)("MBA387c439h","Fetching reviews for conversation:",o.id);const e="professional"===P;(0,h.debugLog)("MBA387c439h","Current user isProfessional:",e);const t=await(0,bt.getUserReviews)(o.id,null,e);(0,h.debugLog)("MBA387c439h","Successfully fetched reviews:",t),g(t.reviews||[]),y(t.average_rating||0),x(t.review_count||0)}catch(e){(0,h.debugLog)("MBA387c439h","Error fetching user reviews:",e.response?.data||e.message)}},H=()=>{T(null),c([]),g([]),y(0),x(0),M(null),R("pets"),t()},U=e=>{T(e),E&&R("details")},V=e=>(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(r.default,{style:na.petImageContainer,children:e.profile_photo?(0,j.jsx)(Q.default,{source:{uri:(0,p.getMediaUrl)(e.profile_photo)},style:na.petImage}):(0,j.jsx)(r.default,{style:na.petImagePlaceholder,children:(0,j.jsx)(S.default,{name:"paw",size:50,color:m.theme.colors.placeholder})})}),(0,j.jsxs)(r.default,{style:na.detailsSection,children:[(0,j.jsx)(a.default,{style:na.sectionHeader,children:"Basic Information"}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Type"}),(0,j.jsx)(a.default,{style:na.detailText,children:e.species.charAt(0).toUpperCase()+e.species.slice(1).toLowerCase()||"Not specified"})]}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Breed"}),(0,j.jsx)(a.default,{style:na.detailText,children:e.breed.charAt(0).toUpperCase()+e.breed.slice(1).toLowerCase()||"Not specified"})]}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Age"}),(0,j.jsx)(a.default,{style:na.detailText,children:e.age||"Not specified"})]}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Weight"}),(0,j.jsx)(a.default,{style:na.detailText,children:e.weight?"".concat(e.weight," lbs"):"Not specified"})]}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Sex"}),(0,j.jsx)(a.default,{style:na.detailText,children:e.sex||"Not specified"})]}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Birthday"}),(0,j.jsx)(a.default,{style:na.detailText,children:e.birthday?new Date(e.birthday).toLocaleDateString():"Not specified"})]}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Adoption Date"}),(0,j.jsx)(a.default,{style:na.detailText,children:e.adoption_date?new Date(e.adoption_date).toLocaleDateString():"Not specified"})]})]}),(0,j.jsxs)(r.default,{style:na.detailsSection,children:[(0,j.jsx)(a.default,{style:na.sectionHeader,children:"Care Instructions"}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Feeding Schedule"}),(0,j.jsx)(a.default,{style:na.detailText,children:e.feeding_schedule||"Not provided"})]}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Potty Break Schedule"}),(0,j.jsx)(a.default,{style:na.detailText,children:e.is_dog?e.potty_break_schedule||"Not provided":"Not applicable for this pet type"})]}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Special Care Instructions"}),(0,j.jsx)(a.default,{style:na.detailText,children:e.special_care_instructions||"None provided"})]})]}),(0,j.jsxs)(r.default,{style:na.detailsSection,children:[(0,j.jsx)(a.default,{style:na.sectionHeader,children:"Behavioral Information"}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Energy Level"}),(0,j.jsx)(a.default,{style:na.detailText,children:e.energy_level||"Not specified"})]}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Can be Left Alone"}),(0,j.jsx)(a.default,{style:na.detailText,children:!0===e.can_be_left_alone?"Yes":!1===e.can_be_left_alone?"No":"Not specified"})]}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Friendly with Children"}),(0,j.jsx)(a.default,{style:na.detailText,children:!0===e.friendly_with_children?"Yes":!1===e.friendly_with_children?"No":"Not specified"})]}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Friendly with Cats"}),(0,j.jsx)(a.default,{style:na.detailText,children:!0===e.friendly_with_cats?"Yes":!1===e.friendly_with_cats?"No":"Not specified"})]}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Friendly with Dogs"}),(0,j.jsx)(a.default,{style:na.detailText,children:!0===e.friendly_with_dogs?"Yes":!1===e.friendly_with_dogs?"No":"Not specified"})]})]}),(0,j.jsxs)(r.default,{style:na.detailsSection,children:[(0,j.jsx)(a.default,{style:na.sectionHeader,children:"Medical Information"}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Spayed/Neutered"}),(0,j.jsx)(a.default,{style:na.detailText,children:!0===e.spayed_neutered?"Yes":!1===e.spayed_neutered?"No":"Not specified"})]}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"House Trained"}),(0,j.jsx)(a.default,{style:na.detailText,children:!0===e.house_trained?"Yes":!1===e.house_trained?"No":"Not specified"})]}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Microchipped"}),(0,j.jsx)(a.default,{style:na.detailText,children:!0===e.microchipped?"Yes":!1===e.microchipped?"No":"Not specified"})]}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Medications"}),(0,j.jsx)(a.default,{style:na.detailText,children:e.medications||"No medications listed"})]}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Medication Notes"}),(0,j.jsx)(a.default,{style:na.detailText,children:e.medication_notes||"None provided"})]})]}),(0,j.jsxs)(r.default,{style:na.detailsSection,children:[(0,j.jsx)(a.default,{style:na.sectionHeader,children:"Veterinary Information"}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Veterinarian"}),(0,j.jsx)(a.default,{style:na.detailText,children:e.vet_name||"Not provided"})]}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Vet Phone"}),(0,j.jsx)(a.default,{style:na.detailText,children:e.vet_phone||"Not provided"})]}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Vet Address"}),(0,j.jsx)(a.default,{style:na.detailText,children:e.vet_address||"Not provided"})]}),(0,j.jsxs)(r.default,{style:na.detailSection,children:[(0,j.jsx)(a.default,{style:na.detailLabel,children:"Insurance Provider"}),(0,j.jsx)(a.default,{style:na.detailText,children:e.insurance_provider||"Not provided"})]})]})]});return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(k.default,{visible:e,onRequestClose:H,animationType:"slide",transparent:!0,children:(0,j.jsx)(r.default,{style:na.modalOverlay,children:(0,j.jsxs)(r.default,{style:[na.modalContainer,W&&na.modalContainerSmallMobile],children:[(0,j.jsxs)(r.default,{style:na.header,children:[(0,j.jsxs)(r.default,{style:na.headerLeft,children:[l?(0,j.jsx)(Q.default,{source:{uri:(0,p.getMediaUrl)(l)},style:na.clientProfilePhoto}):(0,j.jsx)(r.default,{style:na.clientProfilePhotoPlaceholder,children:(0,j.jsx)(S.default,{name:"account",size:24,color:m.theme.colors.placeholder})}),(0,j.jsxs)(r.default,{style:na.headerTextContainer,children:[(0,j.jsx)(a.default,{style:na.clientName,children:i||"Client"}),(0,j.jsx)(r.default,{style:na.clientSubtitleContainer,children:b>0?(0,j.jsxs)(v.default,{style:na.reviewBadge,onPress:()=>{z(!0)},children:[(0,j.jsx)(S.default,{name:"star",size:16,color:m.theme.colors.warning}),(0,j.jsxs)(a.default,{style:na.reviewBadgeText,children:[f," \u2022 ",b," ",1===b?"Review":"Reviews"]})]}):(0,j.jsx)(a.default,{style:na.reviewBadgeText,children:"No reviews yet"})})]})]}),(0,j.jsx)(v.default,{onPress:H,style:na.closeButton,children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),B?(0,j.jsxs)(r.default,{style:na.loadingContainer,children:[(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:na.loadingText,children:"Loading pets..."})]}):I?(0,j.jsxs)(r.default,{style:na.errorContainer,children:[(0,j.jsx)(a.default,{style:na.errorText,children:I}),(0,j.jsx)(v.default,{style:na.retryButton,onPress:O,children:(0,j.jsx)(a.default,{style:na.retryText,children:"Retry"})})]}):0===d.length?(0,j.jsxs)(r.default,{style:na.emptyStateContainer,children:[(0,j.jsx)(S.default,{name:"paw",size:60,color:m.theme.colors.placeholder}),(0,j.jsx)(a.default,{style:na.emptyStateTitle,children:"No Pets Found"}),(0,j.jsx)(a.default,{style:na.emptyStateText,children:"This client doesn't have any pets registered yet. They will need to add pets to create a booking."})]}):(0,j.jsxs)(r.default,{style:[na.content,E&&na.contentMobile],children:[E&&"pets"===L&&(0,j.jsxs)(r.default,{style:na.mobilePetsView,children:[(0,j.jsx)(a.default,{style:na.sectionTitle,children:"Pets"}),(0,j.jsx)(X.default,{style:na.petsScrollView,children:d.map((e=>(0,j.jsxs)(v.default,{style:na.mobilePetItem,onPress:()=>U(e),children:[(0,j.jsxs)(r.default,{style:na.mobilePetContent,children:[(0,j.jsx)(r.default,{style:na.petListImageContainer,children:e.profile_photo?(0,j.jsx)(Q.default,{source:{uri:(0,p.getMediaUrl)(e.profile_photo)},style:na.petListImage}):(0,j.jsx)(r.default,{style:na.petListImagePlaceholder,children:(0,j.jsx)(S.default,{name:"paw",size:16,color:m.theme.colors.placeholder})})}),(0,j.jsxs)(r.default,{style:na.petTextContainer,children:[(0,j.jsx)(a.default,{style:na.mobilePetName,children:e.name.charAt(0).toUpperCase()+e.name.slice(1).toLowerCase()}),(0,j.jsx)(a.default,{style:na.mobilePetType,children:e.species.charAt(0).toUpperCase()+e.species.slice(1).toLowerCase()})]})]}),(0,j.jsx)(S.default,{name:"chevron-right",size:24,color:m.theme.colors.textSecondary})]},e.pet_id)))})]}),E&&"details"===L&&w&&(0,j.jsxs)(r.default,{style:na.mobileDetailsView,children:[(0,j.jsxs)(r.default,{style:na.mobileDetailsHeader,children:[(0,j.jsx)(v.default,{style:na.backButton,onPress:()=>{R("pets")},children:(0,j.jsx)(S.default,{name:"arrow-left",size:24,color:m.theme.colors.primary})}),(0,j.jsx)(a.default,{style:na.mobileDetailsTitle,children:w.name.charAt(0).toUpperCase()+w.name.slice(1).toLowerCase()})]}),(0,j.jsx)(X.default,{style:na.mobileDetailsScrollView,children:V(w)})]}),!E&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(r.default,{style:na.petsList,children:[(0,j.jsx)(a.default,{style:na.sectionTitle,children:"Pets"}),(0,j.jsx)(X.default,{style:na.petsScrollView,children:d.map((e=>(0,j.jsx)(v.default,{style:[na.petItem,w?.pet_id===e.pet_id&&na.petItemSelected],onPress:()=>U(e),children:(0,j.jsxs)(r.default,{style:na.petItemContent,children:[(0,j.jsx)(r.default,{style:na.petListImageContainer,children:e.profile_photo?(0,j.jsx)(Q.default,{source:{uri:(0,p.getMediaUrl)(e.profile_photo)},style:na.petListImage}):(0,j.jsx)(r.default,{style:na.petListImagePlaceholder,children:(0,j.jsx)(S.default,{name:"paw",size:16,color:m.theme.colors.placeholder})})}),(0,j.jsxs)(r.default,{style:na.petTextContainer,children:[(0,j.jsx)(a.default,{style:[na.petName,w?.pet_id===e.pet_id&&na.petNameSelected],children:e.name.charAt(0).toUpperCase()+e.name.slice(1).toLowerCase()}),(0,j.jsx)(a.default,{style:[na.petType,w?.pet_id===e.pet_id&&na.petTypeSelected],children:e.species.charAt(0).toUpperCase()+e.species.slice(1).toLowerCase()})]})]})},e.pet_id)))})]}),(0,j.jsx)(r.default,{style:na.petDetails,children:w?(0,j.jsxs)(X.default,{style:na.detailsScrollView,children:[(0,j.jsx)(a.default,{style:na.detailsTitle,children:w.name.charAt(0).toUpperCase()+w.name.slice(1).toLowerCase()}),V(w)]}):(0,j.jsx)(r.default,{style:na.noSelectionContainer,children:(0,j.jsx)(a.default,{style:na.noSelectionText,children:"Select a pet to view details"})})})]})]}),!B&&!I&&(0,j.jsx)(r.default,{style:na.footer,children:(0,j.jsx)(v.default,{style:na.createBookingButton,onPress:()=>{H(),s&&s()},children:(0,j.jsx)(a.default,{style:na.createBookingButtonText,children:"Create Booking"})})})]})})}),(0,j.jsx)(po,{visible:D,onClose:()=>{z(!1)},reviews:u,averageRating:f,reviewCount:b,userName:i,forProfessional:!1})]})},aa=({message:e,isFromMe:t,styles:o,userTimezone:n,show:i})=>{if(!i||!e||!e.timestamp)return null;const s=Ur(e.timestamp,n);return(0,j.jsx)(r.default,{style:[o.messageTimestampContainer,t?o.sentMessageTimestamp:o.receivedMessageTimestamp,"image_message"===e.type_of_message||e.image_url||e.image_urls||e.metadata&&e.metadata.image_urls?{marginBottom:0,marginTop:20}:null],children:(0,j.jsx)(a.default,{style:o.messageTimestampText,children:s})})};var ia=o(92365);const sa=i.default.create({modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",paddingHorizontal:20},modalContainer:{backgroundColor:m.theme.colors.surface,borderRadius:12,width:"100%",maxWidth:500,padding:20,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20,paddingBottom:10,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},headerText:{fontSize:18,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},closeButton:{padding:5},ratingContainer:{marginBottom:20},ratingLabel:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginBottom:10,fontFamily:m.theme.fonts.regular.fontFamily},starsRow:{flexDirection:"row",justifyContent:"center",alignItems:"center"},starContainer:{padding:5},reviewTextContainer:{marginBottom:20},reviewTextLabel:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginBottom:10,fontFamily:m.theme.fonts.regular.fontFamily},reviewTextInput:{borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,padding:10,fontSize:16,color:m.theme.colors.text,backgroundColor:m.theme.colors.background,fontFamily:m.theme.fonts.regular.fontFamily,minHeight:100},noticeContainer:{backgroundColor:m.theme.colors.error+"15",borderRadius:8,padding:10,marginBottom:20,borderLeftWidth:3,borderLeftColor:m.theme.colors.error},noticeText:{fontSize:14,color:m.theme.colors.error,fontFamily:m.theme.fonts.regular.fontFamily},actionButtons:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},cancelButton:{paddingVertical:12,paddingHorizontal:20,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,backgroundColor:m.theme.colors.surface},cancelButtonText:{color:m.theme.colors.text,fontSize:16,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},submitButton:{paddingVertical:12,paddingHorizontal:20,borderRadius:8,backgroundColor:m.theme.colors.primary},submitButtonText:{color:"white",fontSize:16,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},disabledButton:{opacity:.5}}),la=({visible:e,onClose:t,isProfessional:o,bookingId:i,conversationId:s,onSubmitReview:l})=>{const[d,c]=(0,n.useState)(0),[u,g]=(0,n.useState)(""),[f,p]=(0,n.useState)(!1),[y,b]=(0,n.useState)({visible:!1,message:"",type:"success"});n.useEffect((()=>{e&&(c(0),g(""),p(!1),b({visible:!1,message:"",type:"success"}))}),[e]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(k.default,{visible:e,transparent:!0,animationType:"fade",onRequestClose:t,children:(0,j.jsx)(qo.default,{behavior:"height",style:{flex:1},children:(0,j.jsx)(v.default,{activeOpacity:1,style:sa.modalOverlay,onPress:()=>{ia.default.dismiss(),t()},children:(0,j.jsxs)(v.default,{activeOpacity:1,style:sa.modalContainer,onPress:e=>{e.stopPropagation()},children:[(0,j.jsxs)(r.default,{style:sa.header,children:[(0,j.jsx)(a.default,{style:sa.headerText,children:o?"Please Review Your Client":"Please Rate Your Experience"}),(0,j.jsx)(v.default,{onPress:t,style:sa.closeButton,children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,j.jsxs)(r.default,{style:sa.ratingContainer,children:[(0,j.jsx)(a.default,{style:sa.ratingLabel,children:"Your Rating"}),(0,j.jsx)(r.default,{style:sa.starsRow,children:(()=>{const e=[];for(let t=1;t<=5;t++)e.push((0,j.jsx)(v.default,{onPress:()=>c(t),style:sa.starContainer,children:(0,j.jsx)(S.default,{name:t<=d?"star":"star-outline",size:40,color:t<=d?"#FFD700":m.theme.colors.border})},t));return e})()})]}),(0,j.jsxs)(r.default,{style:sa.reviewTextContainer,children:[(0,j.jsx)(a.default,{style:sa.reviewTextLabel,children:"Your Review"}),(0,j.jsx)(te.default,{style:sa.reviewTextInput,placeholder:"Write your review here...",placeholderTextColor:m.theme.colors.placeHolderText,multiline:!0,numberOfLines:4,minHeight:null,textAlignVertical:"top",value:u,onChangeText:g})]}),(0,j.jsx)(r.default,{style:sa.noticeContainer,children:(0,j.jsx)(a.default,{style:sa.noticeText,children:"Note: Your review won't be visible to the other user until the other user posts their review or 14 days after the booking."})}),(0,j.jsxs)(r.default,{style:sa.actionButtons,children:[(0,j.jsx)(v.default,{style:sa.cancelButton,onPress:t,disabled:f,children:(0,j.jsx)(a.default,{style:sa.cancelButtonText,children:"Cancel"})}),(0,j.jsx)(v.default,{style:[sa.submitButton,0===d||!u.trim()||f?sa.disabledButton:{}],onPress:async()=>{if(0!==d)if(u.trim()){p(!0);try{l&&await l({bookingId:i,rating:d,reviewText:u,isProfessional:o,conversationId:s}),b({visible:!0,message:"Review submitted successfully!",type:"success"}),t()}catch(zs){(0,h.debugLog)("MBA8675309: Error submitting review:",zs),b({visible:!0,message:"Failed to submit review. Please try again.",type:"error"}),p(!1)}}else b({visible:!0,message:"Please write a review",type:"error"});else b({visible:!0,message:"Please select a star rating",type:"error"})},disabled:0===d||!u.trim()||f,children:(0,j.jsx)(a.default,{style:sa.submitButtonText,children:f?"Posting...":"Post Review"})})]})]})})})}),(0,j.jsx)(P,{visible:y.visible,message:y.message,type:y.type,onDismiss:()=>b(Object.assign({},y,{visible:!1})),duration:3e3})]})},da=i.default.create({container:{width:"100%",paddingHorizontal:16,marginVertical:8},completedBanner:{flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:m.theme.colors.success+"15",borderRadius:8,padding:12,marginBottom:8,borderWidth:1,borderColor:m.theme.colors.success,gap:8},completedText:{fontSize:16,fontWeight:"600",color:m.theme.colors.success,fontFamily:m.theme.fonts.header.fontFamily},card:{backgroundColor:m.theme.colors.surface,borderRadius:12,borderWidth:1,borderColor:m.theme.colors.border,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,overflow:"hidden"},header:{flexDirection:"row",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,backgroundColor:m.theme.colors.background,gap:8},title:{fontSize:16,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},content:{padding:16},infoSection:{marginBottom:16},row:{flexDirection:"row",alignItems:"center",marginBottom:8},label:{fontSize:14,fontWeight:"500",color:m.theme.colors.text,minWidth:80,fontFamily:m.theme.fonts.regular.fontFamily},value:{fontSize:14,color:m.theme.colors.text,flex:1,fontFamily:m.theme.fonts.regular.fontFamily},subtitleContainer:{marginTop:8,paddingTop:8,borderTopWidth:1,borderTopColor:m.theme.colors.border},subtitle:{fontSize:13,color:m.theme.colors.textSecondary||"#666",fontStyle:"italic",lineHeight:18,fontFamily:m.theme.fonts.regular.fontFamily},buttonContainer:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",gap:10,marginTop:10},detailsButton:{flex:1,backgroundColor:"#6b705c",paddingVertical:12,paddingHorizontal:16,borderRadius:8,alignItems:"center"},detailsButtonText:{color:"white",fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},reviewButton:{flex:1,backgroundColor:"#6b705c",paddingVertical:12,paddingHorizontal:16,borderRadius:8,alignItems:"center"},reviewButtonText:{color:"white",fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},disabledButton:{backgroundColor:"#ccc",opacity:.6},disabledButtonText:{color:"#999"}}),ca=({data:e,isProfessional:t,conversationId:o,navigation:i,onPress:s})=>{(0,h.debugLog)("MBA8675309: ReviewRequestCard data:",e);const[l,d]=(0,n.useState)(!1),[c,u]=(0,n.useState)(null),[g,f]=(0,n.useState)(!1),p=e=>{switch(e){case"leaveReview":f(!0);break;case"viewReviews":(0,h.debugLog)("MBA8675309: Navigating to MyProfile to view reviews"),i?i.navigate("MyProfile",{initialTab:"profile_info"}):(0,h.debugLog)("MBA8675309: Navigation object not available")}},y=(()=>{const o=!1!==e.pro_review_allowed,n=!1!==e.client_review_allowed,r=!0===e.reviews_visible,a=!0===e.past_14_day_window;if((0,h.debugLog)("MBA8675309: Review state analysis:",{isProfessional:t,proReviewAllowed:o,clientReviewAllowed:n,reviewsVisible:r,past14Days:a,metadata:e}),r)return{message:"Reviews have been exchanged",buttonText:"View Review",buttonAction:"viewReviews",canReview:!1,subtitle:"Both reviews are now visible. If you wish to dispute a review, please contact support."};if(a)return{message:"Review window has expired",buttonText:"View Available Review",buttonAction:"viewReviews",canReview:!1,subtitle:"The 14-day review window has passed. Any submitted reviews are now visible."};if(t){if(!o&&n)return{message:"You have reviewed your client",buttonText:"Review Submitted",buttonAction:"none",canReview:!1,subtitle:"Waiting for your client to leave a review. Once they do, both reviews will be visible."};if(o&&!n)return{message:"Your client has reviewed you",buttonText:"Leave Your Review",buttonAction:"leaveReview",canReview:!0,subtitle:"Leave a review for your client to see their review of you."};if(o&&n)return{message:"Please review your client",buttonText:"Leave a Review",buttonAction:"leaveReview",canReview:!0,subtitle:"Your review won't be visible until your client also leaves a review or 14 days pass."}}else{if(!n&&o)return{message:"You have reviewed your experience",buttonText:"Review Submitted",buttonAction:"none",canReview:!1,subtitle:"Waiting for the professional to leave a review. Once they do, both reviews will be visible."};if(n&&!o)return{message:"The professional has reviewed you",buttonText:"Leave Your Review",buttonAction:"leaveReview",canReview:!0,subtitle:"Leave a review for the professional to see their review of you."};if(n&&o)return{message:"Please review your experience",buttonText:"Leave a Review",buttonAction:"leaveReview",canReview:!0,subtitle:"Your review won't be visible until the professional also leaves a review or 14 days pass."}}return{message:"Review status unavailable",buttonText:"Check Status",buttonAction:"none",canReview:!1,subtitle:"Please contact support if you need assistance with reviews."}})();return(0,j.jsxs)(r.default,{style:da.container,children:[(0,j.jsxs)(r.default,{style:da.completedBanner,children:[(0,j.jsx)(S.default,{name:"check-circle",size:24,color:m.theme.colors.success}),(0,j.jsx)(a.default,{style:da.completedText,children:"Booking Completed"})]}),(0,j.jsxs)(r.default,{style:da.card,children:[(0,j.jsxs)(r.default,{style:da.header,children:[(0,j.jsx)(S.default,{name:"star-outline",size:24,color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:da.title,children:y.message})]}),(0,j.jsxs)(r.default,{style:da.content,children:[(0,j.jsxs)(r.default,{style:da.infoSection,children:[(0,j.jsxs)(r.default,{style:da.row,children:[(0,j.jsx)(a.default,{style:da.label,children:"Booking ID:"}),(0,j.jsx)(a.default,{style:da.value,children:e.booking_id||"N/A"})]}),(0,j.jsxs)(r.default,{style:da.row,children:[(0,j.jsx)(a.default,{style:da.label,children:"Service:"}),(0,j.jsx)(a.default,{style:da.value,children:e.service_type||"N/A"})]}),y.subtitle&&(0,j.jsx)(r.default,{style:da.subtitleContainer,children:(0,j.jsx)(a.default,{style:da.subtitle,children:y.subtitle})})]}),(0,j.jsxs)(r.default,{style:da.buttonContainer,children:[(0,j.jsx)(v.default,{style:da.detailsButton,onPress:()=>{const t=Object.assign({},e,{occurrences:e.occurrences?.map((e=>Object.assign({},e,{rates:e.rates||{base_rate:0,additional_animal_rate:0,applies_after:1,holiday_rate:0,holiday_days:0,additional_rates:[]}})))||[]});u(t),d(!0)},children:(0,j.jsx)(a.default,{style:da.detailsButtonText,children:"View Booking Details"})}),(0,j.jsx)(v.default,{style:[da.reviewButton,!y.canReview&&da.disabledButton],onPress:()=>p(y.buttonAction),disabled:!y.canReview&&"none"===y.buttonAction,children:(0,j.jsx)(a.default,{style:[da.reviewButtonText,!y.canReview&&da.disabledButtonText],children:y.buttonText})})]})]})]}),(0,j.jsx)(dn,{visible:l,onClose:()=>d(!1),bookingId:e.booking_id,initialData:c,isProfessional:t,isReadOnly:!0,hideButtons:!0,modalTitle:"Booking Details"}),(0,j.jsx)(la,{visible:g,onClose:()=>f(!1),isProfessional:t,bookingId:e.booking_id,conversationId:o,onSubmitReview:async e=>{try{const t=await(0,bt.submitBookingReview)(e);return(0,h.debugLog)("MBA8675309: Review submitted successfully:",t),s&&s("reviewSubmitted",t),t}catch(zs){throw(0,h.debugLog)("MBA8675309: Error submitting review:",zs),zs}}})]})},ua=({navigation:e,route:t})=>{const{colors:o}=(0,ne.useTheme)(),{screenWidth:s,isCollapsed:l,isSignedIn:d,loading:c}=(0,n.useContext)(h.AuthContext),u=(e=>i.default.create({container:Object.assign({flex:1,backgroundColor:m.theme.colors.background,paddingTop:0,paddingRight:0,paddingLeft:0,height:"100%",overflow:"hidden",position:"absolute",top:0,left:0,right:0,bottom:0},e<=900?{display:"flex",flexDirection:"column"}:{}),headerContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},headerTitle:{fontSize:20,fontWeight:"bold",color:m.theme.colors.primary,fontFamily:m.theme.fonts.header.fontFamily},filterButton:{marginLeft:"auto"},contentContainer:{flex:1,flexDirection:"row",justifyContent:"center",maxWidth:e>900?"100%":900,alignSelf:"center",width:"100%",overflow:"hidden",height:"100%",display:"flex",marginTop:0,paddingTop:0},mainSection:{flex:1,display:"flex",flexDirection:"column",maxWidth:e<=900?"100%":"70%",alignSelf:e<=900?"stretch":"flex-start",width:e<=900?"100%":"auto",height:"100%",marginTop:0,paddingTop:0},conversationListContainer:{width:e<=900?"100%":"30%",maxWidth:e<900?"":600,backgroundColor:m.theme.colors.surfaceContrast,overflow:"auto"},conversationItem:{padding:16,maxWidth:e<900?"":600,width:"100%",borderBottomWidth:1,borderBottomColor:m.theme.colors.border,flexDirection:"row",alignItems:"center"},conversationProfilePhoto:{width:40,height:40,borderRadius:20,marginRight:12},conversationProfilePhotoFallback:{width:40,height:40,borderRadius:20,marginRight:12,backgroundColor:m.theme.colors.background,justifyContent:"center",alignItems:"center"},conversationContent:{flex:1},selectedConversation:{backgroundColor:m.theme.colors.primary+"20",borderLeftWidth:3,borderLeftColor:m.theme.colors.primary},conversationName:{fontSize:16,fontFamily:m.theme.fonts.header.fontFamily,flex:1},messageSection:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden",paddingHorizontal:5,backgroundColor:m.theme.colors.surface,paddingBottom:0,position:"relative"},messageHeader:Object.assign({padding:12,backgroundColor:m.theme.colors.surfaceContrast,width:"100%",flexDirection:"row",alignItems:"center",zIndex:1},e<=900?{position:"sticky",top:0}:{}),profilePhoto:{width:40,height:40,borderRadius:20,marginRight:12},messageHeaderName:{fontSize:18,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},mobileProfilePhotoContainer:{alignItems:"center",justifyContent:"center",marginBottom:8},mobileProfilePhoto:{width:60,height:60,borderRadius:30},mobileProfilePhotoFallback:{width:60,height:60,borderRadius:30,backgroundColor:m.theme.colors.background,justifyContent:"center",alignItems:"center"},messagesContainer:Object.assign({flex:1,overflow:"auto",width:"100%"},e<=900?{WebkitOverflowScrolling:"touch"}:{}),messageList:{width:"100%",paddingBottom:16},fullWidthMessage:{width:"100%",alignSelf:"center",paddingHorizontal:8},textInput:{flex:1,backgroundColor:m.theme.colors.background,borderRadius:20,paddingHorizontal:16,paddingVertical:8,marginRight:8,marginLeft:8,fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},sendButton:{width:40,height:40,borderRadius:20,justifyContent:"center",alignItems:"center",marginRight:8,paddingHorizontal:0,paddingVertical:0},sendButtonMobile:{width:32,height:32,borderRadius:16,paddingHorizontal:0,paddingVertical:0,marginHorizontal:0,minWidth:0},sendButtonActive:{backgroundColor:m.theme.colors.primary},sendButtonInactive:{backgroundColor:m.theme.colors.border},webInput:{flex:1,backgroundColor:m.theme.colors.surface,borderRadius:20,paddingHorizontal:20,paddingVertical:8,marginHorizontal:8,fontSize:18,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,maxHeight:120,minHeight:20,borderWidth:1,borderColor:m.theme.colors.border},input:{flex:1,backgroundColor:m.theme.colors.surface,borderRadius:20,paddingHorizontal:20,paddingVertical:8,marginHorizontal:8,fontSize:18,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,borderWidth:1,borderColor:m.theme.colors.border,minHeight:20},inputSection:Object.assign({width:"100%",padding:8,backgroundColor:m.theme.colors.surfaceContrast,zIndex:10},e<=900?{position:"relative",bottom:0,left:0,right:0,paddingTop:8,paddingBottom:8,shadowColor:"#000",shadowOffset:{width:0,height:-1},shadowOpacity:.1,shadowRadius:3,elevation:3}:{}),inputContainerOuter:{width:"100%",flexDirection:"column"},inputContainer:{flexDirection:"row",alignItems:"center",width:"100%"},attachButtonContainer:{marginRight:8},attachButton:{padding:8,backgroundColor:m.theme.colors.surfaceContrast,borderRadius:20,width:40,height:40,justifyContent:"center",alignItems:"center"},inputInnerContainer:{flex:1,flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surfaceContrast,borderRadius:20,marginRight:0},dropdownMenu:{position:"absolute",bottom:"100%",left:0,backgroundColor:m.theme.colors.surface,borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:-2},shadowOpacity:.25,shadowRadius:3.84,elevation:5,marginBottom:8,minWidth:150,borderWidth:1,borderColor:m.theme.colors.border},dropdownItem:{padding:12,flexDirection:"row",alignItems:"center"},dropdownText:{color:m.theme.colors.text,fontSize:14,marginLeft:8,fontFamily:m.theme.fonts.regular.fontFamily},messageCard:{maxWidth:e>900?"40%":"75%",borderRadius:12,overflow:"hidden"},messageContent:{paddingHorizontal:8,paddingVertical:4},sentMessage:{alignSelf:"flex-end",backgroundColor:m.theme.colors.primary},receivedMessage:{alignSelf:"flex-start",backgroundColor:m.theme.colors.receivedMessage},messageText:{fontSize:20,lineHeight:20,fontFamily:m.theme.fonts.regular.fontFamily},sentMessageContainer:{alignItems:"flex-end"},receivedMessageContainer:{alignItems:"flex-start",marginBottom:4},sentMessageText:{color:m.theme.colors.whiteText},receivedMessageText:{color:m.theme.colors.text},messageTimestampContainer:{paddingHorizontal:4,marginBottom:2,marginTop:8},sentMessageTimestamp:{alignSelf:"flex-end",marginRight:4,marginBottom:2},receivedMessageTimestamp:{alignSelf:"flex-start",marginLeft:4,marginBottom:2},messageTimestampText:{fontSize:12,color:m.theme.colors.placeholder,fontFamily:m.theme.fonts.regular.fontFamily},searchContainer:{padding:16,backgroundColor:m.theme.colors.surfaceContrast},searchInputContainer:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surface,borderRadius:20,paddingHorizontal:12,marginVertical:6,height:40,borderWidth:1,borderColor:m.theme.colors.border},searchIcon:{marginRight:8},clearButton:{padding:4},searchInput:Object.assign({flex:1,height:"100%",fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},{WebkitTapHighlightColor:"transparent",WebkitAppearance:"none"}),conversationHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:6,width:"100%"},conversationTime:{fontSize:12,color:m.theme.colors.placeholder},conversationLastMessageContainer:{flexDirection:"row",alignItems:"center",width:"100%",marginBottom:6},conversationLastMessage:{fontSize:14,color:m.theme.colors.placeholder,flex:1,fontFamily:m.theme.fonts.regular.fontFamily},unreadMessage:{color:m.theme.colors.text,fontWeight:"bold"},bookingStatusContainer:{backgroundColor:m.theme.colors.primary+"20",padding:4,borderRadius:4,alignSelf:"flex-start",marginTop:2},bookingStatus:{fontSize:12,color:m.theme.colors.primary,fontFamily:m.theme.fonts.regular.fontFamily},activeConversationText:{color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},unreadBadge:{backgroundColor:m.theme.colors.error,borderRadius:10,minWidth:18,height:18,justifyContent:"center",alignItems:"center",paddingHorizontal:4,marginLeft:8,alignSelf:"flex-start"},unreadBadgeText:{color:"white",fontSize:11,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},mobileHeader:{width:"100%",borderBottomWidth:1,borderBottomColor:m.theme.colors.border,position:"sticky",top:0,zIndex:10,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:3,backgroundColor:m.theme.colors.surfaceContrast,marginTop:0,paddingTop:0},mobileHeaderContent:{flexDirection:"row",alignItems:"center",justifyContent:"center",position:"relative",paddingVertical:16,paddingHorizontal:8,width:"100%",minHeight:60},mobileHeaderName:{fontSize:18,fontWeight:"bold",color:m.theme.colors.text,textAlign:"center",fontFamily:m.theme.fonts.header.fontFamily,flexWrap:"wrap"},mobileHeaderNameContainer:{flexDirection:"column",alignItems:"center",justifyContent:"center",flexWrap:"wrap",paddingHorizontal:30},backArrow:{position:"absolute",left:16,zIndex:10,padding:8},editDraftButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surface,paddingHorizontal:12,paddingVertical:6,borderRadius:16,marginLeft:"auto",borderWidth:1,borderColor:m.theme.colors.primary},editDraftText:{marginLeft:4,color:m.theme.colors.primary,fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily},mobileEditDraftButton:{marginRight:10,paddingHorizontal:8,paddingVertical:4,borderRadius:12,borderWidth:1,borderColor:m.theme.colors.primary,backgroundColor:m.theme.colors.surface,minWidth:55,alignSelf:"flex-start"},messageHeaderContent:{flexDirection:"row",alignItems:"center",flex:1},headerDropdownMenu:{position:"absolute",top:"100%",right:16,backgroundColor:m.theme.colors.surface,borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5,marginTop:4,minWidth:180,borderWidth:1,borderColor:m.theme.colors.border,zIndex:1e3},headerDropdownItem:{padding:12,flexDirection:"row",alignItems:"center"},headerDropdownText:{color:m.theme.colors.text,fontSize:14,marginLeft:8,fontFamily:m.theme.fonts.regular.fontFamily},createBookingContainer:{position:"absolute",top:8,left:0,right:0,paddingHorizontal:16,alignItems:"center",zIndex:10,pointerEvents:"box-none"},createBookingHangingButton:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surface,paddingHorizontal:e<=600?12:16,paddingVertical:e<=600?8:10,borderRadius:20,borderWidth:1,borderColor:m.theme.colors.primary,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3,width:"50%",justifyContent:"center"},createBookingHangingText:{marginLeft:8,color:m.theme.colors.primary,fontSize:e<=600?14:16,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingText:{marginTop:12,color:m.theme.colors.placeholder,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},emptyText:{padding:16,color:m.theme.colors.placeholder,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center"},loadingMore:{padding:16},mobileMessageView:{flex:1,display:"flex",flexDirection:"column",height:"100%",marginTop:0,position:"absolute",top:0,left:0,right:0,bottom:0},mobileContainer:{flex:1,display:"flex",flexDirection:"column",height:"100%"},selectedImagesWrapper:{width:"100%",marginBottom:8,marginTop:4,borderBottomWidth:1,borderBottomColor:"#ECECEC",paddingBottom:8},selectedImagesScrollView:{width:"100%",maxHeight:100},selectedImagesContainer:{flexDirection:"row",alignItems:"center",paddingVertical:4},selectedImageContainer:{position:"relative",marginRight:8,borderRadius:8,overflow:"hidden",borderWidth:1,borderColor:"#ECECEC"},selectedImagePreview:{width:80,height:80,borderRadius:8},removeImageButton:{position:"absolute",top:4,right:4,backgroundColor:"rgba(255, 255, 255, 0.8)",borderRadius:12,width:24,height:24,alignItems:"center",justifyContent:"center"},uploadingOverlay:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.3)",alignItems:"center",justifyContent:"center"},messageImage:{width:250,height:250,borderRadius:8,resizeMode:"cover"},messageImagesContainer:{width:"100%",flexDirection:"column",alignItems:"center",justifyContent:"center",marginVertical:8}}))(s,l),y=()=>window.innerWidth,[v,w]=(0,n.useState)(!0),[C,T]=(0,n.useState)(!1),[B,k]=(0,n.useState)(!1),[_,I]=(0,n.useState)(!1),[M,L]=(0,n.useState)(null),[R,D]=(0,n.useState)(null),{isImageViewerVisible:z,selectedImageUrl:P,handleImagePress:F,closeImageViewer:W}=(()=>{const[e,t]=(0,n.useState)(!1),[o,r]=(0,n.useState)(null);return{isImageViewerVisible:e,selectedImageUrl:o,handleImagePress:e=>{(0,h.debugLog)("MBA7654: Image pressed",{imageUrl:e}),e?(r(e),t(!0)):(0,h.debugLog)("MBA7654: No image URL provided, cannot open viewer")},closeImageViewer:()=>{(0,h.debugLog)("MBA7654: Closing image viewer"),t(!1)}}})(),[O,N]=(0,n.useState)([]),[H,U]=(0,n.useState)(!1),[V,q]=(0,n.useState)(!1),[Y,G]=(0,n.useState)(!1),{is_DEBUG:J,is_prototype:$,userRole:K,timeSettings:Z}=(0,n.useContext)(h.AuthContext),[X,Q]=(0,n.useState)([]),[ee,te]=(0,n.useState)([]),oe=(0,n.useRef)(!1),[re,ae]=(0,n.useState)(!1),[ie,se]=(0,n.useState)(!0),[le,de]=(0,n.useState)(1),[ce,ue]=(0,n.useState)(!1),ge=(0,n.useRef)(s),[me,he]=((0,n.useRef)(!1),(0,n.useState)(!0)),fe=(0,n.useRef)(!0),[pe,ye]=(0,n.useState)(!1),[be,xe]=(0,n.useState)(null),[ve,we]=(0,n.useState)(""),[Ce,Se]=(0,n.useState)(!1),[je,Te]=(0,n.useState)(null),[Be,ke]=(0,n.useState)(!1),[Ae,Ie]=(0,n.useState)("disconnected"),{resetNotifications:Me,updateRoute:Le,markConversationAsRead:Re,getConversationUnreadCount:De}=(0,n.useContext)(f.default),[ze,Pe]=(0,n.useState)(!1),Fe=E(),Ee=(0,n.useRef)(!1),We=(0,n.useRef)(!1),Oe=(0,n.useRef)(!1),Ne=(0,n.useRef)(null),He=(0,n.useRef)(null),Ve=(0,n.useRef)(!1),qe=(0,n.useRef)(new Set),Ye=(0,n.useRef)(new Set),Ge=(0,n.useRef)(!1),Je=(0,n.useRef)(new Set),$e=(0,n.useRef)(null),Ke=(0,n.useRef)(0);Ke.current++,(0,h.debugLog)("MBA9876: [COMPONENT] MessageHistory render #"+Ke.current,{timestamp:Date.now(),selectedConversation:M,isSignedIn:d,loading:c,screenWidth:s,routeParams:t.params}),(0,n.useEffect)((()=>{d||((0,h.debugLog)("MBA9999: User signed out, resetting MessageHistory state"),Q([]),N([]),L(null),D(null),Se(!1),Te(null),We.current=!1,He.current=null,qe.current.clear(),Ye.current.clear(),fe.current=!0,he(!0),Ge.current=!1,Je.current.clear())}),[d]),(0,n.useEffect)((()=>{d&&((0,h.debugLog)("MBA9999: User role changed, refreshing conversations",{userRole:K}),L(null),D(null),N([]),We.current=!1,He.current=null,(0,h.debugLog)("MBA24u45vn: Refetching conversations for the new role"),ht())}),[K,d]);const Ze=(0,n.useCallback)((e=>{(0,h.debugLog)("MBA9876: WebSocket message received:",{type:e.type,conversationId:e.conversation_id,messageId:e.message_id,selectedConversation:M,currentMessageCount:O.length});try{if(!e||!e.message_id&&!e.conversation_id&&!e.type)return void(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Invalid message data received");if("user_status_update"===e.type&&e.user_id){(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: [OTHER USER STATUS] Received online status update for user ID:",e.user_id);const t=String(e.user_id),o=!!e.is_online;if((0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: [OTHER USER STATUS] Processing status change for user ".concat(t,", online=").concat(o)),Q((e=>{(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: [OTHER USER STATUS] Checking ".concat(e.length," conversations for user ").concat(t));const n=e.map((e=>{const n=e.participant1_id?String(e.participant1_id):"",r=e.participant2_id?String(e.participant2_id):"";return t===n||t===r?((0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: [OTHER USER STATUS] Found match in conversation ".concat(e.conversation_id,", setting other_participant_online=").concat(o)),Object.assign({},e,{other_participant_online:o})):e})),r=n.filter(((t,o)=>t.other_participant_online!==e[o].other_participant_online)).length;return(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: [OTHER USER STATUS] Updated ".concat(r," conversations with new status for user ").concat(t)),n})),R){const e=R.participant1_id?String(R.participant1_id):"",n=R.participant2_id?String(R.participant2_id):"";t!==e&&t!==n||((0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: [OTHER USER STATUS] Updating selected conversation with online status: ".concat(o," for user ").concat(t)),D((e=>Object.assign({},e,{other_participant_online:o}))))}return}M&&e.conversation_id&&String(e.conversation_id)===String(M)?((0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Message is for current conversation, adding to list"),N((t=>{(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Before adding WebSocket message:",{currentMessageCount:t.length,newMessageId:e.message_id,newMessageContent:e.content?.substring(0,50)});if(t.some((t=>{if(t.message_id&&e.message_id&&String(t.message_id)===String(e.message_id))return(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Duplicate detected by ID"),!0;if(t.content===e.content&&t.sent_by_other_user===e.sent_by_other_user){if(!t.timestamp||!e.timestamp)return(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Duplicate detected by content+sender"),!0;if(Math.abs(new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime())<5e3)return(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Duplicate detected by content+timestamp"),!0}return!(!t._isOptimistic||t.content!==e.content||e.sent_by_other_user)&&((0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Found matching optimistic message, replacing"),!0)}))){if((0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Message already exists in the list, skipping"),e.message_id){const o=t.map((t=>t._isOptimistic&&t.content===e.content&&!e.sent_by_other_user?Object.assign({},e,{_wasOptimistic:!0}):t));return(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Updated optimistic message with real data"),o}return t}(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Adding new message to list:",{messageId:e.message_id,messageLength:t.length,newMessageLength:t.length+1});const o=[e,...t];return(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Messages array updated via WebSocket:",{oldLength:t.length,newLength:o.length,addedMessageId:e.message_id}),o})),e.message_id&&Ne.current&&e.sent_by_other_user&&((0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Marking message as read:",e.message_id),Ne.current(M,[e.message_id]))):e.conversation_id&&((0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Message is for another conversation, updating conversation list"),Q((t=>t.map((t=>String(t.conversation_id)===String(e.conversation_id)?Object.assign({},t,{last_message:e.content,last_message_time:e.timestamp,unread:!0}):t)))))}catch(zs){(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Error handling WebSocket message:",zs)}}),[M]),{isConnected:Xe,connectionStatus:Qe,markMessagesAsRead:et,reconnect:tt,disconnect:ot,simulateConnection:nt,isUsingFallback:rt}=Ir("message",Ze,{handlerId:"message-history"});(0,n.useEffect)((()=>{Ne.current=et}),[et]);(0,n.useCallback)((()=>{(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: [CONNECTION] User manually requested WebSocket reconnection"),"function"===typeof tt&&tt()}),[tt,R]);(0,n.useEffect)((()=>{Ie(Qe),window&&window.WebSocket&&(0,h.debugLog)("MBA3456: [MY CONNECTION] WebSocket connection status changed to ".concat(Qe),{isConnected:Xe,isUsingFallback:rt,userRole:K}),"connected"===Qe&&Xe||rt?(0,h.debugLog)("MBA3456: [MY CONNECTION] Connection fully verified as connected or using fallback",{userRole:K,selectedConversation:M?"ID: ".concat(M):"none"}):(0,h.debugLog)("MBA3456: [MY CONNECTION] Connection not fully verified, status and state mismatch",{connectionStatus:Qe,isConnected:Xe,userRole:K})}),[Qe,Xe,rt,K]),(0,n.useEffect)((()=>{const e=setTimeout((()=>{(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: [MY CONNECTION] Forcing reconnection on component mount"),"function"===typeof tt&&tt()}),1e3);return()=>clearTimeout(e)}),[tt]);const at=(0,n.useRef)(!1),it=(0,n.useRef)(window.innerWidth),st=(0,n.useRef)(0),lt=(0,n.useRef)(null),dt=(0,n.useRef)(!0),ct=(0,n.useRef)(0);(0,b.useFocusEffect)((0,n.useCallback)((()=>{(0,h.debugLog)("MBA24u45vn: MessageHistory screen focused"),dt.current=!0;const e=Date.now();return!fe.current&&X.length>0&&d&&e-ct.current>2e3?((0,h.debugLog)("MBA24u45vn: Returning to MessageHistory screen, refreshing conversations"),ct.current=e,ht()):(0,h.debugLog)("MBA24u45vn: Screen focused but not refreshing conversations",{isInitialLoad:fe.current,hasConversations:X.length>0,conversationsCount:X.length,isSignedIn:d,timeSinceLastRefresh:e-ct.current,minTimeBetweenRefresh:2e3}),()=>{(0,h.debugLog)("MBA24u45vn: MessageHistory screen blurred"),dt.current=!1}}),[X.length,d])),(0,n.useEffect)((()=>{M&&(lt.current={conversationId:M,conversationData:R})}),[M,R]),(0,n.useEffect)((()=>{const o=window.innerWidth,n=0!==it.current&&it.current!==o;if(it.current=window.innerWidth,n)return(0,h.debugLog)("MBA24u45vn","Detected resize event, preserving conversation",{oldWidth:it.current,newWidth:o,hasSelectedConversation:!!M,hasStoredConversation:!!lt.current}),void(!M&&lt.current?.conversationId&&((0,h.debugLog)("MBA24u45vn","Restoring conversation after resize",{conversationId:lt.current.conversationId}),"undefined"!==typeof gt&&(gt.current=!0,(0,h.debugLog)("MBA24u45vn","Marked selection as resize-triggered to prevent redundant fetches")),L(lt.current.conversationId),lt.current.conversationData&&D(lt.current.conversationData)));const r=Date.now();if(r-st.current<1e3)return void(0,h.debugLog)("MBA24u45vn","Initialization throttled - too frequent",{timeSinceLastInit:r-st.current,minRequiredTime:1e3});if(!d||c)return void(0,h.debugLog)("MBA1111 MessageHistory: User not signed in, skipping initialization");const a=fe.current,i=!fe.current&&0===X.length;if(!(a||i))return;if(at.current)return void(0,h.debugLog)("MBA24u45vn","Initialization already in progress, skipping duplicate call");st.current=r,(0,h.debugLog)("MBA1111 MessageHistory: Starting initialization for signed in user");return(async()=>{at.current=!0;try{fe.current=!1,t.params?.conversationId&&(0,h.debugLog)("MBA24u45vn","Processing route params in initializeData",{conversationId:t.params.conversationId,otherUserName:t.params.otherUserName,currentTime:Date.now()}),0===X.length&&(Q([]),N([]),L(null),D(null),w(!0),T(!1),de(1),se(!0),He.current=null);{const e=new URL(window.location.href),t=e.searchParams.get("selectedConversation"),o=t&&"null"!==t?t:null,n=e.searchParams.get("conversationId"),r=n&&"null"!==n?n:null,a=o||r;if((0,h.debugLog)("MBA24u45vn","Checking URL parameters on initialization",{url:window.location.href,rawSelectedConversationId:t,selectedConversationId:o,rawUrlConversationId:n,urlConversationId:r,conversationToLoad:a,hasSelectedConversation:!!M,timestamp:Date.now()}),a){(0,h.debugLog)("MBA24u45vn","Processing valid conversation ID from URL",{conversationId:a,source:o?"selectedConversation":"conversationId",timestamp:Date.now()}),(0,h.debugLog)("MBA24u45vn: Fetching conversations for URL conversation ID");const e=await ht();if(!(e&&Array.isArray(e)&&e.length>0)){(0,h.debugLog)("MBA24u45vn","No conversations data available yet, keeping URL parameters",{conversationId:a,conversationsData:e?"empty array":"null/undefined"}),L(a),window.selectedConversationId=a;const t=new URL(window.location.href),o=["selectedConversation"];return[...t.searchParams.keys()].filter((e=>!o.includes(e))).forEach((e=>{t.searchParams.delete(e)})),window.history.replaceState({},"",t.toString()),void(0,h.debugLog)("MBA24u45vn","Cleaned up other URL parameters but preserved selectedConversation")}{const t=e.find((e=>e.conversation_id===a));if(t){(0,h.debugLog)("MBA24u45vn","Found conversation from URL in data",{conversation_id:t.conversation_id,other_user_name:t.other_user_name,has_profile_pic:!!t.profile_picture}),L(a),D(t),window.selectedConversationId=a;const e=new URL(window.location.href),o=["selectedConversation"];return[...e.searchParams.keys()].filter((e=>!o.includes(e))).forEach((t=>{e.searchParams.delete(t)})),e.searchParams.set("selectedConversation",a),window.history.replaceState({},"",e.toString()),(0,h.debugLog)("MBA24u45vn","Updated URL to preserve selectedConversation",{newUrl:e.toString()}),void ft(a)}{(0,h.debugLog)("MBA24u45vn","Conversation from URL NOT found in conversations data",{conversationId:a,conversationsCount:e.length,availableIds:e.map((e=>e.conversation_id))});const t=new URL(window.location.href);t.searchParams.delete("selectedConversation"),t.searchParams.delete("conversationId"),window.history.replaceState({},"",t.toString()),(0,h.debugLog)("MBA24u45vn","Cleared invalid conversation parameters from URL")}}}else{const e=new URL(window.location.href);if(e.searchParams.toString().length>0){r||n||([...e.searchParams.keys()].forEach((t=>{e.searchParams.delete(t)})),window.history.replaceState({},"",e.toString()),(0,h.debugLog)("MBA24u45vn","Cleared all URL parameters - no valid conversation found"))}}}if(t.params?.conversationId){Ee.current=!0,!0===t.params.isProfessional&&(Oe.current=!0,(0,h.debugLog)("MBA9999: Will open booking creation after data loads")),(0,h.debugLog)("MBA24u45vn: Fetching conversations from initializeData in route.params?.conversationId");await ht();return L(t.params.conversationId),void e.setParams({messageId:null,conversationId:null,otherUserName:null,isProfessional:null,clientId:null})}if(X.length>0&&!fe.current){(0,h.debugLog)("MBA24u45vn: Refreshing existing conversations on re-initialization");const e=await ht();return void(s>900&&e?.length>0&&!M&&(L(e[0].conversation_id),D(e[0])))}(0,h.debugLog)("MBA24u45vn About to fetch conversations for normal initialization");const o=(await ht()).filter((e=>"professional"===K?!0===e.is_professional:"petOwner"!==K||!1===e.is_professional));if(s>900&&o.length>0){const e=[...o].sort(((e,t)=>{const o=e.last_message_time?new Date(e.last_message_time).getTime():0;return(t.last_message_time?new Date(t.last_message_time).getTime():0)-o}));(0,h.debugLog)("MBA3456: Auto-selecting most recent conversation on initialization",{conversation_id:e[0].conversation_id,role:K}),L(e[0].conversation_id),D(e[0])}}catch(zs){console.error("Error in initialization:",zs),fe.current=!0}finally{he(!1),Ee.current=!1,at.current=!1}})(),()=>{(0,h.debugLog)("MBA9999: Component unmounting - cleaning up"),Q([]),N([]),L(null),D(null),fe.current=!0,he(!0),Ee.current=!1,We.current=!1,Oe.current=!1,He.current=null,Ge.current=!1,Je.current.clear();{window.selectedConversationId=null;const e=new URL(window.location.href);(e.searchParams.has("selectedConversation")||e.searchParams.has("conversationId"))&&(e.searchParams.delete("selectedConversation"),e.searchParams.delete("conversationId"),window.history.replaceState({},"",e.toString()),(0,h.debugLog)("MBA4477: Cleared URL params on component unmount"))}e&&e.setParams&&(e.setParams({selectedConversation:void 0}),(0,h.debugLog)("MBA4477: Cleared navigation params on component unmount"))}}),[d,c,K,s]),(0,n.useEffect)((()=>{Oe.current&&R&&We.current&&d&&(J&&console.log("MBA98765 Conversation data and messages loaded, triggering booking creation",{conversationId:R.conversation_id,isProfessional:R.is_professional,hasDraft:Ce,draftData:je?"exists":"none"}),Oe.current=!1,setTimeout((()=>{pt()}),300))}),[R,We.current,Ce,je,d]);const ut=(0,n.useRef)(0),gt=(0,n.useRef)(!1);(0,n.useEffect)((()=>{if(!M||!d)return void(0,h.debugLog)("MBA98765 Skipping conversation data update - no conversation or not signed in");gt.current&&((0,h.debugLog)("MBA24u45vn: Skipping fetch for resize-triggered selection change",{conversationId:M}),gt.current=!1);const e=X.find((e=>e.conversation_id===M));if(e)(0,h.debugLog)("MBA98765 Updating selected conversation data:",{conversation_id:e.conversation_id,is_professional:e.is_professional,other_user_name:e.other_user_name}),D(e);else{(0,h.debugLog)("MBA98765 Selected conversation not found in conversations list");const e=Date.now(),t=1e3;if(e-ut.current<t)return void(0,h.debugLog)("MBA24u45vn: Throttled conversation fetch - too frequent",{timeSinceLastFetch:e-ut.current,conversationId:M});ut.current=e,(0,h.debugLog)("MBA24u45vn: Fetching conversations from useEffect in selectedConversation"),ht()}}),[M,X,d]),(0,n.useEffect)((()=>{M&&d?We.current&&He.current===M||((0,h.debugLog)("MBA98765 Fetching messages for conversation:",M),ft(M,1),We.current=!0,He.current=M):(0,h.debugLog)("MBA98765 Skipping message fetch - no conversation selected or not signed in")}),[M,d]),(0,n.useEffect)((()=>{if(!d)return;const e=ge.current;e<=900&&s>900||e>900&&s<=900?(J&&console.log("MBA98765 Screen width threshold crossed:",{prev:e,current:s,crossedFrom:e<=900?"mobile":"desktop",crossedTo:s<=900?"mobile":"desktop"}),ge.current=s,e<=900&&s>900&&X.length>0&&!M&&(J&&console.log("MBA98765 Auto-selecting first conversation when crossing to desktop"),L(X[0].conversation_id))):ge.current=s}),[s,d]);const mt=(0,n.useRef)(y());(0,n.useEffect)((()=>{if(!X||0===X.length)return;const e=s>900,t=mt.current>900,o=X.length<20;o&&(0,h.debugLog)("MBA3456: Filtering conversations by role",{currentRole:K,totalConversations:X.length,screenWidth:s,isDesktopView:e});const n=X.filter((e=>"professional"===K?!0===e.is_professional:"petOwner"!==K&&"owner"!==K||!1===e.is_professional));o&&(0,h.debugLog)("MBA3456: Filtered conversations result",{originalCount:X.length,filteredCount:n.length,currentRole:K}),te(n);const r=e&&!t,a=e&&!M;if(r||a)if(n.length>0){if(!(M&&n.some((e=>e.conversation_id===M)))){const e=[...n].sort(((e,t)=>{const o=e.last_message_time?new Date(e.last_message_time).getTime():0;return(t.last_message_time?new Date(t.last_message_time).getTime():0)-o}));e.length>0&&((0,h.debugLog)("MBA3456: Auto-selecting most recent conversation after role filter",{conversation_id:e[0].conversation_id,justCrossedToDesktop:r,needsInitialSelection:a}),L(e[0].conversation_id),D(e[0]))}}else L(null),D(null);mt.current=s}),[X,K,M,s]),(0,n.useEffect)((()=>{if(!X||0===X.length)return;const e=X.filter((e=>"professional"===K?!0===e.is_professional:"petOwner"!==K||!1===e.is_professional));if(""===ve.trim())te(e);else{const t=ve.trim().toLowerCase(),o=e.filter((e=>e.other_user_name&&e.other_user_name.toLowerCase().includes(t)));te(o),(0,h.debugLog)("MBA3456: Search filtered conversations",{roleFilteredCount:e.length,searchFilteredCount:o.length,searchQuery:ve.trim()})}}),[ve,X,K]),(0,n.useEffect)((()=>{if(X.length>0&&M&&d){const e=X.find((e=>e.conversation_id===M));if(e)(0,h.debugLog)("MBA24u45vn","Validated preserved selectedConversation from URL",{conversationId:M,conversationName:e.other_user_name,isFound:!0}),R||D(e),We.current&&He.current===M||((0,h.debugLog)("MBA24u45vn","Loading messages for validated preserved conversation"),ft(M,1),We.current=!0,He.current=M);else{(0,h.debugLog)("MBA24u45vn","Preserved selectedConversation not found in loaded conversations",{conversationId:M,totalConversations:X.length,availableIds:X.map((e=>e.conversation_id))});{const e=new URL(window.location.href);e.searchParams.has("selectedConversation")&&(e.searchParams.delete("selectedConversation"),window.history.replaceState({},"",e.toString()),(0,h.debugLog)("MBA24u45vn","Cleared invalid selectedConversation from URL")),window.selectedConversationId=null}L(null),D(null)}}}),[X,M,d,R]);const ht=async()=>{const o=(new Error).stack,n=e.getState()?.routes?.[e.getState()?.index],r=n?.name,a=n?.params;if((0,h.debugLog)("MBA24u45vn","fetchConversations called",{stack:o.split("\n")[2],selectedConversation:M,hasExistingConversations:X.length>0,routeName:r,screenParams:JSON.stringify(a),routeParams:t.params?JSON.stringify(t.params):"none",timestamp:Date.now()}),Ge.current)return(0,h.debugLog)("MBA24u45vn","Conversations fetch already in progress, skipping duplicate call",{caller:o.split("\n")[2],currentlySelected:M}),X;try{Ge.current=!0,w(!0),(0,h.debugLog)("MBA24u45vn","Making API call to fetch conversations",{userRole:K,isSignedIn:d,selectedConversation:M,current_url:window.location.href,caller:o.split("\n")[2]});const e=await(0,bt.getConversations)();if(t.params?.conversationId){const o=e.find((e=>e.conversation_id===t.params.conversationId));(0,h.debugLog)("MBA24u45vn","Checking for new conversation in API response",{conversationId:t.params.conversationId,found:!!o,total_conversations:e.length})}if(e&&Array.isArray(e)){if((0,h.debugLog)("MBA24u45vn","Conversations API response received",{count:e.length,userRole:K,route_params:t.params?JSON.stringify(t.params):"none",current_url:window.location.href,conversations:e.map((e=>({conversation_id:e.conversation_id,is_professional:e.is_professional,other_user_name:e.other_user_name,has_profile_pic:!!e.profile_picture})))}),t.params?.conversationId){const o=e.find((e=>e.conversation_id===t.params.conversationId));o?(0,h.debugLog)("MBA24u45vn","Found conversation in API response matching route params",{conversation_id:o.conversation_id,other_user_name:o.other_user_name,has_profile_pic:!!o.profile_picture,is_selected:M===o.conversation_id}):(0,h.debugLog)("MBA24u45vn","Conversation from route params NOT found in API response",{conversation_id:t.params.conversationId,total_conversations:e.length})}Q(e);const o=e.filter((e=>"professional"===K?!0===e.is_professional:"petOwner"!==K&&"owner"!==K||!1===e.is_professional));if((0,h.debugLog)("MBA3456: Filtered conversations by role:",{originalCount:e.length,filteredCount:o.length,userRole:K,filteredConversations:o.map((e=>({id:e.conversation_id,is_professional:e.is_professional,name:e.other_user_name})))}),te(o),M){const e=o.find((e=>e.conversation_id===M));e?D(e):(L(null),D(null),(0,h.debugLog)("MBA3456: Clearing selected conversation - not valid for current role",{selectedConversation:M,userRole:K}))}return e}return(0,h.debugLog)("MBA3456: Invalid conversations data structure:",e),[]}catch(zs){return(0,h.debugLog)("MBA3456: Error fetching conversations:",zs),[]}finally{w(!1),Ge.current=!1}},ft=async(e,o=1)=>{if(!e)return void(0,h.debugLog)("MBA24u45vn","No conversation ID provided for message fetch");if((0,h.debugLog)("MBA24u45vn","fetchMessages called",{conversationId:e,page:o,stack:(new Error).stack.split("\n")[2],routeParams:t.params?JSON.stringify(t.params):"none",url:window.location.href,selectedConversation:M,hasConversationData:!!R,timestamp:Date.now()}),X.length>0){if(!X.some((t=>{const o=t.conversation_id===e;let n=!1;return"professional"===K?n=!0===t.is_professional:"petOwner"!==K&&"owner"!==K||(n=!1===t.is_professional),(0,h.debugLog)("MBA3456: Validating conversation for role",{conversationId:e,userRole:K,conversation_is_professional:t.is_professional,matchesId:o,matchesRole:n,valid:o&&n}),o&&n}))){if((0,h.debugLog)("MBA3456: Attempted to fetch messages for conversation not valid for current role",{conversationId:e,userRole:K,fromRouteParams:t.params?.conversationId===e,allConversations:X.map((e=>({id:e.conversation_id,is_professional:e.is_professional})))}),t.params?.conversationId!==e)return N([]),L(null),void D(null);(0,h.debugLog)("MBA3456: Conversation from route params, attempting to fetch messages anyway")}}else(0,h.debugLog)("MBA3456: No conversations in state yet, skipping role validation");const n="".concat(e,"-").concat(o);if(Je.current.has(n))(0,h.debugLog)("MBA98765 Messages fetch already in progress for conversation:",e,"page:",o,"- skipping duplicate call");else try{Je.current.add(n),(0,h.debugLog)("MBA98765 Fetching messages for conversation:",e,"page:",o),1===o&&(N([]),Se(!1),Te(null),qe.current.clear(),Ye.current.clear(),de(1)),o>1?(ue(!0),Ve.current=!0):T(!0);const t=await(0,bt.getConversationMessages)(e,o);if(!t)return void(0,h.debugLog)("MBA1111 fetchMessages: No data returned, possible auth issue");if(t&&Array.isArray(t.messages)){const n=t.messages;(0,h.debugLog)("MBA24u45vn","Messages API response received",{conversationId:e,page:o,count:n.length,has_more:!!t.has_more,has_draft:!!t.has_draft,isPagination:o>1,url:window.location.href,timestamp:Date.now()}),t.has_draft&&(Se(!0),Te(t.draft_data),(0,h.debugLog)("MBA98765 Draft data found:",t.draft_data)),N(1===o?n:e=>{const t=new Set(e.map((e=>e.message_id))),o=n.filter((e=>!t.has(e.message_id))),r=[...e,...o];return(0,h.debugLog)("MBA98765 Combined messages for pagination:",{previous:e.length,newUnique:o.length,combined:r.length}),r}),se(!!t.has_more),de(o),qe.current.add(o),n.forEach((e=>{e.message_id&&Ye.current.add(e.message_id)})),(0,h.debugLog)("MBA98765 Message fetch completed for conversation:",e)}else(0,h.debugLog)("MBA98765 Invalid message data structure:",t)}catch(zs){console.error("Error fetching messages:",zs),(0,h.debugLog)("MBA98765 Error in fetchMessages:",zs)}finally{ue(!1),T(!1),setTimeout((()=>{Ve.current=!1}),500),Je.current.delete(n)}},pt=async()=>{if(J&&console.log("MBA98765 handleCreateBooking:",{selectedConversationData:R,selectedConversation:M,isProfessional:R?.is_professional,hasDraft:Ce,draftData:je}),!R){(0,h.debugLog)("MBA24u45vn: No conversation data found, Fetching conversations from handleCreateBooking"),await ht();const e=X.find((e=>e.conversation_id===M));if(!e)return void console.log("MBA98765 Still no conversation data after refresh");D(e),(0,h.debugLog)("MBA24u45vn: Conversation data found in handleCreateBooking",{updatedConversation:e})}const e=!0===R.is_professional;J&&console.log("MBA98765 Is Professional?",e),G(!1),e?(J&&console.log("MBA98765 User is professional - checking for existing draft",{hasDraft:Ce,draftData:je}),Ce&&je?ke(!0):await yt()):(console.log("MBA98765 User is owner - showing request modal"),q(!0))},yt=async()=>{try{const e=await(0,h.getStorage)("userToken"),t=await x.default.post("".concat(p.API_BASE_URL,"/api/bookings/v1/create/"),{conversation_id:M},{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});J&&console.log("MBA98765 Create draft response:",t.data),await ft(M,1),t.data.draft_id&&(xe(t.data.draft_id),setTimeout((()=>{ye(!0)}),100))}catch(zs){console.error("Error creating draft:",zs),Et.default.alert("Error","Unable to create draft. Please try again.")}},xt=(0,n.useCallback)((()=>{if((0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: loadMoreMessages called",{hasMore:ie,isLoadingMore:ce,isLoadingMoreRef:Ve.current,currentPage:le,selectedConversation:M,messagesLength:O.length}),!M)return void(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: No conversation selected, cannot load more messages");const e=Ve.current||ce,t=qe.current.has(le+1);return!ie||e||t?((0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Not loading more messages - conditions not met",{hasMore:ie,isLoadingMoreRefCurrent:Ve.current,isLoadingMore:ce,selectedConversation:!!M,nextPageProcessed:t,reasonText:ie?e?"already loading messages":t?"page already processed":"unknown":"no more messages"}),!1):((0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Starting pagination load for page ".concat(le+1),{hasMore:ie,isAlreadyLoading:e,nextPageAlreadyProcessed:t,currentPage:le}),Ve.current=!0,ue(!0),ft(M,le+1),setTimeout((()=>{Ve.current&&((0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Resetting stuck loading state after timeout"),Ve.current=!1,ue(!1))}),5e3),!0)}),[ie,le,M,O.length,ce]),vt=(0,n.useCallback)((async()=>{M&&((0,h.debugLog)("MBA9999: Refreshing messages for conversation:",M),await ft(M,1))}),[M,ft]),wt=(0,n.useCallback)((({item:t,index:o})=>{const n=(e=>{const t={};return e.forEach((e=>{if(e.metadata&&e.metadata.booking_id){const o=e.metadata.booking_id;t[o]||(t[o]=[]),t[o].push({messageId:e.message_id,type:e.type_of_message,timestamp:new Date(e.created_at||e.timestamp),message:e})}})),Object.keys(t).forEach((e=>{t[e].sort(((e,t)=>t.timestamp-e.timestamp))})),t})(O),i=O.filter((e=>"booking_confirmed"===e.type_of_message)).map((e=>e.metadata?.booking_id)).filter(Boolean),s=O.filter((e=>"booking_confirmed"===e.type_of_message&&e.metadata?.is_review_request||"request_review"===e.type_of_message)).map((e=>e.metadata?.booking_id)).filter(Boolean),l=t.metadata?.booking_id&&s.includes(t.metadata.booking_id);if("request_review"===t.type_of_message||"booking_confirmed"===t.type_of_message&&(t.metadata?.is_review_request||t.metadata?.client_review||t.metadata?.professional_review))return(0,h.debugLog)("MBA8675309: Rendering review request message:",{messageId:t.message_id,content:t.content,metadata:t.metadata,bookingId:t.metadata?.booking_id,isProfessional:R?.is_professional,sender:t.sender}),(0,j.jsx)(r.default,{style:u.fullWidthMessage,children:(0,j.jsx)(ca,{data:Object.assign({},t.metadata,{booking_id:t.metadata?.booking_id,service_type:t.metadata?.service_type}),isProfessional:R?.is_professional,conversationId:M,navigation:e,onPress:e=>{"leaveReview"===e&&Et.default.alert("Review","Review functionality will be implemented soon")}})});const d=o<O.length-1?O[o+1]:null,c=qr(t,d,0===o),g=t.timestamp?Ur(t.timestamp,Z?.timezone||"America/Denver"):"";"send_approved_message"!==t.type_of_message&&"request_changes"!==t.type_of_message&&"initial_booking_request"!==t.type_of_message&&"booking_confirmed"!==t.type_of_message||(0,h.debugLog)("MBA6677: Booking message timestamp details",{messageId:t.message_id,messageType:t.type_of_message,timestamp:t.timestamp,formattedTime:g,timezone:Z?.timezone||"America/Denver"});const m=t.image_urls&&t.image_urls.length>0,f=!m&&t.image_url&&t.image_url.length>0,p="image_message"===t.type_of_message,y=p&&!m&&!f&&t.image_url,b={};i.forEach((e=>{const t=O.filter((t=>t.metadata?.booking_id===e)).sort(((e,t)=>new Date(t.timestamp)-new Date(e.timestamp))),o=t.find((e=>"booking_confirmed"===e.type_of_message));if(o){const n=new Date(o.timestamp),r=t.filter((e=>"send_approved_message"===e.type_of_message&&new Date(e.timestamp)>n));r.length>0&&(b[e]=!0,(0,h.debugLog)("MBA6428: Detected booking update for confirmed booking:",{bookingId:e,confirmationTime:n,newerApprovalRequests:r.map((e=>e.message_id))}))}}));t.metadata?.booking_id&&O.some((e=>"request_changes"===e.type_of_message&&e.metadata?.booking_id===t.metadata.booking_id));const x=t.metadata?.booking_id&&i.includes(t.metadata.booking_id),v=t.metadata?.booking_id&&b[t.metadata.booking_id];let w=!1,C=new Date(t.created_at||t.timestamp);if(t.metadata?.booking_id&&n[t.metadata.booking_id]){const e=n[t.metadata.booking_id];w=e.length>0&&e[0].messageId===t.message_id,(0,h.debugLog)("MBA7321: Message ".concat(t.message_id," for booking ").concat(t.metadata.booking_id," isNewestMessage: ").concat(w))}if("initial_booking_request"===t.type_of_message||"send_approved_message"===t.type_of_message){const o=!t.sent_by_other_user,n=t.metadata?.booking_id,a=n&&O.some((e=>"request_changes"===e.type_of_message&&e.metadata?.booking_id===n)),i="send_approved_message"===t.type_of_message,s=x?"Confirmed":t.metadata?.booking_status,d=i&&x&&n&&O.some((e=>"booking_confirmed"===e.type_of_message&&e.metadata?.booking_id===n&&new Date(e.timestamp)<new Date(t.timestamp))),g=d&&n&&O.some((e=>"request_changes"===e.type_of_message&&e.metadata?.booking_id===n&&new Date(e.timestamp)>new Date(t.timestamp)));d&&(0,h.debugLog)("MBA6428: Detected approval request for already confirmed booking:",{messageId:t.message_id,bookingId:n,isApprovalMessage:i,bookingIsConfirmed:x,isUpdateToConfirmedBooking:d,hasNewerRequestChanges:g});const m=R?.is_professional&&("initial_booking_request"===t.type_of_message||"send_approved_message"===t.type_of_message&&a);m&&(0,h.debugLog)("MBA6428: Showing edit draft button for message:",{messageId:t.message_id,bookingId:n,type:t.type_of_message});let f="0.00";try{t.metadata.cost_summary&&t.metadata.cost_summary.total_client_cost&&(f=t.metadata.cost_summary.total_client_cost)}catch(zs){console.error("Error parsing total cost:",zs)}return(0,j.jsxs)(r.default,{children:[(0,j.jsx)(aa,{message:t,isFromMe:o,styles:u,userTimezone:Z?.timezone||"America/Denver",show:c}),(0,j.jsx)(Tr,{type:"initial_booking_request"===t.type_of_message?"request":"approval",displayType:d?"booking_update":void 0,data:Object.assign({},t.metadata,{booking_id:t.metadata.booking_id,service_type:t.metadata.service_type,total_owner_cost:f,occurrences:t.metadata.occurrences||[]}),isFromMe:o,onPress:()=>{t.metadata.booking_id&&e.navigate("BookingDetails",{bookingId:t.metadata.booking_id,from:"MessageHistory"})},isProfessional:R?.is_professional,onApproveSuccess:e=>{e&&e.status&&(Et.default.alert("Success","Booking approved successfully"),(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Refreshing messages after approval success"),ft(M,1))},onApproveError:e=>{Et.default.alert("Error",e||"Failed to approve booking")},onEditDraft:m?()=>{(0,h.debugLog)("MBA6428: Edit Draft button clicked, calling handleEditDraft with bookingId:",n),Tt(n)}:void 0,bookingStatus:s,hasChangeRequest:a||g,isNewestMessage:w,messageCreatedAt:C,isAfterConfirmation:d,isBookingCompleted:l})]})}if("request_changes"===t.type_of_message){const o=!t.sent_by_other_user,n=t.metadata?.booking_id,a=t.metadata?.service_type,i=x?"Confirmed":t.metadata?.booking_status;let s=w;if(!s&&"request_changes"===t.type_of_message&&n){const e=O.some((e=>"send_approved_message"===e.type_of_message&&e.metadata?.booking_id===n&&new Date(e.timestamp)>new Date(t.timestamp)));s=!e,(0,h.debugLog)("MBA4321: Checking if request_changes is effectively newest:",{messageId:t.message_id,originalIsNewest:w,hasNewerApprovals:e,effectivelyNewest:s})}const d=x&&n&&O.some((e=>("send_approved_message"===e.type_of_message||"booking_confirmed"===e.type_of_message)&&e.metadata?.booking_id===n));return(0,h.debugLog)("MBA4321: Rendering change request message:",{bookingId:n,isFromMe:o,content:t.content,metadata:t.metadata,isNewestMessage:w,isNewestChangeRequest:s,isConfirmed:x,isRelatedToUpdate:d,hasOlderBookingConfirmedMessage:O.some((e=>"booking_confirmed"===e.type_of_message&&e.metadata?.booking_id===n&&new Date(e.timestamp)<new Date(t.timestamp))),hasOlderApprovalMessage:O.some((e=>"send_approved_message"===e.type_of_message&&e.metadata?.booking_id===n&&new Date(e.timestamp)<new Date(t.timestamp)))}),(0,j.jsxs)(r.default,{children:[(0,j.jsx)(aa,{message:t,isFromMe:o,styles:u,userTimezone:Z?.timezone||"America/Denver",show:c}),(0,j.jsx)(Tr,{type:"request_changes",data:Object.assign({},t.metadata,{booking_id:n,service_type:a,cost_summary:t.metadata?.cost_summary||{},occurrences:t.metadata?.occurrences||[],content:t.content}),isFromMe:o,onPress:()=>{n&&e.navigate("BookingDetails",{bookingId:n,from:"MessageHistory"})},isProfessional:R?.is_professional,onApproveSuccess:e=>{e&&e.status&&(Et.default.alert("Success","Changes handled successfully"),(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Refreshing messages after change approval"),ft(M,1))},onApproveError:e=>{Et.default.alert("Error",e||"Failed to process changes")},onEditDraft:R?.is_professional?()=>{Tt(n)}:void 0,bookingStatus:i,hasChangeRequest:!1,isNewestMessage:s,messageCreatedAt:C,isAfterConfirmation:d,isBookingCompleted:l})]})}if("booking_confirmed"===t.type_of_message){const o=!t.sent_by_other_user,n=t.metadata?.booking_id,a=t.metadata?.service_type;let i="0.00",s="0.00";try{t.metadata.cost_summary&&(i=t.metadata.cost_summary.total_client_cost||"0.00",s=t.metadata.cost_summary.total_sitter_payout||"0.00")}catch(zs){console.error("Error parsing cost data:",zs)}return(0,h.debugLog)("MBA6428: Rendering booking confirmation message:",{bookingId:n,isFromMe:o,metadata:t.metadata,totalCost:i,payout:s,hasNewerApprovalRequests:v}),(0,j.jsxs)(r.default,{children:[(0,j.jsx)(aa,{message:t,isFromMe:o,styles:u,userTimezone:Z?.timezone||"America/Denver",show:c}),(0,j.jsx)(Tr,{type:"booking_confirmed",data:{booking_id:n,service_type:a,cost_summary:{total_client_cost:i,total_sitter_payout:s}},isFromMe:o,onPress:()=>{n&&e.navigate("BookingDetails",{bookingId:n,from:"MessageHistory"})},isProfessional:R?.is_professional,bookingStatus:"Confirmed",isNewestMessage:w,messageCreatedAt:C,onEditDraft:R?.is_professional?()=>{(0,h.debugLog)("MBA6428: Edit Draft button clicked for confirmed booking with bookingId:",n),Tt(n)}:void 0,hasNewerApprovalRequests:v,isBookingCompleted:l,onMarkCompletedSuccess:e=>{(0,h.debugLog)("MBA8675309: Booking marked as completed successfully:",e),Et.default.alert("Success","Booking marked as completed successfully"),ft(M,1)},onMarkCompletedError:e=>{(0,h.debugLog)("MBA8675309: Error marking booking as completed:",e),Et.default.alert("Error",e||"Failed to mark booking as completed")}})]})}const S=t.metadata&&!0===t.metadata.is_attachment;if(S)return null;if(p||m||f||y){const e=!t.sent_by_other_user;return(0,j.jsxs)(r.default,{children:[(0,j.jsx)(aa,{message:t,isFromMe:e,styles:u,userTimezone:Z?.timezone||"America/Denver",show:c}),(0,j.jsx)(r.default,{style:e?u.sentMessageContainer:u.receivedMessageContainer,children:(0,j.jsx)(r.default,{style:[u.messageCard,{backgroundColor:"transparent",shadowColor:"transparent"}],children:(0,j.jsxs)(r.default,{style:u.messageContent,children:[m&&(0,j.jsx)(r.default,{style:{flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%"},children:t.image_urls.map(((e,t)=>(0,j.jsx)(Fr,{imageUrl:e,onPress:F,style:{image:{width:250,height:250,borderRadius:8}}},"".concat(e,"-").concat(t))))}),!m&&t.metadata&&t.metadata.image_urls&&t.metadata.image_urls.length>0&&(0,j.jsx)(r.default,{style:{flexDirection:"column",alignItems:"center",justifyContent:"center",marginVertical:8,width:"100%"},children:t.metadata.image_urls.map(((e,t)=>(0,j.jsx)(Fr,{imageUrl:e,onPress:F,style:{image:{width:250,height:250,borderRadius:8,marginVertical:4}}},"".concat(e,"-").concat(t))))}),t.image&&t.image.url&&(0,j.jsx)(r.default,{style:{flexDirection:"column",alignItems:"center",justifyContent:"center",marginVertical:8,width:"100%"},children:(0,j.jsx)(Fr,{imageUrl:t.image.url,onPress:F,style:{image:{width:250,height:250,borderRadius:8,marginVertical:4}}})}),(f||y)&&(0,j.jsx)(r.default,{style:{flexDirection:"column",alignItems:"center",justifyContent:"center",marginVertical:8,width:"100%"},children:(0,j.jsx)(Fr,{imageUrl:t.image_url,onPress:F,style:{image:{width:250,height:250,borderRadius:8,marginVertical:4}}})}),S&&t.image_url&&(0,j.jsx)(r.default,{style:{flexDirection:"column",alignItems:"center",justifyContent:"center",marginVertical:8,width:"100%"},children:(0,j.jsx)(Fr,{imageUrl:t.image_url,onPress:F,style:{image:{width:250,height:250,borderRadius:8,marginVertical:4}}})})]})})}),t.content&&t.content.trim().length>0&&(0,j.jsx)(r.default,{style:[e?u.sentMessageContainer:u.receivedMessageContainer],children:(0,j.jsx)(r.default,{style:[u.messageCard,e?u.sentMessage:u.receivedMessage],children:(0,j.jsx)(r.default,{style:u.messageContent,children:(0,j.jsx)(a.default,{style:[u.messageText,e?u.sentMessageText:u.receivedMessageText],children:t.content})})})})]})}const T=!t.sent_by_other_user;return(0,j.jsxs)(r.default,{children:[(0,j.jsx)(aa,{message:t,isFromMe:T,styles:u,userTimezone:Z?.timezone||"America/Denver",show:c}),(0,j.jsx)(r.default,{style:T?u.sentMessageContainer:u.receivedMessageContainer,children:(0,j.jsx)(r.default,{style:[u.messageCard,T?u.sentMessage:u.receivedMessage],children:(0,j.jsx)(r.default,{style:u.messageContent,children:(0,j.jsx)(a.default,{style:[u.messageText,T?u.sentMessageText:u.receivedMessageText],children:t.content})})})})]})}),[e,R,Z,Ce,je,M,ft,O,F]);(0,n.useEffect)((()=>{if(ve){const e=X.filter((e=>((e.participant1_id===_e?e.participant2_name:e.participant1_name)||e.name||e.other_user_name||"").toLowerCase().includes(ve.toLowerCase())||e.last_message&&e.last_message.toLowerCase().includes(ve.toLowerCase())));te(e)}else te(X);(0,h.debugLog)("MBA5557: Filtering conversations based on search",{searchQuery:ve,totalConversations:X.length,filteredCount:ee.length})}),[ve,X]);const Ct=()=>{const o="professional"===K?ee.filter((e=>!0===e.is_professional)):"petOwner"===K||"owner"===K?ee.filter((e=>!1===e.is_professional)):ee;return(0,h.debugLog)("MBA24u45vn","Rendering conversation list",{filteredConversationsCount:ee.length,safeConversationsCount:o.length,conversationsCount:X.length,currentRole:K,selectedConversation:M,url:window.location.href,routeParams:t.params?JSON.stringify(t.params):"none",timestamp:Date.now(),filteredConversations:o.map((e=>({id:e.conversation_id,is_professional:e.is_professional,name:e.other_user_name,has_profile_pic:!!e.profile_picture})))}),(0,j.jsx)(Qr,{conversations:o,selectedConversation:M,onSelectConversation:t=>{if(t!==M){(0,h.debugLog)("MBA24u45vn","Conversation selected from list",{conversationId:t,previousConversation:M,url:window.location.href,timestamp:Date.now()}),ft(t);{window.selectedConversationId=t;const e=new URL(window.location.href);e.searchParams.set("selectedConversation",t),window.history.replaceState({},"",e.toString())}e.setParams({selectedConversation:t})}L(t)},searchQuery:ve,onSearchChange:we,styles:u,CURRENT_USER_ID:_e,getConversationUnreadCount:De,markConversationAsRead:Re})},St=()=>M?(0,j.jsxs)(qo.default,{style:u.mainSection,behavior:"height",keyboardVerticalOffset:0,children:[s>900&&(0,j.jsx)(r.default,{style:u.messageHeader,children:(0,j.jsx)(oa,{selectedConversationData:R,hasDraft:Ce,draftData:je,onEditDraft:e=>{e&&Bt(e)},styles:u,onCreateBooking:pt,onViewPets:kt})}),(0,j.jsx)(r.default,{style:u.messageSection,className:"message-container",children:(0,j.jsx)(r.default,{style:u.messagesContainer,className:"messagesContainer",children:C?(0,j.jsxs)(r.default,{style:u.loadingContainer,children:[(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:u.loadingText,children:"Loading messages..."})]}):0===O.length?(0,j.jsx)(a.default,{style:u.emptyText,children:"No messages yet, start the conversation!"}):(0,j.jsx)(Zr,{conversationId:M,messages:O,renderMessage:wt,hasMore:ie,isLoadingMore:ce,onLoadMore:xt,onRefreshMessages:vt,isProfessional:R?.is_professional,styles:u,theme:m.theme,className:"message-list-component",userTimezone:Z?.timezone||"America/Denver",onScrollStart:e=>{e((()=>{$e.current&&((0,h.debugLog)("MBA8765: Scroll detected, calling keyboard dismiss handler"),$e.current())}))}})})}),(0,j.jsx)(ta,{onScrollStart:e=>{$e.current=e,(0,h.debugLog)("MBA8765: Registered keyboard dismiss handler from MessageInput")},onSendMessage:async(e,t,o,n)=>{try{if(H)return void(0,h.debugLog)("MBA5511: Send operation already in progress in parent, ignoring duplicate call");U(!0),n&&o?((0,h.debugLog)("MBA5511: Message already sent directly:",{messageId:o.message_id,messageType:o.type_of_message}),N((e=>[o,...e])),Q((e=>e.map((e=>e.conversation_id===M?Object.assign({},e,{last_message:o.content||"Image message",last_message_time:o.timestamp}):e))))):(t&&t.length>0&&(0,h.debugLog)("MBA5678: Sending message with images:",{messageContent:e,imageMessageIds:t,imageCount:t.length}),await(async(e,t=[],o=null)=>{try{if((0,h.debugLog)("MBA2u3f89fbno4: [API] SendNormalMessage called",{messageContentLength:e?.length,messageContentPreview:e?.substring(0,50),selectedConversation:M,hasSelectedConversation:!!M,selectedConversationType:typeof M,hasImageMessageIds:t&&t.length>0,imageMessageIds:t,imageCount:t?.length||0,hasMessageObject:!!o,isImageMessage:"image_message"===o?.type_of_message,currentMessageCount:O.length,timestamp:Date.now()}),!M)throw new Error("No conversation selected");if(o)return(0,h.debugLog)("MBA5511: Using pre-created message object:",{messageId:o.message_id,type:o.type_of_message,hasImageUrls:!!o.image_urls&&o.image_urls.length>0,imageCount:o.image_urls?.length||0}),N((e=>((0,h.debugLog)("MBA5511: Adding message object directly to list",{beforeLength:e.length,afterLength:e.length+1,newMessageId:o.message_id}),[o,...e]))),Q((e=>e.map((e=>e.conversation_id===M?Object.assign({},e,{last_message:o.content||"Image message",last_message_time:o.timestamp}):e)))),o;if((!t||0===t.length)&&(!e||!e.trim()))throw new Error("Message content is empty and no images provided");(0,h.debugLog)("MBA2u3f89fbno4: [API] Sending message with content and/or images",{hasContent:!!e&&e.trim().length>0,hasImages:t&&t.length>0,imageCount:t?.length||0});const n=await(0,h.getStorage)("userToken"),r={conversation_id:M,content:e?e.trim():""};t&&t.length>0&&(r.image_message_ids=t),(0,h.debugLog)("MBA2u3f89fbno4: [API] About to send API request",{requestData:r,apiUrl:"".concat(p.API_BASE_URL,"/api/messages/v1/send_norm_message/"),hasToken:!!n,timestamp:Date.now()});const a=await x.default.post("".concat(p.API_BASE_URL,"/api/messages/v1/send_norm_message/"),r,{headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}});return(0,h.debugLog)("MBA2u3f89fbno4: [API] Message sent successfully",{messageId:a.data.message_id,timestamp:a.data.timestamp,responseStatus:a.status,responseData:a.data}),N((e=>((0,h.debugLog)("MBA2u3f89fbno4: [API] Adding sent message to list",{beforeLength:e.length,afterLength:e.length+1,newMessageId:a.data.message_id}),[a.data,...e]))),Q((t=>t.map((t=>t.conversation_id===M?Object.assign({},t,{last_message:e,last_message_time:a.data.timestamp}):t)))),(0,h.debugLog)("MBA2u3f89fbno4: [API] SendNormalMessage completed successfully"),a.data}catch(zs){if((0,h.debugLog)("MBA2u3f89fbno4: [API] Error in SendNormalMessage",{errorMessage:zs.message,errorResponse:zs.response?.data,errorStatus:zs.response?.status,requestedConversationId:M,requestedMessageContent:e?.substring(0,50),timestamp:Date.now()}),zs.response&&zs.response.data){const e=zs.response.data;"Cannot send messages to a deleted user account."===e.error?Fe({message:e.detail||"This user has deleted their account and is no longer receiving messages.",type:"error",duration:4e3}):e.error?Fe({message:e.error,type:"error",duration:3e3}):e.detail&&Fe({message:e.detail,type:"error",duration:3e3})}else Fe({message:"Failed to send message. Please check your connection and try again.",type:"error",duration:3e3});throw console.error("Error sending message:",zs),zs}})(e,t,o)),U(!1)}catch(zs){(0,h.debugLog)("MBA5678: Error sending message:",zs),U(!1)}},onShowDropdown:e=>G(e),showDropdown:Y,styles:u,screenWidth:s,selectedConversation:M})]}):null,jt=()=>{M&&(0,h.debugLog)("MBA24u45vn","Back button pressed",{selectedConversation:M,hasConversationData:!!R,url:window.location.href,timestamp:Date.now()}),oe.current=!0,e.setParams({selectedConversation:void 0});{const e=new URL(window.location.href);e.searchParams.delete("selectedConversation"),e.searchParams.delete("conversationId"),window.history.replaceState({},"",e.toString()),window.selectedConversationId=null,(0,h.debugLog)("MBA24u45vn","Cleared URL parameters in handleBack",{oldValue:M,url_after:e.toString(),timestamp:Date.now()})}L(null),D(null),N([]),(0,h.debugLog)("MBA24u45vn: Fetching conversations from handleBack"),ht(),setTimeout((()=>{oe.current&&(oe.current=!1)}),500)},Tt=async e=>{if((0,h.debugLog)("MBA6428: handleEditDraft called with booking ID:",e),!e)return(0,h.debugLog)("MBA6428: Error - No booking ID provided"),void Et.default.alert("Error","Missing booking information. Please try again.");try{k(!0),(0,h.debugLog)("MBA6428: Calling createDraftFromBooking API with booking ID:",e);const t=await(0,bt.createDraftFromBooking)(e);if(t.error)return(0,h.debugLog)("MBA6428: Error returned from createDraftFromBooking:",t),void Et.default.alert("Error",t.message||"Failed to create draft from booking. Please try again.");t&&t.draft_id?((0,h.debugLog)("MBA6428: Draft created successfully:",t),Se(!0),Te(t.draft_data),xe(t.draft_id),ke(!1),setTimeout((()=>{(0,h.debugLog)("MBA6428: Opening BookingStepModal with draft:",t.draft_id),ye(!0)}),100)):((0,h.debugLog)("MBA6428: Error - Invalid response from createDraftFromBooking:",t),Et.default.alert("Error","Failed to create draft from booking. Please try again."))}catch(zs){(0,h.debugLog)("MBA6428: Error creating draft from booking:",zs),Et.default.alert("Error","Failed to create draft from booking. Please try again.")}finally{k(!1)}},Bt=e=>{if((0,h.debugLog)("MBA6428: handleOpenExistingDraft called with draft ID:",e),!e)return(0,h.debugLog)("MBA6428: Error - No draft ID provided"),void Et.default.alert("Error","Missing draft information. Please try again.");try{xe(e),ke(!1),setTimeout((()=>{(0,h.debugLog)("MBA6428: Opening BookingStepModal with existing draft:",e),ye(!0)}),100)}catch(zs){(0,h.debugLog)("MBA6428: Error opening booking modal with draft:",zs),Et.default.alert("Error","Failed to open booking draft. Please try again.")}};(0,n.useEffect)((()=>{if(!R||!M)return;const e=R.other_user_name||"Unknown user";return(0,h.debugLog)('MBA3210: [OTHER USER STATUS] Setting up polling for "'.concat(e,'" online status')),()=>{(0,h.debugLog)('MBA3210: [OTHER USER STATUS] Cleaning up polling interval for "'.concat(e,'"'))}}),[R,M]),(0,n.useEffect)((()=>()=>{(0,h.debugLog)("MBA3210: MessageHistory unmounting, cleaning up websocket references")}),[]),(0,n.useEffect)((()=>{const e=()=>{(0,h.debugLog)("MBA3210: Page unloading, but keeping websocket alive for session restore")};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[]),(0,n.useEffect)((()=>(Le&&Le("MessageHistory"),()=>{})),[]),(0,n.useEffect)((()=>(Le&&((0,h.debugLog)("MBA4321: Updating route in MessageNotificationContext to MessageHistory"),Le("MessageHistory")),()=>{(0,h.debugLog)("MBA4321: Cleaning up message notification tracking for MessageHistory")})),[Le]),(0,n.useEffect)((()=>{M&&Re&&((0,h.debugLog)("MBA4321: Marking conversation ".concat(M," as read")),Re(M))}),[M,Re]),(0,n.useEffect)((()=>{if(!fe.current)return;return(async()=>{try{Q([]),N([]),L(null),D(null),w(!0),T(!1),de(1),se(!0),He.current=null;let e=null;{const t=new URL(window.location.href);let o=t.searchParams.get("selectedConversation");o||(o=t.searchParams.get("conversationId")),o&&(e=o,(0,h.debugLog)("MBA4321: Using conversation ID ".concat(o," from URL parameters")),t.searchParams.delete("conversationId"),t.searchParams.delete("selectedConversation"),t.searchParams.set("selectedConversation",o),window.history.replaceState({},"",t.toString()))}!e&&t.params?.conversationId&&(e=t.params.conversationId,(0,h.debugLog)("MBA4321: Using conversation ID ".concat(e," from route parameters")),!0===t.params.isProfessional&&(Oe.current=!0)),(0,h.debugLog)("MBA24u45vn: Fetching conversations from initializeData");const o=await ht();e?(L(e),(0,h.debugLog)("MBA4321: Setting initially selected conversation to ".concat(e))):s>900&&o?.length>0&&(L(o[0].conversation_id),(0,h.debugLog)("MBA4321: Auto-selecting first conversation ".concat(o[0].conversation_id," on desktop")))}catch(zs){console.error("Error initializing MessageHistory:",zs)}finally{fe.current=!1,he(!1)}})(),()=>{(0,h.debugLog)("MBA4321: Cleaning up MessageHistory component"),He.current=null,window.selectedConversationId=null}}),[]),(0,n.useEffect)((()=>{{if(window.performance){const t=window.performance.getEntriesByType("navigation")[0];if(t&&"reload"===t.type){(0,h.debugLog)("MBA3210: Page reload detected, clearing conversation parameters from URL");const t=new URL(window.location.href);t.searchParams.has("selectedConversation")&&(t.searchParams.delete("selectedConversation"),(0,h.debugLog)("MBA3210: Removed selectedConversation parameter from URL")),t.searchParams.has("conversationId")&&(t.searchParams.delete("conversationId"),(0,h.debugLog)("MBA3210: Removed conversationId parameter from URL")),t.searchParams.has("isMobile")&&(t.searchParams.delete("isMobile"),(0,h.debugLog)("MBA3210: Removed isMobile parameter from URL")),window.history.replaceState({},"",t.toString()),(0,h.debugLog)("MBA3210: Updated URL:",t.toString()),L(null),D(null),window.selectedConversationId=null,e&&e.setParams&&e.setParams({selectedConversation:null,conversationId:null,isMobile:null})}}const t=()=>{(0,h.debugLog)("MBA3210: Page unloading, but keeping websocket alive for session restore")};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}}}),[e]),(0,n.useEffect)((()=>{M&&((0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Clearing processed messages cache for new conversation",{conversationId:M,previousCacheSize:qe.current.size,previousMessageIdsSize:Ye.current.size}),qe.current.clear(),Ye.current.clear(),Ve.current=!1,(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Cache cleared for conversation switch",{processedPagesSize:qe.current.size,messageIdsSize:Ye.current.size,isLoadingMoreRef:Ve.current}))}),[M]),(0,n.useEffect)((()=>{(0,h.debugLog)("MBA2u3f89fbno4: [STATE] selectedConversation changed",{newValue:M,timestamp:Date.now()});{const t=new URL(window.location.href);M?(t.searchParams.has("conversationId")&&t.searchParams.delete("conversationId"),t.searchParams.set("selectedConversation",M),window.selectedConversationId=M,(0,h.debugLog)("MBA4477: Updated URL with selectedConversation",{selectedConversation:M,newUrl:t.toString()})):(t.searchParams.has("conversationId")&&t.searchParams.delete("conversationId"),t.searchParams.has("selectedConversation")&&t.searchParams.delete("selectedConversation"),window.selectedConversationId=null,(0,h.debugLog)("MBA4477: Cleared conversation parameters from URL")),window.history.replaceState({},"",t.toString()),e&&e.setParams&&(e.setParams({selectedConversation:M}),(0,h.debugLog)("MBA4477: Updated navigation params with selectedConversation",{selectedConversation:M}))}}),[M,e]),(0,n.useEffect)((()=>{(0,h.debugLog)("MBA2u3f89fbno4: [STATE] isSignedIn changed",{newValue:d,timestamp:Date.now()})}),[d]),(0,n.useEffect)((()=>{(0,h.debugLog)("MBA2u3f89fbno4: [STATE] loading changed",{newValue:c,timestamp:Date.now()})}),[c]),(0,n.useEffect)((()=>{(0,h.debugLog)("MBA2u3f89fbno4: [STATE] screenWidth changed",{newValue:s,timestamp:Date.now()})}),[s]);const kt=()=>{(0,h.debugLog)("MBA3456","View Profile button clicked",{conversation_id:R?.conversation_id,other_user_name:R?.other_user_name}),Pe(!0)},At=()=>{setTimeout((()=>{const e=[".messagesContainer .message-list-component > div > div",".messagesContainer .message-list-component > div",'.messagesContainer div[data-interactable="true"]',".messagesContainer > *"];let t=!1;for(const n of e){const e=document.querySelectorAll(n);if(e&&e.length>0&&(e.forEach((e=>{e.style.cssText+="; padding-top: 300px !important; margin-top: 300px !important;",t=!0,(0,h.debugLog)("MBA9876: Added padding to element",{selector:n,element:e.tagName,childCount:e.childElementCount})})),t))break}if(!t){const e=document.querySelector(".messagesContainer");e&&(e.style.cssText+="; padding-bottom: 300px !important;")}const o=document.querySelector(".messagesContainer");o&&(o.scrollTop=0,(0,h.debugLog)("MBA9876: Forced scroll to top of message list"))}),100)};(0,n.useEffect)((()=>{if(!M)return;At();const e=setInterval(At,500);return()=>{clearInterval(e)}}),[M,O]),(0,n.useEffect)((()=>{if(!M)return;const e=()=>{const e=document.querySelector(".messagesContainer .message-list-component");if(!e)return;e.scrollTop=0;const t=e.querySelector("div > div");if(t){const e=window.getComputedStyle(t);(parseInt(e.paddingTop)||0)<300&&(t.style.paddingTop="300px",t.style.marginTop="300px",(0,h.debugLog)("MBA9876: Applied direct padding fix to FlatList content container",{element:"content container",paddingApplied:"300px",marginApplied:"300px"}))}e.querySelectorAll(":scope > div").forEach((e=>{const t=window.getComputedStyle(e);(parseInt(t.paddingTop)||0)<300&&(e.style.paddingTop="300px",e.style.marginTop="300px",(0,h.debugLog)("MBA9876: Applied padding to direct child",{child:e.className||e.tagName,paddingApplied:"300px",marginApplied:"300px"}))}))};O.length>0&&(e(),setTimeout(e,100),setTimeout(e,500))}),[O,M]);(0,n.useEffect)((()=>{const e=()=>{if(M&&re){const e=document.querySelector(".message-input-container");if(e){e.style.position="fixed",e.style.bottom="0",e.style.left="0",e.style.right="0",e.style.zIndex="1000",e.style.transform="translateZ(0)";const t=document.querySelector(".messagesContainer");t&&(t.style.paddingBottom="80px"),(0,h.debugLog)("MBA9876: [KEYBOARD] Applied keyboard adjustments")}if(document.activeElement&&"TEXTAREA"===document.activeElement.tagName){const e=document.querySelector(".messagesContainer");e&&(e.scrollTop=0)}}};return window.addEventListener("focusin",e),e(),()=>{window.removeEventListener("focusin",e)}}),[M,re]),(0,n.useLayoutEffect)((()=>{const e=document.createElement("style");return e.id="ios-message-fix-style",e.innerHTML="\n      /* Ensure proper message container height and scrolling */\n      .messagesContainer {\n        -webkit-overflow-scrolling: touch;\n        padding-bottom: 80px !important;\n      }\n      \n      /* Fix for inverted FlatList in Safari */\n      .message-list-component {\n        padding-bottom: 0 !important;\n        transform: translateZ(0);\n      }\n      \n      /* Make sure there's enough space at the bottom to not cut off messages */\n      .message-list-component > div > div {\n        padding-bottom: 100px !important;\n      }\n      \n      /* Fix for iOS keyboard issues */\n      .message-input-container {\n        transform: translateZ(0);\n        z-index: 1000;\n      }\n    ",document.head.appendChild(e),(0,h.debugLog)("MBA9876: Added iOS-compatible style fixes",{styleId:"ios-message-fix-style"}),()=>{const e=document.getElementById("ios-message-fix-style");e&&e.remove()}}),[]),(0,n.useLayoutEffect)((()=>{if(!M)return;const e=()=>{const e=document.querySelector(".messagesContainer");e&&(parseInt(e.style.paddingBottom||"0")<80&&(e.style.paddingBottom="80px"),e.style.WebkitOverflowScrolling="touch",(0,h.debugLog)("MBA9876: [iOS] Ensured message list has proper padding"))};e();const t=setTimeout(e,500);return()=>{clearTimeout(t)}}),[M]),(0,n.useEffect)((()=>{if(!M)return;const e=setTimeout((()=>{const e=document.querySelector(".messagesContainer");e&&(e.style.WebkitOverflowScrolling="touch",(0,h.debugLog)("MBA9876: [iOS] Applied smooth scrolling to message container"));const t=document.querySelector(".message-input-container");t&&(t.style.transform="translateZ(0)",(0,h.debugLog)("MBA9876: [iOS] Applied hardware acceleration to input container"))}),250);return()=>{clearTimeout(e)}}),[M]),(0,h.debugLog)("MBA3456: FINAL CHECK before rendering UI",{conversationsTotal:X.length,filteredTotal:ee.length,role:K,originalConversations:X.map((e=>({id:e.conversation_id,is_professional:e.is_professional}))),filteredConversations:ee.map((e=>({id:e.conversation_id,is_professional:e.is_professional})))});const _t="professional"===K?ee.filter((e=>!0===e.is_professional)):"petOwner"===K||"owner"===K?ee.filter((e=>!1===e.is_professional)):ee,It=(0,n.useRef)(null),Mt=(0,n.useRef)(y());(0,n.useEffect)((()=>{const t=()=>{It.current&&clearTimeout(It.current),It.current=setTimeout((()=>{if(M){const t=window.innerWidth,o=Mt.current,n=t<=900;n!==o<=900&&(e.setParams({selectedConversation:M,isMobile:n}),(0,h.debugLog)("MBA4477: Updated navigation params after crossing width threshold",{selectedConversation:M,previousWidth:o,currentWidth:t,isMobile:n}),Mt.current=t)}}),500)};return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t),It.current&&clearTimeout(It.current)}}),[M,e]),(0,n.useEffect)((()=>{const e=navigator.userAgent.toLowerCase(),t=(e.includes("brave")||navigator.brave&&navigator.brave.isBrave&&navigator.brave.isBrave.name,e.includes("duckduckgo"),e.includes("iphone")||e.includes("ipad")||e.includes("mobile")),o=document.createElement("style");return o.id="brave-duckduckgo-fix",o.innerHTML="\n      /* Target CSS fix specifically for mobile */\n      @media (max-width: 900px) {\n        /* Fix input container with !important flags to override browser styles */\n        .message-input-container, .inputSection {\n          background-color: #FFFFFF !important;\n          background: #FFFFFF !important;\n          border-top: 1px solid #ECECEC !important;\n          position: relative !important;\n          z-index: 999 !important;\n          bottom: 0 !important;\n          left: 0 !important;\n          right: 0 !important;\n          margin: 0 !important;\n          padding: 8px !important;\n        }\n        \n        /* Aggressively remove any translucent overlays */\n        .messagesContainer::after,\n        .inputSection::after,\n        .message-input-container::after,\n        .messagesContainer::before,\n        .inputSection::before,\n        .message-input-container::before,\n        .mainSection::after,\n        .mainSection::before {\n          display: none !important;\n          opacity: 0 !important;\n          content: none !important;\n          visibility: hidden !important;\n        }\n        \n        /* Force white background on containers */\n        html, body, #root, .mainSection, .messageSection, .messagesContainer {\n          background-color: #FFFFFF !important;\n        }\n        \n        /* Ensure message input stays on top */\n        .message-input-container textarea,\n        .message-input-container input {\n          position: relative !important;\n          z-index: 1000 !important;\n          opacity: 1 !important;\n          visibility: visible !important;\n        }\n      }\n    ",document.head.appendChild(o),t?(setTimeout((()=>{const e=()=>{const e=document.querySelector(".message-input-container");if(e){e.style.backgroundColor="#FFFFFF",e.style.position="relative",e.style.zIndex="999",e.style.borderTop="1px solid #ECECEC";const t=document.querySelector(".inputSection");t&&(t.style.backgroundColor="#FFFFFF",t.style.position="relative",t.style.zIndex="998")}const t=document.querySelector(".messagesContainer");t&&(t.style.backgroundColor="#FFFFFF")};e(),setTimeout(e,100),window.addEventListener("resize",e),window.addEventListener("orientationchange",e),document.addEventListener("focusin",(t=>{"TEXTAREA"!==t.target.tagName&&"INPUT"!==t.target.tagName||setTimeout(e,100)}))}),500),()=>{window.removeEventListener("resize",(()=>{})),window.removeEventListener("orientationchange",(()=>{})),document.removeEventListener("focusin",(()=>{}));const e=document.getElementById("brave-duckduckgo-fix");e&&e.remove()}):()=>{const e=document.getElementById("brave-duckduckgo-fix");e&&e.remove()}}),[]);const Lt=(0,n.useRef)(new Set);return(0,n.useEffect)((()=>{if(t.params?.conversationId){(0,h.debugLog)("MBA24u45vn","Route params detected",{conversationId:t.params.conversationId,otherUserName:t.params.otherUserName,timestamp:t.params._timestamp,has_fullConversationData:!!t.params.fullConversationData});const e=t.params._timestamp&&Date.now()-t.params._timestamp<1e4,o=!!t.params.fullConversationData,n=t.params._timestamp&&Lt.current.has(t.params._timestamp),r=void 0!==t.params.isMobile&&!e;(0,h.debugLog)("MBA24u45vn","Checking if we should fetch based on navigation source",{hasRecentTimestamp:e,isFromProfessionalModal:o,hasProcessedThisTimestamp:n,isScreenResizeEvent:r,currentTimestamp:Date.now(),navigationTimestamp:t.params._timestamp,isMobile:t.params.isMobile}),!e||!o||n||r||Ge.current||((0,h.debugLog)("MBA24u45vn","Triggering fetch based on navigation from ProfessionalServicesModal",{conversationId:t.params.conversationId,currentConversation:M,timestamp:Date.now()}),t.params._timestamp&&(Lt.current.add(t.params._timestamp),setTimeout((()=>{Lt.current.delete(t.params._timestamp)}),1e4)),L(t.params.conversationId),ht().then((e=>{e&&Array.isArray(e)&&((0,h.debugLog)("MBA24u45vn","Conversations fetched from ProfessionalServicesModal navigation",{conversationCount:e.length,conversationId:t.params.conversationId,found:!!e.find((e=>e.conversation_id===t.params.conversationId))}),ft(t.params.conversationId))})))}}),[t.params]),(0,j.jsxs)(r.default,{style:[u.container,s<=900&&M&&u.mobileContainer,{marginLeft:s>900?l?70:250:0}],children:[v?(0,j.jsxs)(r.default,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:[(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:{marginTop:16,color:m.theme.colors.placeholder},children:"Loading conversations..."})]}):_t.length>0?(0,j.jsx)(r.default,{style:u.contentContainer,children:s<=900?M?(0,j.jsxs)(r.default,{style:u.mobileMessageView,children:[(0,j.jsx)(r.default,{style:[u.mobileHeader,{backgroundColor:m.theme.colors.surfaceContrast,marginTop:M&&s<=900?0:void 0}],children:(0,j.jsx)(oa,{selectedConversationData:R,hasDraft:Ce,draftData:je,onEditDraft:e=>{e&&Bt(e)},onBackPress:jt,styles:u,isMobile:!0,onCreateBooking:pt,onViewPets:kt})}),St()]}):Ct():(0,j.jsxs)(j.Fragment,{children:[Ct(),St()]})}):(0,j.jsxs)(r.default,{style:{flex:1,justifyContent:"center",alignItems:"center",padding:20},children:[(0,j.jsx)(S.default,{name:"message-text-outline",color:m.theme.colors.placeholder,style:{marginBottom:16}}),(0,j.jsx)(a.default,{style:{fontSize:20,fontWeight:"bold",color:m.theme.colors.text,marginBottom:8,textAlign:"center"},children:"No Messages Yet"}),(0,j.jsx)(a.default,{style:{fontSize:16,color:m.theme.colors.placeholder,marginBottom:24,textAlign:"center"},children:"professional"===K?"Create services to start getting bookings and messages from owners":"Search professionals to find services and start messaging"}),(0,j.jsx)(Ue.default,{mode:"contained",onPress:()=>(0,g.navigateToFrom)(e,"professional"===K?"ServiceManager":"SearchProfessionalsListing","MessageHistory"),style:{borderRadius:8},children:"professional"===K?"Create Services":"Find Professionals"})]}),B&&(0,j.jsx)(r.default,{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.4)",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,j.jsxs)(r.default,{style:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:24,alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5},children:[(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:{marginTop:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},children:"Creating draft from booking..."})]})}),(0,j.jsx)(Sr,{visible:pe,onClose:()=>{ye(!1),xe(null),M&&((0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Refreshing message data after closing BookingStepModal"),ft(M,1))},navigation:e,bookingId:be,onComplete:e=>{if((0,h.debugLog)("MBA6428: Booking completed:",e),(0,h.debugLog)("MBA6428: New booking message:",e.message),(0,h.debugLog)("MBA6428: Message metadata:",e.message?.metadata),(0,h.debugLog)("MBA6428: Is this an update?",e.isUpdate),e.error)return Et.default.alert("Error",e.errorMessage||"Failed to process booking. Please try again."),ye(!1),xe(null),void(M&&((0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Refreshing message data after booking error"),ft(M,1)));if(e.message){(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Adding booking completion message to list",{messageId:e.message.message_id,currentMessageCount:O.length}),N((t=>{const o=[e.message,...t];return(0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Booking message added to list",{oldLength:t.length,newLength:o.length}),o}));const t=e.isUpdate?"Updated Booking Request":"Approval Request";Q((o=>o.map((o=>o.conversation_id===M?Object.assign({},o,{last_message:t,last_message_time:e.message.timestamp}):o))))}Se(!1),Te(null),ye(!1),xe(null),M&&((0,h.debugLog)("MBA2349f87g9qbh2nfv9cg: Refreshing message data after successful booking completion"),ft(M,1));const t=e.isUpdate?"Booking update request sent successfully!":"Booking request sent successfully!";Et.default.alert("Success",t)}}),(0,j.jsx)(ra,{visible:ze,onClose:()=>Pe(!1),conversation:{id:R?.conversation_id},otherUserProfilePhoto:R?.profile_picture,otherUserName:R?.other_user_name,onCreateBooking:pt}),(0,j.jsx)(Ar,{visible:Be,onClose:()=>ke(!1),onContinueExisting:()=>{J&&console.log("MBA98765 handleContinueExisting:",{draftData:je,showDraftConfirmModal:Be,showBookingStepModal:pe}),ke(!1),je?.draft_id?(xe(je.draft_id),setTimeout((()=>{J&&console.log("MBA98765 Opening BookingStepModal with draft:",je.draft_id),ye(!0)}),100)):console.error("MBA98765 No draft_id found in draftData:",je)},onCreateNew:async()=>{ke(!1),await yt()}}),(0,j.jsx)(zr,{visible:z,imageUrl:P,onClose:W})]})};o(15175);new class{socket=null;handlers=new Map;reconnectAttempts=0;maxReconnectAttempts=5;reconnectDelay=1e3;heartbeatInterval=null;isConnected=!1;connect(e){try{if(this.socket&&(this.socket.readyState===WebSocket.CONNECTING||this.socket.readyState===WebSocket.OPEN))return void(0,h.debugLog)("WebSocketUtils: Already connected or connecting");let t;(0,h.debugLog)("WebSocketUtils: Connecting to WebSocket");{const o="https:"===window?.location?.protocol?"wss:":"ws:",n=window?.location?.host||"localhost:8081";t="".concat(o,"//").concat(n,"/ws/?token=").concat(e)}this.socket=new WebSocket(t),this.socket.onopen=()=>{(0,h.debugLog)("WebSocketUtils: Connected to WebSocket"),this.isConnected=!0,this.reconnectAttempts=0,this.startHeartbeat()},this.socket.onmessage=e=>{try{const t=JSON.parse(e.data);this.handleMessage(t)}catch(zs){(0,h.debugLog)("WebSocketUtils: Error parsing message:",zs)}},this.socket.onclose=()=>{(0,h.debugLog)("WebSocketUtils: WebSocket closed"),this.isConnected=!1,this.stopHeartbeat(),this.attemptReconnect(e)},this.socket.onerror=e=>{(0,h.debugLog)("WebSocketUtils: WebSocket error:",e),this.isConnected=!1}}catch(zs){(0,h.debugLog)("WebSocketUtils: Error connecting to WebSocket:",zs)}}disconnect(){(0,h.debugLog)("WebSocketUtils: Disconnecting from WebSocket"),this.isConnected=!1,this.stopHeartbeat(),this.socket&&(this.socket.close(),this.socket=null),this.handlers.clear()}sendMessage(e){this.socket&&this.socket.readyState===WebSocket.OPEN?this.socket.send(JSON.stringify(e)):(0,h.debugLog)("WebSocketUtils: Cannot send message - WebSocket not connected")}registerHandler(e,t,o){return this.handlers.has(e)||this.handlers.set(e,new Map),this.handlers.get(e).set(o,t),(0,h.debugLog)("WebSocketUtils: Registered handler",{type:e,id:o}),()=>this.unregisterHandler(e,o)}unregisterHandler(e,t){const o=this.handlers.get(e);o&&(o.delete(t),0===o.size&&this.handlers.delete(e)),(0,h.debugLog)("WebSocketUtils: Unregistered handler",{type:e,id:t})}handleMessage(e){const{type:t,data:o}=e,n=this.handlers.get(t);n&&n.forEach((e=>{try{e(o)}catch(zs){(0,h.debugLog)("WebSocketUtils: Error in message handler:",zs)}}))}attemptReconnect(e){if(this.reconnectAttempts<this.maxReconnectAttempts){this.reconnectAttempts++;const t=this.reconnectDelay*Math.pow(2,this.reconnectAttempts-1);(0,h.debugLog)("WebSocketUtils: Attempting reconnect",{attempt:this.reconnectAttempts,delay:t}),setTimeout((()=>{this.connect(e)}),t)}else(0,h.debugLog)("WebSocketUtils: Max reconnection attempts reached")}startHeartbeat(){this.heartbeatInterval=setInterval((()=>{this.socket&&this.socket.readyState===WebSocket.OPEN&&this.sendMessage({type:"ping"})}),3e4)}stopHeartbeat(){this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}},new Map,new Map;o(82660);i.default.create({container:{flexDirection:"row",alignItems:"center",padding:16,backgroundColor:m.theme.colors.surfaceContrast,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},unreadContainer:{backgroundColor:m.theme.colors.surfaceContrast},avatarContainer:{position:"relative",marginRight:12},avatar:{width:48,height:48,borderRadius:24,backgroundColor:m.theme.colors.primaryLight,alignItems:"center",justifyContent:"center",borderWidth:2,borderColor:m.theme.colors.border},unreadAvatar:{backgroundColor:m.theme.colors.primary,borderColor:m.theme.colors.primary},unreadDot:{position:"absolute",top:-4,right:-4,backgroundColor:m.theme.colors.error,borderRadius:10,minWidth:20,height:20,alignItems:"center",justifyContent:"center",borderWidth:2,borderColor:m.theme.colors.surface},unreadDotText:{color:m.theme.colors.whiteText,fontSize:10,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},content:{flex:1},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:4},name:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,flex:1},unreadName:{fontWeight:"bold",color:m.theme.colors.primary},timestamp:{fontSize:12,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily},messageRow:{marginBottom:4},lastMessage:{fontSize:14,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily,lineHeight:18},unreadMessage:{color:m.theme.colors.text,fontWeight:"500"},statusRow:{flexDirection:"row",gap:8},statusBadge:{flexDirection:"row",alignItems:"center",gap:4,paddingHorizontal:6,paddingVertical:2,borderRadius:10,backgroundColor:m.theme.colors.successLight},draftBadge:{backgroundColor:m.theme.colors.warningLight},statusText:{fontSize:10,color:m.theme.colors.text,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily}}),i.default.create({container:{flex:1,backgroundColor:m.theme.colors.surfaceContrast},header:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingHorizontal:20,paddingVertical:16,backgroundColor:m.theme.colors.surfaceContrast,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},headerTitle:{fontSize:28,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},unreadBadge:{backgroundColor:m.theme.colors.primary,borderRadius:12,paddingHorizontal:8,paddingVertical:4,minWidth:24,alignItems:"center"},unreadText:{color:m.theme.colors.whiteText,fontSize:12,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},searchContainer:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.backgroundContrast,marginHorizontal:16,marginVertical:12,paddingHorizontal:16,paddingVertical:12,borderRadius:25,borderWidth:1,borderColor:m.theme.colors.border},searchInput:{flex:1,marginLeft:12,fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},conversationsList:{flex:1},separator:{height:1,backgroundColor:m.theme.colors.border,marginLeft:76},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",paddingHorizontal:32},emptyTitle:{fontSize:20,fontWeight:"600",color:m.theme.colors.text,marginTop:16,textAlign:"center",fontFamily:m.theme.fonts.header.fontFamily},emptySubtitle:{fontSize:16,color:m.theme.colors.placeHolderText,marginTop:8,textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",paddingHorizontal:32},loadingText:{marginTop:16,fontSize:16,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily}});o(78833);i.default.create({header:{flexDirection:"row",alignItems:"center",paddingHorizontal:16,paddingVertical:12,backgroundColor:m.theme.colors.surfaceContrast,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,elevation:4},backButton:{padding:8,marginRight:8},conversationInfo:{flex:1,marginRight:12},conversationName:{fontSize:18,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},connectionStatus:{fontSize:12,color:m.theme.colors.placeHolderText,marginTop:2,fontFamily:m.theme.fonts.regular.fontFamily},actionsButton:{padding:8},dropdownOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},dropdownContainer:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:12,width:"80%",maxWidth:300,paddingVertical:16,shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.3,shadowRadius:8,elevation:8},dropdownHeader:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingHorizontal:20,paddingBottom:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},dropdownTitle:{fontSize:18,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},dropdownCloseButton:{padding:4},dropdownAction:{flexDirection:"row",alignItems:"center",paddingHorizontal:20,paddingVertical:12,gap:16},dropdownActionText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,flex:1}}),i.default.create({container:{backgroundColor:m.theme.colors.surfaceContrast,borderTopWidth:1,borderTopColor:m.theme.colors.border,paddingBottom:8},imagePreviewContainer:{flexDirection:"row",paddingHorizontal:16,paddingTop:12,gap:12},imagePreview:{position:"relative",width:60,height:60,borderRadius:8,overflow:"hidden",marginRight:8},previewImage:{width:"100%",height:"100%"},removeImageButton:{position:"absolute",top:-5,right:-5,backgroundColor:"rgba(0,0,0,0.6)",borderRadius:10,width:20,height:20,justifyContent:"center",alignItems:"center"},inputRow:{flexDirection:"row",alignItems:"flex-end",paddingHorizontal:16,paddingVertical:12,gap:12},imageButton:{padding:8,borderRadius:20,backgroundColor:m.theme.colors.backgroundContrast,borderWidth:1,borderColor:m.theme.colors.border},textInputContainer:{flex:1,backgroundColor:m.theme.colors.backgroundContrast,borderRadius:20,borderWidth:1,borderColor:m.theme.colors.border,paddingHorizontal:16,paddingVertical:8,maxHeight:100},textInput:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,textAlignVertical:"top",minHeight:20},sendButton:{width:40,height:40,borderRadius:20,justifyContent:"center",alignItems:"center"},sendButtonActive:{backgroundColor:m.theme.colors.primary},sendButtonInactive:{backgroundColor:m.theme.colors.backgroundContrast,borderWidth:1,borderColor:m.theme.colors.border}}),i.default.create({container:{marginVertical:4,paddingHorizontal:8},ownContainer:{alignItems:"flex-end"},otherContainer:{alignItems:"flex-start"},bubble:{maxWidth:"80%",borderRadius:18,paddingHorizontal:12,paddingVertical:8,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},ownBubble:{backgroundColor:m.theme.colors.primary,borderBottomRightRadius:4},otherBubble:{backgroundColor:m.theme.colors.surfaceContrast,borderBottomLeftRadius:4},messageText:{fontSize:16,lineHeight:20,fontFamily:m.theme.fonts.regular.fontFamily},ownMessageText:{color:m.theme.colors.whiteText},otherMessageText:{color:m.theme.colors.text},metadata:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginTop:4,gap:8},timestamp:{fontSize:11,fontFamily:m.theme.fonts.regular.fontFamily},ownTimestamp:{color:m.theme.colors.whiteText,opacity:.8},otherTimestamp:{color:m.theme.colors.placeHolderText},statusIcons:{flexDirection:"row",alignItems:"center"},imageMessageContainer:{alignItems:"flex-end"},imageWrapper:{marginBottom:4,borderRadius:8,overflow:"hidden"},messageImage:{width:200,height:150,borderRadius:8},captionBubble:{maxWidth:"80%",borderRadius:18,paddingHorizontal:12,paddingVertical:8,marginTop:4,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},imageTimestamp:{marginTop:4,alignItems:"center"},ownImageTimestamp:{alignItems:"flex-end"},otherImageTimestamp:{alignItems:"flex-start"}}),i.default.create({container:{flex:1,backgroundColor:m.theme.colors.surfaceContrast},messagesContainer:{flex:1},messagesList:{flex:1},messagesContent:{paddingHorizontal:16,paddingTop:8,paddingBottom:16},dateSeparator:{alignItems:"center",marginVertical:16},dateSeparatorText:{fontSize:12,color:m.theme.colors.placeHolderText,backgroundColor:m.theme.colors.surface,paddingHorizontal:12,paddingVertical:4,borderRadius:12,fontFamily:m.theme.fonts.regular.fontFamily},loadingContainer:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingVertical:16,gap:8},loadingText:{fontSize:14,color:m.theme.colors.placeHolderText,fontFamily:m.theme.fonts.regular.fontFamily}}),i.default.create({container:{flex:1,backgroundColor:m.theme.colors.surfaceContrast}});const ga=e=>ua(e),ma=(e,t)=>i.default.create({mainContainer:{flex:1,backgroundColor:m.theme.colors.background,height:"100vh",overflow:"hidden",position:"fixed",top:0,left:0,right:0,bottom:0,marginLeft:e>900?t?70:250:0,transition:"margin-left 0.3s ease"},container:{flex:1},content:{flex:1,backgroundColor:m.theme.colors.background,paddingTop:0},listSection:{backgroundColor:m.theme.colors.surface},webContent:{width:"100%",maxWidth:e>900?800:600,alignSelf:"center",padding:e<=900?10:16},webListItem:{borderBottomWidth:1,borderBottomColor:m.theme.colors.border,paddingVertical:e<=900?8:12},listItemTitle:{fontSize:e<=900?m.theme.fontSizes.medium:m.theme.fontSizes.large,fontFamily:m.theme.fonts.regular.fontFamily},warningContainer:{backgroundColor:"#FFF3CD",padding:m.theme.spacing.small,marginHorizontal:m.theme.spacing.small,marginTop:m.theme.spacing.small,borderRadius:4},warningText:{color:"#856404",textAlign:"center"}}),ha=({navigation:e})=>{const{screenWidth:t,isCollapsed:o,is_DEBUG:a}=(0,n.useContext)(h.AuthContext),[i,s]=(0,n.useState)(t<=900),l=ma(t,o);(0,n.useEffect)((()=>{s(t<=900)}),[t]);const d=[{title:"Change Password",icon:"lock-reset",route:"ChangePassword"},{title:"Notification Preferences",icon:"bell-outline",route:"NotificationPreferences"},{title:"Privacy Settings",icon:"shield-account",route:"PrivacySettings"},{title:"Language",icon:"translate",route:"LanguageSettings"},{title:"Display & Accessibility",icon:"palette",route:"DisplaySettings"},{title:"Data Usage",icon:"chart-bar",route:"DataUsage"},{title:"About",icon:"information-outline",route:"About"}];return(0,j.jsx)(r.default,{style:l.mainContainer,children:(0,j.jsx)(He.default,{style:l.container,children:(0,j.jsxs)(r.default,{style:l.content,children:[i&&(0,j.jsx)(Dt,{title:"Settings",onBackPress:()=>e.navigate("More")}),(0,j.jsx)(r.default,{style:l.webContent,children:(0,j.jsx)(pn.default,{style:l.listSection,children:d.map(((o,r)=>(0,j.jsxs)(n.Fragment,{children:[(0,j.jsx)(fn.default,{title:o.title,titleStyle:l.listItemTitle,left:e=>(0,j.jsx)(S.default,{name:o.icon,size:t<=900?20:24,color:m.theme.colors.primary}),onPress:()=>e.navigate(o.route),style:[l.webListItem,{paddingHorizontal:t<=900?8:16}]}),r<d.length-1&&(0,j.jsx)(yn.default,{})]},r)))})})]})})})},fa=i.default.create({container:{flex:1,padding:20,width:"100%",maxWidth:800,alignSelf:"center"},contentContainer:{paddingBottom:16},title:{fontSize:24,fontWeight:"bold",marginBottom:10,color:m.theme.colors.primary},date:{fontSize:16,marginBottom:5,color:m.theme.colors.text},version:{fontSize:14,marginBottom:20,color:m.theme.colors.primary,fontStyle:"italic"},sectionTitle:{fontSize:20,fontWeight:"bold",marginTop:20,marginBottom:10,color:m.theme.colors.primary},subsectionTitle:{fontSize:18,fontWeight:"bold",marginTop:15,marginBottom:8,color:m.theme.colors.primary},paragraph:{fontSize:16,marginBottom:10,color:m.theme.colors.text},listItem:{fontSize:16,marginBottom:5,marginLeft:10,color:m.theme.colors.text},subsection:{marginLeft:10,marginTop:10},additionalInfo:{fontSize:16,marginBottom:10,marginTop:5,color:m.theme.colors.text,fontStyle:"italic"},contactInfo:{marginTop:10}}),pa=()=>{const e=(0,b.useNavigation)();return(0,j.jsxs)(Ft,{fullWidthHeader:!0,children:[(0,j.jsx)(Dt,{title:"Privacy Policy",onBackPress:()=>(0,g.handleBack)(e)}),(0,j.jsxs)(X.default,{style:fa.container,contentContainerStyle:fa.contentContainer,children:[(0,j.jsx)(a.default,{style:fa.title,children:be.title}),(0,j.jsxs)(a.default,{style:fa.date,children:["Last Updated: ",be.lastUpdated]}),(0,j.jsxs)(a.default,{style:fa.version,children:["Version ",be.version]}),(0,j.jsx)(a.default,{style:fa.paragraph,children:be.introduction}),be.sections.map(((e,t)=>(e=>(0,j.jsxs)(r.default,{children:[(0,j.jsx)(a.default,{style:fa.sectionTitle,children:e.title}),e.content&&(0,j.jsx)(a.default,{style:fa.paragraph,children:e.content}),e.listItems&&e.listItems.map(((e,t)=>(0,j.jsxs)(a.default,{style:fa.listItem,children:["\u2022 ",e]},t))),e.subsections&&e.subsections.map(((e,t)=>(0,j.jsxs)(r.default,{style:fa.subsection,children:[(0,j.jsx)(a.default,{style:fa.subsectionTitle,children:e.subtitle}),e.content&&(0,j.jsx)(a.default,{style:fa.paragraph,children:e.content}),e.items&&e.items.map(((e,t)=>(0,j.jsxs)(a.default,{style:fa.listItem,children:["\u2022 ",e]},t))),e.additionalInfo&&(0,j.jsx)(a.default,{style:fa.additionalInfo,children:e.additionalInfo})]},t))),e.additionalInfo&&(0,j.jsx)(a.default,{style:fa.additionalInfo,children:e.additionalInfo}),e.contactInfo&&(0,j.jsxs)(r.default,{style:fa.contactInfo,children:[(0,j.jsx)(a.default,{style:fa.listItem,children:e.contactInfo.company}),(0,j.jsx)(a.default,{style:fa.listItem,children:e.contactInfo.attention}),(0,j.jsx)(a.default,{style:fa.listItem,children:e.contactInfo.address}),(0,j.jsxs)(a.default,{style:fa.listItem,children:["Email: ",e.contactInfo.email]})]})]},e.title))(e)))]})]})},ya=i.default.create({container:{flex:1,padding:20,backgroundColor:m.theme.colors.background},title:{fontSize:24,fontWeight:"bold",marginBottom:20,color:m.theme.colors.primary}}),ba=()=>(0,j.jsxs)(r.default,{style:ya.container,children:[(0,j.jsx)(a.default,{style:ya.title,children:"Professional Settings"}),(0,j.jsx)(a.default,{children:"Manage your professional profile and preferences here."})]}),xa=i.default.create({container:{flex:1,padding:20},contentContainer:{paddingBottom:80},title:{fontSize:24,fontWeight:"bold",marginBottom:10,color:m.theme.colors.primary},date:{fontSize:16,marginBottom:5,color:m.theme.colors.text},version:{fontSize:14,marginBottom:20,color:m.theme.colors.primary,fontStyle:"italic"},sectionTitle:{fontSize:20,fontWeight:"bold",marginTop:20,marginBottom:10,color:m.theme.colors.primary},subsectionTitle:{fontSize:18,fontWeight:"bold",marginTop:15,marginBottom:8,color:m.theme.colors.primary},paragraph:{fontSize:16,marginBottom:10,color:m.theme.colors.text},subsection:{marginLeft:10,marginTop:10}}),va=()=>{const e=(0,b.useNavigation)();return(0,j.jsxs)(Ft,{fullWidthHeader:!0,children:[(0,j.jsx)(Dt,{title:"Terms of Service",onBackPress:()=>(0,g.handleBack)(e)}),(0,j.jsxs)(X.default,{style:xa.container,contentContainerStyle:xa.contentContainer,children:[(0,j.jsx)(a.default,{style:xa.title,children:"Terms of Service for CrittrCove"}),(0,j.jsxs)(a.default,{style:xa.date,children:["Effective Date: ",ye.lastUpdated]}),(0,j.jsxs)(a.default,{style:xa.version,children:["Version ",ye.version]}),ye.terms.map(((e,t)=>(e=>(0,j.jsxs)(r.default,{children:[(0,j.jsx)(a.default,{style:xa.sectionTitle,children:e.header}),e.body&&(0,j.jsx)(a.default,{style:xa.paragraph,children:e.body}),e.subsections&&e.subsections.map(((e,t)=>(0,j.jsxs)(r.default,{style:xa.subsection,children:[(0,j.jsx)(a.default,{style:xa.subsectionTitle,children:e.subtitle}),(0,j.jsx)(a.default,{style:xa.paragraph,children:e.body})]},t)))]},e.header))(e)))]})]})},wa=i.default.create({container:{flex:1,padding:20,backgroundColor:m.theme.colors.background},title:{fontSize:24,fontWeight:"bold",marginBottom:20,color:m.theme.colors.primary}}),Ca=()=>(0,j.jsxs)(X.default,{style:wa.container,children:[(0,j.jsx)(a.default,{style:wa.title,children:"Help / FAQ"}),(0,j.jsx)(a.default,{children:"Frequently asked questions and help topics go here..."})]});let Sa,ja;{const e=o(52622);Sa=e.useForm,ja=e.ValidationError}const Ta=i.default.create({container:{flex:1,width:"100%",alignItems:"center",justifyContent:"center",paddingVertical:20,minHeight:"80vh"},contentWrapper:{padding:20,alignItems:"center",backgroundColor:"white",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,maxWidth:"100%"},title:{fontSize:m.theme.fontSizes.largeLarge,fontWeight:"bold",marginBottom:10,color:m.theme.colors.primary,fontFamily:m.theme.fonts.header.fontFamily,textAlign:"center"},subtitle:{fontSize:m.theme.fontSizes.medium,marginBottom:20,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center"},input:{backgroundColor:m.theme.colors.surface,borderRadius:5,borderColor:m.theme.colors.border,borderWidth:1,padding:15,marginBottom:15,fontSize:m.theme.fontSizes.medium,width:"100%",fontFamily:m.theme.fonts.regular.fontFamily},messageInput:{height:120,textAlignVertical:"top"},button:{backgroundColor:m.theme.colors.primary,padding:15,borderRadius:5,alignItems:"center",width:"100%",marginTop:10},buttonText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},successMessage:{color:m.theme.colors.success,textAlign:"center",marginBottom:10,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily,width:"100%"},disabledButton:{opacity:.7},errorInput:{borderColor:m.theme.colors.error,borderWidth:1},errorText:{color:m.theme.colors.error,textAlign:"center",marginBottom:10,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},submitButton:{backgroundColor:m.theme.colors.primary,padding:15,borderRadius:5,alignItems:"center",width:"100%",marginTop:10},submitButtonText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},errorMessage:{color:m.theme.colors.error},infoSection:{backgroundColor:"#F0F9E5",borderRadius:10,padding:20,marginBottom:25,borderWidth:1,borderColor:m.theme.colors.primary+"20"},infoTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"bold",color:m.theme.colors.primary,fontFamily:m.theme.fonts.header.fontFamily,textAlign:"center",marginBottom:20},stepContainer:{marginBottom:20},stepHeader:{flexDirection:"row",alignItems:"center",marginBottom:8},stepNumber:{width:30,height:30,borderRadius:15,backgroundColor:m.theme.colors.primary,justifyContent:"center",alignItems:"center",marginRight:12},stepNumberText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.medium,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},stepTitle:{fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"bold",color:m.theme.colors.primary,fontFamily:m.theme.fonts.header.fontFamily},stepDescription:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,lineHeight:22,marginLeft:42},bulletPoints:{marginLeft:42,marginTop:8},bulletPoint:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,lineHeight:20,marginBottom:4},ctaContainer:{backgroundColor:m.theme.colors.primary+"10",borderRadius:8,padding:15,marginTop:10,borderLeftWidth:4,borderLeftColor:m.theme.colors.primary},ctaText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"600",textAlign:"center",lineHeight:20}}),Ba=()=>{(0,b.useNavigation)();const e=(0,b.useRoute)(),{screenWidth:t,isCollapsed:o}=(0,n.useContext)(h.AuthContext),[i,s]=Sa?Sa("mkgobpro"):[{},()=>{}],[l,d]=(0,n.useState)(""),[c,u]=(0,n.useState)(""),[g,f]=(0,n.useState)(""),[y,w]=(0,n.useState)(!1),[C,S]=(0,n.useState)(""),[T,B]=(0,n.useState)(""),[k,A]=(0,n.useState)(""),[_,I]=(0,n.useState)(""),M=t<900,L=M?"90%":"600px",R=M?"100%":"800px",D="becomeProfessional"===e.params?.source;(0,h.debugLog)("MBA1234: ContactUs screen loaded with params:",{params:e.params,isBecomeProfessional:D});const z=()=>{let e=!0;const t=Xe(l);B(t.message),t.isValid||(e=!1);const o=Ze(c);A(o.message),o.isValid||(e=!1);const n=((e,t={})=>{const o=t.maxLength||5e3,n=t.minLength||0,r=t.allowEmpty||!1;if(!e||""===e.trim())return r?{isValid:!0,message:"",sanitizedInput:""}:{isValid:!1,message:"Message cannot be empty",sanitizedInput:""};const a=Ke(e,"message",{maxLength:o});if(a.length<n)return{isValid:!1,message:"Message must be at least ".concat(n," characters long"),sanitizedInput:a};if(a.length>o)return{isValid:!1,message:"Message must be no more than ".concat(o," characters long"),sanitizedInput:a};const i=e.length;return(i-a.length)/i*100>50&&i>10?{isValid:!1,message:"Message contains too many invalid characters",sanitizedInput:a}:/(.)\1{10,}/.test(a)?{isValid:!1,message:"Message contains too many repeated characters",sanitizedInput:a}:{isValid:!0,message:"",sanitizedInput:a}})(g,{maxLength:2e3,minLength:10,allowEmpty:!1});return I(n.message),n.isValid||(e=!1),e};return i.succeeded?(0,j.jsx)(Ft,{fullWidthHeader:!1,contentWidth:R,style:M?{}:{marginLeft:o?"70px":"250px",width:"calc(100% - ".concat(o?"70px":"250px",")"),transition:"margin-left 0.3s ease, width 0.3s ease"},children:(0,j.jsx)(r.default,{style:Ta.container,children:(0,j.jsxs)(r.default,{style:[Ta.contentWrapper,{width:L}],children:[(0,j.jsx)(a.default,{style:[Ta.title,{color:m.theme.colors.primary}],children:D?"Application Received!":"Thanks for reaching out!"}),(0,j.jsx)(a.default,{style:Ta.successMessage,children:D?"We've received your professional application and will get back to you with next steps soon.":"We'll get back to you soon."})]})})}):(0,j.jsx)(Ft,{fullWidthHeader:!1,contentWidth:R,style:M?{}:{marginLeft:o?"70px":"250px",width:"calc(100% - ".concat(o?"70px":"250px",")"),transition:"margin-left 0.3s ease, width 0.3s ease"},children:(0,j.jsx)(r.default,{style:Ta.container,children:(0,j.jsxs)(r.default,{style:[Ta.contentWrapper,{width:L}],children:[(0,j.jsx)(a.default,{style:Ta.title,children:D?"Become a Professional":"Contact Us"}),(0,j.jsx)(a.default,{style:Ta.subtitle,children:D?"Learn how to join our network of pet care professionals":"Get in touch with our support team"}),D&&(0,j.jsxs)(r.default,{style:Ta.infoSection,children:[(0,j.jsx)(a.default,{style:Ta.infoTitle,children:"How to Become a Professional"}),(0,j.jsxs)(r.default,{style:Ta.stepContainer,children:[(0,j.jsxs)(r.default,{style:Ta.stepHeader,children:[(0,j.jsx)(r.default,{style:Ta.stepNumber,children:(0,j.jsx)(a.default,{style:Ta.stepNumberText,children:"1"})}),(0,j.jsx)(a.default,{style:Ta.stepTitle,children:"Contact Us"})]}),(0,j.jsx)(a.default,{style:Ta.stepDescription,children:"Fill out the contact form below with your email and express your desire to become a professional. Tell us about your experience with pet care and what services you'd like to offer."})]}),(0,j.jsxs)(r.default,{style:Ta.stepContainer,children:[(0,j.jsxs)(r.default,{style:Ta.stepHeader,children:[(0,j.jsx)(r.default,{style:Ta.stepNumber,children:(0,j.jsx)(a.default,{style:Ta.stepNumberText,children:"2"})}),(0,j.jsx)(a.default,{style:Ta.stepTitle,children:"Application Process"})]}),(0,j.jsx)(a.default,{style:Ta.stepDescription,children:"We'll reply with all the information and documents we need, including:"}),(0,j.jsxs)(r.default,{style:Ta.bulletPoints,children:[(0,j.jsx)(a.default,{style:Ta.bulletPoint,children:"\u2022 Background check link (optional, but provides a verification badge)"}),(0,j.jsx)(a.default,{style:Ta.bulletPoint,children:"\u2022 Insurance documentation you can provide (optional, but provides a verification badge)"}),(0,j.jsx)(a.default,{style:Ta.bulletPoint,children:"\u2022 Information about your experience and qualifications (can be included in the below message)"}),(0,j.jsx)(a.default,{style:Ta.bulletPoint,children:"\u2022 Details about the services you want to offer (can be included in the below message)"})]})]}),(0,j.jsxs)(r.default,{style:Ta.stepContainer,children:[(0,j.jsxs)(r.default,{style:Ta.stepHeader,children:[(0,j.jsx)(r.default,{style:Ta.stepNumber,children:(0,j.jsx)(a.default,{style:Ta.stepNumberText,children:"3"})}),(0,j.jsx)(a.default,{style:Ta.stepTitle,children:"Approval & Activation"})]}),(0,j.jsx)(a.default,{style:Ta.stepDescription,children:"Once we review your application and documentation, we'll approve your account and activate your professional status. You'll then be able to create services, manage bookings, and be contacted by pet owners in your area."})]}),(0,j.jsx)(r.default,{style:Ta.ctaContainer,children:(0,j.jsx)(a.default,{style:Ta.ctaText,children:"Ready to get started? Fill out the form below and mention that you want to become a professional!"})})]}),(0,j.jsx)(te.default,{style:[Ta.input,T?Ta.errorInput:null],placeholder:"Your Name",value:l,onChangeText:e=>{const t=Ke(e,"name"),o=e.length>0?(e.length-t.length)/e.length*100:0;o>30&&e.length>3?(0,h.debugLog)("MBA1234: Potentially malicious name input detected in ContactUs:",{original:e,sanitized:t,removalPercentage:o}):(d(t),B(""),S(""))},name:"name"}),T?(0,j.jsx)(a.default,{style:Ta.errorText,children:T}):null,(0,j.jsx)(te.default,{style:[Ta.input,k?Ta.errorInput:null],placeholder:"Your Email",value:c,onChangeText:e=>{const t=Ke(e,"email"),o=e.length>0?(e.length-t.length)/e.length*100:0;o>20&&e.length>5?(0,h.debugLog)("MBA1234: Potentially malicious email input detected in ContactUs:",{original:e,sanitized:t,removalPercentage:o}):(u(t),A(""),S(""))},keyboardType:"email-address",name:"email",autoCapitalize:"none"}),k?(0,j.jsx)(a.default,{style:Ta.errorText,children:k}):null,(0,j.jsx)(te.default,{style:[Ta.input,Ta.messageInput,_?Ta.errorInput:null],placeholder:D?"Tell us about your interest in becoming a professional, your experience with pets, and what services you'd like to offer (minimum 10 characters)":"Your Message (minimum 10 characters)",value:g,onChangeText:e=>{const t=Ke(e,"message",{maxLength:2e3}),o=e.length>0?(e.length-t.length)/e.length*100:0;o>30&&e.length>10?(0,h.debugLog)("MBA1234: Potentially malicious message input detected in ContactUs:",{original:e,sanitized:t,removalPercentage:o}):(f(t),I(""),S(""))},multiline:!0,name:"message"}),_?(0,j.jsx)(a.default,{style:Ta.errorText,children:_}):null,C?(0,j.jsx)(a.default,{style:[Ta.successMessage,C.includes("Failed")&&Ta.errorMessage],children:C}):null,(0,j.jsx)(v.default,{style:[Ta.submitButton,y&&Ta.disabledButton],onPress:async()=>{if(z()){w(!0),S("");try{const e=Ke(l,"name"),t=Ke(c,"email"),o=Ke(g,"message",{maxLength:2e3});(0,h.debugLog)("MBA1234: Contact form submission with sanitized inputs",{originalName:l,sanitizedName:e,originalEmail:c,sanitizedEmail:t,originalMessage:g,sanitizedMessage:o});if(200!==(await x.default.post("".concat(p.API_BASE_URL,"/api/users/v1/contact/"),{name:e,email:t,message:o})).status)throw new Error("Failed to send message");S("Your message has been sent successfully!"),d(""),u(""),f(""),B(""),A(""),I("")}catch(zs){(0,h.debugLog)("MBA1234: Error sending contact form:",zs);let t="Failed to send message. Please try again later.";zs.response&&zs.response.data&&zs.response.data.error&&(t=zs.response.data.error),S(t)}finally{w(!1)}}},disabled:y,children:(0,j.jsx)(a.default,{style:Ta.submitButtonText,children:y?"Sending...":"Send Message"})})]})})})};var ka=o(802),Aa=o(61457);const _a=(0,n.forwardRef)((({placeholder:e,onChangeText:t,initialValue:o="",style:a},i)=>{const{colors:s}=(0,ne.useTheme)(),[l,d]=(0,n.useState)(o),c=(0,n.useRef)(null);(0,n.useEffect)((()=>{o!==l&&d(o)}),[o]);return(0,j.jsxs)(r.default,{style:[Ia.container,a,{backgroundColor:s.surface}],children:[(0,j.jsx)(Aa.default,{icon:()=>(0,j.jsx)(de.default,{name:"search",size:24,color:s.primary}),onPress:()=>c.current?.focus()}),(0,j.jsx)(te.default,{ref:c,style:[Ia.input,{color:s.text}],placeholder:e,placeholderTextColor:s.placeholder,value:l,onChangeText:e=>{e!==l&&(d(e),t(e))},autoFocus:!0,keyboardType:"default",returnKeyType:"search",blurOnSubmit:!1})]})})),Ia=i.default.create({container:{flexDirection:"row",alignItems:"center",borderRadius:25,elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:2},input:{flex:1,fontSize:16,paddingVertical:8,paddingRight:8}}),Ma=(0,n.memo)(_a),La=i.default.create({container:{flex:1,backgroundColor:m.theme.colors.background},androidSafeArea:{paddingTop:0},searchAndFilterContainer:{flexDirection:"row",alignItems:"center",margin:16,maxWidth:600,alignSelf:"center",width:"100%"},searchBar:{flex:1,marginRight:8,marginLeft:0},filterButton:{minWidth:80,marginRight:0},ownerList:{padding:16},ownerCard:{marginBottom:16,maxWidth:600,alignSelf:"center",width:"100%"},petTypes:{flexDirection:"row",marginTop:8},petChip:{marginRight:8},noOwnersContainer:{flex:1,justifyContent:"center",alignItems:"center"},modalContainer:{backgroundColor:"white",padding:20,margin:20,borderRadius:5,maxWidth:600,alignSelf:"center",width:"90%"},modalTitle:{marginBottom:10},filtersContainer:{flexDirection:"row",flexWrap:"wrap",marginBottom:20},filterChip:{margin:4},applyButton:{marginTop:10},closeButton:{marginTop:10,alignSelf:"flex-end"},closeIcon:{position:"absolute",top:10,right:10,zIndex:1}}),Ra=({navigation:e})=>{const{colors:t}=(0,ne.useTheme)(),[o,a]=(0,n.useState)(""),[i,s]=(0,n.useState)([]),[l,d]=(0,n.useState)([]),[c,u]=(0,n.useState)(!1),[g,m]=(0,n.useState)([]);(0,n.useEffect)((()=>{h()}),[]);const h=async()=>{try{await new Promise((e=>setTimeout(e,1e3))),m(Be)}catch(zs){console.error("Error fetching owners:",zs)}},f=(0,n.useCallback)((e=>{d((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))}),[]),p=(0,n.useCallback)((()=>{s(l),u(!1)}),[l]),y=(0,n.useMemo)((()=>g.filter((e=>{const t=e.name.toLowerCase().includes(o.toLowerCase()),n=0===i.length||i.every((t=>{if(["Dog","Cat","Exotic"].includes(t))return e.pet_types.includes(t);const o=new Date(e.last_booking),n=new Date;switch(t){case"week":const e=new Date;return e.setDate(n.getDate()-7),o>=e;case"month":const t=new Date;return t.setMonth(n.getMonth()-1),o>=t;case"year":const r=new Date;return r.setFullYear(n.getFullYear()-1),o>=r;default:return!0}}));return t&&n}))),[g,o,i]),b=(0,n.useCallback)((({item:t})=>(0,j.jsx)(v.default,{onPress:()=>e.navigate("OwnerHistory",{ownerId:t.id}),children:(0,j.jsx)(Jn.default,{style:La.ownerCard,children:(0,j.jsxs)(Jn.default.Content,{children:[(0,j.jsx)($n.default,{children:t.name}),(0,j.jsxs)(Kn.default,{children:["Last booking: ",t.last_booking]}),(0,j.jsx)(r.default,{style:La.petTypes,children:t.pet_types.map((e=>(0,j.jsx)(ka.default,{style:La.petChip,children:e},e)))})]})})})),[e]),x=(0,n.useCallback)((e=>{a(e)}),[]);return(0,j.jsxs)(r.default,{style:La.container,children:[(0,j.jsxs)(r.default,{style:La.searchAndFilterContainer,children:[(0,j.jsx)(mt.default,{onPress:()=>{},children:(0,j.jsx)(Ma,{placeholder:"Search owners",onChangeText:x,initialValue:o,style:La.searchBar})}),(0,j.jsx)(Ue.default,{mode:"outlined",onPress:()=>{d(i),u(!0)},style:La.filterButton,children:"Filters"})]}),y.length>0?(0,j.jsx)(Yt.default,{data:y,renderItem:b,keyExtractor:e=>e.id,contentContainerStyle:La.ownerList,keyboardShouldPersistTaps:"handled",removeClippedSubviews:!1}):(0,j.jsx)(r.default,{style:La.noOwnersContainer,children:(0,j.jsx)(Kn.default,{children:"No owners match your search or filters."})}),(0,j.jsx)(Bt.default,{children:(0,j.jsxs)(Br.default,{visible:c,onDismiss:()=>u(!1),contentContainerStyle:La.modalContainer,children:[(0,j.jsx)(v.default,{onPress:()=>u(!1),style:La.closeIcon,children:(0,j.jsx)(S.default,{name:"close",size:24,color:"black"})}),(0,j.jsx)($n.default,{style:La.modalTitle,children:"Filters"}),(0,j.jsx)(r.default,{style:La.filtersContainer,children:[{label:"Dog Sitting",value:"Dog"},{label:"Cat Sitting",value:"Cat"},{label:"Exotic Sitting",value:"Exotic"},{label:"Last Week",value:"week"},{label:"Last Month",value:"month"},{label:"Last Year",value:"year"}].map((e=>(0,j.jsx)(ka.default,{style:La.filterChip,selected:l.includes(e.value),onPress:()=>f(e.value),icon:l.includes(e.value)?({size:e,color:t})=>(0,j.jsx)(S.default,{name:"check",size:e,color:t}):void 0,children:e.label},e.value)))}),(0,j.jsx)(Ue.default,{mode:"contained",onPress:p,style:La.applyButton,children:"Apply Filters"})]})})]})},Da=({visible:e,onClose:t,serviceName:o,additionalRates:i=[],professionalName:s="Professional",onContactPress:l})=>{const[d,c]=(0,n.useState)(new Date),[u,g]=(0,n.useState)(new Date),[h,f]=(0,n.useState)(0),[p,y]=(0,n.useState)(!1),[b,x]=(0,n.useState)({}),[w,C]=(0,n.useState)(0),[S,T]=(0,n.useState)(0);return(0,n.useEffect)((()=>{const e={};i.forEach((t=>{e[t.title]=Object.assign({},t,{selected:!1})})),x(e)}),[i]),(0,n.useEffect)((()=>{(()=>{let e=p?40:20;e+=10*h,Object.entries(b).forEach((([t,o])=>{o.selected&&(e+=o.amount)})),C(e),T(.1*e)})()}),[h,p,b]),(0,j.jsx)(k.default,{visible:e,animationType:"slide",transparent:!0,onRequestClose:t,children:(0,j.jsx)(r.default,{style:za.modalContainer,children:(0,j.jsxs)(r.default,{style:za.modalContent,children:[(0,j.jsx)(v.default,{style:za.closeIcon,onPress:t,children:(0,j.jsx)(de.default,{name:"close",size:24,color:m.theme.colors.text})}),(0,j.jsx)(a.default,{style:za.modalTitle,children:o}),(0,j.jsxs)(X.default,{style:za.scrollContent,showsVerticalScrollIndicator:!0,persistentScrollbar:!0,children:[(0,j.jsxs)(r.default,{style:za.rateItem,children:[(0,j.jsx)(a.default,{children:"Base Rate"}),(0,j.jsxs)(a.default,{children:["$",20]})]}),(0,j.jsxs)(r.default,{style:za.rateItem,children:[(0,j.jsxs)(a.default,{children:["Additional Animals ($",10," each)"]}),(0,j.jsxs)(r.default,{style:za.counterContainer,children:[(0,j.jsx)(v.default,{onPress:()=>f(Math.max(0,h-1)),style:za.counterButton,children:(0,j.jsx)(de.default,{name:"remove",size:24,color:m.theme.colors.primary})}),(0,j.jsx)(a.default,{style:za.counterText,children:h}),(0,j.jsx)(v.default,{onPress:()=>f(h+1),style:za.counterButton,children:(0,j.jsx)(de.default,{name:"add",size:24,color:m.theme.colors.primary})})]})]}),(0,j.jsxs)(r.default,{style:za.rateItem,children:[(0,j.jsxs)(a.default,{children:["Holiday Rate ($",40,")"]}),(0,j.jsx)(st.default,{value:p,onValueChange:y,trackColor:{false:"#767577",true:m.theme.colors.primary}})]}),Object.entries(b).map((([e,t])=>(0,j.jsxs)(r.default,{style:za.rateItem,children:[(0,j.jsxs)(a.default,{children:[e," ($",t.amount,")"]}),(0,j.jsx)(st.default,{value:t.selected,onValueChange:o=>{x(Object.assign({},b,{[e]:Object.assign({},t,{selected:o})}))},trackColor:{false:"#767577",true:m.theme.colors.primary}})]},e))),(0,j.jsxs)(r.default,{style:za.totalSection,children:[(0,j.jsxs)(r.default,{style:za.totalItem,children:[(0,j.jsx)(a.default,{style:za.totalLabel,children:"Subtotal:"}),(0,j.jsxs)(a.default,{style:za.totalAmount,children:["$",w]})]}),(0,j.jsxs)(r.default,{style:za.totalItem,children:[(0,j.jsx)(a.default,{style:za.totalLabel,children:"Service Fees (10%):"}),(0,j.jsxs)(a.default,{style:za.totalAmount,children:["$",S.toFixed(2)]})]}),(0,j.jsxs)(r.default,{style:[za.totalItem,za.finalTotal],children:[(0,j.jsx)(a.default,{style:[za.totalLabel,za.finalTotalText],children:"Total Cost:"}),(0,j.jsxs)(a.default,{style:[za.totalAmount,za.finalTotalText],children:["$",(w+S).toFixed(2)]})]})]})]}),(0,j.jsx)(v.default,{style:za.contactButton,onPress:l,children:(0,j.jsxs)(a.default,{style:za.contactButtonText,children:["Contact ",s]})})]})})})},za=i.default.create({modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:20,paddingRight:15,width:"90%",maxHeight:"43%",maxWidth:400},scrollContent:{flexGrow:0,marginBottom:10,paddingRight:12,marginRight:-7},modalTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"bold",marginBottom:15,textAlign:"center",marginTop:5,paddingHorizontal:30},dateSection:{marginBottom:20,flexDirection:"row",justifyContent:"space-between",gap:16},dateColumn:{flex:1},dateLabel:{marginBottom:8,fontSize:m.theme.fontSizes.smallMedium,color:m.theme.colors.text},rateItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:15},counterContainer:{flexDirection:"row",alignItems:"center"},counterButton:{padding:5},counterText:{marginHorizontal:10,fontSize:m.theme.fontSizes.medium},totalSection:{marginTop:20,borderTopWidth:1,borderTopColor:m.theme.colors.border,paddingTop:15},totalItem:{flexDirection:"row",justifyContent:"space-between",marginBottom:10},finalTotal:{borderTopWidth:1,borderTopColor:m.theme.colors.border,paddingTop:10,marginTop:5},totalLabel:{fontSize:m.theme.fontSizes.medium,fontWeight:"600"},totalAmount:{fontSize:m.theme.fontSizes.medium,fontWeight:"bold"},finalTotalText:{fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"bold",color:m.theme.colors.primary},closeButton:{backgroundColor:m.theme.colors.primary,padding:12,borderRadius:8,alignItems:"center",marginTop:10},closeButtonText:{color:m.theme.colors.surface,fontSize:m.theme.fontSizes.medium,fontWeight:"600"},closeIcon:{position:"absolute",right:15,top:15,zIndex:1,padding:5},contactButton:{backgroundColor:m.theme.colors.primary,padding:12,borderRadius:8,alignItems:"center",marginTop:10},contactButtonText:{color:m.theme.colors.surface,fontSize:m.theme.fontSizes.medium,fontWeight:"600"}}),Pa=i.default.create({serviceCard:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:12,marginRight:12,width:280,height:220,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,position:"relative",justifyContent:"space-between"},heartButton:{position:"absolute",right:8,top:8,zIndex:1},serviceName:{fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"600",marginTop:8,marginBottom:6,fontFamily:m.theme.fonts.header.fontFamily,flexShrink:1},startingPrice:{fontSize:m.theme.fontSizes.medium+2,color:m.theme.colors.secondary,marginBottom:6,fontFamily:m.theme.fonts.regular.fontFamily},animalTypeContainer:{flexDirection:"row",flexWrap:"wrap",gap:4,marginBottom:8},animalType:{fontSize:m.theme.fontSizes.small+2,color:m.theme.colors.secondary,backgroundColor:m.theme.colors.background,borderRadius:8,paddingHorizontal:6,paddingVertical:2,fontFamily:m.theme.fonts.regular.fontFamily},calculateButton:{backgroundColor:m.theme.colors.primary,padding:10,borderRadius:8,alignItems:"center",marginTop:"auto"},calculateButtonText:{color:m.theme.colors.surface,fontSize:m.theme.fontSizes.medium,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},contentContainer:{flex:1}}),Fa=({service:e,onHeartPress:t,isFavorite:o,professionalName:i,professionalId:s,navigation:l})=>{const[d,c]=(0,n.useState)(!1);return(0,j.jsxs)(r.default,{style:Pa.serviceCard,children:[(0,j.jsxs)(r.default,{style:Pa.contentContainer,children:[(0,j.jsx)(S.default,{name:e.icon,size:30,color:m.theme.colors.primary}),(0,j.jsx)(a.default,{numberOfLines:2,style:Pa.serviceName,children:e.name}),(0,j.jsxs)(a.default,{style:Pa.startingPrice,children:["Starting at $",e.startingPrice]}),(0,j.jsx)(r.default,{style:Pa.animalTypeContainer,children:e.animalTypes.map(((e,t)=>(0,j.jsx)(a.default,{style:Pa.animalType,children:e},t)))})]}),(0,j.jsx)(v.default,{style:Pa.calculateButton,onPress:()=>c(!0),children:(0,j.jsx)(a.default,{style:Pa.calculateButtonText,children:"Calculate Cost"})}),(0,j.jsx)(Da,{visible:d,onClose:()=>c(!1),serviceName:e.name,additionalRates:e.additionalRates||[],professionalName:i,professionalId:s,onContactPress:()=>{const e=Ie.find((e=>e.professionalId===s));if(e)l.replace("MessageHistory",{selectedConversation:e.id,professionalName:i,professionalId:s});else{const e=((e,t,o)=>{const n="conv_".concat(Date.now()),r=o===_e;return{id:n,participant1_id:r?o:e,participant2_id:r?e:o,role_map:{participant1_role:r?"owner":"professional",participant2_role:r?"professional":"owner"},lastMessage:"",timestamp:(new Date).toISOString(),unread:!1,bookingStatus:null}})(s,0,"current_user_id");Ie.unshift(e),Me[e.id]=[],l.replace("MessageHistory",{selectedConversation:e.id,professionalName:i,professionalId:s})}c(!1)}})]})},Ea=o(65899).MapContainer,Wa=[{id:1,name:"Noah M.",service:"Fish Tank Cleaning",date:"Dec 02, 2024",rating:5,text:"Dina was fantastic with our dog! Sent lots of photos and clearly made sure she was comfortable. Will definitely use again!",photo:"https://via.placeholder.com/50"},{id:2,name:"Kaily J.",service:"Ferrier",date:"Nov 26, 2024",rating:4,text:"Dina always takes such good care of Elijah. He was having tummy problems today and she kept me updated all day on how he was doing.",photo:"https://via.placeholder.com/50"},{id:3,name:"Nadia U.",service:"Reptile Boarding & Habitat Maintenance",date:"Nov 19, 2024",rating:5,text:"She took such great care of our puppy! Sent pictures and videos the whole time, her backyard was super nice and clean \u2764\ufe0f my puppy was definitely in great hands! Bonus her dogs were so sweet with our puppy.",photo:"https://via.placeholder.com/50"},{id:4,name:"Vanessa G.",service:"Bird Feeding",date:"Nov 19, 2024",rating:5,text:"Dina was great! She communicated through the whole stay and sent plenty of videos and photos. 10/10",photo:"https://via.placeholder.com/50"}];if("undefined"!==typeof document)try{const e=document.createElement("style");e.textContent="\n      .services-scroll::-webkit-scrollbar {\n        -webkit-appearance: none;\n      }\n\n      .services-scroll::-webkit-scrollbar:vertical {\n        width: 11px;\n      }\n\n      .services-scroll::-webkit-scrollbar:horizontal {\n        height: 11px;\n      }\n\n      .services-scroll::-webkit-scrollbar-thumb {\n        border-radius: 8px;\n        border: 2px solid white;\n        background-color: rgba(0, 0, 0, .5);\n      }\n    ",document.head&&document.head.appendChild(e)}catch(zs){console.warn("MBA5511: Could not inject CSS styles:",zs)}const Oa=async(e,t)=>{try{"undefined"!==typeof sessionStorage?sessionStorage.setItem(e,t):await y.default.setItem(e,t)}catch(zs){console.warn("MBA5511: Storage setItem failed:",zs)}},Na=async e=>{try{return"undefined"!==typeof sessionStorage?sessionStorage.getItem(e):await y.default.getItem(e)}catch(zs){return console.warn("MBA5511: Storage getItem failed:",zs),null}},Ha=async e=>{try{"undefined"!==typeof sessionStorage?sessionStorage.removeItem(e):await y.default.removeItem(e)}catch(zs){console.warn("MBA5511: Storage removeItem failed:",zs)}},Ua=i.default.create({scrollViewContent:{flexGrow:1,paddingBottom:16,height:"calc(100vh - 124px)",overflow:"auto"},content:{alignSelf:"center",padding:24},topSection:{flexDirection:"row",gap:24,marginBottom:24},gallerySection:{maxHeight:400,overflow:"hidden",marginBottom:24},photoGrid:{flexDirection:"row",flexWrap:"wrap",gap:8,maxHeight:320,overflow:"auto"},bottomSection:{flexDirection:"row",gap:24},servicesSection:{flex:1,backgroundColor:m.theme.colors.background,padding:24,borderRadius:12,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},aboutSection:{maxHeight:300,overflow:"auto",marginBottom:24,padding:16,backgroundColor:m.theme.colors.surface,borderRadius:12},profileHeader:{alignItems:"flex-start"},profileInfo:{alignItems:"flex-start"},hostingSection:{marginTop:24},hostTitle:{fontSize:18,fontWeight:"bold",marginBottom:12,fontFamily:m.theme.fonts.header.fontFamily},weightRanges:{gap:8},weightRange:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},galleryPhoto:{width:100,height:100,borderRadius:8},centered:{flex:1,justifyContent:"center",alignItems:"center"},profilePhoto:{width:120,height:120,borderRadius:60,marginBottom:16,alignSelf:"center"},profilePhotoPlaceholder:{backgroundColor:m.theme.colors.surface,justifyContent:"center",alignItems:"center",marginBottom:10},name:{fontSize:24,fontWeight:"bold",marginBottom:4,textAlign:"center",fontFamily:m.theme.fonts.header.fontFamily},location:{fontSize:16,color:m.theme.colors.secondary,marginBottom:8,textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily},section:{padding:20,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},sectionTitle:{fontSize:20,fontWeight:"bold",marginBottom:10,color:m.theme.colors.primary,fontFamily:m.theme.fonts.header.fontFamily},bioInput:{backgroundColor:m.theme.colors.surface},service:{fontSize:16,marginBottom:5},rateItem:{flexDirection:"row",alignItems:"center",marginBottom:10},rateLabel:{flex:1,fontSize:16},rateInput:{flex:1,backgroundColor:m.theme.colors.surface},photoGrid:{flexDirection:"row",flexWrap:"wrap"},petPhoto:{width:50,height:50,borderRadius:25,backgroundColor:m.theme.colors.surface,justifyContent:"center",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border},addPhotoButton:{width:100,height:100,margin:5,borderRadius:10,borderWidth:1,borderColor:m.theme.colors.primary,justifyContent:"center",alignItems:"center"},saveButton:{margin:20},ratingContainer:{flexDirection:"row",alignItems:"center",justifyContent:"center",marginBottom:16},rating:{fontSize:16,fontWeight:"bold",marginLeft:5},reviewCount:{fontSize:14,color:m.theme.colors.secondary,marginLeft:4},contactButton:{backgroundColor:m.theme.colors.primary,padding:12,borderRadius:8,alignSelf:"center"},contactButtonText:{fontSize:16,fontWeight:"bold",color:m.theme.colors.surface,textAlign:"center"},statsContainer:{flexDirection:"row",justifyContent:"space-around",marginBottom:20},statItem:{flexDirection:"row",alignItems:"center",marginRight:10},statText:{fontSize:16,marginLeft:5},bioText:{fontSize:18,lineHeight:28,color:m.theme.colors.text,overflow:"hidden",fontFamily:m.theme.fonts.regular.fontFamily},serviceItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:10},serviceText:{fontSize:8,fontFamily:m.theme.fonts.regular.fontFamily},servicePrice:{fontSize:14,color:m.theme.colors.secondary,fontFamily:m.theme.fonts.regular.fontFamily},skillsGrid:{flexDirection:"row",flexWrap:"wrap"},skillBadge:{backgroundColor:m.theme.colors.surface,padding:10,borderRadius:5,margin:5},skillText:{fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},photoGallery:{flexDirection:"row"},calculatorText:{fontSize:16,color:m.theme.colors.secondary,fontFamily:m.theme.fonts.regular.fontFamily},additionalRatesButton:{marginTop:16,paddingVertical:12,paddingHorizontal:16,borderRadius:6,backgroundColor:m.theme.colors.surface,alignItems:"center",borderWidth:1,borderColor:m.theme.colors.outline},additionalRatesText:{color:m.theme.colors.primary,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},calendarSection:{marginTop:24},readMoreButton:{marginTop:8},readMoreText:{color:m.theme.colors.primary,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},reviewsSection:{marginVertical:32,width:"100%",backgroundColor:m.theme.colors.background},reviewItem:{marginBottom:16,backgroundColor:m.theme.colors.surface,padding:16,borderRadius:12,maxWidth:600},servicesSection:{backgroundColor:m.theme.colors.surface,padding:24,borderRadius:12,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,marginBottom:24},mapContainer:{height:400,width:"100%",marginVertical:24},map:{flex:1},petsSection:{marginBottom:24,backgroundColor:m.theme.colors.surface,padding:16,borderRadius:12},petItem:{flexDirection:"row",alignItems:"center",marginBottom:12,padding:12,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,backgroundColor:m.theme.colors.background},petInfo:{marginLeft:12,flex:1},petName:{fontSize:16,fontWeight:"600",marginBottom:2,fontFamily:m.theme.fonts.header.fontFamily},petBreed:{fontSize:14,color:m.theme.colors.secondary,marginBottom:2,fontFamily:m.theme.fonts.regular.fontFamily},petDetails:{fontSize:14,color:m.theme.colors.secondary,fontFamily:m.theme.fonts.regular.fontFamily},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},aboutSubsections:{flexDirection:"row",gap:24},communicationSection:{flex:1},skillsSection:{flex:1},homeDetails:{flexDirection:"row",flexWrap:"wrap",gap:16},noReviews:{fontSize:16,color:m.theme.colors.secondary,fontStyle:"italic",textAlign:"center",marginTop:16},twoColumnLayout:{flexDirection:"row",gap:24},singleColumnLayout:{flexDirection:"column"},leftColumn:{flex:1,maxWidth:400},rightColumn:{flex:2},calendar:{height:300,marginTop:16},serviceText:{fontSize:12,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"100"},homeFeaturesGrid:{flexDirection:"row",flexWrap:"wrap",gap:8,marginTop:16},featureBubble:{backgroundColor:m.theme.colors.surface,paddingVertical:8,paddingHorizontal:16,borderRadius:20,borderWidth:1,borderColor:m.theme.colors.outline},featureText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},reviewItem:{marginBottom:24,backgroundColor:m.theme.colors.surface,padding:16,borderRadius:12},reviewHeader:{flexDirection:"row",marginBottom:12},reviewerPhoto:{width:40,height:40,borderRadius:20,marginRight:12},reviewerInfo:{flex:1},reviewerName:{fontSize:16,fontWeight:"600",marginBottom:4,fontFamily:m.theme.fonts.header.fontFamily},serviceInfo:{flexDirection:"row",alignItems:"center",gap:4},reviewText:{fontSize:14,lineHeight:20,fontFamily:m.theme.fonts.regular.fontFamily},modalTitle:{fontSize:20,fontWeight:"600",marginBottom:16,fontFamily:m.theme.fonts.header.fontFamily},modalScroll:{maxHeight:"70vh"},closeButton:{marginTop:16,alignItems:"center",padding:12,backgroundColor:m.theme.colors.primary,borderRadius:8},closeButtonText:{color:"#fff",fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},modalCloseIcon:{padding:8},modalScrollContent:{paddingBottom:24},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)",padding:40},reviewsGrid:{flexDirection:"row",flexWrap:"wrap",gap:16,marginTop:16},reviewItem:{backgroundColor:m.theme.colors.surface,padding:16,borderRadius:12,flex:1,minWidth:300,marginBottom:0},specialistSection:{marginTop:24,backgroundColor:m.theme.colors.surface,padding:16,borderRadius:12},specialistText:{fontSize:16,lineHeight:24,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},modalReviewItem:{marginBottom:16,width:"100%"},leftColumnMobile:{maxWidth:"100%",alignItems:"center"},seeAllButton:{borderWidth:1,borderColor:m.theme.colors.primary,paddingHorizontal:12,paddingVertical:6,borderRadius:8,alignSelf:"flex-start",minWidth:"auto",width:"auto"},seeAllButtonText:{color:m.theme.colors.primary,fontSize:16,fontWeight:"600",textAlign:"center",fontFamily:m.theme.fonts.regular.fontFamily},modalServicesGrid:{flexDirection:"row",flexWrap:"wrap",gap:16,justifyContent:"center",padding:16},reviewMeta:{gap:4},starContainer:{flexDirection:"row",alignItems:"center",marginBottom:4}}),Va=({route:e,navigation:t})=>{const{width:s}=(0,Ne.default)(),{screenWidth:l,isCollapsed:d,is_DEBUG:c}=(0,n.useContext)(h.AuthContext),[u,g]=(0,n.useState)(null),[f,p]=(0,n.useState)(!1),[y,b]=(0,n.useState)(!1),[x,w]=(0,n.useState)(!1),[C,T]=(0,n.useState)(!1),[B,A]=(0,n.useState)([]),[_,I]=(0,n.useState)(!1),[M,L]=(0,n.useState)(l<=900),R=(()=>{const{width:e}=(0,Ne.default)(),[t,o]=(0,n.useState)(!0);return(0,n.useEffect)((()=>{o(e>=900)}),[e]),t})();(0,n.useEffect)((()=>(c&&console.log("MBA9999: ProfessionalProfile component mounted"),()=>{c&&console.log("MBA9999: ProfessionalProfile component unmounting")})),[]),(0,n.useEffect)((()=>{c&&console.log("MBA9999: Professional data changed:",u?u.name:"null")}),[u]),(0,n.useEffect)((()=>{L(l<=900)}),[l]),(0,n.useEffect)((()=>{const e=t.getState().routes.some((e=>"SearchProfessionalsListing"===e.name));p(t.canGoBack()&&e)}),[t]);const D=async()=>{c&&console.log("MBA9999: handleBack called, Platform:","web"),await Ha("currentProfessional"),c&&console.log("MBA9999: Navigating back to SearchProfessionalsListing"),t.navigate("SearchProfessionalsListing")};(0,n.useEffect)((()=>{(async()=>{if(c&&console.log("MBA9999: loadProfessionalData called",{hasRouteParams:!!e?.params?.professional,platform:"web"}),e?.params?.professional)c&&console.log("MBA9999: Setting professional data from route params:",e.params.professional.name),g(e.params.professional),await Oa("currentProfessional",JSON.stringify(e.params.professional));else{const e=await Na("currentProfessional");if(c&&console.log("MBA9999: Checking storage for professional data:",!!e),e)try{const t=JSON.parse(e);c&&console.log("MBA9999: Setting professional data from storage:",t.name),g(t)}catch(zs){console.error("MBA9999: Error parsing stored professional data:",zs),t.replace("SearchProfessionalsListing")}else c&&console.log("MBA9999: No professional data found, redirecting to search"),t.replace("SearchProfessionalsListing")}})()}),[e?.params?.professional,t,c]);const z=e=>{A((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))};if(!u)return(0,j.jsxs)(Ft,{fullWidthHeader:!0,children:[(0,j.jsx)(Dt,{title:"Professional Profile",onBackPress:D}),(0,j.jsx)(r.default,{style:Ua.centered,children:(0,j.jsx)(a.default,{children:"Loading..."})})]});const P=()=>u.profilePicture?(0,j.jsx)(Q.default,{source:{uri:u.profilePicture},style:Ua.profilePhoto}):(0,j.jsx)(r.default,{style:[Ua.profilePhoto,Ua.profilePhotoPlaceholder],children:(0,j.jsx)(S.default,{name:"account",size:80,color:m.theme.colors.primary})}),F=()=>(0,j.jsxs)(r.default,{style:Ua.ratingContainer,children:[(0,j.jsx)(S.default,{name:"star",size:24,color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:Ua.rating,children:u.reviews}),(0,j.jsxs)(a.default,{style:[Ua.reviewCount,{marginLeft:12}],children:["(",u.reviewCount||50," reviews)"]})]}),E=({text:e,maxLines:t=3})=>(0,j.jsxs)(r.default,{children:[(0,j.jsx)(a.default,{numberOfLines:t,style:Ua.specialistText,children:e}),(0,j.jsx)(v.default,{style:Ua.readMoreButton,onPress:()=>T(!0),children:(0,j.jsx)(a.default,{style:Ua.readMoreText,children:"Read more"})})]}),W=()=>{if(Ea){const{MapContainer:e,TileLayer:t,Marker:n}=o(65899);return(0,j.jsx)(r.default,{style:Ua.mapContainer,children:(0,j.jsxs)(e,{center:[38.8339,-104.8214],zoom:13,style:{height:400,width:"100%"},children:[(0,j.jsx)(t,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),(0,j.jsx)(n,{position:[38.8339,-104.8214]})]})})}return null},O=i.default.create({modalContent:{backgroundColor:m.theme.colors.background,padding:24,borderRadius:12,width:l<=650?"90%":"60%",maxWidth:800,maxHeight:"90%"}}),N=({text:e})=>(0,j.jsx)(r.default,{style:Ua.featureBubble,children:(0,j.jsx)(a.default,{style:Ua.featureText,children:e})}),H=e=>(0,j.jsxs)(r.default,{style:Ua.reviewItem,children:[(0,j.jsxs)(r.default,{style:Ua.reviewHeader,children:[(0,j.jsx)(Q.default,{source:{uri:e.photo},style:Ua.reviewerPhoto}),(0,j.jsxs)(r.default,{style:Ua.reviewerInfo,children:[(0,j.jsx)(a.default,{style:Ua.reviewerName,children:e.name}),(0,j.jsxs)(r.default,{style:Ua.reviewMeta,children:[(0,j.jsx)(r.default,{style:Ua.starContainer,children:[...Array(5)].map(((t,o)=>(0,j.jsx)(S.default,{name:o<e.rating?"star":"star-outline",size:16,color:m.theme.colors.primary},o)))}),(0,j.jsxs)(r.default,{style:Ua.serviceInfo,children:[(0,j.jsx)(S.default,{name:"home",size:16,color:m.theme.colors.secondary}),(0,j.jsxs)(a.default,{style:Ua.serviceText,children:[e.service," \u2022 ",e.date]})]})]})]})]}),(0,j.jsx)(a.default,{style:Ua.reviewText,children:e.text})]},e.id),U=()=>(0,j.jsx)(r.default,{style:q.dynamicServicesBox,children:(0,j.jsxs)(r.default,{style:Ua.calendarSection,children:[(0,j.jsx)(a.default,{style:[Ua.sectionTitle,{marginBottom:0}],children:"Availability"}),(0,j.jsx)(wn.Calendar,{style:Ua.calendar,theme:{calendarBackground:m.theme.colors.surface,selectedDayBackgroundColor:m.theme.colors.primary,selectedDayTextColor:"#ffffff",todayTextColor:m.theme.colors.primary}})]})}),V=(i.default.create({servicesSection:{marginBottom:24},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},seeAllButton:{borderWidth:1,borderColor:m.theme.colors.primary,paddingHorizontal:12,paddingVertical:6,borderRadius:8,alignSelf:"flex-start",minWidth:"auto",width:"auto"},seeAllButtonText:{color:m.theme.colors.primary,fontSize:16,fontWeight:"600",textAlign:"center"},servicesScroll:{marginHorizontal:-24,paddingHorizontal:24},modalServicesGrid:{flexDirection:"row",flexWrap:"wrap",gap:16,justifyContent:"center",padding:16}}),()=>{const e=Ie.find((e=>e.professionalId===u.id));if(e)t.replace("MessageHistory",{selectedConversation:e.id});else{const e={id:"conv_".concat(Date.now()),name:u.name,professionalId:u.id,lastMessage:"",timestamp:(new Date).toISOString(),unread:!1,bookingStatus:null};Ie.unshift(e),Me[e.id]=[],t.replace("MessageHistory",{selectedConversation:e.id})}}),q=((e,t)=>i.default.create({mainContainer:{flex:1,backgroundColor:m.theme.colors.background,height:"100vh",overflow:"hidden",position:"fixed",top:0,left:0,right:0,bottom:0,marginLeft:e>900?t?70:250:0,transition:"margin-left 0.3s ease"},dynamicProfileSection:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:16,marginBottom:16,alignItems:"center",width:"100%",display:s>=600?"flex":"block"},dynamicProfileSectionMobile:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:16,marginBottom:16,alignItems:"center",width:"100%",maxWidth:500,alignSelf:"center",display:"flex",flexDirection:"column",alignItems:"center"},dynamicServicesBox:{backgroundColor:m.theme.colors.surface,padding:24,paddingTop:0,borderRadius:12,marginTop:24,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.2,shadowRadius:4,elevation:3,width:"100%",maxWidth:600,alignSelf:"center"}}))(l,d);return(0,j.jsx)(r.default,{style:q.mainContainer,children:(0,j.jsxs)(Ft,{fullWidthHeader:!0,contentWidth:"1200px",children:[(0,j.jsx)(Dt,{title:"Professional Profile",onBackPress:D}),(0,j.jsx)(X.default,{contentContainerStyle:Ua.scrollViewContent,children:(0,j.jsx)(r.default,{style:[Ua.content,{width:(()=>{{const e=l>900?s-(d?70:250):s;return Math.min(1e3,e-32)}})()}],children:(0,j.jsxs)(r.default,{style:[Ua.twoColumnLayout,!R&&Ua.singleColumnLayout],children:[s>=600?(0,j.jsxs)(r.default,{style:[Ua.leftColumn,!R&&Ua.leftColumnMobile],children:[(0,j.jsxs)(r.default,{style:[Ua.profileSection,!R&&Ua.profileSectionMobile],children:[P(),(0,j.jsx)(a.default,{style:Ua.name,children:u.name}),(0,j.jsx)(a.default,{style:Ua.location,children:u.location}),F(),(0,j.jsx)(v.default,{style:Ua.contactButton,onPress:V,children:(0,j.jsxs)(a.default,{style:Ua.contactButtonText,children:["Contact ",u.name]})})]}),R&&U(),R&&W(),R&&Te&&Te.length>0&&(Te&&0!==Te.length?(0,j.jsxs)(r.default,{style:Ua.petsSection,children:[(0,j.jsx)(a.default,{style:Ua.sectionTitle,children:"Pets"}),Te.map(((e,t)=>(0,j.jsxs)(r.default,{style:Ua.petItem,children:[(0,j.jsx)(r.default,{style:Ua.petPhoto,children:(0,j.jsx)(S.default,{name:"dog"===e.animal_type.toLowerCase()?"dog":"cat"===e.animal_type.toLowerCase()?"cat":"snake",size:30,color:m.theme.colors.primary})}),(0,j.jsxs)(r.default,{style:Ua.petInfo,children:[(0,j.jsx)(a.default,{style:Ua.petName,children:e.name}),(0,j.jsx)(a.default,{style:Ua.petBreed,children:e.breed}),(0,j.jsx)(a.default,{style:Ua.petDetails,children:"".concat(e.weight," lbs, ").concat(e.age.years," years").concat(e.age.months?" ".concat(e.age.months," months"):"")})]})]},e.id)))]}):null)]}):(0,j.jsxs)(r.default,{style:[q.dynamicProfileSection,q.dynamicProfileSectionMobile],children:[P(),(0,j.jsx)(a.default,{style:Ua.name,children:u.name}),(0,j.jsx)(a.default,{style:Ua.location,children:u.location}),F(),(0,j.jsx)(v.default,{style:Ua.contactButton,onPress:V,children:(0,j.jsxs)(a.default,{style:Ua.contactButtonText,children:["Contact ",u.name]})})]}),(0,j.jsxs)(r.default,{style:Ua.rightColumn,children:[(0,j.jsxs)(r.default,{style:Ua.servicesSection,children:[(0,j.jsxs)(r.default,{style:Ua.sectionHeader,children:[(0,j.jsx)(a.default,{style:Ua.sectionTitle,children:"Services"}),(0,j.jsx)(v.default,{style:Ua.seeAllButton,onPress:()=>I(!0),children:(0,j.jsx)(a.default,{style:Ua.seeAllButtonText,children:"See All"})})]}),(0,j.jsx)(r.default,{style:Ua.servicesWrapper,children:(0,j.jsx)(X.default,{horizontal:!0,showsHorizontalScrollIndicator:!0,style:[Ua.servicesScroll,{className:"services-scroll",overflowX:"scroll"}],contentContainerStyle:Ua.servicesScrollContent,persistentScrollbar:!0,children:je.slice(0,5).map((e=>(0,j.jsx)(Fa,{service:e,onHeartPress:z,isFavorite:B.includes(e.id),professionalName:u.name,professionalId:u.id,navigation:t},e.id)))})})]}),!R&&U(),(0,j.jsxs)(r.default,{style:Ua.specialistSection,children:[(0,j.jsx)(a.default,{style:Ua.sectionTitle,children:"Specialist Experience"}),(0,j.jsx)(E,{text:u?.bio||""})]}),(0,j.jsxs)(r.default,{style:Ua.reviewsSection,children:[(0,j.jsx)(a.default,{style:Ua.sectionTitle,children:"Reviews"}),(0,j.jsx)(r.default,{style:Ua.reviewsGrid,children:Wa.slice(0,4).map(H)}),(0,j.jsx)(v.default,{style:Ua.readMoreButton,onPress:()=>w(!0),children:(0,j.jsx)(a.default,{style:Ua.readMoreText,children:"Read more reviews"})})]}),(0,j.jsxs)(r.default,{style:Ua.homeSection,children:[(0,j.jsx)(a.default,{style:Ua.sectionTitle,children:"Home"}),(0,j.jsxs)(r.default,{style:Ua.homeFeaturesGrid,children:[(0,j.jsx)(N,{text:"No children present"}),(0,j.jsx)(N,{text:"Has security system"}),(0,j.jsx)(N,{text:"Non-smoking household"}),(0,j.jsx)(N,{text:"Has 2 dogs"}),(0,j.jsx)(N,{text:"Dogs allowed on bed"}),(0,j.jsx)(N,{text:"Dogs allowed on furniture"}),(0,j.jsx)(N,{text:"Potty breaks every 0-2 hours"})]})]}),!R&&W()]})]})})}),(0,j.jsx)(k.default,{visible:y,animationType:"slide",transparent:!0,onRequestClose:()=>b(!1),children:(0,j.jsx)(r.default,{style:Ua.modalContainer,children:(0,j.jsxs)(r.default,{style:O.modalContent,children:[(0,j.jsx)(a.default,{style:Ua.bioText,children:u.bio}),(0,j.jsx)(v.default,{style:Ua.closeButton,onPress:()=>b(!1),children:(0,j.jsx)(a.default,{style:Ua.closeButtonText,children:"Close"})})]})})}),(0,j.jsx)(k.default,{visible:x,animationType:"slide",transparent:!0,onRequestClose:()=>w(!1),children:(0,j.jsx)(r.default,{style:Ua.modalContainer,children:(0,j.jsxs)(r.default,{style:O.modalContent,children:[(0,j.jsxs)(r.default,{style:Ua.modalHeader,children:[(0,j.jsx)(a.default,{style:Ua.modalTitle,children:"All Reviews"}),(0,j.jsx)(v.default,{style:Ua.modalCloseIcon,onPress:()=>w(!1),children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,j.jsx)(X.default,{style:Ua.modalScroll,contentContainerStyle:Ua.modalScrollContent,children:Wa.map((e=>(0,j.jsx)(r.default,{style:Ua.modalReviewItem,children:H(e)},e.id)))})]})})}),(0,j.jsx)(k.default,{visible:C,animationType:"slide",transparent:!0,onRequestClose:()=>T(!1),children:(0,j.jsx)(r.default,{style:Ua.modalContainer,children:(0,j.jsxs)(r.default,{style:O.modalContent,children:[(0,j.jsxs)(r.default,{style:Ua.modalHeader,children:[(0,j.jsx)(a.default,{style:Ua.modalTitle,children:"Specialist Experience"}),(0,j.jsx)(v.default,{style:Ua.modalCloseIcon,onPress:()=>T(!1),children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,j.jsx)(X.default,{style:Ua.modalScroll,contentContainerStyle:Ua.modalScrollContent,children:(0,j.jsx)(a.default,{style:Ua.bioText,children:u?.bio})})]})})}),(0,j.jsx)(k.default,{visible:_,animationType:"slide",transparent:!0,onRequestClose:()=>I(!1),children:(0,j.jsx)(r.default,{style:Ua.modalContainer,children:(0,j.jsxs)(r.default,{style:O.modalContent,children:[(0,j.jsxs)(r.default,{style:Ua.modalHeader,children:[(0,j.jsx)(a.default,{style:Ua.modalTitle,children:"All Services"}),(0,j.jsx)(v.default,{style:Ua.modalCloseIcon,onPress:()=>I(!1),children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,j.jsx)(X.default,{style:Ua.modalScroll,contentContainerStyle:Ua.modalScrollContent,children:(0,j.jsx)(r.default,{style:Ua.modalServicesGrid,children:je.map((e=>(0,j.jsx)(Fa,{service:e,onHeartPress:z,isFavorite:B.includes(e.id),professionalName:u.name,professionalId:u.id,navigation:t},e.id)))})})]})})})]})})},qa=i.default.create({container:{marginTop:16},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",marginTop:50},sectionTitle:{fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"bold",marginBottom:8,color:m.theme.colors.text},noContractsText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,textAlign:"center",marginTop:20},card:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:16,marginBottom:16},contractTitle:{fontSize:m.theme.fontSizes.medium,fontWeight:"bold",color:m.theme.colors.primary},ownerName:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginTop:4},buttonContainer:{flexDirection:"row",justifyContent:"flex-end",marginTop:8},button:{backgroundColor:m.theme.colors.primary,paddingHorizontal:12,paddingVertical:6,borderRadius:4,marginLeft:8},buttonText:{color:m.theme.colors.background,fontWeight:"bold"}}),Ya=()=>{const[e,t]=(0,n.useState)([]),[o,i]=(0,n.useState)(!0);(0,n.useEffect)((()=>{s()}),[]);const s=async()=>{i(!0);try{const e=await y.default.getItem("userToken");if(!e)return void console.error("No token found");const o=await x.default.get("".concat(p.API_BASE_URL,"/api/contracts/"),{headers:{Authorization:"Bearer ".concat(e)}});t(o.data)}catch(zs){console.error("Error fetching contracts:",zs)}finally{i(!1)}};return o?(0,j.jsx)(r.default,{style:qa.loadingContainer,children:(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.primary})}):(0,j.jsxs)(r.default,{style:qa.container,children:[(0,j.jsx)(a.default,{style:qa.sectionTitle,children:"Your Contracts"}),0===e.length?(0,j.jsx)(a.default,{style:qa.noContractsText,children:"No contracts yet"}):e.map((e=>(0,j.jsxs)(r.default,{style:qa.card,children:[(0,j.jsx)(a.default,{style:qa.contractTitle,children:e.title}),(0,j.jsxs)(a.default,{style:qa.ownerName,children:["Owner: ",e.owner_name]}),(0,j.jsxs)(r.default,{style:qa.buttonContainer,children:[(0,j.jsx)(v.default,{style:qa.button,children:(0,j.jsx)(a.default,{style:qa.buttonText,children:"Share"})}),(0,j.jsx)(v.default,{style:qa.button,children:(0,j.jsx)(a.default,{style:qa.buttonText,children:"Edit"})})]})]},e.id)))]})},Ga=i.default.create({picker:{backgroundColor:m.theme.colors.surface,marginBottom:8,borderRadius:4,padding:0,width:"90%"},modalPicker:{width:"90%"},dropdownButton:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:m.theme.colors.surface,borderRadius:4,padding:12,marginBottom:16,borderWidth:1,borderColor:m.theme.colors.border},dropdownButtonText:{color:m.theme.colors.text},pickerModalContainer:{flex:1,justifyContent:"flex-end",backgroundColor:"rgba(0, 0, 0, 0.5)"},pickerContainer:{backgroundColor:m.theme.colors.background,borderTopLeftRadius:20,borderTopRightRadius:20,padding:16},pickerCloseButton:{backgroundColor:m.theme.colors.primary,padding:16,alignItems:"center"},pickerCloseButtonText:{color:m.theme.colors.background,fontWeight:"bold"}}),Ja=({owners:e,selectedOwner:t,onSelectOwner:o})=>{const[r,a]=(0,n.useState)(!1);return(0,j.jsxs)(Ye.Picker,{selectedValue:t,onValueChange:e=>o(e),style:Ga.picker,children:[(0,j.jsx)(Ye.Picker.Item,{label:"Select a owner...",value:""}),e.map((e=>(0,j.jsx)(Ye.Picker.Item,{label:e.name,value:e.name},e.id)))]})},$a=i.default.create({container:{marginBottom:16},sectionTitle:{fontSize:18,fontWeight:"bold",marginBottom:8,color:m.theme.colors.text},button:{backgroundColor:m.theme.colors.primary,paddingHorizontal:16,paddingVertical:12,borderRadius:8,alignItems:"center",marginBottom:10},buttonText:{color:m.theme.colors.background,fontWeight:"bold",fontSize:16},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{width:"80%",backgroundColor:m.theme.colors.surface,borderRadius:10,padding:20,alignItems:"center"},modalTitle:{fontSize:20,fontWeight:"bold",marginBottom:20},templateGrid:{flexDirection:"row",flexWrap:"wrap",justifyContent:"center"},templateBox:{width:100,height:100,margin:10,justifyContent:"center",alignItems:"center",backgroundColor:m.theme.colors.primary,borderRadius:5},templateTitle:{color:m.theme.colors.background,textAlign:"center"},noTemplatesText:{fontSize:16,color:m.theme.colors.text,textAlign:"center",marginTop:20},closeButton:{marginTop:20,padding:10,backgroundColor:m.theme.colors.primary,borderRadius:5},closeButtonText:{color:m.theme.colors.background,fontWeight:"bold"},textArea:{width:"100%",height:100,padding:10,borderColor:m.theme.colors.primary,borderWidth:1,borderRadius:5,marginBottom:10,textAlignVertical:"top"},ownerPickerContainer:{width:"100%",marginBottom:10},pickerModalContainer:{flex:1,justifyContent:"flex-end",backgroundColor:"rgba(0, 0, 0, 0.5)"},pickerContainer:{backgroundColor:m.theme.colors.background,borderTopLeftRadius:20,borderTopRightRadius:20,padding:16},pickerCloseButton:{backgroundColor:m.theme.colors.primary,padding:16,alignItems:"center"},pickerCloseButtonText:{color:m.theme.colors.background,fontWeight:"bold"}}),Ka=({templates:e})=>{const[t,o]=(0,n.useState)(!1),[i,s]=(0,n.useState)(!1),[l,d]=(0,n.useState)(null),[c,u]=(0,n.useState)(""),[g,m]=(0,n.useState)([]),[h,f]=(0,n.useState)("");(0,n.useEffect)((()=>{b()}),[]);const b=async()=>{try{const e=await y.default.getItem("userToken");if(!e)return void console.error("No token found");const t=await x.default.get("".concat(p.API_BASE_URL,"/api/clients/"),{headers:{Authorization:"Bearer ".concat(e)}});m(t.data)}catch(zs){console.error("Error fetching owners:",zs)}};return(0,j.jsxs)(r.default,{style:$a.container,children:[(0,j.jsx)(a.default,{style:$a.sectionTitle,children:"Create New Contract"}),(0,j.jsx)(v.default,{style:$a.button,onPress:()=>o(!0),children:(0,j.jsx)(a.default,{style:$a.buttonText,children:"Use Template"})}),(0,j.jsx)(k.default,{visible:t,transparent:!0,animationType:"slide",onRequestClose:()=>o(!1),children:(0,j.jsx)(r.default,{style:$a.modalContainer,children:(0,j.jsxs)(r.default,{style:$a.modalContent,children:[(0,j.jsx)(a.default,{style:$a.modalTitle,children:"Select a Template"}),(0,j.jsx)(X.default,{contentContainerStyle:$a.templateGrid,children:0===e.length?(0,j.jsx)(a.default,{style:$a.noTemplatesText,children:"No templates yet"}):e.map((e=>(0,j.jsx)(v.default,{style:$a.templateBox,onPress:()=>(e=>{d(e),u(e.description),o(!1),s(!0)})(e),children:(0,j.jsx)(a.default,{style:$a.templateTitle,children:e.title})},e.id)))}),(0,j.jsx)(v.default,{style:$a.closeButton,onPress:()=>o(!1),children:(0,j.jsx)(a.default,{style:$a.closeButtonText,children:"Close"})})]})})}),(0,j.jsx)(k.default,{visible:i,transparent:!0,animationType:"slide",onRequestClose:()=>s(!1),children:(0,j.jsx)(r.default,{style:$a.modalContainer,children:(0,j.jsxs)(r.default,{style:$a.modalContent,children:[(0,j.jsx)(a.default,{style:$a.modalTitle,children:"Edit Contract"}),(0,j.jsxs)(r.default,{style:$a.ownerPickerContainer,children:[(0,j.jsx)(a.default,{style:$a.sectionTitle,children:"Select a Owner"}),(0,j.jsx)(Ja,{owners:g,selectedOwner:h,onSelectOwner:f})]}),(0,j.jsx)(te.default,{style:$a.textArea,placeholder:"Contract Content",value:c,onChangeText:u,multiline:!0}),(0,j.jsx)(v.default,{style:$a.button,onPress:()=>{u((e=>"".concat(e,"\n[signable] ___________ [end signable]")))},children:(0,j.jsx)(a.default,{style:$a.buttonText,children:"Add Signable Field"})}),(0,j.jsx)(v.default,{style:$a.button,onPress:async()=>{try{const e=await y.default.getItem("userToken");if(!e)return void console.error("No token found");const t=await x.default.post("".concat(p.API_BASE_URL,"/api/contracts/"),{template:l.id,content:c,owner:h},{headers:{Authorization:"Bearer ".concat(e)}});console.log("Contract submitted:",t.data),s(!1)}catch(zs){console.error("Error submitting contract:",zs)}},children:(0,j.jsx)(a.default,{style:$a.buttonText,children:"Submit Contract"})}),(0,j.jsx)(v.default,{style:$a.closeButton,onPress:()=>s(!1),children:(0,j.jsx)(a.default,{style:$a.closeButtonText,children:"Close"})})]})})})]})},Za=i.default.create({container:{flex:1},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",minHeight:200},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",minHeight:200,backgroundColor:m.theme.colors.surface,borderRadius:8,padding:20,marginTop:16},emptyText:{fontSize:16,color:m.theme.colors.text,textAlign:"center"},sectionTitle:{fontSize:18,fontWeight:"bold",marginBottom:8,color:m.theme.colors.text},card:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:16,marginBottom:16},chronicleTitle:{fontSize:16,fontWeight:"bold",color:m.theme.colors.primary},ownerName:{fontSize:14,color:m.theme.colors.text,marginTop:4},petName:{fontSize:14,color:m.theme.colors.text,marginTop:2},summary:{fontSize:14,color:m.theme.colors.text,marginTop:8,marginBottom:8},buttonContainer:{flexDirection:"row",justifyContent:"flex-end",marginTop:8},button:{backgroundColor:m.theme.colors.primary,paddingHorizontal:12,paddingVertical:6,borderRadius:4,marginLeft:8},buttonText:{color:m.theme.colors.background,fontWeight:"bold"}}),Xa=({chronicles:e})=>e&&0!==e.length?(0,j.jsxs)(X.default,{style:Za.container,children:[(0,j.jsx)(a.default,{style:Za.sectionTitle,children:"Your Chronicles"}),e.map((e=>(0,j.jsxs)(r.default,{style:Za.card,children:[(0,j.jsx)(a.default,{style:Za.chronicleTitle,children:e.title}),(0,j.jsxs)(a.default,{style:Za.ownerName,children:["Owner: ",e.owner]}),(0,j.jsxs)(a.default,{style:Za.petName,children:["Pet: ",e.pets.join(", ")]}),(0,j.jsx)(a.default,{style:Za.summary,children:e.summary}),(0,j.jsxs)(r.default,{style:Za.buttonContainer,children:[(0,j.jsx)(v.default,{style:Za.button,children:(0,j.jsx)(a.default,{style:Za.buttonText,children:"Edit"})}),(0,j.jsx)(v.default,{style:Za.button,children:(0,j.jsx)(a.default,{style:Za.buttonText,children:"Send to Owner"})})]})]},e.id)))]}):(0,j.jsx)(r.default,{style:Za.emptyContainer,children:(0,j.jsx)(a.default,{style:Za.emptyText,children:"No chronicles yet"})}),{width:Qa}=C.default.get("window"),ei=i.default.create({outerContainer:{width:"100%",alignItems:"center",marginBottom:16},container:{width:Qa-80,maxWidth:600,alignItems:"center"},inputContainer:{width:"100%",position:"relative"},input:Object.assign({width:"100%",backgroundColor:m.theme.colors.surface,borderRadius:4,padding:8,minHeight:60},{border:"1px solid ".concat(m.theme.colors.border)}),dropdownButton:{position:"absolute",right:8,top:8,padding:4},modalOverlay:{flex:1},dropdownContainer:Object.assign({position:"absolute",backgroundColor:m.theme.colors.background,borderRadius:4,borderWidth:1,borderColor:m.theme.colors.border,maxHeight:200,zIndex:1e3},{boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}),dropdownList:{maxHeight:200},dropdownItem:{padding:12,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},dropdownItemText:{color:m.theme.colors.text}}),ti=({value:e,onChange:t})=>{const[o,i]=(0,n.useState)(!1),[s,l]=(0,n.useState)({top:0,left:0,width:0}),d=(0,n.useRef)(null),[c,u]=(0,n.useState)(null),g=e=>{t(e)};(0,n.useLayoutEffect)((()=>(o&&d.current&&d.current.measure(((e,t,o,n,r,a)=>{if(!isNaN(a)&&!isNaN(n)){l({top:a+n,left:r,width:o})}})),document.body.style.overflow=o?"hidden":"auto",()=>{document.body.style.overflow="auto"})),[o,c]);const h=()=>{i(!o)};return(0,j.jsx)(r.default,{style:ei.outerContainer,children:(0,j.jsxs)(r.default,{style:ei.container,children:[(0,j.jsxs)(r.default,{style:ei.inputContainer,ref:d,onLayout:e=>{const{x:t,y:o,width:n,height:r}=e.nativeEvent.layout;u({x:t,y:o,width:n,height:r})},children:[(0,j.jsx)(te.default,{style:ei.input,value:e,onChangeText:g,placeholder:"Enter or select a question",multiline:!0}),(0,j.jsx)(v.default,{style:ei.dropdownButton,onPress:h,children:(0,j.jsx)(S.default,{name:o?"chevron-up":"chevron-down",size:24,color:m.theme.colors.primary})})]}),(0,j.jsx)(k.default,{visible:o,transparent:!0,animationType:"none",onRequestClose:h,children:(0,j.jsx)(v.default,{style:ei.modalOverlay,activeOpacity:1,onPress:h,children:(0,j.jsx)(r.default,{style:[ei.dropdownContainer,{top:s.top,left:s.left,width:s.width}],children:(0,j.jsx)(X.default,{style:ei.dropdownList,children:["What is your favorite animal?","How many pets do you have?","What's your experience with exotic pets?","Do you have any allergies to animals?","What type of exotic pet are you interested in?","Have you owned an exotic pet before?","Are you familiar with the care requirements for exotic pets?","Do you have a veterinarian experienced with exotic animals?","What's your living situation? (House, apartment, etc.)","Are there any local regulations about exotic pet ownership in your area?"].map(((e,t)=>(0,j.jsx)(v.default,{style:ei.dropdownItem,onPress:()=>{g(e),h()},children:(0,j.jsx)(a.default,{style:ei.dropdownItemText,children:e})},t)))})})})})]})})},{width:oi}=C.default.get("window"),ni=i.default.create({createButton:{backgroundColor:m.theme.colors.primary,paddingHorizontal:16,paddingVertical:12,borderRadius:8,alignItems:"center",marginBottom:16},createButtonText:{color:m.theme.colors.background,fontWeight:"bold",fontSize:16},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:m.theme.colors.background,borderRadius:8,padding:16,width:"90%",maxHeight:"80%"},webModalContent:{width:oi>600?"40%":"90%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},modalTitle:{fontSize:20,fontWeight:"bold",color:m.theme.colors.text},closeButton:{padding:8},closeButtonText:{fontSize:20,color:m.theme.colors.text,fontWeight:"bold"},label:{fontSize:16,fontWeight:"bold",marginBottom:8,color:m.theme.colors.text},input:{backgroundColor:m.theme.colors.surface,borderRadius:4,marginBottom:8,minHeight:20},picker:{backgroundColor:m.theme.colors.surface,marginBottom:8,borderRadius:4,padding:0},petOption:{padding:8,backgroundColor:m.theme.colors.surface,marginBottom:8,borderRadius:4},selectedPet:{backgroundColor:m.theme.colors.primary},petOptionText:{color:m.theme.colors.text},uploadButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:12,backgroundColor:m.theme.colors.surface,borderRadius:4,marginTop:16},uploadButtonText:{marginLeft:8,color:m.theme.colors.primary,fontWeight:"bold"},photoPreview:{flexDirection:"row",marginTop:16},photoThumbnail:{width:80,height:80,marginRight:8,borderRadius:4},questionContainer:{marginBottom:16,width:"100%",alignItems:"center"},modalButtonContainer:{flexDirection:"row",justifyContent:"space-between",marginTop:16},cancelButton:{backgroundColor:m.theme.colors.error,paddingHorizontal:16,paddingVertical:12,borderRadius:4,alignItems:"center",flex:1,marginRight:8},cancelButtonText:{color:m.theme.colors.background,fontWeight:"bold"},submitButton:{backgroundColor:m.theme.colors.primary,paddingHorizontal:16,paddingVertical:12,borderRadius:4,alignItems:"center",flex:1,marginLeft:8},submitButtonText:{color:m.theme.colors.background,fontWeight:"bold"},addQuestionButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:12,backgroundColor:m.theme.colors.surface,borderRadius:4,marginTop:8,marginBottom:16,zIndex:1},addQuestionButtonText:{marginLeft:8,zIndex:1,color:m.theme.colors.primary,fontWeight:"bold"},answerInputContainer:{width:"100%",alignItems:"center"},answerInput:Object.assign({width:oi-80,maxWidth:600,minHeight:60,backgroundColor:m.theme.colors.surface,borderRadius:4,padding:8,marginTop:8},{border:"1px solid ".concat(m.theme.colors.border)}),summaryInput:Object.assign({backgroundColor:m.theme.colors.surface,borderRadius:4,marginBottom:8,padding:8,height:100,textAlignVertical:"top"},{minHeight:100},{border:"1px solid ".concat(m.theme.colors.border)}),dropdownButton:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:m.theme.colors.surface,borderRadius:4,padding:12,marginBottom:16,borderWidth:1,borderColor:m.theme.colors.border},dropdownButtonText:{color:m.theme.colors.text},pickerModalContainer:{flex:1,justifyContent:"flex-end",backgroundColor:"rgba(0, 0, 0, 0.5)"},pickerContainer:{backgroundColor:m.theme.colors.background,borderTopLeftRadius:20,borderTopRightRadius:20,padding:16},pickerCloseButton:{backgroundColor:m.theme.colors.primary,padding:16,alignItems:"center"},pickerCloseButtonText:{color:m.theme.colors.background,fontWeight:"bold"},photoContainer:{marginRight:8},photo:{width:100,height:100,borderRadius:8}}),ri=({onCreateChronicle:e})=>{const[t,o]=(0,n.useState)(!1),[i,s]=(0,n.useState)(""),[l,d]=(0,n.useState)([]),[c,u]=(0,n.useState)([{question:"",answer:"",isPreset:!0}]),[g,h]=(0,n.useState)(""),[f,p]=(0,n.useState)([]),[y,b]=(0,n.useState)(!1),[x,w]=(0,n.useState)(!1),[C,T]=(0,n.useState)(!1),B=[{id:"1",name:"John Doe",pets:[{id:"1",name:"Max"},{id:"2",name:"Bella"}]},{id:"2",name:"Jane Smith",pets:[{id:"3",name:"Luna"},{id:"4",name:"Charlie"}]}],_=(e,t,o)=>{const n=[...c];n[e]=Object.assign({},n[e],{[t]:o}),u(n)},I=()=>{s(""),d([]),h(""),u([{question:"",answer:""}]),p([])},M=({photo:e})=>(0,j.jsx)(r.default,{style:ni.photoContainer,children:(0,j.jsx)(Q.default,{source:{uri:e.uri},style:ni.photo})});return(0,j.jsxs)(r.default,{children:[(0,j.jsx)(v.default,{style:ni.createButton,onPress:()=>o(!0),children:(0,j.jsx)(a.default,{style:ni.createButtonText,children:"Create New Chronicle"})}),(0,j.jsx)(k.default,{animationType:"slide",transparent:!0,visible:t,onRequestClose:()=>o(!1),children:(0,j.jsx)(r.default,{style:ni.modalContainer,children:(0,j.jsxs)(r.default,{style:[ni.modalContent,ni.webModalContent],children:[(0,j.jsxs)(r.default,{style:ni.modalHeader,children:[(0,j.jsx)(a.default,{style:ni.modalTitle,children:"Create New Chronicle"}),(0,j.jsx)(v.default,{onPress:()=>o(!1),children:(0,j.jsx)(a.default,{style:ni.closeButtonText,children:"\u2715"})})]}),(0,j.jsxs)(X.default,{children:[(0,j.jsx)(a.default,{style:ni.label,children:"Select Owner"}),(0,j.jsx)(Ja,{owners:B,selectedOwner:i,onSelectOwner:s}),(0,j.jsx)(a.default,{style:ni.label,children:"Select Pets"}),i&&B.find((e=>e.name===i))?.pets.map((e=>(0,j.jsx)(v.default,{style:[ni.petOption,l.includes(e.name)&&ni.selectedPet],onPress:()=>{l.includes(e.name)?d(l.filter((t=>t!==e.name))):d([...l,e.name])},children:(0,j.jsx)(a.default,{style:ni.petOptionText,children:e.name})},e.id))),(0,j.jsx)(a.default,{style:ni.label,children:"Summary"}),(0,j.jsx)(te.default,{style:ni.summaryInput,multiline:!0,value:g,onChangeText:h,placeholder:"Write a summary of the chronicle",textAlignVertical:"top"}),c.map(((e,t)=>(0,j.jsxs)(r.default,{style:ni.questionContainer,children:[(0,j.jsxs)(a.default,{style:ni.label,children:["Question ",t+1]}),(0,j.jsx)(ti,{value:e.question,onChange:e=>_(t,"question",e)}),(0,j.jsx)(r.default,{style:ni.answerInputContainer,children:(0,j.jsx)(te.default,{style:[ni.input,ni.answerInput],value:e.answer,onChangeText:e=>_(t,"answer",e),placeholder:"Enter answer",multiline:!0})})]},t))),(0,j.jsxs)(v.default,{style:ni.addQuestionButton,onPress:()=>{u([...c,{question:"",answer:"",isPreset:!1}])},children:[(0,j.jsx)(S.default,{name:"plus",size:20,color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:ni.addQuestionButtonText,children:"Add Another Question"})]}),(0,j.jsxs)(v.default,{style:ni.uploadButton,onPress:async()=>{try{b(!0);const e=await Mt.launchImageLibraryAsync({mediaTypes:Lt.MediaTypeOptions.Images,allowsMultipleSelection:!0,quality:1});e.canceled||p([...f,...e.assets])}catch(zs){console.error("Error uploading images:",zs)}finally{b(!1)}},disabled:y,children:[(0,j.jsx)(S.default,{name:"camera",size:24,color:y?m.theme.colors.disabled:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:[ni.uploadButtonText,y&&ni.uploadingText],children:y?"Uploading...":"Upload Photos"}),y&&(0,j.jsx)(A.default,{size:"small",color:m.theme.colors.primary,style:ni.uploadingSpinner})]}),(0,j.jsx)(X.default,{horizontal:!0,style:ni.photoPreview,children:f.map(((e,t)=>(0,j.jsx)(M,{photo:e},t)))})]}),(0,j.jsxs)(r.default,{style:ni.modalButtonContainer,children:[(0,j.jsx)(v.default,{style:ni.cancelButton,onPress:()=>{o(!1),I()},children:(0,j.jsx)(a.default,{style:ni.cancelButtonText,children:"Cancel"})}),(0,j.jsx)(v.default,{style:ni.submitButton,onPress:()=>{T(!0);const t={id:Date.now(),owner:i,pets:l,summary:g,questions:c,photos:f,title:"Chronicle for ".concat(i)};setTimeout((()=>{console.log("Sending data to backend:",t),e(t),T(!1),o(!1),I()}),2e3)},disabled:C,children:(0,j.jsx)(a.default,{style:ni.submitButtonText,children:C?"Creating Chronicle...":"Create Chronicle"})})]})]})})})]})},ai=i.default.create({safeArea:{flex:1,backgroundColor:m.theme.colors.background,paddingTop:0},scrollViewContent:{flexGrow:1},container:{flex:1,padding:16,alignItems:"center"},title:{fontSize:24,fontWeight:"bold",marginBottom:16,color:m.theme.colors.primary,textAlign:"center"},tabContainer:{flexDirection:"row",marginBottom:16,width:"100%",maxWidth:500},tab:{flex:1,paddingVertical:12,alignItems:"center",backgroundColor:m.theme.colors.surface,borderRadius:8,marginHorizontal:4},activeTab:{backgroundColor:m.theme.colors.primary},tabText:{color:m.theme.colors.text,fontWeight:"bold"},activeTabText:{color:m.theme.colors.background},contentContainer:{width:"100%",maxWidth:500},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",minHeight:200},useTemplateButton:{backgroundColor:m.theme.colors.primary,padding:10,borderRadius:5,marginBottom:16,alignItems:"center"},useTemplateButtonText:{color:m.theme.colors.background,fontWeight:"bold"},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{width:"80%",backgroundColor:m.theme.colors.surface,borderRadius:10,padding:20,alignItems:"center"},modalTitle:{fontSize:20,fontWeight:"bold",marginBottom:20},templateGrid:{flexDirection:"row",flexWrap:"wrap",justifyContent:"center"},templateBox:{width:100,height:100,backgroundColor:m.theme.colors.primary,margin:10,justifyContent:"center",alignItems:"center",borderRadius:5},templateTitle:{color:m.theme.colors.background,textAlign:"center"},closeButton:{marginTop:20,padding:10,backgroundColor:m.theme.colors.primary,borderRadius:5},closeButtonText:{color:m.theme.colors.background,fontWeight:"bold"}}),ii=()=>{const[e,t]=(0,n.useState)("contracts"),[o,i]=(0,n.useState)([]),[s,l]=(0,n.useState)(!1),[d,c]=(0,n.useState)([]);(0,n.useEffect)((()=>{"chronicles"===e&&u()}),[e]);const u=async()=>{l(!0),await new Promise((e=>setTimeout(e,1e3)));i([{id:1,title:"Fluffy's Adventure",owner:"John Doe",pets:["Fluffy"],summary:"Fluffy had a great time at the park today!"},{id:2,title:"Max's Playdate",owner:"Jane Smith",pets:["Max"],summary:"Max enjoyed playing with other dogs at the beach."}]),l(!1)};(0,n.useEffect)((()=>{(async()=>{try{const e=await y.default.getItem("userToken");if(!e)return void console.error("No token found");const t=await x.default.get("".concat(p.API_BASE_URL,"/api/contracts/templates/"),{headers:{Authorization:"Bearer ".concat(e)}});c(t.data)}catch(zs){console.error("Error fetching templates:",zs)}})()}),[]);return(0,j.jsx)(He.default,{style:ai.safeArea,children:(0,j.jsx)(X.default,{contentContainerStyle:ai.scrollViewContent,children:(0,j.jsxs)(r.default,{style:ai.container,children:[(0,j.jsx)(a.default,{style:ai.title,children:"My Contracts & Chronicles"}),(0,j.jsxs)(r.default,{style:ai.tabContainer,children:[(0,j.jsx)(v.default,{style:[ai.tab,"contracts"===e&&ai.activeTab],onPress:()=>t("contracts"),children:(0,j.jsx)(a.default,{style:[ai.tabText,"contracts"===e&&ai.activeTabText],children:"Contracts"})}),(0,j.jsx)(v.default,{style:[ai.tab,"chronicles"===e&&ai.activeTab],onPress:()=>t("chronicles"),children:(0,j.jsx)(a.default,{style:[ai.tabText,"chronicles"===e&&ai.activeTabText],children:"Critter Chronicles"})})]}),"contracts"===e&&(0,j.jsxs)(r.default,{style:ai.contentContainer,children:[(0,j.jsx)(Ka,{templates:d}),(0,j.jsx)(Ya,{})]}),"chronicles"===e&&(0,j.jsx)(r.default,{style:ai.contentContainer,children:s?(0,j.jsx)(r.default,{style:ai.loadingContainer,children:(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.primary})}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ri,{onCreateChronicle:e=>{i((t=>[...t,e]))}}),(0,j.jsx)(Xa,{chronicles:o})]})})]})})})},{width:si}=C.default.get("window"),li=(e,t)=>i.default.create({container:{flex:1,backgroundColor:m.theme.colors.background,marginLeft:e>900?t?70:250:0,transition:"margin-left 0.3s ease"},safeArea:{flex:1,paddingTop:0},content:{flex:1,justifyContent:"center",alignItems:"center",padding:20},backButton:{position:"absolute",top:20,left:20,flexDirection:"row",alignItems:"center",zIndex:1},backText:{marginLeft:8,fontSize:18,fontWeight:"600",color:m.theme.colors.text},card:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:12,padding:40,width:"100%",maxWidth:400,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5},title:{fontSize:28,fontWeight:"600",color:m.theme.colors.text,textAlign:"center",marginBottom:30},inputContainer:{position:"relative",marginBottom:20},input:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:15,fontSize:16,color:m.theme.colors.text,borderWidth:1,borderColor:m.theme.colors.border,paddingRight:50},eyeIcon:{position:"absolute",right:15,top:15,padding:5},button:{marginTop:10,marginBottom:20},errorText:{color:m.theme.colors.error,textAlign:"center",marginBottom:15,fontSize:14},successText:{color:m.theme.colors.success||"#4CAF50",textAlign:"center",marginBottom:15,fontSize:14},loader:{marginTop:10},forgotPasswordButton:{alignItems:"center",marginTop:10},forgotPasswordText:{color:m.theme.colors.primary,fontSize:14,textDecorationLine:"underline"}}),di=()=>{const[e,t]=(0,n.useState)(""),[o,i]=(0,n.useState)(""),[s,l]=(0,n.useState)(""),[d,c]=(0,n.useState)(""),[u,g]=(0,n.useState)(""),[f,p]=(0,n.useState)(!1),[x,w]=(0,n.useState)(!1),[C,T]=(0,n.useState)(!1),[B,k]=(0,n.useState)(!1),{isSignedIn:_,screenWidth:I,isCollapsed:M}=(0,n.useContext)(h.AuthContext),[L,R]=(0,n.useState)(null),[D,z]=(0,n.useState)(""),[P,F]=(0,n.useState)(""),[E,W]=(0,n.useState)(""),O=(0,b.useNavigation)();(0,n.useEffect)((()=>{(async()=>{const e=await y.default.getItem("userToken");R(e)})()}),[]);const N=li(I,M);return(0,j.jsx)(r.default,{style:N.container,children:(0,j.jsx)(He.default,{style:N.safeArea,children:(0,j.jsxs)(r.default,{style:N.content,children:[(0,j.jsxs)(v.default,{onPress:()=>O.navigate("MyProfile",{initialTab:"settings_payments"}),style:N.backButton,children:[(0,j.jsx)(S.default,{name:"arrow-left",size:24,color:m.theme.colors.text}),(0,j.jsx)(a.default,{style:N.backText,children:"Change Password"})]}),(0,j.jsxs)(r.default,{style:N.card,children:[(0,j.jsx)(a.default,{style:N.title,children:"Change Password"}),(0,j.jsxs)(r.default,{style:N.inputContainer,children:[(0,j.jsx)(te.default,{style:[N.input,D?N.errorInput:null],placeholder:"Current Password",value:e,onChangeText:e=>{const o=Ke(e,"password"),n=e.length>0?(e.length-o.length)/e.length*100:0;n>50&&e.length>8?(0,h.debugLog)("MBA1234: Potentially malicious current password input detected:",{original:e,sanitized:o,removalPercentage:n}):(t(o),z(""),c(""),g(""))},secureTextEntry:!x,placeholderTextColor:m.theme.colors.placeHolderText}),(0,j.jsx)(v.default,{style:N.eyeIcon,onPress:()=>w(!x),children:(0,j.jsx)(S.default,{name:x?"eye-off":"eye",size:20,color:m.theme.colors.placeHolderText})}),D?(0,j.jsx)(a.default,{style:N.errorText,children:D}):null]}),(0,j.jsxs)(r.default,{style:N.inputContainer,children:[(0,j.jsx)(te.default,{style:[N.input,P?N.errorInput:null],placeholder:"New Password",value:o,onChangeText:e=>{const t=Ke(e,"password"),o=e.length>0?(e.length-t.length)/e.length*100:0;o>50&&e.length>8?(0,h.debugLog)("MBA1234: Potentially malicious new password input detected:",{original:e,sanitized:t,removalPercentage:o}):(i(t),F(""),c(""),g(""))},secureTextEntry:!C,placeholderTextColor:m.theme.colors.placeHolderText}),(0,j.jsx)(v.default,{style:N.eyeIcon,onPress:()=>T(!C),children:(0,j.jsx)(S.default,{name:C?"eye-off":"eye",size:20,color:m.theme.colors.placeHolderText})}),P?(0,j.jsx)(a.default,{style:N.errorText,children:P}):null]}),(0,j.jsxs)(r.default,{style:N.inputContainer,children:[(0,j.jsx)(te.default,{style:[N.input,E?N.errorInput:null],placeholder:"Confirm New Password",value:s,onChangeText:e=>{const t=Ke(e,"password"),o=e.length>0?(e.length-t.length)/e.length*100:0;o>50&&e.length>8?(0,h.debugLog)("MBA1234: Potentially malicious confirm password input detected:",{original:e,sanitized:t,removalPercentage:o}):(l(t),W(""),c(""),g(""))},secureTextEntry:!B,placeholderTextColor:m.theme.colors.placeHolderText}),(0,j.jsx)(v.default,{style:N.eyeIcon,onPress:()=>k(!B),children:(0,j.jsx)(S.default,{name:B?"eye-off":"eye",size:20,color:m.theme.colors.placeHolderText})}),E?(0,j.jsx)(a.default,{style:N.errorText,children:E}):null]}),d?(0,j.jsx)(a.default,{style:N.errorText,children:d}):null,u?(0,j.jsx)(a.default,{style:N.successText,children:u}):null,(0,j.jsx)(No,{title:"Change Password",onPress:async()=>{if((()=>{let t=!0;e.trim()||(z("Current password is required"),t=!1);const n=Qe(o);F(n.message),n.isValid||(t=!1);const r=et(o,s);return W(r.message),r.isValid||(t=!1),t})()){p(!0),c(""),g("");try{const n=Ke(e,"password"),r=Ke(o,"password");(0,h.debugLog)("MBA1234: Password change request with sanitized inputs"),await(0,bt.changePassword)(n,r),g("Password changed successfully!"),t(""),i(""),l(""),setTimeout((()=>{O.navigate("MyProfile",{initialTab:"settings_payments"})}),2e3)}catch(d){(0,h.debugLog)("MBA1234: Error changing password:",d);let t="Failed to change password. Please try again.";d.response&&d.response.data&&("string"===typeof d.response.data?t=d.response.data:d.response.data.error?t=d.response.data.error:d.response.data.detail&&(t=d.response.data.detail)),c(t)}finally{p(!1)}}},disabled:f,style:N.button}),f&&(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.primary,style:N.loader}),(0,j.jsx)(v.default,{onPress:()=>{O.navigate("ResetPassword")},style:N.forgotPasswordButton,children:(0,j.jsx)(a.default,{style:N.forgotPasswordText,children:"Forgot Password?"})})]})]})})})},ci=["Horse","Cow","Sheep","Goat","Pig","Dogs","Cats","Bird","Rabbit","Hamster","Snake","Lizard","Turtle","Gecko","Chameleon","Fish","Frog","Newt","Axolotl","Spider","Scorpion","Crab","Snail","Millipede"],ui=["Colorado Springs, Colorado"],gi=(["Farm Animals","Domestic","Exotic","Aquatic","Invertibrates"].map((e=>({label:e,value:e.toLowerCase().replace(/\s+/g,"-")}))),({onFiltersChange:e,onShowProfessionals:t,isMobile:o,onSearchResults:s,initialFilters:l})=>{const[d,c]=(0,n.useState)(l?.location||""),[u,g]=(0,n.useState)([]),[f,p]=(0,n.useState)(l?.service_query||""),[y,b]=(0,n.useState)(l?.animal_types||[]),[x,w]=(0,n.useState)(l?.overnight_service||!1),[C,T]=(0,n.useState)(l?.price_max||200),[B,k]=(0,n.useState)(new Date),[A,_]=(0,n.useState)(new Date),[I,M]=(0,n.useState)(!1),[L,R]=(0,n.useState)(!1),[D,z]=(0,n.useState)(l?.filter_background_checked||!1),[P,F]=(0,n.useState)(l?.filter_insured||!1),[E,W]=(0,n.useState)(l?.filter_elite_pro||!1),[O,N]=(0,n.useState)(!1),[H,U]=(0,n.useState)(""),[V,q]=(0,n.useState)([]),[Y,G]=(0,n.useState)(!1),{screenWidth:J,isSignedIn:$}=(0,n.useContext)(h.AuthContext);(0,n.useEffect)((()=>{(0,h.debugLog)("MBA23o4iuv59","Location state changed:",d)}),[d]),(0,n.useEffect)((()=>{(0,h.debugLog)("MBA23o4iuv59","Location suggestions changed:",{count:u.length,suggestions:u})}),[u]),n.useEffect((()=>{l&&((0,h.debugLog)("MBA23o4iuv59","Initial filters updated:",l),c(l.location||""),p(l.service_query||""),b(l.animal_types||[]),w(l.overnight_service||!1),T(l.price_max||200),z(l.filter_background_checked||!1),F(l.filter_insured||!1),W(l.filter_elite_pro||!1))}),[l]);const K=i.default.create({container:{padding:m.theme.spacing.medium,backgroundColor:m.theme.colors.surface,height:"100%",width:"100%",overflow:"visible",paddingTop:m.theme.spacing.medium,paddingBottom:m.theme.spacing.medium},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:m.theme.spacing.xlarge,gap:m.theme.spacing.small},title:{fontSize:m.theme.fontSizes.xlarge,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},section:{marginBottom:m.theme.spacing.xlarge,position:"relative"},label:{fontSize:m.theme.fontSizes.medium,fontWeight:"500",color:m.theme.colors.text,marginVertical:m.theme.spacing.small,fontFamily:m.theme.fonts.regular.fontFamily},dropdown:{height:48,backgroundColor:m.theme.colors.background,borderRadius:8,padding:m.theme.spacing.medium,borderWidth:1,borderColor:m.theme.colors.border},locationInputWrapper:{position:"relative",marginBottom:m.theme.spacing.small,zIndex:1100},locationInput:{height:48,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,paddingHorizontal:m.theme.spacing.medium,backgroundColor:m.theme.colors.background,fontSize:m.theme.fontSizes.medium,zIndex:1101},modalBackdrop:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",zIndex:1099},suggestionsWrapper:{position:"absolute",top:"100%",left:0,right:0,maxHeight:200,backgroundColor:m.theme.colors.background,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,zIndex:1102,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3},suggestionsContainer:{flex:1},suggestionItem:{padding:m.theme.spacing.medium,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},suggestionItemNotSupported:{backgroundColor:m.theme.colors.background},suggestionText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},suggestionTextNotSupported:{color:m.theme.colors.placeholderText,fontStyle:"italic"},suggestionType:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.placeholderText,fontFamily:m.theme.fonts.regular.fontFamily},datePickersContainer:{flexDirection:"column",gap:m.theme.spacing.medium,marginRight:16,zIndex:500},datePickerWrapper:{width:"100%"},dateLabel:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,marginBottom:8,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},dateInput:{height:48,backgroundColor:m.theme.colors.background,borderRadius:8,padding:m.theme.spacing.medium,borderWidth:1,borderColor:m.theme.colors.border,fontSize:m.theme.fontSizes.medium},priceRangeContainer:{flexDirection:"row",alignItems:"center",gap:m.theme.spacing.medium,marginTop:m.theme.spacing.small},slider:{flex:1,height:48,marginHorizontal:m.theme.spacing.medium},priceText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,minWidth:50},selectedText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},placeholderText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.placeholderText,fontFamily:m.theme.fonts.regular.fontFamily},dropdownContainer:{backgroundColor:m.theme.colors.background,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,overflow:"hidden"},dropdownItem:{padding:m.theme.spacing.medium},dropdownItemSelected:{backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.primary,borderRadius:8,margin:4},dropdownItemText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},dropdownItemTextSelected:{color:m.theme.colors.primary,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},personButton:{padding:m.theme.spacing.small,borderRadius:8,marginLeft:"auto"},showProfessionalsButton:{backgroundColor:m.theme.colors.primary,padding:m.theme.spacing.medium,borderRadius:8,alignItems:"center",marginTop:m.theme.spacing.large},showProfessionalsText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.medium,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},locationContainer:{flexDirection:"column",width:"100%",gap:m.theme.spacing.small,zIndex:1100,position:"relative"},useLocationButton:{flexDirection:"row",alignItems:"center",padding:m.theme.spacing.small,backgroundColor:m.theme.colors.surface,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,gap:4,alignSelf:"flex-start"},useLocationText:{color:m.theme.colors.text,fontSize:m.theme.fontSizes.small},input:{height:48,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,paddingHorizontal:m.theme.spacing.medium,backgroundColor:m.theme.colors.surface},animalTypesContainer:{flexDirection:"row",flexWrap:"wrap",gap:m.theme.spacing.small,marginTop:m.theme.spacing.small,marginBottom:m.theme.spacing.medium,zIndex:800},animalTypeButton:{flexDirection:"row",alignItems:"center",padding:m.theme.spacing.small,backgroundColor:m.theme.colors.surface,borderRadius:20,borderWidth:1,borderColor:m.theme.colors.border,gap:4},animalTypeButtonSelected:{backgroundColor:m.theme.colors.primary,borderColor:m.theme.colors.primary},animalTypeLabel:{color:m.theme.colors.text,fontSize:m.theme.fontSizes.small},animalTypeLabelSelected:{color:m.theme.colors.whiteText},switchContainer:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginVertical:m.theme.spacing.small,gap:m.theme.spacing.medium,zIndex:700},priceContainer:{flexDirection:"row",alignItems:"center",gap:m.theme.spacing.small,zIndex:600},priceLabel:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,minWidth:50},checkboxContainer:{marginTop:m.theme.spacing.medium,gap:m.theme.spacing.small,zIndex:400},checkboxRow:{flexDirection:"row",alignItems:"center",gap:m.theme.spacing.small},checkbox:{width:24,height:24,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:4,alignItems:"center",justifyContent:"center",backgroundColor:m.theme.colors.surface},checkboxChecked:{backgroundColor:m.theme.colors.primary,borderColor:m.theme.colors.primary},checkboxLabel:{flex:1,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text},badgeFilterRow:{flexDirection:"row",alignItems:"center",gap:m.theme.spacing.small},badgeIcon:{marginRight:4},headerButtons:{flexDirection:"row",gap:m.theme.spacing.small},iconButton:{padding:m.theme.spacing.small,borderRadius:8},checkboxLabelContainer:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingRight:m.theme.spacing.small},searchButton:{backgroundColor:m.theme.colors.primary,padding:m.theme.spacing.medium,borderRadius:8,alignItems:"center",marginTop:m.theme.spacing.large,marginBottom:m.theme.spacing.large},searchButtonText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.medium,fontWeight:"600"},searchButtonDisabled:{backgroundColor:m.theme.colors.border,opacity:.6},otherAnimalInputWrapper:{backgroundColor:m.theme.colors.background,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,marginTop:m.theme.spacing.small,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3},otherAnimalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:m.theme.spacing.medium},otherAnimalTitle:{fontSize:m.theme.fontSizes.medium,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},closeButton:{padding:m.theme.spacing.small,borderRadius:8},animalInputContainer:{flexDirection:"row",alignItems:"center",marginHorizontal:m.theme.spacing.medium,marginBottom:m.theme.spacing.small},animalInput:{flex:1,height:48,borderWidth:0,borderRadius:8,paddingHorizontal:m.theme.spacing.medium,backgroundColor:m.theme.colors.background,fontSize:m.theme.fontSizes.medium},addAnimalButton:{backgroundColor:m.theme.colors.primary,paddingVertical:8,paddingHorizontal:16,borderRadius:8,marginLeft:m.theme.spacing.small},addAnimalButtonText:{color:m.theme.colors.whiteText,fontWeight:"600",fontSize:m.theme.fontSizes.small,fontFamily:m.theme.fonts.regular.fontFamily},animalSuggestionsWrapper:{flex:1},animalSuggestionsContainer:{flex:1},animalSuggestionItem:{padding:m.theme.spacing.medium,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},animalSuggestionText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},animalSelectionWrapper:{flexDirection:"column",gap:m.theme.spacing.small},selectedAnimalsContainer:{marginTop:m.theme.spacing.medium,padding:m.theme.spacing.medium,backgroundColor:m.theme.colors.background,borderRadius:8},selectedAnimalsLabel:{fontSize:m.theme.fontSizes.medium,fontWeight:"500",color:m.theme.colors.text,marginBottom:m.theme.spacing.small,fontFamily:m.theme.fonts.regular.fontFamily},selectedAnimalsList:{flexDirection:"row",flexWrap:"wrap",gap:m.theme.spacing.small},selectedAnimalTag:{flexDirection:"row",alignItems:"center",padding:m.theme.spacing.small,backgroundColor:m.theme.colors.primary,borderRadius:8,gap:m.theme.spacing.small},selectedAnimalText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.medium,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"flex-start"},modalSuggestionsWrapper:{position:"absolute",left:m.theme.spacing.medium,right:m.theme.spacing.medium,maxHeight:200,backgroundColor:m.theme.colors.background,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3,zIndex:1200}}),Z=({icon:e,label:t,selected:o,onPress:n})=>(0,j.jsxs)(v.default,{style:[K.animalTypeButton,o&&K.animalTypeButtonSelected],onPress:n,children:[(0,j.jsx)(S.default,{name:e,size:24,color:o?m.theme.colors.whiteText:m.theme.colors.text}),(0,j.jsx)(a.default,{style:[K.animalTypeLabel,o&&K.animalTypeLabelSelected],children:t})]}),Q=e=>{y.includes(e)?b(y.filter((t=>t!==e))):b([...y,e])};return(0,j.jsxs)(X.default,{style:K.container,children:[(0,j.jsxs)(r.default,{style:K.header,children:[(0,j.jsx)(a.default,{style:K.title,children:"Refine Search"}),(0,j.jsx)(v.default,{style:K.personButton,onPress:t,children:(0,j.jsx)(S.default,{name:"account-group",size:24,color:m.theme.colors.text})}),o&&(0,j.jsx)(r.default,{style:K.headerButtons,children:(0,j.jsx)(v.default,{style:K.iconButton,onPress:()=>{t&&t("map")},children:(0,j.jsx)(S.default,{name:"map",size:24,color:m.theme.colors.text})})})]}),(0,j.jsx)(a.default,{style:K.label,children:"I'm looking for services for my:"}),(0,j.jsxs)(r.default,{style:K.animalSelectionWrapper,children:[(0,j.jsxs)(r.default,{style:K.animalTypesContainer,children:[(0,j.jsx)(Z,{icon:"dog",label:"Dogs",selected:y.includes("Dogs"),onPress:()=>Q("Dogs")}),(0,j.jsx)(Z,{icon:"cat",label:"Cats",selected:y.includes("Cats"),onPress:()=>Q("Cats")}),(0,j.jsxs)(v.default,{style:[K.animalTypeButton,O&&K.animalTypeButtonSelected],onPress:()=>N(!O),children:[(0,j.jsx)(S.default,{name:"dots-horizontal",size:24,color:O?m.theme.colors.whiteText:m.theme.colors.text}),(0,j.jsx)(a.default,{style:[K.animalTypeLabel,O&&K.animalTypeLabelSelected],children:"Other"})]})]}),O&&(0,j.jsx)((({value:e,onChange:t,suggestions:o,onSuggestionSelect:i,isVisible:s,onClose:l,onAnimalSelect:d})=>{const c=(0,n.useRef)(null),u=(0,n.useRef)(!1),g=(0,n.useRef)(!1),h=(0,n.useCallback)((0,er.debounce)((e=>{if(e.length<1)return void i([]);const t=ci.filter((t=>t.toLowerCase().includes(e.toLowerCase())));i(t)}),300),[i]),f=()=>{""!==e.trim()&&(d(e.trim()),t(""),i([]),l())};return s?(0,j.jsxs)(r.default,{style:K.otherAnimalInputWrapper,children:[(0,j.jsxs)(r.default,{style:K.otherAnimalHeader,children:[(0,j.jsx)(a.default,{style:K.otherAnimalTitle,children:"Search for animal type"}),(0,j.jsx)(v.default,{onPress:()=>{g.current=!0,l()},style:K.closeButton,children:(0,j.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.text})})]}),(0,j.jsxs)(r.default,{style:K.animalInputContainer,children:[(0,j.jsx)(te.default,{ref:c,style:K.animalInput,placeholder:"Type animal name (e.g., Snake, Turtle, Horse)",value:e,onChangeText:e=>{t(e),h(e),u.current=!1,g.current=!1},onBlur:()=>{""!==e.trim()&&setTimeout((()=>{""===e.trim()||u.current||g.current||f(),u.current=!1,g.current=!1}),200)},autoFocus:!0}),""!==e.trim()&&(0,j.jsx)(v.default,{style:K.addAnimalButton,onPress:f,children:(0,j.jsx)(a.default,{style:K.addAnimalButtonText,children:"Add"})})]}),o.length>0&&(0,j.jsx)(r.default,{style:K.animalSuggestionsWrapper,children:(0,j.jsx)(X.default,{style:K.animalSuggestionsContainer,keyboardShouldPersistTaps:"always",nestedScrollEnabled:!0,children:o.map(((e,o)=>(0,j.jsx)(v.default,{style:K.animalSuggestionItem,onPress:()=>{u.current=!0,d(e),t(""),i([]),l()},children:(0,j.jsx)(a.default,{style:K.animalSuggestionText,children:e})},o)))})})]}):null}),{value:H,onChange:U,suggestions:V,onSuggestionSelect:q,isVisible:O,onClose:()=>{N(!1),U(""),q([])},onAnimalSelect:Q})]}),y.length>0&&(0,j.jsxs)(r.default,{style:K.selectedAnimalsContainer,children:[(0,j.jsx)(a.default,{style:K.selectedAnimalsLabel,children:"Selected animals:"}),(0,j.jsx)(r.default,{style:K.selectedAnimalsList,children:y.map(((e,t)=>(0,j.jsxs)(v.default,{style:K.selectedAnimalTag,onPress:()=>Q(e),children:[(0,j.jsx)(a.default,{style:K.selectedAnimalText,children:e}),(0,j.jsx)(S.default,{name:"close",size:16,color:m.theme.colors.whiteText})]},t)))})]}),(0,j.jsx)(a.default,{style:K.label,children:"Location"}),(0,j.jsx)(dt,{value:d,onChange:c,suggestions:ui,placeholder:"Enter city in Colorado",zIndex:1100,showNotAvailable:!0}),(0,j.jsx)(a.default,{style:K.label,children:"What service do you need? (e.g., Dog Walking, Pet Sitting)"}),(0,j.jsx)(dt,{value:f,onChange:p,suggestions:["All Services",...ve],placeholder:"Search services...",zIndex:1e3}),(0,j.jsxs)(r.default,{style:K.switchContainer,children:[(0,j.jsx)(a.default,{style:K.label,children:"Overnight Service"}),(0,j.jsx)(st.default,{value:x,onValueChange:w,trackColor:{false:m.theme.colors.border,true:m.theme.colors.primary}})]}),(0,j.jsx)(a.default,{style:K.label,children:"Price Range"}),(0,j.jsxs)(r.default,{style:K.priceContainer,children:[(0,j.jsx)(a.default,{style:K.priceLabel,children:"$0"}),(0,j.jsx)(oo(),{style:K.slider,minimumValue:0,maximumValue:250,value:C,onValueChange:T,minimumTrackTintColor:m.theme.colors.primary,maximumTrackTintColor:m.theme.colors.border,thumbTintColor:m.theme.colors.primary,step:1}),(0,j.jsxs)(a.default,{style:K.priceLabel,children:["$",Math.round(C)]})]}),(0,j.jsx)(a.default,{style:K.label,children:"Professional Credentials"}),(0,j.jsxs)(r.default,{style:K.checkboxContainer,children:[(0,j.jsxs)(r.default,{style:K.checkboxRow,children:[(0,j.jsx)(v.default,{style:[K.checkbox,D&&K.checkboxChecked],onPress:()=>z(!D),children:D&&(0,j.jsx)(S.default,{name:"check",size:16,color:m.theme.colors.whiteText})}),(0,j.jsx)(r.default,{style:K.checkboxLabelContainer,children:(0,j.jsxs)(r.default,{style:K.badgeFilterRow,children:[(0,j.jsx)(S.default,{name:"shield-check",size:16,color:"#9C27B0",style:K.badgeIcon}),(0,j.jsx)(a.default,{style:K.checkboxLabel,children:"Background Checked Only"})]})})]}),(0,j.jsxs)(r.default,{style:K.checkboxRow,children:[(0,j.jsx)(v.default,{style:[K.checkbox,P&&K.checkboxChecked],onPress:()=>F(!P),children:P&&(0,j.jsx)(S.default,{name:"check",size:16,color:m.theme.colors.whiteText})}),(0,j.jsx)(r.default,{style:K.checkboxLabelContainer,children:(0,j.jsxs)(r.default,{style:K.badgeFilterRow,children:[(0,j.jsx)(S.default,{name:"security",size:16,color:"#0784C6",style:K.badgeIcon}),(0,j.jsx)(a.default,{style:K.checkboxLabel,children:"Insured Only"})]})})]}),(0,j.jsxs)(r.default,{style:K.checkboxRow,children:[(0,j.jsx)(v.default,{style:[K.checkbox,E&&K.checkboxChecked],onPress:()=>W(!E),children:E&&(0,j.jsx)(S.default,{name:"check",size:16,color:m.theme.colors.whiteText})}),(0,j.jsx)(r.default,{style:K.checkboxLabelContainer,children:(0,j.jsxs)(r.default,{style:K.badgeFilterRow,children:[(0,j.jsx)(S.default,{name:"medal",size:16,color:"#4CAF50",style:K.badgeIcon}),(0,j.jsx)(a.default,{style:K.checkboxLabel,children:"Elite Pro Only"})]})})]})]}),(0,j.jsx)(v.default,{style:[K.searchButton,Y&&K.searchButtonDisabled],onPress:async()=>{G(!0);try{(0,h.debugLog)("MBA9999","Starting professional search with filters:",{selectedAnimals:y,location:d,service:f,overnightService:x,priceRange:C,filterBackgroundChecked:D,filterInsured:P,filterElitePro:E});const e={animal_types:y,location:d.trim(),service_query:f.trim(),overnight_service:x,price_min:0,price_max:C,radius_miles:30,page:1,page_size:20,filter_background_checked:D,filter_insured:P,filter_elite_pro:E},o=await(0,bt.searchProfessionals)(e);(0,h.debugLog)("MBA9999","Search completed successfully:",o),o.fallback_message&&(0,h.debugLog)("MBA9999","Fallback message received:",o.fallback_message),s&&s(o,e),t&&t()}catch(zs){(0,h.debugLog)("MBA9999","Search failed:",zs),console.error("Search failed:",zs)}finally{G(!1)}},disabled:Y,children:(0,j.jsx)(a.default,{style:K.searchButtonText,children:Y?"Searching...":"Search"})})]})}),mi=({professional:e,index:t,onPress:o})=>{e.primary_service?.unit_of_time&&(0,h.debugLog)("MBA4001: Unit of time mapping",{backend_value:e.primary_service.unit_of_time,frontend_value:Ce[e.primary_service.unit_of_time],professional_name:e.name}),e.reviews&&(0,h.debugLog)("MBA4001: Professional reviews data",{professional_name:e.name,has_reviews:e.reviews.average_rating>0,average_rating:e.reviews.average_rating,review_count:e.reviews.review_count,has_review_text:!!e.reviews.latest_highest_review_text,has_author_profile_pic:!!e.reviews.latest_review_author_profile_pic,has_reviewer_profile_pic:!!e.reviews.reviewer_profile_picture,author_pic_url:e.reviews.latest_review_author_profile_pic||"none",reviewer_pic_url:e.reviews.reviewer_profile_picture||"none"});const n=e.reviews&&e.reviews.average_rating>0,i=e.badges?.is_background_checked||e.badges?.is_insured||e.badges?.is_elite_pro;return(0,j.jsxs)(v.default,{style:hi.listItem,onPress:()=>{o&&o()},children:[(0,j.jsxs)(r.default,{style:hi.cardContent,children:[(0,j.jsx)(r.default,{style:hi.leftSection,children:e.profile_picture_url?(0,j.jsx)(Q.default,{source:{uri:(0,p.getMediaUrl)(e.profile_picture_url)},style:hi.profileImage}):(0,j.jsx)(r.default,{style:[hi.profileImage,hi.fallbackIconContainer],children:(0,j.jsx)(S.default,{name:"account",size:50,color:m.theme.colors.textSecondary})})}),(0,j.jsx)(r.default,{style:hi.mainContent,children:(0,j.jsxs)(r.default,{style:hi.header,children:[(0,j.jsxs)(r.default,{style:hi.nameSection,children:[(0,j.jsxs)(a.default,{style:hi.name,children:[t+1,". ",e.primary_service?.service_name||"Various Services"]}),(0,j.jsx)(a.default,{style:hi.location,children:e.name}),(0,j.jsx)(a.default,{style:hi.distance,children:e.location})]}),(0,j.jsxs)(r.default,{style:hi.priceSection,children:[(0,j.jsx)(a.default,{style:hi.fromText,children:"from"}),(0,j.jsxs)(a.default,{style:hi.amount,children:[(0,j.jsx)(a.default,{style:hi.dollarSign,children:"$"}),e.primary_service?e.primary_service.price_per_visit:"N/A"]}),(0,j.jsx)(a.default,{style:hi.perNight,children:e.primary_service?Ce[e.primary_service.unit_of_time]||e.primary_service.unit_of_time:"per visit"})]})]})})]}),(n||i)&&(0,j.jsxs)(r.default,{style:[hi.reviewSection],children:[n&&(0,j.jsxs)(r.default,{style:[hi.ratingContainer,{marginBottom:i?m.theme.spacing.small:0}],children:[(0,j.jsx)(S.default,{name:"star",size:16,color:"#FFD700"}),(0,j.jsx)(a.default,{style:hi.ratingText,children:e.reviews.average_rating.toFixed(2)}),(0,j.jsx)(a.default,{style:hi.dot,children:" \u2022 "}),(0,j.jsxs)(a.default,{style:hi.reviews,children:[e.reviews.review_count," reviews"]})]}),i&&(0,j.jsxs)(r.default,{style:hi.badgesContainer,children:[e.badges?.is_background_checked&&(0,j.jsxs)(r.default,{style:[hi.badge,hi.backgroundCheckedBadge],children:[(0,j.jsx)(S.default,{name:"shield-check",size:14,color:"#9C27B0"}),(0,j.jsx)(a.default,{style:[hi.badgeText,hi.backgroundCheckedBadgeText],children:"Background Checked"})]}),e.badges?.is_insured&&(0,j.jsxs)(r.default,{style:[hi.badge,hi.insuredBadge],children:[(0,j.jsx)(S.default,{name:"security",size:14,color:"#0784C6"}),(0,j.jsx)(a.default,{style:[hi.badgeText,hi.insuredBadgeText],children:"Insured"})]}),e.badges?.is_elite_pro&&(0,j.jsxs)(r.default,{style:[hi.badge,hi.eliteProBadge],children:[(0,j.jsx)(S.default,{name:"medal",size:14,color:"#4CAF50"}),(0,j.jsx)(a.default,{style:[hi.badgeText,hi.eliteProBadgeText],children:"Elite Pro"})]})]})]})]})},hi=i.default.create({container:{flex:1,width:"100%",backgroundColor:m.theme.colors.surfaceContrast},listContent:{flexGrow:1},listItem:{width:"100%",backgroundColor:m.theme.colors.surfaceContrast,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3},cardContent:{flexDirection:"row",paddingHorizontal:m.theme.spacing.medium,paddingTop:m.theme.spacing.medium,paddingBottom:m.theme.spacing.medium},leftSection:{marginRight:m.theme.spacing.medium,justifyContent:"center"},profileImage:{width:60,height:60,borderRadius:30},mainContent:{flex:1},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start"},nameSection:{flex:1,marginRight:m.theme.spacing.medium},name:{fontSize:m.theme.fontSizes.large,fontWeight:"600",color:m.theme.colors.text,marginBottom:4},location:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.textSecondary,marginBottom:2},distance:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.textSecondary},priceSection:{alignItems:"flex-end"},fromText:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.textSecondary},amount:{fontSize:m.theme.fontSizes.large+4,fontWeight:"600",color:m.theme.colors.primary,marginVertical:2},dollarSign:{color:m.theme.colors.primary},perNight:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.textSecondary,maxWidth:50},reviewSection:{paddingHorizontal:m.theme.spacing.medium,paddingBottom:m.theme.spacing.medium,borderTopWidth:0,borderTopColor:"transparent",marginTop:0},ratingContainer:{flexDirection:"row",alignItems:"center",marginBottom:m.theme.spacing.small},ratingText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontWeight:"500",marginLeft:4},dot:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.textSecondary},reviews:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.textSecondary},repeatOwners:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.textSecondary},bestReviewContainer:{flexDirection:"row",alignItems:"center"},reviewerImage:{width:32,height:32,borderRadius:16,marginRight:m.theme.spacing.small},bestReviewTextContainer:{flex:1},bestReview:{flex:1,fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontStyle:"italic"},readMore:{color:m.theme.colors.primary,fontStyle:"normal",fontWeight:"500"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",paddingRight:m.theme.spacing.small,backgroundColor:m.theme.colors.surfaceContrast},mobileHeaderRight:{flexDirection:"row",alignItems:"center"},headerContent:{flex:1,marginHorizontal:m.theme.spacing.medium},headerTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"600",color:m.theme.colors.text,marginBottom:m.theme.spacing.small},filterChips:{flexDirection:"row",flexWrap:"wrap",gap:m.theme.spacing.small},filterChip:{backgroundColor:m.theme.colors.background,paddingHorizontal:m.theme.spacing.medium,paddingVertical:m.theme.spacing.small,borderRadius:16,borderWidth:1,borderColor:m.theme.colors.border},filterChipText:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.text},filterButton:{padding:m.theme.spacing.small,borderRadius:8},headerButtons:{flexDirection:"row",gap:m.theme.spacing.small},emptyStateContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:m.theme.spacing.large},emptyStateTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"600",color:m.theme.colors.text,marginTop:m.theme.spacing.medium,marginBottom:m.theme.spacing.small,textAlign:"center"},emptyStateMessage:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.textSecondary,textAlign:"center",marginBottom:m.theme.spacing.large,lineHeight:22},adjustSearchButton:{paddingHorizontal:m.theme.spacing.large,paddingVertical:m.theme.spacing.medium,borderRadius:8,backgroundColor:m.theme.colors.primary},adjustSearchButtonText:{fontSize:m.theme.fontSizes.medium,fontWeight:"600",color:m.theme.colors.whiteText},fallbackIconContainer:{backgroundColor:m.theme.colors.background,borderRadius:40,justifyContent:"center",alignItems:"center"},fallbackReviewerIconContainer:{backgroundColor:m.theme.colors.background,justifyContent:"center",alignItems:"center"},badgesContainer:{flexDirection:"row",flexWrap:"wrap",gap:m.theme.spacing.small,marginTop:m.theme.spacing.small},badge:{flexDirection:"row",alignItems:"center",paddingVertical:4,paddingHorizontal:8,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:16,backgroundColor:m.theme.colors.background},badgeText:{fontSize:12,color:m.theme.colors.text,marginLeft:4,fontWeight:"500"},backgroundCheckedBadge:{borderColor:"#9C27B0",backgroundColor:"rgba(156, 39, 176, 0.1)"},backgroundCheckedBadgeText:{color:"#9C27B0"},insuredBadge:{borderColor:"#0784C6",backgroundColor:"rgba(7, 132, 198, 0.1)"},insuredBadgeText:{color:"#0784C6"},eliteProBadge:{borderColor:"#4CAF50",backgroundColor:"rgba(76, 175, 80, 0.1)"},eliteProBadgeText:{color:"#4CAF50"},fallbackMessageContainer:{backgroundColor:m.theme.colors.warning+"20",borderLeftWidth:4,borderLeftColor:m.theme.colors.warning,padding:m.theme.spacing.medium,marginHorizontal:m.theme.spacing.medium,marginBottom:m.theme.spacing.medium,borderRadius:8,flexDirection:"row",alignItems:"flex-start",gap:m.theme.spacing.small},fallbackTextContainer:{flex:1,flexDirection:"column"},fallbackMessageText:{fontSize:m.theme.fontSizes.medium,fontWeight:"600",color:m.theme.colors.warning,fontFamily:m.theme.fonts.regular.fontFamily},fallbackSubtext:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,marginTop:m.theme.spacing.small}}),fi=({professionals:e,onLoadMore:t,onProfessionalSelect:o,isMobile:n,filters:i,onFilterPress:s,searchParams:l=null,fallbackMessage:d=null})=>{const c=()=>{const e=(()=>{if(!l)return{title:"No professionals found",message:"Please try adjusting your search criteria."};const{animal_types:e=[],location:t="",service_query:o="",overnight_service:n=!1}=l,r=t.toLowerCase().includes("colorado springs")||t.toLowerCase().includes("colorado")||""===t;if(r&&0===e.length&&!o&&!n)return{title:"No professionals in the Colorado Springs area yet!",message:"Please come back later when we onboard more professionals to your area."};let a=[];if(e.length>0){const t=1===e.length?"".concat(e[0]," care"):"care for ".concat(e.join(", "));a.push(t)}if(o&&a.push('"'.concat(o,'" services')),n&&a.push("overnight services"),t&&!r&&a.push("in ".concat(t)),a.length>0){const e=a.join(", ");return{title:"No professionals found with ".concat(e),message:"Please try adjusting your search parameters or expanding your search area."}}return{title:"No professionals found",message:"Please try adjusting your search criteria."}})();return(0,h.debugLog)("MBA4001: Showing empty state",{searchParams:l,emptyStateTitle:e.title,emptyStateMessage:e.message}),(0,j.jsxs)(r.default,{style:hi.emptyStateContainer,children:[(0,j.jsx)(S.default,{name:"account-search",size:80,color:m.theme.colors.textSecondary}),(0,j.jsx)(a.default,{style:hi.emptyStateTitle,children:e.title}),(0,j.jsx)(a.default,{style:hi.emptyStateMessage,children:e.message}),(0,j.jsx)(v.default,{style:hi.adjustSearchButton,onPress:()=>s&&s(),children:(0,j.jsx)(a.default,{style:hi.adjustSearchButtonText,children:"Adjust Search"})})]})},u=()=>(0,j.jsxs)(r.default,{style:[hi.header,{borderBottomWidth:1,borderBottomColor:m.theme.colors.border,paddingBottom:m.theme.spacing.medium}],children:[(0,j.jsxs)(r.default,{style:hi.headerContent,children:[(0,j.jsx)(a.default,{style:[hi.headerTitle,{paddingTop:m.theme.spacing.medium}],children:"Pet Care Professionals"}),(0,j.jsx)(r.default,{style:hi.filterChips,children:i?.categories?.map(((e,t)=>(0,j.jsx)(r.default,{style:hi.filterChip,children:(0,j.jsx)(a.default,{style:hi.filterChipText,children:e})},t)))})]}),(0,j.jsxs)(r.default,{style:[hi.headerButtons,{paddingTop:8}],children:[(0,j.jsx)(v.default,{style:hi.filterButton,onPress:s,children:(0,j.jsx)(S.default,{name:"filter",size:24,color:m.theme.colors.text})}),n&&(0,j.jsx)(v.default,{style:hi.filterButton,onPress:()=>{s&&s("map")},children:(0,j.jsx)(S.default,{name:"map",size:24,color:m.theme.colors.text})})]})]});return e&&0!==e.length?(0,j.jsxs)(r.default,{style:hi.container,children:[u(),d&&(0,j.jsxs)(r.default,{style:hi.fallbackMessageContainer,children:[(0,j.jsx)(S.default,{name:"information",size:24,color:m.theme.colors.warning}),(0,j.jsxs)(r.default,{style:hi.fallbackTextContainer,children:[(0,j.jsx)(a.default,{style:hi.fallbackMessageText,children:d}),(0,j.jsx)(a.default,{style:hi.fallbackSubtext,children:"Showing available professionals in Colorado Springs instead below. Please select different professionals to see all their services:"})]})]}),(0,j.jsx)(Yt.default,{data:e,renderItem:({item:e,index:t})=>(0,j.jsx)(mi,{professional:e,index:t,onPress:()=>o(e)}),keyExtractor:e=>e.professional_id.toString(),onEndReached:t,onEndReachedThreshold:.5,contentContainerStyle:hi.listContent})]}):(0,j.jsxs)(r.default,{style:hi.container,children:[u(),c()]})};let pi,yi,bi,xi,vi,wi;try{const e=o(65899);pi=e.MapContainer,yi=e.TileLayer,bi=e.Marker,xi=e.Popup,vi=e.useMap,wi=o(14918),o(1297)}catch(zs){console.warn("Failed to load Leaflet libraries:",zs)}if(wi)try{delete wi.Icon.Default.prototype._getIconUrl,wi.Icon.Default.mergeOptions({iconRetinaUrl:o(18249),iconUrl:o(37024),shadowUrl:o(91071)})}catch(zs){console.warn("Failed to configure Leaflet icons:",zs)}const Ci=({professional:e,onShowServicesModal:t})=>{const o=(0,n.useRef)(null),r=(0,n.useRef)(null);if(!wi||!bi||!xi)return null;const a=wi.divIcon({className:"custom-marker",html:'<div style="\n    width: 32px;\n    height: 32px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n  ">\n    <svg viewBox="0 0 24 24" width="32" height="32">\n      <path fill="'.concat(m.theme.colors.primary,'" d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>\n    </svg>\n  </div>'),iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]});if((0,n.useEffect)((()=>{const e=o.current;if(e){const t=e.getElement?e:e._leaflet_marker;t&&t.on("mouseover",(()=>{r.current&&r.current.openOn(e._map)}))}}),[]),!e.coordinates||"number"!==typeof e.coordinates.latitude||"number"!==typeof e.coordinates.longitude)return null;const i=[e.coordinates.latitude,e.coordinates.longitude];return(0,j.jsx)(bi,{ref:o,position:i,icon:a,eventHandlers:{click:e=>{e.originalEvent?.stopPropagation(),setTimeout((()=>{o.current&&r.current&&o.current.openPopup()}),10)}},children:(0,j.jsx)(xi,{ref:r,closeButton:!0,autoClose:!1,closeOnClick:!1,closeOnEscapeKey:!0,children:(0,j.jsxs)("div",{style:{padding:"16px",minWidth:"250px",maxWidth:"300px",fontFamily:"system-ui, -apple-system, sans-serif"},children:[(0,j.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:"18px",fontWeight:"600",color:"#1a1a1a"},children:e.name}),(0,j.jsx)("p",{style:{margin:"0 0 4px 0",fontSize:"14px",color:"#666"},children:e.location}),(0,j.jsx)("p",{style:{margin:"0 0 8px 0",fontSize:"14px",color:"#1a1a1a",fontWeight:"500"},children:e.primary_service?.service_name}),(0,j.jsxs)("p",{style:{margin:"0 0 12px 0",fontSize:"16px",fontWeight:"600",color:m.theme.colors.primary},children:["from $",e.primary_service?.price_per_visit||"N/A","/",(s=e.primary_service?.unit_of_time||"visit",Ce[s]||s)]}),(0,j.jsx)("button",{style:{backgroundColor:m.theme.colors.primary,color:"white",border:"none",padding:"10px 16px",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer",width:"100%"},onClick:()=>{t&&t(e)},children:"View Details"})]})})});var s},Si=({professionals:e,onMarkerPress:t,region:o,isMobile:n,onShowServicesModal:i})=>{if(!pi||!yi||!bi||!xi||!wi)return(0,j.jsx)(r.default,{style:ji.container,children:(0,j.jsx)(r.default,{style:ji.fallbackContainer,children:(0,j.jsx)(a.default,{style:ji.fallbackText,children:"Map not available"})})});const s=(()=>{const t=e.filter((e=>e.coordinates&&e.coordinates.latitude&&e.coordinates.longitude));if(0===t.length)return{center:[o.latitude,o.longitude],zoom:13};if(1===t.length){const e=t[0];return{center:[e.coordinates.latitude,e.coordinates.longitude],zoom:14}}const n=t.map((e=>e.coordinates.latitude)),r=t.map((e=>e.coordinates.longitude)),a=Math.min(...n),i=Math.max(...n),s=Math.min(...r),l=Math.max(...r),d=(a+i)/2,c=(s+l)/2,u=i-a,g=l-s,m=Math.max(u,g);let h=13;return h=m>.5?10:m>.2?11:m>.1?12:m>.05?13:14,{center:[d,c],zoom:h}})();return(0,j.jsx)(r.default,{style:ji.mapContainer,children:(0,j.jsxs)(pi,{center:s.center,zoom:s.zoom,style:{height:"100%",width:"100%"},children:[(0,j.jsx)(yi,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),e.filter((e=>e.coordinates&&e.coordinates.latitude&&e.coordinates.longitude)).map(((e,t)=>(0,j.jsx)(Ci,{professional:e,onShowServicesModal:i},e.professional_id)))]},"".concat(s.center[0],"-").concat(s.center[1],"-").concat(s.zoom))})},ji=i.default.create({container:{flex:1,backgroundColor:m.theme.colors.background,height:"100%",width:"100%",overflow:"hidden"},mapContainer:{flex:1,backgroundColor:m.theme.colors.background,height:"100%",width:"100%",overflow:"hidden"},map:{flex:1,height:"100%",width:"100%"},markerContainer:{alignItems:"center",justifyContent:"center"},markerPin:{width:30,height:30,backgroundColor:m.theme.colors.primary,borderRadius:15,borderWidth:3,borderColor:"white",alignItems:"center",justifyContent:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.3,shadowRadius:3,elevation:5},markerInner:{width:12,height:12,backgroundColor:"white",borderRadius:6},markerText:{color:m.theme.colors.whiteText,fontWeight:"bold"},calloutContainer:{backgroundColor:m.theme.colors.surface,padding:m.theme.spacing.medium,borderRadius:8,borderWidth:1,borderColor:m.theme.colors.border,minWidth:200,maxWidth:250},calloutTitle:{fontSize:m.theme.fontSizes.medium,fontWeight:"600",color:m.theme.colors.text,marginBottom:4},calloutLocation:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.textSecondary,marginBottom:4},calloutService:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.text,fontWeight:"500",marginBottom:4},calloutPrice:{fontSize:m.theme.fontSizes.medium,fontWeight:"600",color:m.theme.colors.primary,marginBottom:8},calloutButton:{backgroundColor:m.theme.colors.primary,paddingVertical:8,paddingHorizontal:12,borderRadius:6,alignItems:"center"},calloutButtonText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.small,fontWeight:"500"},calloutText:{color:m.theme.colors.text,fontSize:m.theme.fontSizes.small},popupContent:{padding:16,minWidth:250,maxWidth:300},popupTitle:{fontSize:18,fontWeight:"600",fontFamily:m.theme.fonts.header.fontFamily,color:m.theme.colors.text,marginBottom:8},popupLocation:{fontSize:14,color:m.theme.colors.textSecondary,marginBottom:4},popupService:{fontSize:14,color:m.theme.colors.text,fontWeight:"500",marginBottom:8},popupPrice:{fontSize:16,fontWeight:"600",color:m.theme.colors.primary,marginBottom:12},popupButton:{backgroundColor:m.theme.colors.primary,paddingVertical:10,paddingHorizontal:16,borderRadius:8,alignItems:"center"},popupButtonText:{color:m.theme.colors.whiteText,fontSize:14,fontWeight:"500"},fallbackContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:m.theme.colors.background},fallbackText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.textSecondary},customMarker:{alignItems:"center",justifyContent:"center"}}),Ti=({professionals:e,onMarkerPress:t,region:o,isMobile:n,onShowServicesModal:r})=>(0,j.jsx)(Si,{professionals:e,onMarkerPress:t,region:o,isMobile:n,onShowServicesModal:r}),Bi=i.default.create({modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",padding:20},modalContainer:{backgroundColor:m.theme.colors.surface,borderRadius:12,width:"90%",maxWidth:800,maxHeight:"80%",overflow:"hidden"},modalContainerSmallMobile:{width:"calc(100% - 10px)",height:"calc(100% - 10px)",maxWidth:"none",maxHeight:"none",borderRadius:8},header:{padding:20,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},headerTop:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},headerLeft:{flex:1,flexDirection:"row",alignItems:"center"},headerTextContainer:{flex:1},professionalName:{fontSize:20,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},professionalLocation:{fontSize:14,color:m.theme.colors.textSecondary,marginTop:4,marginRight:8},headerLocationContainer:{flexDirection:"row",alignItems:"center",flexWrap:"wrap",marginTop:4},reviewBadge:{flexDirection:"row",flexWrap:"wrap",alignItems:"center",paddingTop:4,paddingRight:4,borderRadius:12},reviewBadgeText:{fontSize:14,color:m.theme.colors.text,marginLeft:4,fontWeight:"500"},closeButton:{padding:8},loadingContainer:{padding:40,alignItems:"center"},loadingText:{marginTop:16,color:m.theme.colors.textSecondary},errorContainer:{padding:40,alignItems:"center"},errorText:{color:m.theme.colors.error,textAlign:"center",marginBottom:16},retryButton:{backgroundColor:m.theme.colors.primary,paddingHorizontal:20,paddingVertical:10,borderRadius:8},retryText:{color:m.theme.colors.whiteText,fontWeight:"500"},content:{flexDirection:"row",flex:1},contentMobile:{flexDirection:"column"},mobileMainView:{flex:1,padding:20},mobileServiceItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},mobileServiceContent:{flex:1},mobileServiceName:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginBottom:4},mobileServicePrice:{fontSize:14,color:m.theme.colors.textSecondary},mobileDetailsView:{flex:1},mobileDetailsHeader:{flexDirection:"row",alignItems:"center",padding:20,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},backButton:{padding:8,marginRight:12},mobileDetailsTitle:{fontSize:18,fontWeight:"600",color:m.theme.colors.text,flex:1},mobileDetailsScrollView:{flex:1,padding:20},servicesList:{width:"40%",borderRightWidth:1,borderRightColor:m.theme.colors.border,padding:20},sectionTitle:{fontSize:18,fontWeight:"600",color:m.theme.colors.text,marginBottom:16,fontFamily:m.theme.fonts.header.fontFamily},servicesScrollView:{flex:1},serviceItem:{padding:12,borderRadius:8,marginBottom:8,backgroundColor:m.theme.colors.background,borderWidth:1,borderColor:m.theme.colors.border},serviceItemSelected:{backgroundColor:m.theme.colors.primary,borderColor:m.theme.colors.primary},serviceName:{fontSize:14,fontWeight:"500",color:m.theme.colors.text,marginBottom:4},serviceNameSelected:{color:m.theme.colors.whiteText},servicePrice:{fontSize:12,color:m.theme.colors.textSecondary},servicePriceSelected:{color:m.theme.colors.whiteText},serviceDetails:{flex:1,padding:20},detailsScrollView:{flex:1},detailsTitle:{fontSize:24,fontWeight:"600",color:m.theme.colors.text,marginBottom:20,fontFamily:m.theme.fonts.header.fontFamily},detailSection:{marginBottom:20},detailLabel:{fontSize:14,fontWeight:"600",color:m.theme.colors.text,marginBottom:8},detailText:{fontSize:14,color:m.theme.colors.textSecondary,lineHeight:20},overnightBadge:{backgroundColor:m.theme.colors.primary,color:m.theme.colors.whiteText,paddingHorizontal:12,paddingVertical:6,borderRadius:16,fontSize:12,fontWeight:"500",alignSelf:"flex-start"},additionalRateItem:{paddingVertical:8,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,position:"relative"},additionalRateRow:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},additionalRateTitleContainer:{flexDirection:"row",alignItems:"flex-start",flex:1},additionalRateTitle:{fontSize:14,color:m.theme.colors.text,flex:1,marginLeft:4},infoIcon:{padding:2,marginTop:-2},additionalRatePrice:{fontSize:14,fontWeight:"500",color:m.theme.colors.primary,marginLeft:16},tooltipModalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},tooltipModalContent:{backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:12,padding:16,margin:20,maxWidth:300,shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.2,shadowRadius:8,elevation:10},tooltipHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:12},tooltipTitle:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,flex:1},tooltipCloseButton:{padding:4,marginLeft:8},tooltipText:{fontSize:14,color:m.theme.colors.textSecondary,lineHeight:20},noSelectionContainer:{flex:1,justifyContent:"center",alignItems:"center"},noSelectionText:{color:m.theme.colors.textSecondary,fontSize:16},footer:{padding:20,borderTopWidth:1,borderTopColor:m.theme.colors.border},contactButton:{backgroundColor:m.theme.colors.primary,paddingVertical:16,borderRadius:8,alignItems:"center"},contactButtonDisabled:{backgroundColor:m.theme.colors.placeholder,opacity:.7},contactButtonContent:{flexDirection:"row",alignItems:"center",justifyContent:"center"},contactButtonText:{color:m.theme.colors.whiteText,fontSize:16,fontWeight:"600"},errorModalContent:{backgroundColor:m.theme.colors.surface,borderWidth:1,borderColor:m.theme.colors.border,borderRadius:12,padding:16,margin:20,maxWidth:300,shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.2,shadowRadius:8,elevation:10},errorModalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:12},errorModalTitle:{fontSize:16,fontWeight:"600",color:m.theme.colors.text,flex:1},errorModalCloseButton:{padding:4,marginLeft:8},errorModalText:{fontSize:14,color:m.theme.colors.textSecondary,lineHeight:20},errorModalOkButton:{backgroundColor:m.theme.colors.primary,paddingVertical:16,borderRadius:8,alignItems:"center",marginTop:16},errorModalOkText:{color:m.theme.colors.whiteText,fontSize:16,fontWeight:"600"},professionalProfilePhoto:{width:50,height:50,borderRadius:25,marginRight:15},professionalProfilePhotoPlaceholder:{width:50,height:50,borderRadius:25,backgroundColor:m.theme.colors.background,justifyContent:"center",alignItems:"center",borderWidth:1,borderColor:m.theme.colors.border,marginRight:15},noReviewsText:{fontSize:14,color:m.theme.colors.textSecondary,marginLeft:4},tabContainer:{flexDirection:"row",borderBottomWidth:1,borderBottomColor:m.theme.colors.border,marginBottom:16},tab:{flex:1,paddingVertical:12,paddingHorizontal:16,alignItems:"center",borderBottomWidth:2,borderBottomColor:"transparent"},activeTab:{borderBottomColor:m.theme.colors.primary},tabText:{fontSize:16,fontWeight:"500",color:m.theme.colors.textSecondary},activeTabText:{color:m.theme.colors.primary,fontWeight:"600"},reviewsTabContent:{flex:1},reviewsList:{flex:1},reviewsContent:{paddingBottom:16},reviewCard:{padding:16,backgroundColor:m.theme.colors.background,borderRadius:8,marginBottom:12,borderWidth:1,borderColor:m.theme.colors.border},reviewUserInfo:{flexDirection:"row",alignItems:"flex-start"},profileContainer:{marginRight:16},reviewProfileImage:{width:50,height:50,borderRadius:25},defaultReviewProfileImage:{width:50,height:50,borderRadius:25,backgroundColor:m.theme.colors.primary,justifyContent:"center",alignItems:"center"},reviewUserDetails:{flex:1,justifyContent:"center"},nameAndStarsRow:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:8},reviewerName:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginRight:8},starsContainer:{flexDirection:"row"},starIcon:{marginRight:2},serviceRow:{flexDirection:"row",alignItems:"center",flexWrap:"wrap"},serviceName:{fontSize:14,color:m.theme.colors.primary,fontWeight:"500",marginRight:8},calendarIcon:{marginRight:4},serviceInfoText:{fontSize:14,color:m.theme.colors.textSecondary},reviewText:{fontSize:14,color:m.theme.colors.text,lineHeight:20,marginTop:8},headerBadgesContainer:{marginTop:16},headerBadgesScrollContent:{flexDirection:"row",gap:6},headerBadge:{flexDirection:"row",alignItems:"center",paddingVertical:3,paddingHorizontal:6,borderWidth:1,borderRadius:12},headerBadgeText:{fontSize:10,marginLeft:3,fontWeight:"500"},headerBackgroundCheckedBadge:{borderColor:"#9C27B0",backgroundColor:"rgba(156, 39, 176, 0.1)"},headerBackgroundCheckedBadgeText:{color:"#9C27B0"},headerInsuredBadge:{borderColor:"#0784C6",backgroundColor:"rgba(7, 132, 198, 0.1)"},headerInsuredBadgeText:{color:"#0784C6"},headerEliteProBadge:{borderColor:"#4CAF50",backgroundColor:"rgba(76, 175, 80, 0.1)"},headerEliteProBadgeText:{color:"#4CAF50"}}),ki=({visible:e,onClose:t,professional:o,primaryService:i})=>{const s=(0,b.useNavigation)(),{isSignedIn:l}=(0,n.useContext)(h.AuthContext),[d,c]=(0,n.useState)([]),[u,g]=(0,n.useState)(null),[f,y]=(0,n.useState)(!1),[x,w]=(0,n.useState)(null),[T,B]=(0,n.useState)(null),[_,I]=(0,n.useState)("services"),[M,L]=(0,n.useState)(!1),[R,D]=(0,n.useState)(!1),[z,P]=(0,n.useState)(""),[F,E]=(0,n.useState)([]),[W,O]=(0,n.useState)(0),[N,H]=(0,n.useState)(0),[U,V]=(0,n.useState)(!1),[q,Y]=(0,n.useState)(!1),[G,J]=(0,n.useState)("services"),{width:$}=C.default.get("window"),K=$<=768,Z=$<=600;(0,n.useEffect)((()=>{e&&o?.professional_id&&(ee(),te())}),[e,o?.professional_id]),(0,n.useEffect)((()=>{if(d.length>0&&i){const e=d.find((e=>e.service_id===i.service_id));g(e||d[0])}else d.length>0&&g(d[0])}),[d,i]);const ee=async()=>{y(!0),w(null);try{(0,h.debugLog)("MBA9999","Fetching services for professional:",o.professional_id);const e=await(0,bt.getProfessionalServicesDetailed)(o.professional_id);c(e)}catch(e){(0,h.debugLog)("MBA9999","Error fetching professional services:",e),w("Failed to load services")}finally{y(!1)}},te=async()=>{if(o?.professional_id){V(!0);try{const e=o.professional_id.toString();(0,h.debugLog)("MBA4001","Fetching reviews for professional:",e);const t=await(0,bt.getUserReviews)(null,e,!1);(0,h.debugLog)("MBA4001","Reviews fetched successfully:",t),t&&"object"===typeof t?(E(t.reviews||[]),O(t.average_rating||0),H(t.review_count||0),t.reviews&&t.reviews.length>0&&(0,h.debugLog)("MBA4001","First review has profile picture:",{has_profile_pic:!!t.reviews[0].reviewer_profile_picture,profile_pic_url:t.reviews[0].reviewer_profile_picture||"none"}),t.detail&&(0,h.debugLog)("MBA4001","Review fetch message:",t.detail)):((0,h.debugLog)("MBA4001","Unexpected reviews data format:",t),E([]),O(0),H(0))}catch(e){(0,h.debugLog)("MBA4001","Error fetching professional reviews:",e),E([]),O(0),H(0)}finally{V(!1)}}},oe=()=>{g(null),c([]),w(null),B(null),I("services"),D(!1),P(""),E([]),O(0),H(0),J("services"),t()},ne=e=>{g(e),K&&I("details")},re=e=>{if(!e||"object"!==typeof e)return"Various animals";const t=Object.keys(e);return 0===t.length?"Various animals":1===t.length?t[0]:2===t.length?"".concat(t[0]," & ").concat(t[1]):"".concat(t[0],", ").concat(t[1]," & ").concat(t.length-2," more")},ae=e=>{const t=[];for(let o=1;o<=5;o++)t.push((0,j.jsx)(S.default,{name:o<=e?"star":"star-outline",size:16,color:m.theme.colors.warning,style:Bi.starIcon},o));return(0,j.jsx)(r.default,{style:Bi.starsContainer,children:t})},ie=e=>{if(e){const t=(0,p.getMediaUrl)(e);return(0,j.jsx)(Q.default,{source:{uri:t},style:Bi.reviewProfileImage,resizeMode:"cover"})}return(0,j.jsx)(r.default,{style:Bi.defaultReviewProfileImage,children:(0,j.jsx)(S.default,{name:"account",size:32,color:m.theme.colors.surface})})},se=e=>{return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(r.default,{style:Bi.detailSection,children:[(0,j.jsx)(a.default,{style:Bi.detailLabel,children:"Description"}),(0,j.jsx)(a.default,{style:Bi.detailText,children:e.description})]}),(0,j.jsxs)(r.default,{style:Bi.detailSection,children:[(0,j.jsx)(a.default,{style:Bi.detailLabel,children:"Animal Types"}),(0,j.jsx)(a.default,{style:Bi.detailText,children:re(e.animal_types)})]}),(0,j.jsxs)(r.default,{style:Bi.detailSection,children:[(0,j.jsx)(a.default,{style:Bi.detailLabel,children:"Base Rate"}),(0,j.jsxs)(a.default,{style:Bi.detailText,children:["$",e.base_rate," per ",e.unit_of_time]})]}),(0,j.jsxs)(r.default,{style:Bi.detailSection,children:[(0,j.jsx)(a.default,{style:Bi.detailLabel,children:"Additional Animal Rate"}),(0,j.jsxs)(a.default,{style:Bi.detailText,children:["$",e.additional_animal_rate," (applies after ",e.applies_after," animal",e.applies_after>1?"s":"",")"]})]}),e.holiday_rate&&"$0"!==e.holiday_rate&&"$0.00"!==e.holiday_rate&&"0%"!==e.holiday_rate&&"0.00%"!==e.holiday_rate&&"0"!==e.holiday_rate&&(0,j.jsxs)(r.default,{style:Bi.detailSection,children:[(0,j.jsx)(a.default,{style:Bi.detailLabel,children:"Holiday Rate"}),(0,j.jsx)(a.default,{style:Bi.detailText,children:e.holiday_rate})]}),e.is_overnight&&(0,j.jsx)(r.default,{style:Bi.detailSection,children:(0,j.jsx)(a.default,{style:Bi.overnightBadge,children:"Overnight Service"})}),(t=e.additional_rates,t&&0!==t.length?(0,j.jsxs)(r.default,{style:Bi.detailSection,children:[(0,j.jsx)(a.default,{style:Bi.detailLabel,children:"Additional Rates"}),t.map((e=>(0,j.jsx)(r.default,{style:Bi.additionalRateItem,children:(0,j.jsxs)(r.default,{style:Bi.additionalRateRow,children:[(0,j.jsxs)(r.default,{style:Bi.additionalRateTitleContainer,children:[e.description&&(0,j.jsx)(v.default,{style:Bi.infoIcon,onPress:()=>B(T===e.rate_id?null:e.rate_id),children:(0,j.jsx)(S.default,{name:"information-outline",size:16,color:m.theme.colors.primary})}),(0,j.jsx)(a.default,{style:Bi.additionalRateTitle,children:e.title})]}),(0,j.jsxs)(a.default,{style:Bi.additionalRatePrice,children:["$",e.rate]})]})},e.rate_id)))]}):null)]});var t},le=()=>U?(0,j.jsxs)(r.default,{style:Bi.loadingContainer,children:[(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:Bi.loadingText,children:"Loading reviews..."})]}):0===F.length?(0,j.jsxs)(r.default,{style:Bi.emptyStateContainer,children:[(0,j.jsx)(S.default,{name:"star-outline",size:60,color:m.theme.colors.placeholder}),(0,j.jsx)(a.default,{style:Bi.emptyStateText,children:"No reviews yet"})]}):(0,j.jsx)(X.default,{style:Bi.reviewsList,contentContainerStyle:Bi.reviewsContent,children:[...F].sort(((e,t)=>t.rating-e.rating)).map((e=>(0,j.jsx)(r.default,{style:Bi.reviewCard,children:(0,j.jsxs)(r.default,{style:Bi.reviewUserInfo,children:[(0,j.jsx)(r.default,{style:Bi.profileContainer,children:ie(e.reviewer_profile_picture)}),(0,j.jsxs)(r.default,{style:Bi.reviewUserDetails,children:[(0,j.jsxs)(r.default,{style:Bi.nameAndStarsRow,children:[(0,j.jsx)(a.default,{style:Bi.reviewerName,children:e.client_name||"Anonymous"}),ae(e.rating)]}),(0,j.jsxs)(r.default,{style:Bi.serviceRow,children:[(0,j.jsx)(S.default,{name:"briefcase-outline",size:14,color:m.theme.colors.textSecondary,style:Bi.calendarIcon}),(0,j.jsx)(a.default,{style:Bi.serviceName,children:e.service_name||"No Service Found"}),(0,j.jsx)(a.default,{style:Bi.serviceName,children:"\u2022"}),(0,j.jsx)(S.default,{name:"calendar",size:14,color:m.theme.colors.textSecondary,style:Bi.calendarIcon}),(0,j.jsx)(a.default,{style:Bi.serviceInfoText,children:e.last_occurrence_end_date||e.created_at})]}),(0,j.jsx)(a.default,{style:Bi.reviewText,children:e.review_text||"No comments provided."})]})]})},e.review_id)))});return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(k.default,{visible:e,onRequestClose:oe,animationType:"slide",transparent:!0,children:[(0,j.jsx)(r.default,{style:Bi.modalOverlay,children:(0,j.jsxs)(r.default,{style:[Bi.modalContainer,Z&&Bi.modalContainerSmallMobile],children:[(0,j.jsxs)(r.default,{style:Bi.header,children:[(0,j.jsxs)(r.default,{style:Bi.headerTop,children:[(0,j.jsxs)(r.default,{style:Bi.headerLeft,children:[o?.profile_picture_url?(0,j.jsx)(Q.default,{source:{uri:(0,p.getMediaUrl)(o.profile_picture_url)},style:Bi.professionalProfilePhoto}):(0,j.jsx)(r.default,{style:Bi.professionalProfilePhotoPlaceholder,children:(0,j.jsx)(S.default,{name:"account",size:24,color:m.theme.colors.placeholder})}),(0,j.jsxs)(r.default,{style:Bi.headerTextContainer,children:[(0,j.jsx)(a.default,{style:Bi.professionalName,children:o?.name}),(0,j.jsxs)(r.default,{style:Bi.headerLocationContainer,children:[N>0?(0,j.jsxs)(v.default,{style:Bi.reviewBadge,onPress:()=>{Y(!0)},children:[(0,j.jsx)(S.default,{name:"star",size:16,color:m.theme.colors.warning}),(0,j.jsxs)(a.default,{style:Bi.reviewBadgeText,children:[W.toFixed(2)," \u2022 ",N," ",1===N?"Review":"Reviews"]})]}):(0,j.jsx)(a.default,{style:Bi.noReviewsText,children:"No reviews yet"}),(0,j.jsxs)(a.default,{style:Bi.professionalLocation,children:["\u2022 ",o?.location]})]})]})]}),(0,j.jsx)(v.default,{onPress:oe,style:Bi.closeButton,children:(0,j.jsx)(S.default,{name:"close",size:24,color:m.theme.colors.text})})]}),(0,j.jsx)(r.default,{style:Bi.headerBadgesContainer,children:(0,j.jsxs)(X.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:Bi.headerBadgesScrollContent,children:[o?.badges?.is_background_checked&&(0,j.jsxs)(r.default,{style:[Bi.headerBadge,Bi.headerBackgroundCheckedBadge],children:[(0,j.jsx)(S.default,{name:"shield-check",size:12,color:"#9C27B0"}),(0,j.jsx)(a.default,{style:[Bi.headerBadgeText,Bi.headerBackgroundCheckedBadgeText],children:"Background Checked"})]}),o?.badges?.is_insured&&(0,j.jsxs)(r.default,{style:[Bi.headerBadge,Bi.headerInsuredBadge],children:[(0,j.jsx)(S.default,{name:"security",size:12,color:"#0784C6"}),(0,j.jsx)(a.default,{style:[Bi.headerBadgeText,Bi.headerInsuredBadgeText],children:"Insured"})]}),o?.badges?.is_elite_pro&&(0,j.jsxs)(r.default,{style:[Bi.headerBadge,Bi.headerEliteProBadge],children:[(0,j.jsx)(S.default,{name:"medal",size:12,color:"#4CAF50"}),(0,j.jsx)(a.default,{style:[Bi.headerBadgeText,Bi.headerEliteProBadgeText],children:"Elite Pro"})]})]})})]}),f?(0,j.jsxs)(r.default,{style:Bi.loadingContainer,children:[(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:Bi.loadingText,children:"Loading services..."})]}):x?(0,j.jsxs)(r.default,{style:Bi.errorContainer,children:[(0,j.jsx)(a.default,{style:Bi.errorText,children:x}),(0,j.jsx)(v.default,{style:Bi.retryButton,onPress:ee,children:(0,j.jsx)(a.default,{style:Bi.retryText,children:"Retry"})})]}):(0,j.jsxs)(r.default,{style:[Bi.content,K&&Bi.contentMobile],children:[K&&"services"===_&&(0,j.jsxs)(r.default,{style:Bi.mobileMainView,children:[(0,j.jsxs)(r.default,{style:Bi.tabContainer,children:[(0,j.jsx)(v.default,{style:[Bi.tab,"services"===G&&Bi.activeTab],onPress:()=>J("services"),children:(0,j.jsx)(a.default,{style:[Bi.tabText,"services"===G&&Bi.activeTabText],children:"Services"})}),(0,j.jsx)(v.default,{style:[Bi.tab,"reviews"===G&&Bi.activeTab],onPress:()=>J("reviews"),children:(0,j.jsxs)(a.default,{style:[Bi.tabText,"reviews"===G&&Bi.activeTabText],children:["Reviews ",N>0&&"(".concat(N,")")]})})]}),"services"===G?(0,j.jsx)(X.default,{style:Bi.servicesScrollView,children:d.map((e=>(0,j.jsxs)(v.default,{style:Bi.mobileServiceItem,onPress:()=>ne(e),children:[(0,j.jsxs)(r.default,{style:Bi.mobileServiceContent,children:[(0,j.jsx)(a.default,{style:Bi.mobileServiceName,children:e.service_name}),(0,j.jsxs)(a.default,{style:Bi.mobileServicePrice,children:["$",e.base_rate,"/",e.unit_of_time]})]}),(0,j.jsx)(S.default,{name:"chevron-right",size:24,color:m.theme.colors.textSecondary})]},e.service_id)))}):(0,j.jsx)(r.default,{style:Bi.reviewsTabContent,children:le()})]}),K&&"details"===_&&u&&(0,j.jsxs)(r.default,{style:Bi.mobileDetailsView,children:[(0,j.jsxs)(r.default,{style:Bi.mobileDetailsHeader,children:[(0,j.jsx)(v.default,{style:Bi.backButton,onPress:()=>{I("services")},children:(0,j.jsx)(S.default,{name:"arrow-left",size:24,color:m.theme.colors.primary})}),(0,j.jsx)(a.default,{style:Bi.mobileDetailsTitle,children:u.service_name})]}),(0,j.jsx)(X.default,{style:Bi.mobileDetailsScrollView,children:se(u)})]}),!K&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(r.default,{style:Bi.servicesList,children:[(0,j.jsxs)(r.default,{style:Bi.tabContainer,children:[(0,j.jsx)(v.default,{style:[Bi.tab,"services"===G&&Bi.activeTab],onPress:()=>J("services"),children:(0,j.jsx)(a.default,{style:[Bi.tabText,"services"===G&&Bi.activeTabText],children:"Services"})}),(0,j.jsx)(v.default,{style:[Bi.tab,"reviews"===G&&Bi.activeTab],onPress:()=>J("reviews"),children:(0,j.jsxs)(a.default,{style:[Bi.tabText,"reviews"===G&&Bi.activeTabText],children:["Reviews ",N>0&&"(".concat(N,")")]})})]}),"services"===G?(0,j.jsx)(X.default,{style:Bi.servicesScrollView,children:d.map((e=>(0,j.jsxs)(v.default,{style:[Bi.serviceItem,u?.service_id===e.service_id&&Bi.serviceItemSelected],onPress:()=>ne(e),children:[(0,j.jsx)(a.default,{style:[Bi.serviceName,u?.service_id===e.service_id&&Bi.serviceNameSelected],children:e.service_name}),(0,j.jsxs)(a.default,{style:[Bi.servicePrice,u?.service_id===e.service_id&&Bi.servicePriceSelected],children:["$",e.base_rate,"/",e.unit_of_time]})]},e.service_id)))}):(0,j.jsx)(r.default,{style:Bi.reviewsTabContent,children:le()})]}),"services"===G&&(0,j.jsx)(r.default,{style:Bi.serviceDetails,children:u?(0,j.jsxs)(X.default,{style:Bi.detailsScrollView,children:[(0,j.jsx)(a.default,{style:Bi.detailsTitle,children:u.service_name}),se(u)]}):(0,j.jsx)(r.default,{style:Bi.noSelectionContainer,children:(0,j.jsx)(a.default,{style:Bi.noSelectionText,children:"Select a service to view details"})})})]})]}),!f&&!x&&(0,j.jsx)(r.default,{style:Bi.footer,children:(0,j.jsx)(v.default,{style:[Bi.contactButton,M&&Bi.contactButtonDisabled],onPress:async()=>{if(o?.professional_id){if(!l)return(0,h.debugLog)("MBA24u45vn","User not signed in, redirecting to login"),t(),void s.navigate("SignIn");L(!0);try{(0,h.debugLog)("MBA24u45vn","Navigation state before creating conversation",{current_route:s.getState()?.routes?.[s.getState()?.index]?.name,current_params:JSON.stringify(s.getState()?.routes?.[s.getState()?.index]?.params||{}),route_count:s.getState()?.routes?.length,current_index:s.getState()?.index,timestamp:Date.now()}),(0,h.debugLog)("MBA24u45vn","Creating conversation with professional - START",{professional_id:o.professional_id,professional_name:o.name,from_screen:s.getState()?.routes?.[s.getState()?.index]?.name||"unknown",previous_screen:s.getState()?.routes?.[s.getState()?.index-1]?.name||"unknown",timestamp:Date.now()});const e=await(0,bt.createConversation)(o.professional_id);(0,h.debugLog)("MBA24u45vn","Conversation created successfully",{conversation_id:e.conversation_id,other_user_name:e.other_user_name,status:e.status,is_professional:e.is_professional,full_response:JSON.stringify(e),timestamp:Date.now()});const n=s.getState()?.routes?.[s.getState()?.index]?.name,r=s.getState()?.routes?.[s.getState()?.index]?.params;(0,h.debugLog)("MBA24u45vn","About to navigate to MessageHistory",{from_route:n,current_params:JSON.stringify(r),conversation_id:e.conversation_id,navigation_timestamp:Date.now(),navigation_state:JSON.stringify(s.getState())}),t(),await new Promise((e=>setTimeout(e,500)));const a={conversationId:e.conversation_id,otherUserName:o.name,otherUserProfilePic:o.profile_picture||null,isProfessional:!1,fullConversationData:JSON.stringify(e),_timestamp:Date.now()};(0,h.debugLog)("MBA24u45vn","Navigation params prepared",{params:JSON.stringify(a),timestamp:Date.now()}),s.navigate("MessageHistory",a),(0,h.debugLog)("MBA24u45vn","Navigation to MessageHistory completed",{conversation_id:e.conversation_id,timestamp:Date.now()}),setTimeout((()=>{(0,h.debugLog)("MBA24u45vn","Navigation state after navigation (with timeout)",{current_route:s.getState()?.routes?.[s.getState()?.index]?.name,current_params:JSON.stringify(s.getState()?.routes?.[s.getState()?.index]?.params||{}),route_count:s.getState()?.routes?.length,current_index:s.getState()?.index,timestamp:Date.now()})}),100)}catch(e){(0,h.debugLog)("MBA3456","Error creating conversation:",e),400===e.response?.status&&"Cannot create conversation with yourself"===e.response?.data?.error?(P("You cannot contact yourself."),D(!0)):(P("Failed to create conversation. Please try again."),D(!0))}finally{L(!1)}}else Et.default.alert("Error","Professional information not available")},disabled:M,children:M?(0,j.jsxs)(r.default,{style:Bi.contactButtonContent,children:[(0,j.jsx)(A.default,{size:"small",color:m.theme.colors.whiteText}),(0,j.jsx)(a.default,{style:[Bi.contactButtonText,{marginLeft:8}],children:"Creating conversation..."})]}):(0,j.jsxs)(a.default,{style:Bi.contactButtonText,children:["Contact ",o?.name]})})})]})}),(0,j.jsx)(k.default,{visible:null!==T,transparent:!0,animationType:"fade",onRequestClose:()=>B(null),children:(0,j.jsx)(v.default,{style:Bi.tooltipModalOverlay,activeOpacity:1,onPress:()=>B(null),children:(0,j.jsxs)(r.default,{style:Bi.tooltipModalContent,children:[(0,j.jsxs)(r.default,{style:Bi.tooltipHeader,children:[(0,j.jsx)(a.default,{style:Bi.tooltipTitle,children:d.find((e=>e.additional_rates?.find((e=>e.rate_id===T))))?.additional_rates?.find((e=>e.rate_id===T))?.title||"Rate Info"}),(0,j.jsx)(v.default,{style:Bi.tooltipCloseButton,onPress:()=>B(null),children:(0,j.jsx)(S.default,{name:"close",size:18,color:m.theme.colors.text})})]}),(0,j.jsx)(a.default,{style:Bi.tooltipText,children:d.find((e=>e.additional_rates?.find((e=>e.rate_id===T))))?.additional_rates?.find((e=>e.rate_id===T))?.description||""})]})})}),(0,j.jsx)(k.default,{visible:R,transparent:!0,animationType:"fade",onRequestClose:()=>D(!1),children:(0,j.jsx)(v.default,{style:Bi.tooltipModalOverlay,activeOpacity:1,onPress:()=>D(!1),children:(0,j.jsxs)(v.default,{style:Bi.errorModalContent,activeOpacity:1,onPress:e=>e.stopPropagation(),children:[(0,j.jsxs)(r.default,{style:Bi.errorModalHeader,children:[(0,j.jsx)(a.default,{style:Bi.errorModalTitle,children:"Error"}),(0,j.jsx)(v.default,{style:Bi.errorModalCloseButton,onPress:()=>D(!1),children:(0,j.jsx)(S.default,{name:"close",size:20,color:m.theme.colors.text})})]}),(0,j.jsx)(a.default,{style:Bi.errorModalText,children:z}),(0,j.jsx)(v.default,{style:Bi.errorModalOkButton,onPress:()=>D(!1),children:(0,j.jsx)(a.default,{style:Bi.errorModalOkText,children:"OK"})})]})})})]}),(0,j.jsx)(po,{visible:q,onClose:()=>{Y(!1)},reviews:F,averageRating:W,reviewCount:N,userName:o?.name,forProfessional:!0})]})};var Ai=o(49377);const _i=({navigation:e,route:t})=>{const{width:o}=(0,Ne.default)(),{screenWidth:a,isCollapsed:s,isSignedIn:l}=(0,n.useContext)(h.AuthContext),[d,c]=(0,n.useState)(a<=1200),[u,g]=(0,n.useState)(a<=900),[f,p]=(0,n.useState)(d?"filters":"all"),[y,b]=(0,n.useState)([]),[x,w]=(0,n.useState)({}),[C,S]=(0,n.useState)(!1),[T,B]=(0,n.useState)(!0),[k,A]=(0,n.useState)(!0),[_,I]=(0,n.useState)(!1),[M,L]=(0,n.useState)(null),[R,D]=(0,n.useState)(null),[z,P]=(0,n.useState)(null),[F,E]=(0,n.useState)({latitude:38.8339,longitude:-104.8214,latitudeDelta:.0922,longitudeDelta:.0421}),[W,O]=(0,n.useState)({categories:[]}),[N,H]=(0,n.useState)(!1),[U,V]=(0,n.useState)(null),q=(e,t=20)=>e?e.length<=t?e:e.substring(0,t)+"...":"",Y=e=>{if(!e)return[];(0,h.debugLog)("MBA9999","Generating filter categories from search params:",e);const t=[];if(e.animal_types&&e.animal_types.length>0&&(1===e.animal_types.length?t.push(e.animal_types[0]):2===e.animal_types.length?(t.push(e.animal_types[0]),t.push(e.animal_types[1])):(t.push(e.animal_types[0]),t.push("+".concat(e.animal_types.length-1," more")))),e.location){const o=(e=>{if(!e)return"";const t=e.match(/^([^,]+)/);return t&&t[1]?t[1].trim():q(e)})(e.location);t.push(o),(0,h.debugLog)("MBA9999",'Extracted city "'.concat(o,'" from location "').concat(e.location,'"'))}if(e.service_query){const o=q(e.service_query,15);t.push(o)}e.overnight_service&&t.push("Overnight"),e.price_max&&e.price_max<250&&t.push("Under $".concat(e.price_max)),e.filter_background_checked&&t.push("Background Checked"),e.filter_insured&&t.push("Insured"),e.filter_elite_pro&&t.push("Elite Pro");const o=t.length>4?[...t.slice(0,3),"+".concat(t.length-3," more")]:t;return(0,h.debugLog)("MBA9999","Generated filter categories:",o),o};(0,n.useEffect)((()=>{c(a<=1200),g(a<=900),p(a<=1200?"filters":"all")}),[a]),(0,n.useEffect)((()=>e.addListener("focus",(()=>{d&&p("filters")}))),[e,d]),(0,n.useEffect)((()=>{G()}),[]);const G=async()=>{I(!0);try{(0,h.debugLog)("MBA9999","Loading initial professionals for Colorado Springs");const e={animal_types:[],location:"Colorado Springs, Colorado",service_query:"",overnight_service:!1,price_min:0,price_max:999999,radius_miles:30,page:1,page_size:20},t=await(0,bt.searchProfessionals)(e);(0,h.debugLog)("MBA9999","Initial professionals loaded:",t),L(t),b(t.professionals||[]),D(e);const o=Y(e);O({categories:o})}catch(zs){(0,h.debugLog)("MBA9999","Error loading initial professionals:",zs),console.error("Error loading initial professionals:",zs)}finally{I(!1)}},J=(e,t=null)=>{if((0,h.debugLog)("MBA9999","Received search results:",e),L(e),b(e.professionals||[]),e.fallback_message?(P(e.fallback_message),(0,h.debugLog)("MBA9999","Fallback message set:",e.fallback_message)):P(null),t){D(t);const o=Y(t);O({categories:o}),(0,h.debugLog)("MBA9999","Updated active filters:",o),(0,h.debugLog)("MBA9999","Search complete: Found "+(e.professionals?.length||0)+" professionals with active filters: "+o.join(", "))}},$=e=>{w(e)},K=()=>{},Z=e=>{V(e),H(!0)},X=e=>{V(e),H(!0)},Q=()=>{S(!C)},ee=e=>{A(!1),d&&p("map"===e?"map":"list")},te=()=>{B(!T),T||S(!0)},oe=((e,t,o,n)=>i.default.create({mainContainer:{flex:1,backgroundColor:m.theme.colors.background,position:"fixed",top:0,left:0,right:0,bottom:0,marginLeft:e>900&&o?t?70:250:0,paddingTop:!o||n?60:0,transition:"margin-left 0.3s ease"},container:{flex:1,display:"flex",flexDirection:"column",height:!o||n?"calc(100vh - 60px)":"100vh",overflow:"hidden"},content:{flex:1,flexDirection:"row",height:n?"100%":"calc(100vh - 64px)",overflow:"hidden"},leftColumn:{height:"100%",borderRightWidth:1,borderRightColor:m.theme.colors.border,backgroundColor:m.theme.colors.background,transition:"width 0.3s ease",position:"relative",zIndex:1},leftColumnToggle:{position:"absolute",top:"50%",right:-16,transform:[{translateY:-20}],zIndex:2e3,backgroundColor:m.theme.colors.surface,padding:m.theme.spacing.small,borderRadius:20,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3,width:32,height:32,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:m.theme.colors.border},mapColumn:{flex:1,backgroundColor:m.theme.colors.background,height:"100%",transition:"width 0.3s ease",position:"relative",zIndex:0},toggleButton:{position:"absolute",top:m.theme.spacing.medium,right:m.theme.spacing.medium,zIndex:1e3,backgroundColor:m.theme.colors.surface,padding:m.theme.spacing.small,borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3},toggleButtonText:{color:m.theme.colors.primary,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},containerMobile:{flex:1,backgroundColor:m.theme.colors.background,height:"100%",overflow:"hidden"},mobileHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderBottomWidth:2,padding:10,marginHorizontal:10,backgroundColor:m.theme.colors.background},mobileHeaderText:{fontSize:m.theme.fontSizes.large,fontWeight:"500",fontFamily:m.theme.fonts.header.fontFamily},headerIcon:{padding:8,marginLeft:16},searchButton:{backgroundColor:m.theme.colors.primary,padding:10,alignItems:"center",borderRadius:5,margin:10},searchButtonText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.medium+2,fontFamily:m.theme.fonts.regular.fontFamily},mapToggleButton:{position:"absolute",top:m.theme.spacing.medium,right:m.theme.spacing.medium,zIndex:1e3,backgroundColor:m.theme.colors.surface,padding:m.theme.spacing.small,borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:3}}))(a,s,l,u);return(0,j.jsxs)(r.default,{style:oe.mainContainer,children:[(0,j.jsx)(He.default,{style:oe.container,children:(0,j.jsx)(r.default,{style:oe.content,children:(()=>{if(!d){const e=T?"50%":"33.333%",t=C?"50%":"66.666%";return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(r.default,{style:[oe.leftColumn,{width:e}],children:[(0,j.jsx)(v.default,{style:[oe.toggleButton,oe.leftColumnToggle],onPress:te,children:(0,j.jsx)(Ai.default,{name:T?"chevron-left":"chevron-right",size:24,color:m.theme.colors.primary})}),k?(0,j.jsx)(gi,{onFiltersChange:$,onShowProfessionals:ee,onSearchResults:J,initialFilters:R}):(0,j.jsx)(fi,{professionals:y,onLoadMore:K,onProfessionalSelect:Z,isMobile:u,filters:W,searchParams:R,fallbackMessage:z,onFilterPress:e=>{"map"===e?p("map"):A(!0)}})]}),(0,j.jsxs)(r.default,{style:[oe.mapColumn,{width:t}],children:[(0,j.jsx)(v.default,{style:[oe.toggleButton,oe.mapToggleButton],onPress:Q,children:(0,j.jsx)(Ai.default,{name:C?"arrow-expand":"arrow-collapse",size:24,color:m.theme.colors.primary})}),(0,j.jsx)(Ti,{professionals:y,onMarkerPress:Z,onShowServicesModal:X,region:F,isMobile:u})]})]})}return(0,j.jsxs)(r.default,{style:oe.containerMobile,children:["filters"===f&&(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(gi,{onFiltersChange:$,onShowProfessionals:ee,onSearchResults:J,isMobile:d,initialFilters:R})}),"list"===f&&(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(fi,{professionals:y,onLoadMore:K,onProfessionalSelect:Z,isMobile:d,filters:W,searchParams:R,fallbackMessage:z,onFilterPress:e=>{p("map"===e?"map":"filters")}})}),"map"===f&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(r.default,{style:oe.mobileHeader,children:(0,j.jsx)(v.default,{onPress:()=>p("list"),children:(0,j.jsx)(Ai.default,{name:"arrow-left",size:24,color:m.theme.colors.primary})})}),(0,j.jsx)(Ti,{professionals:y,onMarkerPress:Z,onShowServicesModal:X,region:F,isMobile:d})]})]})})()})}),(0,j.jsx)(ki,{visible:N,onClose:()=>{H(!1),V(null)},professional:U,primaryService:U?.primary_service})]})},Ii=i.default.create({container:{flex:1,height:"100vh",backgroundColor:m.theme.colors.surface,position:"fixed",top:0,right:0,bottom:0,left:0,overflow:"hidden",transition:"margin-left 0.3s ease"},content:{flex:1,height:"100%",overflow:"auto"},mainContent:{flex:1,width:"100%",alignSelf:"center",backgroundColor:m.theme.colors.background},headerSection:{width:"100%",backgroundColor:m.theme.colors.surfaceContrast,paddingHorizontal:24,paddingTop:24,zIndex:2},bookingsContent:{flex:1,backgroundColor:m.theme.colors.surface,position:"relative"},title:{fontSize:32,fontWeight:"600",color:m.theme.colors.text,marginBottom:24,fontFamily:m.theme.fonts.header.fontFamily},tabContainer:{flexDirection:"row",gap:32},tab:{paddingBottom:8,borderBottomWidth:2,borderBottomColor:"transparent"},activeTab:{borderBottomColor:m.theme.colors.primary},tabText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},activeTabText:{color:m.theme.colors.primary,fontWeight:"500"},stickyHeader:{position:"absolute",top:0,left:0,right:0,backgroundColor:m.theme.colors.surfaceContrast,zIndex:2,marginHorizontal:24,marginTop:24,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,borderRadius:8,padding:16},stickyHeaderContent:{width:"100%",gap:16},searchContainer:{flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,padding:12,borderWidth:1,borderColor:"#CCCBC9"},filterScrollContent:{flexGrow:0},filtersWrapper:{flexDirection:"row",justifyContent:"flex-end",marginRight:-16},filterContainer:{flexDirection:"row",gap:8,backgroundColor:m.theme.colors.surfaceContrast,paddingVertical:8,paddingLeft:4,paddingRight:16},filterButton:Object.assign({paddingHorizontal:12,paddingVertical:6,borderRadius:16,justifyContent:"center"},{transition:"all 0.2s ease-in-out",cursor:"pointer"}),filterButtonHovered:{transform:[{scale:1.05}],shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:5},filterContent:{flexDirection:"row",alignItems:"center",justifyContent:"center",gap:6},checkmark:{marginLeft:4},allButton:{backgroundColor:"#EFF9FF"},allButtonText:{color:"#0784C6"},pendingButton:{backgroundColor:m.theme.colors.mybookings.main},pendingButtonText:{color:m.theme.colors.mybookings.secondary},confirmedButton:{backgroundColor:"#E8E9E2"},confirmedButtonText:{color:"#898974"},completedButton:{backgroundColor:"#F5F5F4"},completedButtonText:{color:m.theme.colors.mybookings.completedText},filterText:{fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center"},listHeaderSpacing:{paddingTop:16},listContainer:{paddingHorizontal:24,paddingBottom:34},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingMoreContainer:{paddingVertical:16,alignItems:"center"},emptyStateContainer:{flex:1,justifyContent:"center",alignItems:"center",paddingHorizontal:24},emptyStateTitle:{fontSize:m.theme.fontSizes.large,fontWeight:"600",color:m.theme.colors.text,marginTop:16,textAlign:"center",fontFamily:m.theme.fonts.header.fontFamily},emptyStateSubtitle:{fontSize:16,color:m.theme.colors.placeholder,textAlign:"center",marginTop:8,marginBottom:24,fontFamily:m.theme.fonts.regular.fontFamily},createServiceButton:{backgroundColor:m.theme.colors.primary,paddingHorizontal:24,paddingVertical:12,borderRadius:8,marginTop:8},createServiceButtonText:{color:m.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},retryButton:{backgroundColor:m.theme.colors.error,paddingHorizontal:24,paddingVertical:12,borderRadius:8,marginTop:8},retryButtonText:{color:m.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},searchInput:{outlineStyle:"none",outlineWidth:0,outline:"none",marginLeft:8}}),Mi=()=>{const e=(0,b.useNavigation)(),{isApprovedProfessional:t,userRole:o,is_DEBUG:i,isCollapsed:s,screenWidth:l}=(0,n.useContext)(h.AuthContext),[d,c]=(0,n.useState)(l<900),[u,f]=(0,n.useState)(l>=1200),[y,w]=(0,n.useState)("professional"===o?"professional":"owner"),[T,B]=(0,n.useState)(""),[k,_]=(0,n.useState)([]),[I,M]=(0,n.useState)(!0),[L,R]=(0,n.useState)(null),[D,z]=(0,n.useState)(1),[P,F]=(0,n.useState)(!0),[E,W]=(0,n.useState)(!1),[O,N]=(0,n.useState)("all"),[H,U]=(0,n.useState)(null),V=kt();(0,n.useEffect)((()=>{const e=C.default.addEventListener("change",(()=>{c(C.default.get("window").width<900),f(C.default.get("window").width>=1200)}));return()=>{e?.remove()}}),[]),(0,n.useEffect)((()=>{"professional"===o&&t&&w("professional")}),[o,t]);const q=async(e=1,n=!1)=>{n?W(!0):(M(!0),R(null));try{let r=sessionStorage.getItem("userToken");if(!r)throw new Error("No authentication token found");i&&console.log("MBA1234 Fetching bookings:",{isApprovedProfessional:t,userRole:o,activeTab:y,page:e,status:O});const a=await x.default.get("".concat(p.API_BASE_URL,"/api/bookings/v1/"),{headers:{Authorization:"Bearer ".concat(r)},params:{page:e,page_size:20,status:O}}),s="professional"===y?a.data.bookings.professional_bookings||[]:a.data.bookings.owner_bookings||[];_(n?e=>[...e,...s]:s),F(20===s.length),z(e)}catch(L){console.error("Error fetching bookings:",L),R("Failed to fetch bookings")}finally{M(!1),W(!1)}};(0,n.useEffect)((()=>{i&&console.log("MBA1234 Fetching bookings due to dependency change:",{activeTab:y,userRole:o,isApprovedProfessional:t,activeFilter:O}),z(1),_([]),q(1)}),[y,o,t,O]);return(0,j.jsx)(r.default,{style:[Ii.container,{marginLeft:d?0:s?70:250}],children:(0,j.jsx)(r.default,{style:[Ii.content,{marginTop:d?60:0}],children:(0,j.jsxs)(r.default,{style:Ii.mainContent,children:[(0,j.jsxs)(r.default,{style:Ii.headerSection,children:[(0,j.jsx)(a.default,{style:Ii.title,children:"My Bookings"}),t&&(0,j.jsxs)(r.default,{style:Ii.tabContainer,children:[(0,j.jsx)(v.default,{style:[Ii.tab,"professional"===y&&Ii.activeTab],onPress:()=>w("professional"),children:(0,j.jsx)(a.default,{style:[Ii.tabText,"professional"===y&&Ii.activeTabText],children:"Your Bookings"})}),(0,j.jsx)(v.default,{style:[Ii.tab,"owner"===y&&Ii.activeTab],onPress:()=>w("owner"),children:(0,j.jsx)(a.default,{style:[Ii.tabText,"owner"===y&&Ii.activeTabText],children:"Owner Bookings"})})]})]}),(0,j.jsx)(r.default,{style:Ii.bookingsContent,children:I?(0,j.jsx)(r.default,{style:Ii.loadingContainer,children:(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.primary})}):k.length>0?(0,j.jsxs)(r.default,{style:Ii.bookingsContent,children:[(0,j.jsx)(r.default,{style:Ii.stickyHeader,children:(0,j.jsxs)(r.default,{style:[Ii.stickyHeaderContent,{flexDirection:u?"row":"column"}],children:[(0,j.jsxs)(r.default,{style:[Ii.searchContainer,u?{flex:.4,marginRight:"auto"}:null],children:[(0,j.jsx)(S.default,{name:"magnify",size:24,color:m.theme.colors.mybookings.searchBar}),(0,j.jsx)(te.default,{style:[Ii.searchInput,{color:m.theme.colors.mybookings.searchBar,width:"100%",height:"100%"}],placeholder:"Search by pet name, owner, or date",value:T,onChangeText:e=>{if(B(e),!e.trim())return z(1),_([]),void q(1);const t=e.toLowerCase(),o=k.filter((e=>"professional"===y?e.id.toLowerCase().includes(t)||e.ownerName.toLowerCase().includes(t):e.id.toLowerCase().includes(t)||e.professionalName.toLowerCase().includes(t)));_(o)},outlineStyle:"none"})]}),(0,j.jsx)(r.default,{style:[Ii.filtersWrapper,u?{flex:.6,alignItems:"flex-end"}:null],children:(0,j.jsx)(X.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:Ii.filterScrollContent,children:(0,j.jsxs)(r.default,{style:Ii.filterContainer,children:[(0,j.jsx)(v.default,{style:[Ii.filterButton,Ii.allButton,V&&"all"===H&&Ii.filterButtonHovered],onPress:()=>N("all"),onMouseEnter:()=>V&&U("all"),onMouseLeave:()=>V&&U(null),children:(0,j.jsxs)(r.default,{style:Ii.filterContent,children:[(0,j.jsx)(S.default,{name:"filter-variant",size:16,color:"#0784C6"}),(0,j.jsx)(a.default,{style:[Ii.filterText,Ii.allButtonText],children:"All"}),"all"===O&&(0,j.jsx)(S.default,{name:"check",size:16,color:"#0784C6",style:Ii.checkmark})]})}),(0,j.jsx)(v.default,{style:[Ii.filterButton,Ii.pendingButton,V&&"pending"===H&&Ii.filterButtonHovered],onPress:()=>N("pending"),onMouseEnter:()=>V&&U("pending"),onMouseLeave:()=>V&&U(null),children:(0,j.jsxs)(r.default,{style:Ii.filterContent,children:[(0,j.jsx)(S.default,{name:"clock-outline",size:16,color:m.theme.colors.mybookings.secondary}),(0,j.jsx)(a.default,{style:[Ii.filterText,Ii.pendingButtonText],children:"Pending"}),"pending"===O&&(0,j.jsx)(S.default,{name:"check",size:16,color:m.theme.colors.mybookings.secondary,style:Ii.checkmark})]})}),(0,j.jsx)(v.default,{style:[Ii.filterButton,Ii.confirmedButton,V&&"confirmed"===H&&Ii.filterButtonHovered],onPress:()=>N("confirmed"),onMouseEnter:()=>V&&U("confirmed"),onMouseLeave:()=>V&&U(null),children:(0,j.jsxs)(r.default,{style:Ii.filterContent,children:[(0,j.jsx)(S.default,{name:"check-circle-outline",size:16,color:"#898974"}),(0,j.jsx)(a.default,{style:[Ii.filterText,Ii.confirmedButtonText],children:"Confirmed"}),"confirmed"===O&&(0,j.jsx)(S.default,{name:"check",size:16,color:"#898974",style:Ii.checkmark})]})}),(0,j.jsx)(v.default,{style:[Ii.filterButton,Ii.completedButton,V&&"completed"===H&&Ii.filterButtonHovered],onPress:()=>N("completed"),onMouseEnter:()=>V&&U("completed"),onMouseLeave:()=>V&&U(null),children:(0,j.jsxs)(r.default,{style:Ii.filterContent,children:[(0,j.jsx)(S.default,{name:"flag-checkered",size:16,color:m.theme.colors.mybookings.completedText}),(0,j.jsx)(a.default,{style:[Ii.filterText,Ii.completedButtonText],children:"Completed"}),"completed"===O&&(0,j.jsx)(S.default,{name:"check",size:16,color:m.theme.colors.mybookings.completedText,style:Ii.checkmark})]})})]})})})]})}),(0,j.jsx)(Yt.default,{data:k,renderItem:({item:t})=>(0,j.jsx)(en,{booking:{id:t.booking_id||t.id,ownerName:t.owner_name||t.ownerName,professionalName:t.professional_name||t.professionalName,serviceName:t.service_type||t.serviceName,date:t.start_date||t.date,time:t.start_time||t.time,status:t.status},type:y,onViewDetails:()=>(async t=>{i&&console.log("MBA1234 Navigating to booking details:",{bookingId:t.booking_id||t.id,isProfessional:"professional"===y}),await(0,g.navigateToFrom)(e,"BookingDetails","MyBookings",{bookingId:t.booking_id||t.id,isProfessional:"professional"===y})})(t),onCancel:()=>(async e=>{i&&console.log("MBA1234 Cancel booking:",e)})(t.booking_id||t.id)}),keyExtractor:e=>(e.booking_id||e.id||Math.random().toString()).toString(),contentContainerStyle:Ii.listContainer,onEndReached:()=>{!E&&P&&q(D+1,!0)},onEndReachedThreshold:.5,ListFooterComponent:()=>E?(0,j.jsx)(r.default,{style:Ii.loadingMoreContainer,children:(0,j.jsx)(A.default,{size:"small",color:m.theme.colors.primary})}):null,ListHeaderComponent:(0,j.jsx)(r.default,{style:[Ii.listHeaderSpacing,{height:u?130:190}]})})]}):(0,j.jsx)((()=>(0,j.jsxs)(r.default,{style:Ii.emptyStateContainer,children:[(0,j.jsx)(S.default,{name:L?"alert-circle-outline":"calendar-blank-outline",size:64,color:L?m.theme.colors.error:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:Ii.emptyStateTitle,children:L?"Error Getting Bookings":"No Bookings Found"}),(0,j.jsx)(a.default,{style:Ii.emptyStateSubtitle,children:L?"There was an error fetching your bookings. Please try again later.":"professional"===y?t?"Create a service to start receiving bookings":"Apply to become a professional to start receiving bookings":"Browse available services to make your first booking"}),!L&&(0,j.jsx)(v.default,{style:Ii.createServiceButton,onPress:()=>e.navigate("professional"===y?t?"ServiceManager":"BecomeProfessional":"SearchProfessionalsListing"),children:(0,j.jsx)(a.default,{style:Ii.createServiceButtonText,children:"professional"===y?t?"Create Service":"Become Professional":"Browse Services"})}),L&&(0,j.jsx)(v.default,{style:Ii.retryButton,onPress:()=>q(1),children:(0,j.jsx)(a.default,{style:Ii.retryButtonText,children:"Retry"})})]})),{})})]})})})},Li=i.default.create({header:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:16,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,backgroundColor:m.theme.colors.background,zIndex:100,elevation:100},logoContainer:{flex:1},logoText:{fontSize:m.theme.fontSizes.large,fontWeight:"bold",color:m.theme.colors.primary,fontFamily:m.theme.fonts.header.fontFamily},profileButton:{padding:4},mobileLogo:{height:40,width:120,resizeMode:"contain"},profileImage:{width:32,height:32,borderRadius:16,backgroundColor:m.theme.colors.surface}}),Ri=({title:e="CrittrCove",onProfilePress:t=null,customStyles:a={}})=>{const i=(0,b.useNavigation)(),{userProfileImage:s}=(0,n.useContext)(h.AuthContext);return(0,j.jsxs)(r.default,{style:[Li.header,a],children:[(0,j.jsx)(v.default,{onPress:()=>{return e="Home",void i.navigate(e);var e},children:(0,j.jsx)(Q.default,{source:o(14082),style:[Li.mobileLogo,{tintColor:m.theme.colors.primary}]})}),(0,j.jsx)(v.default,{onPress:()=>{t?t():i.navigate("Profile")},style:Li.profileButton,children:s?(0,j.jsx)(Q.default,{source:{uri:s},style:Li.profileImage}):(0,j.jsx)(S.default,{name:"account-circle",size:32,color:m.theme.colors.primary})})]})},Di=i.default.create({container:{flex:1,height:"100vh",backgroundColor:m.theme.colors.surface,position:"fixed",top:0,right:0,bottom:0,left:0,overflow:"hidden",transition:"margin-left 0.3s ease"},content:{flex:1,height:"100%",overflow:"auto"},loadingContainer:{justifyContent:"center",alignItems:"center"},safeAreaContainer:{flex:1,backgroundColor:m.theme.colors.surface},scrollView:{flex:1},scrollContent:{flexGrow:1,paddingBottom:80}}),zi=()=>{(0,b.useNavigation)();const[e,t]=(0,n.useState)([]),[o,a]=(0,n.useState)(!1),[i,s]=(0,n.useState)(!0),[l,d]=(0,n.useState)(!1),[c,u]=(0,n.useState)(C.default.get("window").width<900),{isCollapsed:g,is_DEBUG:f,isSignedIn:p,userRole:y}=(0,n.useContext)(h.AuthContext),x=E();(0,n.useEffect)((()=>{const e=C.default.addEventListener("change",(()=>{u(C.default.get("window").width<900)}));return()=>{e?.remove()}}),[]);const v=async()=>{try{if("professional"===y){s(!0);const e=await(0,bt.getProfessionalServices)();(0,h.debugLog)("MBA7890: Fetched services:",e),t(e)}}catch(zs){console.error("MBA7890: Error fetching services:",zs),"professional"===y&&x({message:"Failed to load services",type:"error",duration:3e3})}finally{s(!1)}};return(0,n.useEffect)((()=>{p&&y?((0,h.debugLog)("MBA7890","Fetching services for user:",{userRole:y,isSignedIn:p}),v()):(t([]),s(!1))}),[p,y]),(0,n.useEffect)((()=>{o&&(v(),a(!1))}),[o]),(0,b.useFocusEffect)((0,n.useCallback)((()=>{p&&y&&((0,h.debugLog)("MBA7890","Screen focused, fetching services for user:",{userRole:y,isSignedIn:p}),v())}),[p,y])),(0,n.useEffect)((()=>{(async()=>{const e="ServiceManager";let t;t=sessionStorage.getItem("previousRoute"),sessionStorage.setItem("previousRoute",t||""),sessionStorage.setItem("currentRoute",e),t||(t="Dashboard",sessionStorage.setItem("previousRoute",t||""),sessionStorage.setItem("currentRoute",e))})()}),[]),i?(0,j.jsx)(r.default,{style:[Di.container,Di.loadingContainer],children:(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.primary})}):(0,j.jsx)(r.default,{style:[Di.container,{marginLeft:c?0:g?70:250}],children:l?(0,j.jsxs)(vn.SafeAreaView,{style:Di.safeAreaContainer,children:[(0,j.jsx)(Ri,{title:"CrittrCove"}),(0,j.jsx)(X.default,{style:Di.scrollView,contentContainerStyle:[Di.scrollContent,{marginTop:20}],showsVerticalScrollIndicator:!1,children:(0,j.jsx)(It,{services:e||[],setServices:t,setHasUnsavedChanges:a,isProfessionalTab:!1,isMobile:l})})]}):(0,j.jsx)(r.default,{style:[Di.content,{marginTop:c?30:0}],showsVerticalScrollIndicator:!1,children:(0,j.jsx)(It,{services:e||[],setServices:t,setHasUnsavedChanges:a,isProfessionalTab:!1,isMobile:l})})})},Pi=i.default.create({container:{flex:1},searchBarContainer:{margin:20,marginTop:16},searchBar:{elevation:4,borderRadius:12,backgroundColor:m.theme.colors.surface,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,flexDirection:"row",alignItems:"center",padding:12},searchInput:{fontSize:16,color:m.theme.colors.text},scrollView:{flex:1},blogCard:{margin:20,marginTop:0,padding:20,borderRadius:16,elevation:4,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8},authorContainer:{flexDirection:"row"},authorImage:{width:48,height:48,borderRadius:24,marginRight:16},blogContent:{flex:1},title:{fontSize:18,fontWeight:"600",marginBottom:8,lineHeight:24,fontFamily:m.theme.fonts.header.fontFamily},authorInfo:{flexDirection:"row",alignItems:"center",marginBottom:12},authorName:{fontSize:14,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},dot:{marginHorizontal:6,fontFamily:m.theme.fonts.regular.fontFamily},readTime:{fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily},preview:{fontSize:14,lineHeight:20,marginBottom:16,fontFamily:m.theme.fonts.regular.fontFamily},tags:{flexDirection:"row",flexWrap:"wrap",marginBottom:16},tag:{paddingHorizontal:10,paddingVertical:4,borderRadius:12,marginRight:8,marginBottom:8},tagText:{fontSize:11,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},stats:{flexDirection:"row",justifyContent:"flex-start",marginTop:8},stat:{flexDirection:"row",alignItems:"center",marginRight:20},statText:{marginLeft:6,fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily},noResultsContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:40,marginTop:40},noResultsText:{fontSize:18,fontWeight:"500",marginTop:16,marginBottom:8,fontFamily:m.theme.fonts.regular.fontFamily},noResultsSubtext:{fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily},webSearchInput:{flex:1,padding:8,fontSize:16,border:"none",backgroundColor:"transparent",WebkitTapHighlightColor:"transparent",outlineWidth:0,outlineStyle:"none",boxShadow:"none",borderColor:"transparent",fontFamily:m.theme.fonts.regular.fontFamily}}),Fi=({navigation:e})=>{const t=(0,ne.useTheme)(),[o,i]=(0,n.useState)(""),[s,l]=(0,n.useState)(Le),d=(0,n.useCallback)((e=>{i(e);const t=e.toLowerCase(),o=Le.filter((e=>e.title.toLowerCase().includes(t)||e.author.name.toLowerCase().includes(t)||e.content.toLowerCase().includes(t)||e.tags.some((e=>e.toLowerCase().includes(t)))));l(o)}),[]);return(0,j.jsxs)(r.default,{style:[Pi.container,{backgroundColor:t.colors.background}],children:[(0,j.jsx)(Dt,{title:"Blog",onBackPress:()=>{e.navigate("Home")}}),(0,j.jsx)(r.default,{style:Pi.searchBarContainer,children:(0,j.jsxs)(r.default,{style:[Pi.searchBar,{backgroundColor:t.colors.surface}],children:[(0,j.jsx)(S.default,{name:"magnify",size:24,color:t.colors.primary}),(0,j.jsx)(te.default,{placeholder:"Search by title, author, content, or tags",placeholderTextColor:t.colors.textSecondary,onChangeText:d,value:o,style:[Pi.webSearchInput,{color:t.colors.text}]}),o?(0,j.jsx)(v.default,{onPress:()=>d(""),children:(0,j.jsx)(S.default,{name:"close-circle",size:24,color:t.colors.primary})}):null]})}),(0,j.jsx)(X.default,{style:Pi.scrollView,showsVerticalScrollIndicator:!1,children:s.length>0?s.map((o=>{const n=o.content.slice(0,200)+"...";return(0,j.jsx)(v.default,{style:[Pi.blogCard,{backgroundColor:t.colors.surface}],onPress:()=>(0,g.navigateToFrom)(e,"BlogPost","Blog",{postId:o.id}),children:(0,j.jsxs)(r.default,{style:Pi.authorContainer,children:[(0,j.jsx)(Q.default,{source:{uri:o.author.profilePicture},style:Pi.authorImage}),(0,j.jsxs)(r.default,{style:Pi.blogContent,children:[(0,j.jsx)(a.default,{style:[Pi.title,{color:t.colors.primary}],children:o.title}),(0,j.jsxs)(r.default,{style:Pi.authorInfo,children:[(0,j.jsx)(a.default,{style:[Pi.authorName,{color:t.colors.secondary}],children:o.author.name}),(0,j.jsx)(a.default,{style:[Pi.dot,{color:t.colors.textSecondary}],children:" \u2022 "}),(0,j.jsx)(a.default,{style:[Pi.readTime,{color:t.colors.textSecondary}],children:o.readTime})]}),(0,j.jsx)(a.default,{style:[Pi.preview,{color:t.colors.textSecondary}],numberOfLines:3,children:n}),(0,j.jsx)(r.default,{style:Pi.tags,children:o.tags.map(((e,o)=>(0,j.jsx)(r.default,{style:[Pi.tag,{backgroundColor:t.colors.primary+"15"}],children:(0,j.jsx)(a.default,{style:[Pi.tagText,{color:t.colors.primary}],children:e})},o)))})]})]})},o.id)})):(0,j.jsxs)(r.default,{style:Pi.noResultsContainer,children:[(0,j.jsx)(S.default,{name:"magnify-close",size:48,color:t.colors.secondary}),(0,j.jsx)(a.default,{style:[Pi.noResultsText,{color:t.colors.secondary}],children:"No blog posts found"}),(0,j.jsx)(a.default,{style:[Pi.noResultsSubtext,{color:t.colors.textSecondary}],children:"Try adjusting your search terms"})]})})]})},Ei=i.default.create({mainContainer:{flex:1},container:{flex:1},header:{padding:20,paddingBottom:16},authorContainer:{flexDirection:"row",marginBottom:16},authorImage:{width:56,height:56,borderRadius:28,marginRight:16},authorInfo:{flex:1},authorName:{fontSize:18,fontWeight:"600",marginBottom:6,fontFamily:m.theme.fonts.header.fontFamily},authorBio:{fontSize:14,lineHeight:20,marginBottom:8,fontFamily:m.theme.fonts.regular.fontFamily},postInfo:{flexDirection:"row",alignItems:"center"},date:{fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily},dot:{marginHorizontal:6,fontFamily:m.theme.fonts.regular.fontFamily},readTime:{fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily},tags:{flexDirection:"row",flexWrap:"wrap",paddingHorizontal:20,paddingBottom:16},tag:{paddingHorizontal:12,paddingVertical:6,borderRadius:16,marginRight:8,marginBottom:8},tagText:{fontSize:12,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},contentContainer:{paddingHorizontal:20,paddingBottom:20},content:{fontSize:16,lineHeight:26,marginBottom:16,fontFamily:m.theme.fonts.regular.fontFamily},subheading:{fontSize:20,fontWeight:"600",marginTop:24,marginBottom:12,fontFamily:m.theme.fonts.header.fontFamily},boldText:{fontSize:16,fontWeight:"600",lineHeight:26,marginBottom:16,fontFamily:m.theme.fonts.header.fontFamily},listItem:{flexDirection:"row",marginBottom:8,paddingLeft:8},bulletPoint:{fontSize:16,marginRight:12,marginTop:2,fontFamily:m.theme.fonts.regular.fontFamily},emptyLine:{height:16},stats:{flexDirection:"row",justifyContent:"space-around",padding:20,borderTopWidth:1,borderBottomWidth:1,marginHorizontal:20},stat:{flexDirection:"row",alignItems:"center"},statText:{marginLeft:8,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},references:{padding:20,paddingTop:16},referencesTitle:{fontSize:20,fontWeight:"bold",marginBottom:16,fontFamily:m.theme.fonts.header.fontFamily},reference:{marginBottom:12,padding:12,backgroundColor:"#f8f9fa",borderRadius:8},referenceText:{fontSize:14,lineHeight:20,fontFamily:m.theme.fonts.regular.fontFamily},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},errorText:{fontSize:18,fontWeight:"500",marginTop:16,marginBottom:24,fontFamily:m.theme.fonts.regular.fontFamily},errorButton:{paddingHorizontal:20,paddingVertical:10,borderRadius:8},errorButtonText:{fontSize:16,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily}}),Wi=({route:e,navigation:t})=>{const[o,i]=(0,n.useState)(null),s=(0,ne.useTheme)(),l=e=>e&&"object"===typeof e&&e.author&&"object"===typeof e.author&&e.author.name&&e.author.profilePicture&&e.author.bio&&e.title&&e.content&&Array.isArray(e.tags);if((0,n.useEffect)((()=>{(async()=>{try{let o,n=null;if(e?.params?.postId)n=e.params.postId;else{if(e?.params?.post&&l(e.params.post))return i(e.params.post),void sessionStorage.setItem("currentBlogPost",JSON.stringify(e.params.post));{const e=new URLSearchParams(window.location.search);n=e.get("post")||e.get("postId")}}if(n){const e=Le.find((e=>e.id===n));if(e&&l(e))return i(e),void sessionStorage.setItem("currentBlogPost",JSON.stringify(e))}if(o=sessionStorage.getItem("currentBlogPost"),o){const e=JSON.parse(o);if(l(e))return void i(e)}(0,g.navigateToFrom)(t,"Blog","BlogPost")}catch(zs){console.error("Error loading blog post:",zs),(0,g.navigateToFrom)(t,"Blog","BlogPost")}})()}),[e?.params]),!o||!l(o))return(0,j.jsxs)(r.default,{style:[Ei.mainContainer,{backgroundColor:s.colors.background}],children:[(0,j.jsx)(Dt,{title:"Blog Post",onBackPress:()=>(0,g.handleBack)(t)}),(0,j.jsxs)(r.default,{style:Ei.errorContainer,children:[(0,j.jsx)(S.default,{name:"alert-circle-outline",size:48,color:s.colors.error}),(0,j.jsx)(a.default,{style:[Ei.errorText,{color:s.colors.error}],children:"Blog post not found or invalid"}),(0,j.jsx)(v.default,{style:[Ei.errorButton,{backgroundColor:s.colors.primary}],onPress:()=>(0,g.navigateToFrom)(t,"Blog","BlogPost"),children:(0,j.jsx)(a.default,{style:[Ei.errorButtonText,{color:s.colors.surface}],children:"Go to Blog List"})})]})]});return(0,j.jsxs)(r.default,{style:[Ei.mainContainer,{backgroundColor:s.colors.background}],children:[(0,j.jsx)(Dt,{title:o.title,onBackPress:()=>(0,g.handleBack)(t)}),(0,j.jsxs)(X.default,{style:Ei.container,showsVerticalScrollIndicator:!1,children:[(0,j.jsx)(r.default,{style:Ei.header,children:(0,j.jsxs)(r.default,{style:Ei.authorContainer,children:[(0,j.jsx)(Q.default,{source:{uri:o.author.profilePicture},style:Ei.authorImage}),(0,j.jsxs)(r.default,{style:Ei.authorInfo,children:[(0,j.jsx)(a.default,{style:[Ei.authorName,{color:s.colors.secondary}],children:o.author.name}),(0,j.jsx)(a.default,{style:[Ei.authorBio,{color:s.colors.textSecondary}],children:o.author.bio}),(0,j.jsxs)(r.default,{style:Ei.postInfo,children:[(0,j.jsx)(a.default,{style:[Ei.date,{color:s.colors.textSecondary}],children:o.publishDate}),(0,j.jsx)(a.default,{style:[Ei.dot,{color:s.colors.textSecondary}],children:" \u2022 "}),(0,j.jsx)(a.default,{style:[Ei.readTime,{color:s.colors.textSecondary}],children:o.readTime})]})]})]})}),(0,j.jsx)(r.default,{style:Ei.tags,children:o.tags.map(((e,t)=>(0,j.jsx)(r.default,{style:[Ei.tag,{backgroundColor:s.colors.primary+"15"}],children:(0,j.jsx)(a.default,{style:[Ei.tagText,{color:s.colors.primary}],children:e})},t)))}),(0,j.jsx)(r.default,{style:Ei.contentContainer,children:(d=o.content,d.split("\n").map(((e,t)=>{if(e.startsWith("## "))return(0,j.jsx)(a.default,{style:[Ei.subheading,{color:s.colors.primary}],children:e.replace("## ","")},t);if(e.startsWith("- **")&&e.includes("**:")){const o=e.split("**:"),n=o[0].replace("- **",""),i=o[1]||"";return(0,j.jsxs)(r.default,{style:Ei.listItem,children:[(0,j.jsx)(a.default,{style:[Ei.bulletPoint,{color:s.colors.primary}],children:"\u2022"}),(0,j.jsxs)(a.default,{style:[Ei.content,{color:s.colors.text,flex:1}],children:[(0,j.jsx)(a.default,{style:[Ei.boldText,{color:s.colors.primary}],children:n}),i]})]},t)}return e.startsWith("- ")?(0,j.jsxs)(r.default,{style:Ei.listItem,children:[(0,j.jsx)(a.default,{style:[Ei.bulletPoint,{color:s.colors.primary}],children:"\u2022"}),(0,j.jsx)(a.default,{style:[Ei.content,{color:s.colors.text,flex:1}],children:e.replace("- ","")})]},t):e.startsWith("**")&&e.endsWith("**")?(0,j.jsx)(a.default,{style:[Ei.boldText,{color:s.colors.primary}],children:e.replace(/\*\*/g,"")},t):""===e.trim()?(0,j.jsx)(r.default,{style:Ei.emptyLine},t):(0,j.jsx)(a.default,{style:[Ei.content,{color:s.colors.text}],children:e},t)})))}),(0,j.jsxs)(r.default,{style:Ei.references,children:[(0,j.jsx)(a.default,{style:[Ei.referencesTitle,{color:s.colors.primary}],children:"References"}),o.references.map(((e,t)=>(0,j.jsx)(v.default,{style:Ei.reference,onPress:()=>(e=>{e.url?ee.default.openURL(e.url):e.doi&&ee.default.openURL("https://doi.org/".concat(e.doi))})(e),children:(0,j.jsxs)(a.default,{style:[Ei.referenceText,{color:s.colors.textSecondary}],children:[e.authors," (",e.year||"n.d.","). ",e.title,". ",e.publication,".",e.doi&&" DOI: ".concat(e.doi)]})},t)))]})]})]});var d};var Oi=o(67146),Ni=o(52622);const Hi=({children:e})=>(0,j.jsx)(r.default,{style:{width:"100%",maxWidth:550,marginLeft:"auto",marginRight:"auto",paddingHorizontal:15},children:e}),Ui=({visible:e,message:t,onClose:o})=>(0,j.jsx)(k.default,{visible:e,transparent:!0,animationType:"fade",onRequestClose:o,children:(0,j.jsx)(r.default,{style:qi.modalOverlay,children:(0,j.jsxs)(r.default,{style:qi.modalContent,children:[(0,j.jsx)(a.default,{style:qi.modalText,children:t}),(0,j.jsx)(v.default,{style:qi.modalButton,onPress:o,children:(0,j.jsx)(a.default,{style:qi.modalButtonText,children:"OK"})})]})})}),Vi=({selectedCity:e,onSelectCity:t})=>{const[o,i]=(0,n.useState)(!1),[s,l]=(0,n.useState)(""),d=[{id:"1",name:"Colorado Springs"},{id:"2",name:"Denver"},{id:"3",name:"Boulder"},{id:"4",name:"Fort Collins"},{id:"5",name:"Pueblo"},{id:"6",name:"Aurora"},{id:"7",name:"Littleton"},{id:"8",name:"Castle Rock"},{id:"9",name:"Parker"},{id:"10",name:"Centennial"},{id:"11",name:"Other"}].filter((e=>e.name.toLowerCase().includes(s.toLowerCase()))),c=d.some((e=>"Other"===e.name))?d:[...d,{id:"11",name:"Other"}];return(0,j.jsxs)(r.default,{style:qi.dropdownContainer,children:[(0,j.jsxs)(v.default,{style:[qi.dropdownButton,!e&&qi.requiredField],onPress:()=>i(!o),children:[(0,j.jsx)(a.default,{style:qi.dropdownButtonText,children:e||"Select your city"}),(0,j.jsx)(S.default,{name:o?"chevron-up":"chevron-down",size:24,color:m.theme.colors.primary})]}),o&&(0,j.jsxs)(r.default,{style:qi.dropdownList,children:[(0,j.jsx)(te.default,{style:qi.searchInput,placeholder:"Search cities...",value:s,onChangeText:l}),(0,j.jsx)(Yt.default,{data:c,renderItem:({item:e})=>(0,j.jsx)(v.default,{style:[qi.cityItem,"Other"===e.name&&qi.otherCityItem],onPress:()=>{t(e.name),i(!1)},children:(0,j.jsx)(a.default,{style:[qi.cityItemText,"Other"===e.name&&qi.otherCityText],children:e.name})}),keyExtractor:e=>e.id,style:qi.cityList})]})]})},qi=i.default.create({scrollView:{flex:1,width:"100%"},scrollViewContent:{flexGrow:1,alignItems:"center",justifyContent:"center",width:"100%"},container:{width:"100%",alignItems:"center",justifyContent:"center",paddingVertical:20},contentWrapper:{padding:20,backgroundColor:"white",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,width:"100%"},title:{fontSize:m.theme.fontSizes.largeLarge,fontWeight:"bold",marginBottom:10,color:m.theme.colors.primary,fontFamily:m.theme.fonts.header.fontFamily,textAlign:"center"},description:{fontSize:m.theme.fontSizes.medium,marginBottom:20,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center",lineHeight:24},formSection:{width:"100%"},nameContainer:{flexDirection:"row",gap:10,marginBottom:15},nameField:{flex:1},label:{fontSize:m.theme.fontSizes.medium,marginBottom:5,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},input:{backgroundColor:m.theme.colors.surface,borderRadius:5,borderColor:m.theme.colors.border,borderWidth:1,padding:15,marginBottom:15,fontSize:m.theme.fontSizes.medium,width:"100%",fontFamily:m.theme.fonts.regular.fontFamily},textArea:{height:100,textAlignVertical:"top"},checkboxGroup:{marginBottom:15},checkboxContainer:{flexDirection:"row",alignItems:"flex-start",marginBottom:10,paddingRight:10},checkboxIcon:{marginRight:10},checkboxLabel:{flex:1,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},radioGroup:{marginBottom:15},radioContainer:{flexDirection:"row",alignItems:"center",marginBottom:10},radio:{width:20,height:20,borderRadius:10,borderWidth:2,borderColor:m.theme.colors.primary,marginRight:10},radioSelected:{backgroundColor:m.theme.colors.primary},radioLabel:{fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},submitButton:{backgroundColor:m.theme.colors.primary,padding:15,borderRadius:5,alignItems:"center",width:"100%",marginTop:20},submitButtonText:{color:m.theme.colors.whiteText,fontSize:m.theme.fontSizes.mediumLarge,fontWeight:"bold",fontFamily:m.theme.fonts.regular.fontFamily},disabledButton:{opacity:.7},successMessage:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center",marginBottom:15,lineHeight:24},otherInputContainer:{paddingLeft:34,width:"100%"},otherInput:{marginTop:5,marginBottom:10,width:"90%"},addressSection:{marginBottom:20},cityStateContainer:{flexDirection:"row",justifyContent:"space-between",gap:10},cityInput:{flex:2,marginBottom:0},stateInput:{flex:1,marginBottom:0},zipInput:{flex:1,marginBottom:0},addressNote:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.text,marginBottom:10,paddingHorizontal:5},optional:{color:m.theme.colors.secondary,fontSize:m.theme.fontSizes.small,fontStyle:"italic"},referralSection:{backgroundColor:m.theme.colors.surface,padding:20,borderRadius:10,marginVertical:20,borderWidth:1,borderColor:m.theme.colors.border},buttonContainer:{flexDirection:"row",justifyContent:"flex-start",gap:10,marginBottom:20},button:{paddingVertical:8,paddingHorizontal:24,borderRadius:5,borderWidth:1,borderColor:m.theme.colors.primary,backgroundColor:"white",minWidth:80,alignItems:"center"},buttonSelected:{backgroundColor:m.theme.colors.primary},buttonText:{color:m.theme.colors.primary,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},buttonTextSelected:{color:"white"},requiredFieldNote:{fontSize:m.theme.fontSizes.small,color:m.theme.colors.text,marginBottom:20,fontStyle:"italic"},requiredAsterisk:{color:"#FF0000",fontSize:m.theme.fontSizes.medium},linkContainer:{flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:m.theme.colors.surface,padding:10,borderRadius:5,marginVertical:10},link:{color:m.theme.colors.primary,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily,marginRight:10},copyButton:{padding:5},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:20,width:"90%",maxWidth:400,alignItems:"center"},modalText:{fontSize:m.theme.fontSizes.medium,marginBottom:20,textAlign:"center",color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},modalButton:{backgroundColor:m.theme.colors.primary,paddingVertical:12,paddingHorizontal:24,borderRadius:8,minWidth:100,alignItems:"center"},modalButtonText:{color:m.theme.colors.surface,fontSize:m.theme.fontSizes.medium,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},inputError:{borderColor:"#FF0000",borderWidth:1},errorText:{color:"#FF0000",fontSize:m.theme.fontSizes.small,marginTop:-10,marginBottom:15,fontFamily:m.theme.fonts.regular.fontFamily},dropdownContainer:{marginBottom:15,zIndex:1e3},dropdownButton:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:m.theme.colors.surface,borderRadius:5,borderColor:m.theme.colors.border,borderWidth:1,padding:15},dropdownButtonText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},dropdownList:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:"white",borderRadius:5,borderColor:m.theme.colors.border,borderWidth:1,marginTop:5,maxHeight:300,zIndex:1e3},searchInput:{padding:10,borderBottomWidth:1,borderBottomColor:m.theme.colors.border,fontSize:m.theme.fontSizes.medium,fontFamily:m.theme.fonts.regular.fontFamily},cityList:{maxHeight:250},cityItem:{padding:15,borderBottomWidth:1,borderBottomColor:m.theme.colors.border},cityItemText:{fontSize:m.theme.fontSizes.medium,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},requiredField:{borderColor:"#FF0000",borderWidth:1},otherCityItem:{borderTopWidth:1,borderTopColor:m.theme.colors.border,backgroundColor:m.theme.colors.surface},otherCityText:{color:m.theme.colors.primary,fontWeight:"500"}}),Yi=()=>{const e=(0,b.useNavigation)(),{is_prototype:t,screenWidth:o}=(0,n.useContext)(h.AuthContext),[i,s]=(0,Ni.useForm)("mkgobpro"),[l,d]=(0,n.useState)(""),[c,u]=(0,n.useState)(""),[g,f]=(0,n.useState)(""),[p,y]=(0,n.useState)(""),[x,w]=(0,n.useState)(""),[C,T]=(0,n.useState)([]),[B,k]=(0,n.useState)(""),[A,_]=(0,n.useState)(""),[I,M]=(0,n.useState)(""),[L,R]=(0,n.useState)(!1),[D,z]=(0,n.useState)(!1),[P,F]=(0,n.useState)(!1),[E,W]=(0,n.useState)(""),[O,N]=(0,n.useState)(!1),[H,U]=(0,n.useState)(""),[V,q]=(0,n.useState)(""),[Y,G]=(0,n.useState)(""),[J,$]=(0,n.useState)(""),[K,Z]=(0,n.useState)(""),[Q,ee]=(0,n.useState)(""),[oe,ne]=(0,n.useState)(""),[re,ae]=(0,n.useState)({visible:!1,message:""}),[ie,se]=(0,n.useState)(""),[le,de]=(0,n.useState)(""),[ce,ue]=(0,n.useState)(""),[ge,me]=(0,n.useState)(""),[he,fe]=(0,n.useState)(""),pe="100%",ye=()=>{e.navigate("SignUp")},be=async()=>{try{await Oi.default.setString("https://crittrcove.com/waitlist"),alert("Link copied to clipboard!")}catch(zs){console.error("Failed to copy link:",zs)}};return i.succeeded?(0,j.jsxs)(Ft,{fullWidthHeader:!0,contentWidth:pe,children:[(0,j.jsx)(Dt,{title:"Join Waitlist",onBackPress:ye}),(0,j.jsx)(X.default,{style:qi.scrollView,contentContainerStyle:qi.scrollViewContent,children:(0,j.jsx)(Hi,{children:(0,j.jsx)(r.default,{style:qi.container,children:(0,j.jsxs)(r.default,{style:qi.contentWrapper,children:[(0,j.jsx)(a.default,{style:[qi.title,{color:m.theme.colors.primary}],children:"Thank you for joining the CrittrCove waitlist!"}),(0,j.jsx)(a.default,{style:qi.successMessage,children:"As a waitlist member, you'll enjoy exclusive early access to the app, priority placement, special gifts, and a unique profile badge to highlight your role as a founding member of CrittrCove."}),(0,j.jsxs)(r.default,{style:qi.referralSection,children:[(0,j.jsx)(a.default,{style:[qi.title,{fontSize:m.theme.fontSizes.large,marginTop:20}],children:"Want Another Custom Pet Sticker? \ud83c\udf81"}),(0,j.jsx)(a.default,{style:qi.successMessage,children:"Share CrittrCove with your pet-loving friends! When they join the waitlist using this link:"}),(0,j.jsxs)(r.default,{style:qi.linkContainer,children:[(0,j.jsx)(a.default,{style:qi.link,children:"https://crittrcove.com/waitlist"}),(0,j.jsx)(v.default,{onPress:be,style:qi.copyButton,children:(0,j.jsx)(S.default,{name:"content-copy",size:20,color:m.theme.colors.primary})})]}),(0,j.jsx)(a.default,{style:qi.successMessage,children:"and mention your name, we'll send you another custom sticker featuring your pet. It's our way of saying thank you for helping grow our community!"}),(0,j.jsx)(a.default,{style:[qi.successMessage,{fontStyle:"italic"}],children:"Simply tell your friends to mention your name when they sign up, and we'll take care of the rest."})]}),(0,j.jsx)(a.default,{style:qi.successMessage,children:"Stay tuned for exciting updates!"})]})})})})]}):(0,j.jsxs)(Ft,{fullWidthHeader:!0,contentWidth:pe,children:[(0,j.jsx)(Dt,{title:"Join Waitlist",onBackPress:ye}),(0,j.jsx)(X.default,{style:qi.scrollView,contentContainerStyle:qi.scrollViewContent,children:(0,j.jsx)(Hi,{children:(0,j.jsx)(r.default,{style:qi.container,children:(0,j.jsxs)(r.default,{style:qi.contentWrapper,children:[(0,j.jsx)(a.default,{style:qi.title,children:"Join the CrittrCove Waitlist!"}),(0,j.jsx)(a.default,{style:qi.description,children:"Welcome to Critter Cove's early sign-up, the ultimate pet care marketplace for all pets\u2014whether furry, feathery, or scaly! Our app connects local pet care specialists with pet owners, offering reliable and loving care for your beloved companions."}),(0,j.jsx)(a.default,{style:qi.description,children:"By joining our waitlist, you'll gain early access to exclusive features, special gifts, education, discounts, a custom sticker featuring your pet (if you so wish), and a profile badge as a founding member of the Critter Cove community."}),(0,j.jsxs)(a.default,{style:qi.requiredFieldNote,children:[(0,j.jsx)(a.default,{style:qi.requiredAsterisk,children:"*"})," indicates required field"]}),(0,j.jsxs)(r.default,{style:qi.formSection,children:[(0,j.jsxs)(r.default,{style:qi.nameContainer,children:[(0,j.jsxs)(r.default,{style:qi.nameField,children:[(0,j.jsxs)(a.default,{style:qi.label,children:["First Name ",(0,j.jsx)(a.default,{style:qi.requiredAsterisk,children:"*"})]}),(0,j.jsx)(te.default,{style:qi.input,value:l,onChangeText:d,placeholder:"First Name"})]}),(0,j.jsxs)(r.default,{style:qi.nameField,children:[(0,j.jsxs)(a.default,{style:qi.label,children:["Last Name ",(0,j.jsx)(a.default,{style:qi.requiredAsterisk,children:"*"})]}),(0,j.jsx)(te.default,{style:qi.input,value:c,onChangeText:u,placeholder:"Last Name"})]})]}),(0,j.jsxs)(a.default,{style:qi.label,children:["Email ",(0,j.jsx)(a.default,{style:qi.requiredAsterisk,children:"*"})]}),(0,j.jsx)(te.default,{style:[qi.input,ie?qi.inputError:null],value:g,onChangeText:e=>{f(e),se("")},placeholder:"Email",keyboardType:"email-address",autoCapitalize:"none"}),ie?(0,j.jsx)(a.default,{style:qi.errorText,children:ie}):null,(0,j.jsxs)(a.default,{style:qi.label,children:["Phone Number ",(0,j.jsx)(a.default,{style:qi.requiredAsterisk,children:"*"})]}),(0,j.jsx)(te.default,{style:[qi.input,le?qi.inputError:null],value:p,onChangeText:e=>{const t=(e=>{const t=e.replace(/\D/g,""),o=t.match(/^(\d{0,3})(\d{0,3})(\d{0,4})$/);if(o){const[,e,t,n]=o;let r="";return e&&(r+="(".concat(e)),t&&(r+=") ".concat(t)),n&&(r+="-".concat(n)),r}return t})(e);y(t),de("")},placeholder:"(XXX) XXX-XXXX",keyboardType:"numeric",maxLength:14}),le?(0,j.jsx)(a.default,{style:qi.errorText,children:le}):null,(0,j.jsxs)(a.default,{style:qi.label,children:["Do you currently own pets? If yes, tell us all about them! ",(0,j.jsx)(a.default,{style:qi.requiredAsterisk,children:"*"})]}),(0,j.jsx)(te.default,{style:[qi.input,qi.textArea],value:x,onChangeText:w,placeholder:"Tell us about your pets",multiline:!0,numberOfLines:4}),(0,j.jsxs)(a.default,{style:qi.label,children:["What kind of pet care services are you most interested in? ",(0,j.jsx)(a.default,{style:qi.requiredAsterisk,children:"*"})]}),(0,j.jsx)(r.default,{style:qi.checkboxGroup,children:["Pet Sitting","Grooming","Training","Veterinary Services","Farm/Homestead Care","Care Consulting","Other"].map((e=>(0,j.jsxs)(r.default,{children:[(0,j.jsxs)(v.default,{style:qi.checkboxContainer,onPress:()=>(e=>{T((t=>("Other"===e&&N(!t.includes("Other")),t.includes(e)?t.filter((t=>t!==e)):[...t,e])))})(e),children:[(0,j.jsx)(S.default,{name:C.includes(e)?"checkbox-marked":"checkbox-blank-outline",size:24,color:m.theme.colors.primary,style:qi.checkboxIcon}),(0,j.jsx)(a.default,{style:qi.checkboxLabel,children:e})]}),"Other"===e&&C.includes("Other")&&(0,j.jsxs)(r.default,{style:qi.otherInputContainer,children:[(0,j.jsxs)(a.default,{style:qi.label,children:["Please specify other service ",(0,j.jsx)(a.default,{style:qi.requiredAsterisk,children:"*"})]}),(0,j.jsx)(te.default,{style:[qi.input,qi.otherInput],value:E,onChangeText:W,placeholder:"Enter other service"})]})]},e)))}),(0,j.jsxs)(a.default,{style:qi.label,children:["Are you signing up as a: ",(0,j.jsx)(a.default,{style:qi.requiredAsterisk,children:"*"})]}),(0,j.jsx)(r.default,{style:qi.radioGroup,children:["Pet owner in need of services","Care specialist (sitter, groomer, ferrier, fish tank cleaner, etc)","Both"].map((e=>(0,j.jsxs)(v.default,{style:qi.radioContainer,onPress:()=>k(e),children:[(0,j.jsx)(r.default,{style:[qi.radio,B===e&&qi.radioSelected]}),(0,j.jsx)(a.default,{style:qi.radioLabel,children:e})]},e)))}),(0,j.jsxs)(a.default,{style:qi.label,children:["Where did you hear about us? ",(0,j.jsx)(a.default,{style:qi.requiredAsterisk,children:"*"})]}),(0,j.jsx)(r.default,{style:qi.radioGroup,children:["Nextdoor","Reddit","Google","Other - Enter name of Person who referred you or other referral source for a free sticker"].map((e=>(0,j.jsxs)(v.default,{style:qi.radioContainer,onPress:()=>ee(e),children:[(0,j.jsx)(r.default,{style:[qi.radio,Q===e&&qi.radioSelected]}),(0,j.jsx)(a.default,{style:qi.radioLabel,children:e})]},e)))}),"Other - Enter name of Person who referred you or other referral source for a free sticker"===Q&&(0,j.jsxs)(r.default,{children:[(0,j.jsxs)(a.default,{style:qi.label,children:["Please specify where you heard about us ",(0,j.jsx)(a.default,{style:qi.requiredAsterisk,children:"*"})]}),(0,j.jsx)(te.default,{style:qi.input,value:oe,onChangeText:ne,placeholder:"Enter referral source"})]}),(0,j.jsxs)(a.default,{style:qi.label,children:["Which city are you located in? ",(0,j.jsx)(a.default,{style:qi.requiredAsterisk,children:"*"})]}),(0,j.jsx)(Vi,{selectedCity:ce,onSelectCity:e=>{ue(e),fe("")}}),"Other"===ce&&(0,j.jsxs)(r.default,{style:qi.otherInputContainer,children:[(0,j.jsxs)(a.default,{style:qi.label,children:["Please specify your city ",(0,j.jsx)(a.default,{style:qi.requiredAsterisk,children:"*"})]}),(0,j.jsx)(te.default,{style:[qi.input,he&&qi.inputError],value:ge,onChangeText:e=>{me(e),fe("")},placeholder:"Enter your city"})]}),he?(0,j.jsx)(a.default,{style:qi.errorText,children:he}):null,(0,j.jsxs)(a.default,{style:qi.label,children:["What hesitations do you have about using an app to connect you to local pet care? ",(0,j.jsx)(a.default,{style:qi.optional,children:"(Optional)"})]}),(0,j.jsx)(te.default,{style:[qi.input,qi.textArea],value:A,onChangeText:_,placeholder:"Share your concerns",multiline:!0,numberOfLines:4}),(0,j.jsxs)(a.default,{style:qi.label,children:["What features or tools would make Critter Cove perfect for you? ",(0,j.jsx)(a.default,{style:qi.optional,children:"(Optional)"})]}),(0,j.jsx)(te.default,{style:[qi.input,qi.textArea],value:I,onChangeText:M,placeholder:"Share your ideas",multiline:!0,numberOfLines:4}),(0,j.jsxs)(r.default,{style:qi.addressSection,children:[(0,j.jsxs)(a.default,{style:qi.label,children:["Mailing Address ",(0,j.jsx)(a.default,{style:qi.optional,children:"(Optional)"})]}),(0,j.jsxs)(a.default,{style:qi.addressNote,children:["\ud83c\udf81 ",(0,j.jsx)(a.default,{style:{fontStyle:"italic"},children:" Want a custom sticker featuring your pet? Add your mailing address and we'll send you one for joining the waitlist!"})]}),(0,j.jsx)(te.default,{style:qi.input,value:H,onChangeText:U,placeholder:"Street Address"}),(0,j.jsx)(te.default,{style:qi.input,value:V,onChangeText:q,placeholder:"Apartment/Unit # (if applicable)"}),(0,j.jsxs)(r.default,{style:qi.cityStateContainer,children:[(0,j.jsx)(te.default,{style:[qi.input,qi.cityInput],value:Y,onChangeText:G,placeholder:"City"}),(0,j.jsx)(te.default,{style:[qi.input,qi.stateInput],value:J,onChangeText:$,placeholder:"State",maxLength:2,autoCapitalize:"characters"}),(0,j.jsx)(te.default,{style:[qi.input,qi.zipInput],value:K,onChangeText:Z,placeholder:"ZIP",keyboardType:"numeric",maxLength:5})]})]}),(0,j.jsxs)(a.default,{style:qi.label,children:["Would you like to be added to the email newsletter for updates on the app, pet care tips, discounts and more? ",(0,j.jsx)(a.default,{style:qi.optional,children:"(Optional)"})]}),(0,j.jsxs)(r.default,{style:qi.buttonContainer,children:[(0,j.jsx)(v.default,{style:[qi.button,L&&qi.buttonSelected],onPress:()=>R(!0),children:(0,j.jsx)(a.default,{style:[qi.buttonText,L&&qi.buttonTextSelected],children:"Yes"})}),(0,j.jsx)(v.default,{style:[qi.button,!L&&qi.buttonSelected],onPress:()=>R(!1),children:(0,j.jsx)(a.default,{style:[qi.buttonText,!L&&qi.buttonTextSelected],children:"No"})})]}),(0,j.jsxs)(a.default,{style:qi.label,children:["I agree to the terms and conditions and understand my data will be used to improve the app experience. ",(0,j.jsx)(a.default,{style:qi.requiredAsterisk,children:"*"})]}),(0,j.jsxs)(r.default,{style:qi.buttonContainer,children:[(0,j.jsx)(v.default,{style:[qi.button,D&&qi.buttonSelected],onPress:()=>z(!0),children:(0,j.jsx)(a.default,{style:[qi.buttonText,D&&qi.buttonTextSelected],children:"Yes"})}),(0,j.jsx)(v.default,{style:[qi.button,!D&&qi.buttonSelected],onPress:()=>z(!1),children:(0,j.jsx)(a.default,{style:[qi.buttonText,!D&&qi.buttonTextSelected],children:"No"})})]}),(0,j.jsx)(v.default,{style:[qi.submitButton,(P||!D)&&qi.disabledButton],onPress:async e=>{if(e.preventDefault(),se(""),de(""),fe(""),!(e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))(g))return se("Please enter a valid email address"),void ae({visible:!0,message:"Please enter a valid email address"});if(!p)return de("Please enter a valid phone number"),void ae({visible:!0,message:"Please enter a valid phone number"});if(!ce)return fe("Please select your city"),void ae({visible:!0,message:"Please select your city"});if("Other"===ce&&!ge.trim())return fe("Please specify your city"),void ae({visible:!0,message:"Please specify your city"});if(g&&l&&c&&p&&x&&0!==C.length&&B&&D&&Q)if(!C.includes("Other")||E.trim())if("Other - Enter name of Person who referred you or other referral source for a free sticker"!==Q||oe.trim()){F(!0);try{const e={firstName:l,lastName:c,email:g,phone:p,petInfo:x,services:C.includes("Other")?[...C.filter((e=>"Other"!==e)),"Other - ".concat(E.trim())].join(", "):C.join(", "),userType:B,hesitations:A,desiredFeatures:I,newsletter:L?"Yes":"No",agreeToTerms:D?"Yes":"No",referralSource:"Other - Enter name of Person who referred you or other referral source for a free sticker"===Q?"Other - ".concat(oe.trim()):Q,streetAddress:H||"",aptUnit:V||"",city:"Other"===ce?"Other - ".concat(ge.trim()):ce,stateRegion:J||"",zipCode:K||""};console.log("MBA9876: Submitting form data:",e);const t=await s(e);console.log("MBA9876: Formspree response:",t),i.succeeded&&(d(""),u(""),f(""),y(""),w(""),T([]),W(""),N(!1),k(""),_(""),M(""),R(!1),z(!1),U(""),q(""),G(""),$(""),Z(""),ee(""),ne(""))}catch(zs){console.error("MBA9876: Error submitting form:",zs),console.error("MBA9876: Error response:",zs.response?.data),ae({visible:!0,message:zs.response?.data?.error||"An error occurred while submitting the form. Please try again."})}finally{F(!1)}}else ae({visible:!0,message:"Please specify where you heard about us"});else ae({visible:!0,message:"Please specify the other service you are interested in"});else ae({visible:!0,message:"Please fill in all required fields"})},disabled:P||!D,children:(0,j.jsx)(a.default,{style:qi.submitButtonText,children:P?"Submitting...":"Join Waitlist"})})]})]})})})}),(0,j.jsx)(Ui,{visible:re.visible,message:re.message,onClose:()=>ae({visible:!1,message:""})})]})};var Gi=o(58180);const Ji=i.default.create({container:{flex:1,justifyContent:"center",alignItems:"center",padding:20,backgroundColor:m.theme.colors.background},title:{fontSize:24,fontWeight:"bold",marginBottom:30,color:m.theme.colors.text,fontFamily:m.theme.fonts?.medium?.fontFamily||void 0},buttonContainer:{width:"100%",marginVertical:10,maxWidth:300}}),$i=()=>{const e=E();return(0,j.jsxs)(r.default,{style:Ji.container,children:[(0,j.jsx)(a.default,{style:Ji.title,children:"Toast Notification Test"}),(0,j.jsx)(r.default,{style:Ji.buttonContainer,children:(0,j.jsx)(Gi.default,{title:"Show Success Toast",onPress:()=>{e({message:"Success! Operation completed successfully.",type:"success",duration:3e3})},color:m.theme.colors.primary})}),(0,j.jsx)(r.default,{style:Ji.buttonContainer,children:(0,j.jsx)(Gi.default,{title:"Show Error Toast",onPress:()=>{e({message:"Error! Something went wrong.",type:"error",duration:3e3})},color:m.theme.colors.error})}),(0,j.jsx)(r.default,{style:Ji.buttonContainer,children:(0,j.jsx)(Gi.default,{title:"Show Info Toast",onPress:()=>{e({message:"Info: This is an informational message.",type:"info",duration:3e3})},color:m.theme.colors.info||"#29B6F6"})}),(0,j.jsx)(r.default,{style:Ji.buttonContainer,children:(0,j.jsx)(Gi.default,{title:"Show Warning Toast",onPress:()=>{e({message:"Warning: This action may have consequences.",type:"warning",duration:3e3})},color:m.theme.colors.warning||"#FFA726"})}),(0,j.jsx)(r.default,{style:Ji.buttonContainer,children:(0,j.jsx)(Gi.default,{title:"Show Long Toast",onPress:()=>{e({message:"This is a longer toast message that will stay visible for 5 seconds to demonstrate how longer messages look.",type:"info",duration:5e3})},color:"#9C27B0"})}),(0,j.jsxs)(r.default,{style:{marginTop:20,padding:10,borderWidth:1,borderColor:"#ccc",borderRadius:8},children:[(0,j.jsx)(a.default,{style:{fontSize:18,fontWeight:"bold",marginBottom:10},children:"Invitation API Debug"}),(0,j.jsx)(v.default,{style:{backgroundColor:"#3498db",padding:10,borderRadius:5,alignItems:"center",marginBottom:10},onPress:async()=>{try{const o="29a05c7f-bde2-4e57-8a86-8f6e8062812a";(0,h.debugLog)("MBAnb23ou4bf954 TEST: Verifying invitation token:",o);const n=await(0,bt.verifyInvitation)(o);if((0,h.debugLog)("MBAnb23ou4bf954 TEST: Verification result:",n),n.valid){(0,h.debugLog)("MBAnb23ou4bf954 TEST: Trying to accept invitation with authenticated request");try{const t=await(0,bt.acceptInvitation)(o);(0,h.debugLog)("MBAnb23ou4bf954 TEST: Accept result:",t),e({message:"Invitation accepted successfully!",type:"success",duration:3e3})}catch(t){(0,h.debugLog)("MBAnb23ou4bf954 TEST: Accept error:",t.message),t.response&&(0,h.debugLog)("MBAnb23ou4bf954 TEST: Accept error details:",t.response.data),e({message:"Error: ".concat(t.message),type:"error",duration:3e3})}}else(0,h.debugLog)("MBAnb23ou4bf954 TEST: Invitation is not valid:",n.error),e({message:"Invalid invitation: ".concat(n.error||"Unknown error"),type:"error",duration:3e3})}catch(zs){(0,h.debugLog)("MBAnb23ou4bf954 TEST: Overall error:",zs.message),e({message:"Error: ".concat(zs.message),type:"error",duration:3e3})}},children:(0,j.jsx)(a.default,{style:{color:"white"},children:"Test Invitation API"})})]})]})},Ki=i.default.create({card:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,padding:16,elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,width:"100%"},contentContainer:{width:"100%"},topRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",width:"100%",flexWrap:"wrap"},profileInfo:{flexDirection:"row",alignItems:"center",flex:1,minWidth:0},profileInfoWrap:{flexDirection:"row",alignItems:"center",flex:1,minWidth:"70%"},avatar:{width:60,height:60,borderRadius:30,marginRight:16,flexShrink:0},nameContainer:{flex:1,justifyContent:"center",minWidth:0,marginRight:16},nameContainerWide:{maxWidth:"60%"},name:{fontSize:18,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily,marginBottom:8},petsContainer:{flexDirection:"row",flexWrap:"wrap",alignItems:"center",marginBottom:8},petsLabel:{fontSize:14,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,flexShrink:0},petsText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,flex:1,minWidth:0},petsTextWide:{maxWidth:"80%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},servicesContainer:{flexDirection:"row",flexWrap:"wrap",alignItems:"center",marginBottom:8},servicesLabel:{fontSize:14,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,flexShrink:0},servicesText:{fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,flex:1,minWidth:0},servicesTextWide:{maxWidth:"80%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},statusSection:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8,marginTop:8},lastBookingContainer:{flexDirection:"row",alignItems:"center"},lastBookingText:{marginLeft:6,fontSize:14,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},noBookingsContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#F2F2F0",borderRadius:4,padding:4,marginTop:8,alignSelf:"flex-start"},noBookingsText:{fontSize:12,color:"#898974",fontFamily:m.theme.fonts.regular.fontFamily,marginLeft:6},pastBookingsContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#F9F2FC",borderRadius:4,padding:4,marginTop:8,alignSelf:"flex-start"},pastBookingsText:{marginLeft:6,fontSize:12,color:"#9C27B0",fontFamily:m.theme.fonts.regular.fontFamily},upcomingContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#F0F9E5",padding:6,borderRadius:16},upcomingText:{marginLeft:6,fontSize:14,color:m.theme.colors.primary,fontFamily:m.theme.fonts.regular.fontFamily,fontWeight:"500"},buttonSection:{flexDirection:"row",gap:12,alignItems:"center",justifyContent:"flex-end",flexShrink:0},buttonSectionWrap:{marginTop:12,marginLeft:"auto"},mobileBtnSection:{flexDirection:"row",justifyContent:"flex-end",gap:12,marginTop:12},viewProfileButton:{paddingVertical:8,paddingHorizontal:16,backgroundColor:"#F0F9E5",borderRadius:6,alignItems:"center",justifyContent:"center",transition:"transform 0.2s ease, box-shadow 0.2s ease"},viewProfileText:{color:m.theme.colors.primary,fontSize:14,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},createBookingButton:{paddingVertical:8,paddingHorizontal:16,backgroundColor:m.theme.colors.primary,borderRadius:6,alignItems:"center",justifyContent:"center",transition:"transform 0.2s ease, box-shadow 0.2s ease"},createBookingText:{color:m.theme.colors.surfaceContrast,fontSize:14,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},buttonHovered:{transform:[{translateY:-3}],boxShadow:"0px 6px 10px rgba(0, 0, 0, 0.15)"},activeBookingsContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#F0F9E5",borderRadius:4,padding:4,marginTop:8,alignSelf:"flex-start"},activeBookingsText:{marginLeft:6,fontSize:12,color:"#4CAF50",fontFamily:m.theme.fonts.regular.fontFamily}}),Zi=({connection:e,type:t,onViewProfile:i,onCreateBooking:s})=>{const l="clients"===t,{screenWidth:d}=(0,n.useContext)(h.AuthContext),c=d<900,u=d>=1200,g=d>=2500,[f,p]=(0,n.useState)(!1),[y,b]=(0,n.useState)(!1),x=kt(),w=e.active_bookings_count>0?{icon:"calendar-check",iconColor:"#4CAF50",text:"Active Bookings",containerStyle:Ki.activeBookingsContainer,textStyle:Ki.activeBookingsText}:1===e.has_past_booking?{icon:"history",iconColor:"#9C27B0",text:"Past Bookings",containerStyle:Ki.pastBookingsContainer,textStyle:Ki.pastBookingsText}:{icon:"calendar-remove",iconColor:"#898974",text:"No Bookings Yet",containerStyle:Ki.noBookingsContainer,textStyle:Ki.noBookingsText};return(0,h.debugLog)("MBA9452: Rendering ConnectionCard:",{connectionId:e.id,connectionName:e.name,connectionType:t,conversationId:e.conversation_id,hasActivePastBooking:e.has_past_booking,activeBookingsCount:e.active_bookings_count,isMobile:c,isWideScreen:u,isExtraWideScreen:g,screenWidth:d}),(0,j.jsx)(r.default,{style:Ki.card,children:(0,j.jsxs)(r.default,{style:Ki.contentContainer,children:[(0,j.jsxs)(r.default,{style:Ki.topRow,children:[(0,j.jsxs)(r.default,{style:[Ki.profileInfo,!g&&Ki.profileInfoWrap],children:[(0,j.jsx)(Q.default,{source:e.avatar?{uri:e.avatar}:o(4456),style:Ki.avatar}),(0,j.jsxs)(r.default,{style:[Ki.nameContainer,u&&Ki.nameContainerWide],children:[(0,j.jsx)(a.default,{style:Ki.name,children:e.name}),l?(0,j.jsxs)(r.default,{style:Ki.petsContainer,children:[(0,j.jsx)(a.default,{style:Ki.petsLabel,children:"Pets: "}),(0,j.jsx)(a.default,{style:[Ki.petsText,u&&Ki.petsTextWide],children:e.pets?.length>0?e.pets.map((e=>"".concat(e.name," (").concat(e.species,")"))).join(", "):"No pets added yet"})]}):(0,j.jsxs)(r.default,{style:Ki.servicesContainer,children:[(0,j.jsx)(a.default,{style:Ki.servicesLabel,children:"Services: "}),(0,j.jsx)(a.default,{style:[Ki.servicesText,u&&Ki.servicesTextWide],children:e.services?.join(", ")||"No services"})]}),(0,j.jsxs)(r.default,{style:w.containerStyle,children:[(0,j.jsx)(S.default,{name:w.icon,size:14,color:w.iconColor}),(0,j.jsx)(a.default,{style:w.textStyle,children:w.text})]})]})]}),!c&&(0,j.jsxs)(r.default,{style:[Ki.buttonSection,!g&&Ki.buttonSectionWrap],children:[(0,j.jsx)(v.default,{style:[Ki.viewProfileButton,f&&Ki.buttonHovered],onPress:()=>{(0,h.debugLog)("MBA4321 View Messages button clicked",{connectionName:e.name,conversationId:e.conversation_id}),i(e)},onMouseEnter:()=>x&&p(!0),onMouseLeave:()=>x&&p(!1),children:(0,j.jsx)(a.default,{style:Ki.viewProfileText,children:"View Messages"})}),l&&(0,j.jsx)(v.default,{style:[Ki.createBookingButton,y&&Ki.buttonHovered],onPress:()=>{(0,h.debugLog)("MBA4321 Create Booking button clicked",{connectionName:e.name,conversationId:e.conversation_id}),s(e)},onMouseEnter:()=>x&&b(!0),onMouseLeave:()=>x&&b(!1),children:(0,j.jsx)(a.default,{style:Ki.createBookingText,children:"Create Booking"})})]})]}),e.last_booking&&(0,j.jsxs)(r.default,{style:Ki.statusSection,children:[(0,j.jsxs)(r.default,{style:Ki.lastBookingContainer,children:[(0,j.jsx)(S.default,{name:"calendar-clock",size:16,color:m.theme.colors.text}),(0,j.jsxs)(a.default,{style:Ki.lastBookingText,children:["Last booking: ",e.last_booking]})]}),e.upcoming_booking&&(0,j.jsxs)(r.default,{style:Ki.upcomingContainer,children:[(0,j.jsx)(S.default,{name:"calendar-check",size:16,color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:Ki.upcomingText,children:"Upcoming Booking"})]})]}),c&&(0,j.jsxs)(X.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:Ki.mobileBtnSection,children:[(0,j.jsx)(v.default,{style:[Ki.viewProfileButton,f&&Ki.buttonHovered],onPress:()=>{(0,h.debugLog)("MBA4321 View Messages button clicked (mobile)",{connectionName:e.name,conversationId:e.conversation_id}),i(e)},onMouseEnter:()=>x&&p(!0),onMouseLeave:()=>x&&p(!1),children:(0,j.jsx)(a.default,{style:Ki.viewProfileText,children:"View Messages"})}),l&&(0,j.jsx)(v.default,{style:[Ki.createBookingButton,y&&Ki.buttonHovered],onPress:()=>{(0,h.debugLog)("MBA4321 Create Booking button clicked (mobile)",{connectionName:e.name,conversationId:e.conversation_id}),s(e)},onMouseEnter:()=>x&&b(!0),onMouseLeave:()=>x&&b(!1),children:(0,j.jsx)(a.default,{style:Ki.createBookingText,children:"Create Booking In Messages"})})]})]})})},Xi=i.default.create({container:{flex:1,height:"100vh",backgroundColor:m.theme.colors.surface,position:"fixed",top:0,right:0,bottom:0,left:0,overflow:"hidden",transition:"margin-left 0.3s ease"},content:{flex:1,height:"100%",overflow:"auto"},mainContent:{flex:1,width:"100%",alignSelf:"center",backgroundColor:m.theme.colors.background,position:"relative"},headerSection:{width:"100%",backgroundColor:m.theme.colors.surfaceContrast,paddingHorizontal:24,paddingTop:24,zIndex:2},connectionsContent:{flex:1,backgroundColor:m.theme.colors.surface,position:"relative"},title:{fontSize:32,fontWeight:"600",color:m.theme.colors.text,marginBottom:24,fontFamily:m.theme.fonts.header.fontFamily},tabContainer:{flexDirection:"row",gap:32},tab:{paddingBottom:8,borderBottomWidth:2,borderBottomColor:"transparent"},activeTab:{borderBottomColor:m.theme.colors.primary},tabText:{fontSize:16,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily},activeTabText:{color:m.theme.colors.primary,fontWeight:"500"},stickyHeader:{position:"absolute",top:0,left:0,right:0,backgroundColor:m.theme.colors.surfaceContrast,zIndex:2,marginHorizontal:24,marginTop:24,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,borderRadius:8,padding:16},stickyHeaderContent:{width:"100%",gap:16},searchAndInviteContainer:{flexDirection:"row",alignItems:"center",gap:12},searchContainer:{flex:1,flexDirection:"row",alignItems:"center",backgroundColor:m.theme.colors.surfaceContrast,borderRadius:8,padding:12,borderWidth:1,borderColor:"#CCCBC9",minHeight:48},searchContainerFocused:{borderColor:m.theme.colors.primary,borderWidth:2,shadowColor:m.theme.colors.primary,shadowOffset:{width:0,height:0},shadowOpacity:.1,shadowRadius:4},searchInput:Object.assign({flex:1,color:"#666",fontSize:16,marginLeft:8,fontFamily:m.theme.fonts.regular.fontFamily,outlineStyle:"none",outlineWidth:0,WebkitAppearance:"none",padding:0,minHeight:24},{caretColor:m.theme.colors.primary}),inviteButtonSmall:Object.assign({flexDirection:"row",alignItems:"center",paddingVertical:10,paddingHorizontal:12,borderRadius:8,backgroundColor:m.theme.colors.primary,gap:6},{transition:"all 0.2s ease",cursor:"pointer"}),inviteButtonSmallText:{color:m.theme.colors.surface,fontSize:14,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},filtersWrapper:{flexDirection:"row",justifyContent:"flex-end",marginRight:-16},filterScrollContent:{flexGrow:0},filterContainer:{flexDirection:"row",gap:8,backgroundColor:m.theme.colors.surfaceContrast,paddingVertical:8,paddingLeft:4,paddingRight:16},filterButton:Object.assign({paddingHorizontal:12,paddingVertical:6,borderRadius:16,justifyContent:"center"},{transition:"all 0.2s ease-in-out",cursor:"pointer"}),filterButtonHovered:{transform:[{scale:1.05}],shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:5},filterContent:{flexDirection:"row",alignItems:"center",justifyContent:"center",gap:6},checkmark:{marginLeft:4},allButton:{backgroundColor:"#EFF9FF"},allButtonText:{color:"#0784C6"},activeBookingsButton:{backgroundColor:"#E8F5E9"},activeBookingsButtonText:{color:"#4CAF50"},noBookingsButton:{backgroundColor:"#E8E9E2"},noBookingsButtonText:{color:"#898974"},pastBookingsButton:{backgroundColor:"#F3E5F5"},pastBookingsButtonText:{color:"#9C27B0"},filterText:{fontSize:14,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center"},listHeaderSpacing:{paddingTop:16},listContainer:{paddingHorizontal:24,paddingBottom:34,alignItems:"stretch",width:"100%"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingMoreContainer:{paddingVertical:16,alignItems:"center"},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",paddingHorizontal:24},emptyText:{fontSize:16,color:m.theme.colors.placeholder,textAlign:"center",marginTop:8,marginBottom:24,fontFamily:m.theme.fonts.regular.fontFamily},inviteButton:{backgroundColor:m.theme.colors.primary,paddingHorizontal:24,paddingVertical:12,borderRadius:8,marginTop:8},inviteButtonText:{color:m.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},footer:{paddingVertical:16,alignItems:"center",justifyContent:"center",width:"100%"},footerText:{color:m.theme.colors.placeholder,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center",marginBottom:12},createServiceButton:Object.assign({paddingVertical:10,paddingHorizontal:16,backgroundColor:m.theme.colors.primary,borderRadius:8,marginTop:8},{transition:"all 0.2s ease",cursor:"pointer"}),createServiceButtonText:{color:m.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:m.theme.colors.surface,borderRadius:12,padding:24,width:"90%",maxWidth:500,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:4,elevation:5},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},modalTitle:{fontSize:20,fontWeight:"600",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily},closeButton:{padding:4},modalText:{fontSize:16,color:m.theme.colors.text,marginBottom:24,fontFamily:m.theme.fonts.regular.fontFamily,lineHeight:24},inviteTypeToggle:{flexDirection:"row",gap:12,marginBottom:24},inviteTypeButton:Object.assign({flex:1,padding:12,borderWidth:1,borderColor:"#CCCBC9",borderRadius:8,flexDirection:"row",alignItems:"center",justifyContent:"center",gap:6},{cursor:"pointer"}),inviteTypeButtonActive:{borderColor:m.theme.colors.primary,backgroundColor:"rgba(7, 132, 198, 0.05)"},inviteTypeText:{fontSize:16,color:"#666",fontFamily:m.theme.fonts.regular.fontFamily},inviteTypeTextActive:{color:m.theme.colors.primary,fontWeight:"500"},inputContainer:{marginBottom:24},inputLabel:{fontSize:16,fontWeight:"500",color:m.theme.colors.text,marginBottom:8,fontFamily:m.theme.fonts.regular.fontFamily},emailInput:{borderWidth:1,borderColor:"#CCCBC9",borderRadius:8,padding:12,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},emailInputError:{borderColor:m.theme.colors.error,borderWidth:2},validationErrorText:{color:m.theme.colors.error,fontSize:12,marginTop:4,fontFamily:m.theme.fonts.regular.fontFamily},linkContainer:{marginBottom:24},generatedLinkContainer:{flexDirection:"row",alignItems:"center",gap:12,padding:12,borderWidth:1,borderColor:"#CCCBC9",borderRadius:8,backgroundColor:"rgba(0, 0, 0, 0.02)"},generatedLink:{flex:1,color:m.theme.colors.text,fontSize:16,fontFamily:m.theme.fonts.regular.fontFamily},copyButton:Object.assign({padding:8},{cursor:"pointer"}),errorText:{color:m.theme.colors.error||"#D32F2F",fontSize:16,marginBottom:16,fontFamily:m.theme.fonts.regular.fontFamily},successText:{color:m.theme.colors.success||"#4CAF50",fontSize:16,marginBottom:16,fontFamily:m.theme.fonts.regular.fontFamily},modalButtons:{flexDirection:"row",justifyContent:"flex-end",gap:12,marginTop:8},cancelButton:Object.assign({paddingVertical:10,paddingHorizontal:16,borderRadius:8,borderWidth:1,borderColor:"#CCCBC9",backgroundColor:m.theme.colors.surface},{cursor:"pointer"}),cancelButtonText:{color:m.theme.colors.text,fontSize:16,fontWeight:"500",fontFamily:m.theme.fonts.regular.fontFamily},sendInviteButton:Object.assign({paddingVertical:10,paddingHorizontal:16,borderRadius:8,backgroundColor:m.theme.colors.primary,minWidth:140,alignItems:"center",justifyContent:"center"},{cursor:"pointer"}),sendInviteButtonText:{color:m.theme.colors.surface,fontSize:16,fontWeight:"600",fontFamily:m.theme.fonts.regular.fontFamily},disabledButton:Object.assign({backgroundColor:"#CCCCCC",opacity:.7},{cursor:"not-allowed"}),columnWrapper:{flexWrap:"wrap",justifyContent:"space-between",gap:16,width:"100%"},cardWrapper:{flex:1,width:"100%",marginBottom:16},mobileCardWrapper:{maxWidth:"100%"},wideScreenCardWrapper:{maxWidth:"calc(50% - 11px)"},buttonHovered:{transform:[{translateY:-3}],shadowColor:"#000",shadowOffset:{width:0,height:6},shadowOpacity:.15,shadowRadius:10,elevation:5}}),Qi=()=>{const e=(0,b.useNavigation)(),{isApprovedProfessional:t,userRole:o,isCollapsed:i,screenWidth:s}=(0,n.useContext)(h.AuthContext),[l,d]=(0,n.useState)(s<900),[c,u]=(0,n.useState)(s>=1500),[f,p]=(0,n.useState)("clients"),[y,x]=(0,n.useState)(""),[w,T]=(0,n.useState)([]),[B,_]=(0,n.useState)(!0),[I,M]=(0,n.useState)(null),[L,R]=(0,n.useState)(1),[D,z]=(0,n.useState)(!0),[P,F]=(0,n.useState)(!1),[E,W]=(0,n.useState)("all"),[O,N]=(0,n.useState)(null),[H,U]=(0,n.useState)(!1),[V,q]=(0,n.useState)(""),[Y,G]=(0,n.useState)(!1),[J,$]=(0,n.useState)(!1),K=(0,n.useRef)(null),[Z,Q]=(0,n.useState)([]),[ee,oe]=(0,n.useState)("email"),[ne,re]=(0,n.useState)(""),[ae,ie]=(0,n.useState)(""),[se,le]=(0,n.useState)(""),[de,ce]=(0,n.useState)(!1),[ue,ge]=(0,n.useState)(!1),[me,he]=(0,n.useState)(""),fe=kt();(0,n.useEffect)((()=>{const e=C.default.addEventListener("change",(()=>{d(C.default.get("window").width<900),u(C.default.get("window").width>=1200)}));return()=>{e?.remove()}}),[]),(0,n.useEffect)((()=>{p("professional"===o?"clients":"professionals")}),[o]),(0,n.useEffect)((()=>{(async()=>{(0,h.debugLog)("MBA4321 Checking user role for navigation",{userRole:o}),"petOwner"===o&&(sessionStorage.setItem("previousRoute",""),sessionStorage.setItem("currentRoute","Dashboard"),(0,h.debugLog)("MBA4321 User is pet owner, navigating to Dashboard"),e.navigate("Dashboard"))})()}),[o,e]);const pe=async(e=1,t=!1)=>{_(!t),t&&F(!0),(0,h.debugLog)("MBA4321 Fetching connections:",{page:e,isLoadMore:t});try{const o=await(0,bt.getUserConnections)(e);(0,h.debugLog)("MBA4321 Response from API:",o);const n=o.connections||[];if(t){const e=[...w,...n];T(e),Q(e)}else T(n),Q(n);z(20===n.length),R(e)}catch(I){(0,h.debugLog)("MBA4321 Error fetching connections:",I),M("Failed to fetch connections")}finally{_(!1),F(!1)}};(0,n.useEffect)((()=>{(0,h.debugLog)("MBA4321 Fetching connections due to dependency change:",{activeTab:f,userRole:o}),R(1),T([]),pe(1)}),[f,o]),(0,n.useEffect)((()=>{(0,h.debugLog)("MBA4321 Filtering connections locally based on:",{activeFilter:E}),Z.length>0&&ye()}),[E,Z]);const ye=()=>{if(!Z.length)return;if((0,h.debugLog)("MBA9452: Filtering connections locally with filter:",E),"all"===E)return void T(Z);let e=[];switch(E){case"active_bookings":e=Z.filter((e=>e.active_bookings_count>0));break;case"no_bookings":e=Z.filter((e=>0===e.active_bookings_count&&0===e.has_past_booking));break;case"past_bookings":e=Z.filter((e=>0===e.active_bookings_count&&1===e.has_past_booking));break;default:e=Z}T(e)},be=e=>{if((0,h.debugLog)("MBA1234","Validating invite email:",e),!e||""===e.trim())return he(""),{isValid:!0,sanitized:""};const t=Ke(e,"email",{maxLength:254}),o=e.length,n=t.length,r=o>0?(o-n)/o*100:0;if(r>30&&o>5)return(0,h.debugLog)("MBA1234","Malicious content detected in invite email:",{originalLength:o,sanitizedLength:n,removalPercentage:r}),he("Invalid characters detected in email"),{isValid:!1,sanitized:t};const a=Ze(t);return a.isValid?(he(""),{isValid:!0,sanitized:t}):(he(a.message),{isValid:!1,sanitized:t})},xe=()=>{(0,h.debugLog)("MBA4321 Opening invite client modal"),q(""),re(""),ie(""),le(""),he(""),oe("email"),U(!0)};return(0,j.jsx)(r.default,{style:[Xi.container,{marginLeft:l?0:i?70:250}],children:(0,j.jsxs)(r.default,{style:[Xi.content,{marginTop:l?60:0}],children:[(0,j.jsxs)(r.default,{style:Xi.mainContent,children:[(0,j.jsxs)(r.default,{style:Xi.headerSection,children:[(0,j.jsx)(a.default,{style:Xi.title,children:"Connections"}),(0,j.jsx)(r.default,{style:Xi.tabContainer,children:"professional"===o&&(0,j.jsx)(v.default,{style:[Xi.tab,"clients"===f&&Xi.activeTab],onPress:()=>p("clients"),children:(0,j.jsx)(a.default,{style:[Xi.tabText,"clients"===f&&Xi.activeTabText],children:"My Clients"})})})]}),(0,j.jsx)(r.default,{style:Xi.connectionsContent,children:B?(0,j.jsx)(r.default,{style:Xi.loadingContainer,children:(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.primary})}):(0,j.jsxs)(r.default,{style:Xi.connectionsContent,children:[(0,j.jsx)(r.default,{style:Xi.stickyHeader,children:(0,j.jsxs)(r.default,{style:[Xi.stickyHeaderContent,{flexDirection:c?"row":"column"}],children:[(0,j.jsxs)(r.default,{style:[Xi.searchAndInviteContainer,c?{flex:.4,marginRight:"auto",flexDirection:"row",alignItems:"center"}:{flexDirection:"row",alignItems:"center"}],children:[(0,j.jsxs)(r.default,{style:[Xi.searchContainer,J&&Xi.searchContainerFocused],children:[(0,j.jsx)(S.default,{name:"magnify",size:24,color:J?m.theme.colors.primary:"#666"}),(0,j.jsx)(te.default,{ref:K,style:Xi.searchInput,placeholder:"clients"===f?"Search by client name or pet":"Search by professional name or service",value:y,onChangeText:e=>{if(x(e),!e.trim())return(0,h.debugLog)("MBA9452: Empty search query, reapplying current filter"),void ye();(0,h.debugLog)("MBA9452: Searching connections with query:",e);let t=[];if("all"===E)t=Z;else switch(E){case"active_bookings":t=Z.filter((e=>e.active_bookings_count>0));break;case"no_bookings":t=Z.filter((e=>0===e.active_bookings_count&&0===e.has_past_booking));break;case"past_bookings":t=Z.filter((e=>0===e.active_bookings_count&&1===e.has_past_booking));break;default:t=Z}const o=e.toLowerCase(),n=t.filter((e=>e.name.toLowerCase().includes(o)||"clients"===f&&e.pets?.some((e=>e.name?.toLowerCase().includes(o)||e.species?.toLowerCase().includes(o)))));T(n)},onFocus:()=>$(!0),onBlur:()=>$(!1)}),y?(0,j.jsx)(v.default,{onPress:()=>{x(""),ye()},children:(0,j.jsx)(S.default,{name:"close-circle",size:20,color:"#777"})}):null]}),"clients"===f&&"professional"===o&&(0,j.jsxs)(v.default,{style:[Xi.inviteButtonSmall,de&&Xi.buttonHovered],onPress:xe,onMouseEnter:()=>fe&&ce(!0),onMouseLeave:()=>fe&&ce(!1),children:[(0,j.jsx)(S.default,{name:"account-plus",size:16,color:m.theme.colors.surface}),(0,j.jsx)(a.default,{style:Xi.inviteButtonSmallText,children:"Invite"})]})]}),(0,j.jsx)(r.default,{style:[Xi.filtersWrapper,c?{flex:.6,alignItems:"flex-end"}:null],children:(0,j.jsx)(X.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:Xi.filterScrollContent,children:(0,j.jsxs)(r.default,{style:Xi.filterContainer,children:[(0,j.jsx)(v.default,{style:[Xi.filterButton,Xi.allButton,"all"===O&&Xi.filterButtonHovered],onPress:()=>W("all"),onMouseEnter:()=>fe&&N("all"),onMouseLeave:()=>fe&&N(null),children:(0,j.jsxs)(r.default,{style:Xi.filterContent,children:[(0,j.jsx)(S.default,{name:"filter-variant",size:16,color:"#0784C6"}),(0,j.jsx)(a.default,{style:[Xi.filterText,Xi.allButtonText],children:"All"}),"all"===E&&(0,j.jsx)(S.default,{name:"check",size:16,color:"#0784C6",style:Xi.checkmark})]})}),(0,j.jsx)(v.default,{style:[Xi.filterButton,Xi.activeBookingsButton,"active_bookings"===O&&Xi.filterButtonHovered],onPress:()=>W("active_bookings"),onMouseEnter:()=>fe&&N("active_bookings"),onMouseLeave:()=>fe&&N(null),children:(0,j.jsxs)(r.default,{style:Xi.filterContent,children:[(0,j.jsx)(S.default,{name:"calendar-check",size:16,color:"#4CAF50"}),(0,j.jsx)(a.default,{style:[Xi.filterText,Xi.activeBookingsButtonText],children:"Active Bookings"}),"active_bookings"===E&&(0,j.jsx)(S.default,{name:"check",size:16,color:"#4CAF50",style:Xi.checkmark})]})}),(0,j.jsx)(v.default,{style:[Xi.filterButton,Xi.noBookingsButton,"no_bookings"===O&&Xi.filterButtonHovered],onPress:()=>W("no_bookings"),onMouseEnter:()=>fe&&N("no_bookings"),onMouseLeave:()=>fe&&N(null),children:(0,j.jsxs)(r.default,{style:Xi.filterContent,children:[(0,j.jsx)(S.default,{name:"calendar-remove",size:16,color:"#898974"}),(0,j.jsx)(a.default,{style:[Xi.filterText,Xi.noBookingsButtonText],children:"No Bookings"}),"no_bookings"===E&&(0,j.jsx)(S.default,{name:"check",size:16,color:"#898974",style:Xi.checkmark})]})}),(0,j.jsx)(v.default,{style:[Xi.filterButton,Xi.pastBookingsButton,"past_bookings"===O&&Xi.filterButtonHovered],onPress:()=>W("past_bookings"),onMouseEnter:()=>fe&&N("past_bookings"),onMouseLeave:()=>fe&&N(null),children:(0,j.jsxs)(r.default,{style:Xi.filterContent,children:[(0,j.jsx)(S.default,{name:"history",size:16,color:"#9C27B0"}),(0,j.jsx)(a.default,{style:[Xi.filterText,Xi.pastBookingsButtonText],children:"Past Bookings"}),"past_bookings"===E&&(0,j.jsx)(S.default,{name:"check",size:16,color:"#9C27B0",style:Xi.checkmark})]})})]})})})]})}),w.length>0?(0,j.jsx)(Yt.default,{data:w,renderItem:({item:t})=>((0,h.debugLog)("MBA4321 Rendering connection item:",t),(0,j.jsx)(r.default,{style:[Xi.cardWrapper,l&&Xi.mobileCardWrapper,c&&Xi.wideScreenCardWrapper],children:(0,j.jsx)(Zi,{connection:t,type:f,onViewProfile:()=>(async t=>{(0,h.debugLog)("MBA4321 Navigating to messages with connection:",{connectionId:t.id,connectionName:t.name,conversationId:t.conversation_id}),await(0,g.navigateToFrom)(e,"MessageHistory","Connections",{conversationId:t.conversation_id,otherUserName:t.name})})(t),onCreateBooking:"clients"===f?()=>(async t=>{(0,h.debugLog)("MBA4321 Creating booking with client:",{clientId:t.id,clientName:t.name,conversationId:t.conversation_id}),await(0,g.navigateToFrom)(e,"MessageHistory","Connections",{conversationId:t.conversation_id,otherUserName:t.name,clientId:t.client_id,isProfessional:!0})})(t):null})})),keyExtractor:e=>e.client_id.toString(),contentContainerStyle:Xi.listContainer,onEndReached:()=>{!P&&D&&pe(L+1,!0)},onEndReachedThreshold:.5,ListFooterComponent:()=>P?((0,h.debugLog)("MBA4321 Loading more connections"),(0,j.jsx)(r.default,{style:Xi.footer,children:(0,j.jsx)(A.default,{size:"small",color:m.theme.colors.primary})})):!D&&w.length>0?((0,h.debugLog)("MBA4321 No more connections to load"),(0,j.jsxs)(r.default,{style:Xi.footer,children:[(0,j.jsxs)(a.default,{style:Xi.footerText,children:["No more ",f," to load"]}),"professional"===o&&"clients"===f&&(0,j.jsx)(v.default,{style:[Xi.createServiceButton,ue&&Xi.buttonHovered],onPress:()=>{(0,h.debugLog)("MBA4321 Create Service button clicked in footer"),(0,g.navigateToFrom)(e,"ServiceManager","Connections")},onMouseEnter:()=>fe&&ge(!0),onMouseLeave:()=>fe&&ge(!1),children:(0,j.jsx)(a.default,{style:Xi.createServiceButtonText,children:"Create a Service to Get More Clients"})})]})):null,ListHeaderComponent:(0,j.jsx)(r.default,{style:[Xi.listHeaderSpacing,{height:c?130:190}]}),numColumns:c?3:l?1:2,columnWrapperStyle:!l&&Xi.columnWrapper},c?"three-columns":l?"one-column":"two-columns"):y?(0,j.jsxs)(r.default,{style:Xi.emptyContainer,children:[(0,j.jsx)(r.default,{style:[Xi.listHeaderSpacing,{height:c?130:190}]}),(0,j.jsx)(S.default,{name:"magnify-close",size:80,color:m.theme.colors.placeholder}),(0,j.jsxs)(a.default,{style:Xi.emptyText,children:["No ",f,' found matching "',y,'"']}),(0,j.jsx)(v.default,{style:Xi.inviteButton,onPress:()=>{x(""),ye()},children:(0,j.jsx)(a.default,{style:Xi.inviteButtonText,children:"Clear Search"})})]}):(0,j.jsx)((({type:e})=>(0,j.jsxs)(r.default,{style:Xi.emptyContainer,children:[(0,j.jsx)(S.default,{name:"clients"===e?"account-group-outline":"account-tie-outline",size:80,color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:Xi.emptyText,children:{clients:{all:"You don't have any clients with bookings or that you have invited yet. Invite a client to get started!",active:"You don't have any active clients.",pending:"You don't have any pending client requests.",past:"You don't have any past clients."},professionals:{all:"You're not connected with any professionals yet.",active:"You don't have any active professionals.",pending:"You don't have any pending professional connections.",past:"You don't have any past professional connections."}}[e][E]}),"clients"===e&&"professional"===o&&(0,j.jsx)(v.default,{style:Xi.inviteButton,onPress:xe,children:(0,j.jsx)(a.default,{style:Xi.inviteButtonText,children:"Invite Client"})})]})),{type:f})]})})]}),(0,j.jsx)(k.default,{visible:H,transparent:!0,animationType:"fade",onRequestClose:()=>U(!1),children:(0,j.jsx)(r.default,{style:Xi.modalOverlay,children:(0,j.jsxs)(r.default,{style:Xi.modalContent,children:[(0,j.jsxs)(r.default,{style:Xi.modalHeader,children:[(0,j.jsx)(a.default,{style:Xi.modalTitle,children:"Invite Client"}),(0,j.jsx)(v.default,{style:Xi.closeButton,onPress:()=>U(!1),children:(0,j.jsx)(S.default,{name:"close",size:24,color:"#666"})})]}),(0,j.jsx)(a.default,{style:Xi.modalText,children:"Invite a client to connect with you on CrittrCove. You can either send them an email invitation or generate a link to share."}),(0,j.jsxs)(r.default,{style:Xi.inviteTypeToggle,children:[(0,j.jsxs)(v.default,{style:[Xi.inviteTypeButton,"email"===ee&&Xi.inviteTypeButtonActive],onPress:()=>{oe("email"),ie(""),le(""),he("")},children:[(0,j.jsx)(S.default,{name:"email-outline",size:20,color:"email"===ee?m.theme.colors.primary:"#666"}),(0,j.jsx)(a.default,{style:[Xi.inviteTypeText,"email"===ee&&Xi.inviteTypeTextActive],children:"Email Invitation"})]}),(0,j.jsxs)(v.default,{style:[Xi.inviteTypeButton,"link"===ee&&Xi.inviteTypeButtonActive],onPress:()=>{oe("link"),ie(""),le(""),he("")},children:[(0,j.jsx)(S.default,{name:"link-variant",size:20,color:"link"===ee?m.theme.colors.primary:"#666"}),(0,j.jsx)(a.default,{style:[Xi.inviteTypeText,"link"===ee&&Xi.inviteTypeTextActive],children:"Generate Link"})]})]}),"email"===ee?(0,j.jsxs)(r.default,{style:Xi.inputContainer,children:[(0,j.jsx)(a.default,{style:Xi.inputLabel,children:"Client's Email Address"}),(0,j.jsx)(te.default,{style:[Xi.emailInput,me?Xi.emailInputError:null],placeholder:"client@example.com",value:V,onChangeText:e=>{const{sanitized:t}=be(e);q(t)},keyboardType:"email-address",autoCapitalize:"none",maxLength:254}),me?(0,j.jsx)(a.default,{style:Xi.validationErrorText,children:me}):null]}):ne?(0,j.jsxs)(r.default,{style:Xi.linkContainer,children:[(0,j.jsx)(a.default,{style:Xi.inputLabel,children:"Shareable Invitation Link"}),(0,j.jsxs)(r.default,{style:Xi.generatedLinkContainer,children:[(0,j.jsx)(a.default,{style:Xi.generatedLink,numberOfLines:1,ellipsizeMode:"middle",children:ne}),(0,j.jsx)(v.default,{style:Xi.copyButton,onPress:()=>{ne&&(navigator.clipboard.writeText(ne),le("Link copied to clipboard!"))},children:(0,j.jsx)(S.default,{name:"content-copy",size:20,color:m.theme.colors.primary})})]})]}):null,ae?(0,j.jsx)(a.default,{style:Xi.errorText,children:ae}):null,se?(0,j.jsx)(a.default,{style:Xi.successText,children:se}):null,(0,j.jsxs)(r.default,{style:Xi.modalButtons,children:[(0,j.jsx)(v.default,{style:Xi.cancelButton,onPress:()=>U(!1),children:(0,j.jsx)(a.default,{style:Xi.cancelButtonText,children:"Close"})}),ne&&"email"!==ee?null:(0,j.jsx)(v.default,{style:[Xi.sendInviteButton,"email"===ee&&(!V||me)&&Xi.disabledButton,Y&&Xi.disabledButton],onPress:async()=>{if(ie(""),le(""),"email"===ee){const{isValid:e}=be(V);if(!e||me)return ie(me||"Please enter a valid email address"),void(0,h.debugLog)("MBA1234 Invalid email format:",{inviteEmail:V,emailValidationError:me});if(!V||!V.trim())return ie("Please enter an email address"),void(0,h.debugLog)("MBA1234 Empty email:",V)}G(!0),(0,h.debugLog)("MBA4321 Creating invitation:",{type:ee,email:"email"===ee?V:null});try{const e=await(0,bt.inviteClient)(ee,"email"===ee?V:null);(0,h.debugLog)("MBA4321 Invitation created successfully:",e),"email"===ee?(le("Invitation sent to ".concat(V," - please have your client check spam if they don't see it in their inbox.")),q("")):(re(e.invitation_link),le("Invitation link created successfully!")),"pending"!==E&&"all"!==E||pe(1)}catch(I){(0,h.debugLog)("MBA4321 Error creating invitation:",I),ie(I.response?.data?.error||"Failed to send invitation. Please try again.")}finally{G(!1)}},disabled:Y||"email"===ee&&(!V||me),children:Y?(0,j.jsx)(A.default,{size:"small",color:m.theme.colors.surface}):(0,j.jsx)(a.default,{style:Xi.sendInviteButtonText,children:"email"===ee?"Send Invitation":"Generate Link"})})]})]})})})]})})},es={dogBoarding:{title:"Dog Boarding Colorado Springs | Trusted Pet Care | CrittrCove",description:"Find reliable dog boarding professionals in Colorado Springs. Connect with experienced pet sitters providing overnight care for your furry friends. Book trusted local dog boarding today.",keywords:"dog boarding colorado springs, pet boarding, overnight dog care, dog sitters, pet care colorado springs"},dogWalker:{title:"Dog Walker Colorado Springs | Professional Pet Walking | CrittrCove",description:"Professional dog walking services in Colorado Springs. Reliable pet walkers for daily exercise and care. Book trusted dog walkers in your neighborhood today.",keywords:"dog walker colorado springs, pet walking, dog exercise, professional dog walkers, pet care services"},catSitting:{title:"Cat Sitting Colorado Springs | Professional Cat Care | CrittrCove",description:"Trusted cat sitting services in Colorado Springs. Professional cat sitters providing in-home care for your feline friends. Book reliable cat care today.",keywords:"cat sitting colorado springs, cat sitters, feline care, in-home cat care, pet sitting services"},exoticPetCare:{title:"Exotic Pet Care Colorado Springs | Specialized Pet Services | CrittrCove",description:"Expert exotic pet care in Colorado Springs. Specialized services for reptiles, birds, ferrets, and unique pets. Professional exotic animal care you can trust.",keywords:"exotic pet care colorado springs, reptile care, bird care, ferret care, unusual pet services, specialized pet care"},ferretSitter:{title:"Ferret Sitter Colorado Springs | Specialized Ferret Care | CrittrCove",description:"Professional ferret sitting services in Colorado Springs. Experienced ferret sitters providing specialized care for your furry friends. Book trusted ferret care.",keywords:"ferret sitter colorado springs, ferret care, small animal care, exotic pet sitting, professional ferret services"},birdBoarding:{title:"Bird Boarding Colorado Springs | Avian Care Services | CrittrCove",description:"Professional bird boarding and avian care in Colorado Springs. Experienced bird sitters for parrots, canaries, and all feathered friends. Trusted bird care services.",keywords:"bird boarding colorado springs, avian care, parrot sitting, bird sitters, feathered pet care, professional bird services"},horseSitting:{title:"Horse Sitting Colorado | Equine Care Services | CrittrCove",description:"Professional horse sitting and equine care throughout Colorado. Experienced horse sitters providing quality care for your horses. Trusted equine services.",keywords:"horse sitting colorado, equine care, horse sitters, large animal care, professional equine services, horse care colorado"},reptileSitter:{title:"Reptile Sitter Colorado Springs | Specialized Reptile Care | CrittrCove",description:"Expert reptile sitting services in Colorado Springs. Professional reptile sitters for snakes, lizards, and all cold-blooded pets. Specialized reptile care.",keywords:"reptile sitter colorado springs, snake care, lizard care, reptile services, cold-blooded pet care, exotic reptile sitting"},petBoarding:{title:"Pet Boarding Colorado Springs | All Pet Types Welcome | CrittrCove",description:"Comprehensive pet boarding services in Colorado Springs. Professional care for dogs, cats, exotic pets, and more. Trusted overnight pet care services.",keywords:"pet boarding colorado springs, all pet types, overnight pet care, professional pet boarding, animal care services"},dogSitting:{title:"Dog Sitting Colorado Springs | In-Home Dog Care | CrittrCove",description:"Professional dog sitting services in Colorado Springs. Reliable dog sitters providing in-home care and companionship for your dogs. Book trusted dog sitting.",keywords:"dog sitting colorado springs, in-home dog care, dog sitters, pet sitting services, canine care, professional dog care"}},ts={container:{flex:1,backgroundColor:"#ffffff"},contentContainer:{paddingHorizontal:24,paddingVertical:32,maxWidth:1200,alignSelf:"center",width:"100%"},heroSection:{marginBottom:48,textAlign:"center"},mainHeading:{fontSize:42,fontWeight:"bold",color:m.theme.colors.primary,marginBottom:16,lineHeight:50,textAlign:"center"},introContainer:{alignItems:"center"},section:{marginBottom:40},sectionHeading:{fontSize:32,fontWeight:"bold",color:m.theme.colors.text,marginBottom:16,lineHeight:38},sectionContent:{},faqContainer:{},faqItem:{marginBottom:24,borderBottomWidth:1,borderBottomColor:"#e0e0e0",paddingBottom:16},faqQuestion:{fontSize:20,fontWeight:"600",color:m.theme.colors.text,marginBottom:8,lineHeight:26},faqAnswer:{fontSize:16,color:m.theme.colors.textSecondary,lineHeight:24},internalLinksContainer:{flexDirection:"row",flexWrap:"wrap",gap:12},internalLink:{backgroundColor:"#f5f5f5",paddingHorizontal:16,paddingVertical:12,borderRadius:8,marginRight:12,marginBottom:12},internalLinkText:{color:m.theme.colors.primary,fontSize:16,fontWeight:"500",textDecorationLine:"underline"},ctaSection:{backgroundColor:"#f8f9fa",padding:32,borderRadius:12,alignItems:"center",marginTop:24},ctaHeading:{fontSize:28,fontWeight:"bold",color:m.theme.colors.text,marginBottom:8,textAlign:"center"},ctaSubtext:{fontSize:18,color:m.theme.colors.textSecondary,textAlign:"center",marginBottom:24,lineHeight:26},ctaButtons:{flexDirection:"row",gap:16,width:"100%",maxWidth:500},ctaButton:{paddingVertical:16,paddingHorizontal:24,borderRadius:8,alignItems:"center",flex:1},primaryCTA:{backgroundColor:m.theme.colors.primary},primaryCTAText:{color:"#ffffff",fontSize:16,fontWeight:"600"},secondaryCTA:{backgroundColor:"transparent",borderWidth:2,borderColor:m.theme.colors.primary},secondaryCTAText:{color:m.theme.colors.primary,fontSize:16,fontWeight:"600"}},os=({seoConfig:e,mainHeading:t,introContent:o,whyCrittrCoveContent:i,faqItems:s,internalLinks:l,structuredData:d})=>{const c=(0,b.useNavigation)();if((0,U.debugLog)("MBA2iovno5rn: SEOLandingPageTemplate component rendering",{platform:"web",seoConfigTitle:e?.title,mainHeading:t,hasIntroContent:!!o,hasWhyCrittrCoveContent:!!i,faqItemsCount:s?.length||0,internalLinksCount:l?.length||0,hasStructuredData:!!d}),!e||!t)return(0,U.debugLog)("MBA2iovno5rn: Missing required props for SEO template",{hasSeoConfig:!!e,hasMainHeading:!!t}),(0,j.jsx)(r.default,{style:ts.container,children:(0,j.jsxs)(r.default,{style:ts.contentContainer,children:[(0,j.jsx)(a.default,{style:ts.mainHeading,children:"Loading..."}),(0,j.jsx)(a.default,{children:"Please wait while we load the page content."})]})});((e,t,o={})=>{(0,n.useEffect)((()=>{if((0,U.debugLog)("MBA2iovno5rn: useSEO hook triggered",{platform:"web",title:e,description:t,additionalMeta:o,hasDocument:"undefined"!==typeof document}),"undefined"!==typeof document){if(e&&(document.title=e),t){let e=document.querySelector('meta[name="description"]');e||(e=document.createElement("meta"),e.setAttribute("name","description"),document.head.appendChild(e)),e.setAttribute("content",t)}Object.entries(o).forEach((([e,t])=>{let o=document.querySelector('meta[name="'.concat(e,'"]'));o||(o=document.createElement("meta"),o.setAttribute("name",e),document.head.appendChild(o)),o.setAttribute("content",t)}));const n={"twitter:card":"summary_large_image","twitter:title":e,"twitter:description":t,"twitter:image":"https://crittrcove.com/og-image.jpg","twitter:site":"@crittrcove"};Object.entries(n).forEach((([e,t])=>{if(t){let o=document.querySelector('meta[name="'.concat(e,'"]'));o||(o=document.createElement("meta"),o.setAttribute("name",e),document.head.appendChild(o)),o.setAttribute("content",t)}}));const r={"og:title":e,"og:description":t,"og:type":"website","og:site_name":"CrittrCove","og:url":window.location.href,"og:image":"https://crittrcove.com/og-image.jpg","og:locale":"en_US"};Object.entries(r).forEach((([e,t])=>{if(t){let o=document.querySelector('meta[property="'.concat(e,'"]'));o||(o=document.createElement("meta"),o.setAttribute("property",e),document.head.appendChild(o)),o.setAttribute("content",t)}}))}}),[e,t,o])})(e.title,e.description,{keywords:e.keywords,robots:"index, follow",viewport:"width=device-width, initial-scale=1"}),n.useEffect((()=>{(0,U.debugLog)("MBA2iovno5rn: SEOLandingPageTemplate useEffect triggered",{hasStructuredData:!!d,structuredDataType:typeof d}),d&&(e=>{if("undefined"!==typeof document){const t=Object.assign({"@context":"https://schema.org","@type":"LocalBusiness",name:"CrittrCove",description:"Professional pet care services specializing in exotic pets in Colorado Springs",url:"https://crittrcove.com",telephone:"+1-555-CRITTR",address:{"@type":"PostalAddress",addressLocality:"Colorado Springs",addressRegion:"CO",addressCountry:"US"},areaServed:"Colorado Springs, CO",priceRange:"$",category:"Pet Care Service"},e),o=document.querySelector('script[type="application/ld+json"]');o&&o.remove();const n=document.createElement("script");n.type="application/ld+json",n.textContent=JSON.stringify(t),document.head.appendChild(n)}})(d)}),[d]);(0,U.debugLog)("MBA2iovno5rn: SEOLandingPageTemplate about to render ScrollView",{containerStyle:ts.container,contentContainerStyle:ts.contentContainer,accessibilityRole:"main"});try{return(0,U.debugLog)("MBA2iovno5rn: Rendering SEO template with ScrollView",{containerStyle:ts.container,contentContainerStyle:ts.contentContainer}),(0,j.jsxs)(X.default,{style:ts.container,contentContainerStyle:ts.contentContainer,accessibilityRole:"main",children:[(0,U.debugLog)("MBA2iovno5rn: ScrollView children starting to render",{mainHeading:t,hasIntroContent:!!o,hasWhyCrittrCoveContent:!!i}),(0,j.jsxs)(r.default,{style:ts.heroSection,children:[(0,U.debugLog)("MBA2iovno5rn: Hero section rendering",{mainHeading:t,heroSectionStyle:ts.heroSection}),(0,j.jsx)(a.default,{style:ts.mainHeading,accessibilityRole:"heading",accessibilityLevel:1,children:t}),(0,U.debugLog)("MBA2iovno5rn: Main heading rendered, now rendering intro container",{introContainerStyle:ts.introContainer}),(0,j.jsx)(r.default,{style:ts.introContainer,children:o})]}),(0,U.debugLog)("MBA2iovno5rn: Hero section completed, now rendering Why CrittrCove section",{sectionStyle:ts.section,hasWhyCrittrCoveContent:!!i}),(0,j.jsxs)(r.default,{style:ts.section,accessibilityRole:"region",accessibilityLabel:"Why Choose CrittrCove",children:[(0,j.jsx)(a.default,{style:ts.sectionHeading,accessibilityRole:"heading",accessibilityLevel:2,children:"Why Choose CrittrCove?"}),(0,j.jsx)(r.default,{style:ts.sectionContent,children:i})]}),(0,U.debugLog)("MBA2iovno5rn: Why CrittrCove section completed, now rendering FAQ section",{faqItemsCount:s?.length||0}),(0,j.jsxs)(r.default,{style:ts.section,accessibilityRole:"region",accessibilityLabel:"Frequently Asked Questions",children:[(0,j.jsx)(a.default,{style:ts.sectionHeading,accessibilityRole:"heading",accessibilityLevel:2,children:"Frequently Asked Questions"}),(0,j.jsx)(r.default,{style:ts.faqContainer,children:s.map(((e,t)=>((0,U.debugLog)("MBA2iovno5rn: Rendering FAQ item ".concat(t),{question:e.question,answerLength:e.answer?.length||0}),(0,j.jsxs)(r.default,{style:ts.faqItem,children:[(0,j.jsx)(a.default,{style:ts.faqQuestion,accessibilityRole:"heading",accessibilityLevel:3,children:e.question}),(0,j.jsx)(a.default,{style:ts.faqAnswer,children:e.answer})]},t))))})]}),l&&l.length>0&&(0,j.jsxs)(r.default,{style:ts.section,accessibilityRole:"navigation",accessibilityLabel:"Related Services",children:[(0,j.jsx)(a.default,{style:ts.sectionHeading,accessibilityRole:"heading",accessibilityLevel:2,children:"Other Pet Care Services"}),(0,j.jsx)(r.default,{style:ts.internalLinksContainer,children:l.map(((e,t)=>(0,j.jsx)(v.default,{style:ts.internalLink,onPress:()=>{return t=e.route,(0,U.debugLog)("MBA2iovno5rn: Internal link pressed",{route:t}),void c.navigate(t);var t},accessibilityRole:"link",accessibilityLabel:"View ".concat(e.text),children:(0,j.jsx)(a.default,{style:ts.internalLinkText,children:e.text})},t)))})]}),(0,j.jsxs)(r.default,{style:ts.ctaSection,accessibilityRole:"region",accessibilityLabel:"Get Started",children:[(0,j.jsx)(a.default,{style:ts.ctaHeading,accessibilityRole:"heading",accessibilityLevel:2,children:"Ready to Get Started?"}),(0,j.jsx)(a.default,{style:ts.ctaSubtext,children:"Join the CrittrCove community today and connect with trusted pet care professionals."}),(0,j.jsx)(r.default,{style:ts.ctaButtons,children:(0,j.jsx)(v.default,{style:[ts.ctaButton,ts.primaryCTA],onPress:()=>{return e="SignUp",(0,U.debugLog)("MBA2iovno5rn: CTA button pressed",{route:e}),void c.navigate(e);var e},accessibilityRole:"button",accessibilityLabel:"Sign up as a pet owner",children:(0,j.jsx)(a.default,{style:ts.primaryCTAText,children:"Sign Up Today"})})})]})]})}catch(zs){return(0,U.debugLog)("MBA2iovno5rn: Error rendering SEOLandingPageTemplate",{error:zs.message,stack:zs.stack}),(0,j.jsxs)(r.default,{style:ts.container,children:[(0,j.jsx)(a.default,{style:ts.mainHeading,children:"Error Loading Page"}),(0,j.jsx)(a.default,{children:"Please try refreshing the page."})]})}},ns={introContent:{maxWidth:800},introText:{fontSize:18,color:m.theme.colors.textSecondary,lineHeight:28,marginBottom:16,textAlign:"center"},contentSection:{},paragraph:{fontSize:16,color:m.theme.colors.textSecondary,lineHeight:26,marginBottom:16},bold:{fontWeight:"600",color:m.theme.colors.text}},rs=()=>{(0,U.debugLog)("MBA2iovno5rn: DogBoardingColoradoSprings component rendering",{platform:"web",seoConfig:es.dogBoarding,hasIntroContent:!0,hasWhyCrittrCoveContent:!0,faqItemsCount:3,internalLinksCount:4});const e=(0,j.jsxs)(r.default,{style:ns.introContent,children:[(0,j.jsx)(a.default,{style:ns.introText,children:"Find trusted dog boarding professionals in Colorado Springs with CrittrCove. Our network connects you with experienced pet sitters who may provide overnight care and companionship for your furry friends in the comfort of their own homes or in loving host families."}),(0,j.jsx)(a.default,{style:ns.introText,children:"Whether you need short-term boarding for a weekend getaway or extended care for business travel, Colorado Springs dog boarding professionals on our platform aim to provide personalized attention and care."})]}),t=(0,j.jsxs)(r.default,{style:ns.contentSection,children:[(0,j.jsxs)(a.default,{style:ns.paragraph,children:[(0,j.jsx)(a.default,{style:ns.bold,children:"Professional Overnight Care:"})," Unlike traditional kennels, the dog boarding professionals on our platform provide home-like environments where your dog receives individual attention and maintains their regular routine. These experienced sitters offer overnight stays in comfortable, safe settings."]}),(0,j.jsxs)(a.default,{style:ns.paragraph,children:[(0,j.jsx)(a.default,{style:ns.bold,children:"Local Colorado Springs Knowledge:"})," Many boarding professionals on our platform are familiar with the local area, including dog-friendly parks, emergency veterinary clinics, and exercise locations specific to Colorado Springs. We recommend discussing local knowledge with potential caregivers."]}),(0,j.jsxs)(a.default,{style:ns.paragraph,children:[(0,j.jsx)(a.default,{style:ns.bold,children:"No Platform Fees During Beta:"})," During our beta period, professionals collect payment directly from you (typically via Venmo, cash, or their preferred method) rather than through the app. This eliminates payment processor fees and platform charges, keeping costs lower for everyone."]})]}),o=[{question:"How much does dog boarding cost in Colorado Springs?",answer:"Estimated dog boarding rates in Colorado Springs typically range from $35-75 per night, as professionals set their own pricing based on care level and services included. Factors like dog size, special needs, and additional services affect pricing. No platform fees during beta - professionals collect payment directly."},{question:"What's included in overnight dog boarding services?",answer:"Dog boarding services often include overnight supervision, regular feeding, exercise, playtime, and companionship. Many professionals also offer additional services like walks, medication administration, and daily photo updates. Since each professional sets their own service packages, we recommend discussing specific care needs and confirming what's included before booking."},{question:"How do I choose the right boarding sitter for my dog?",answer:"Review professional profiles to find experience matching your dog's needs, read reviews from other Colorado Springs pet owners, and schedule a meet-and-greet before booking. Look for caregivers with experience handling your dog's size, breed, and temperament, and verify their comfort level with your specific dog's needs."}],n=[{text:"Dog Sitting Colorado Springs",route:"DogSittingColoradoSprings"},{text:"Dog Walker Colorado Springs",route:"DogWalkerColoradoSprings"},{text:"Pet Boarding Colorado Springs",route:"PetBoardingColoradoSprings"},{text:"Cat Sitting Colorado Springs",route:"CatSittingColoradoSprings"}];return(0,U.debugLog)("MBA2iovno5rn: DogBoardingColoradoSprings about to render SEOLandingPageTemplate",{mainHeading:"Trusted Dog Boarding in Colorado Springs",introContentType:typeof e,whyCrittrCoveContentType:typeof t,faqItemsLength:o.length,internalLinksLength:n.length}),(0,j.jsx)(os,{seoConfig:es.dogBoarding,mainHeading:"Trusted Dog Boarding in Colorado Springs",introContent:e,whyCrittrCoveContent:t,faqItems:o,internalLinks:n})},as={introContent:{maxWidth:800},introText:{fontSize:18,color:m.theme.colors.textSecondary,lineHeight:28,marginBottom:16,textAlign:"center"},paragraph:{fontSize:16,color:m.theme.colors.textSecondary,lineHeight:26,marginBottom:16},bold:{fontWeight:"600",color:m.theme.colors.text}},is=()=>{const e=(0,j.jsxs)(r.default,{style:as.introContent,children:[(0,j.jsx)(a.default,{style:as.introText,children:"Professional dog walking services in Colorado Springs. Connect with trusted local dog walkers who provide reliable exercise and companionship for your furry friend while you're at work or away."}),(0,j.jsx)(a.default,{style:as.introText,children:"Our vetted dog walkers in Colorado Springs offer flexible scheduling, GPS tracking, and detailed walk reports to keep you connected with your pet's daily exercise routine."})]}),t=(0,j.jsxs)(r.default,{style:as.contentSection,children:[(0,j.jsxs)(a.default,{style:as.paragraph,children:[(0,j.jsx)(a.default,{style:as.bold,children:"Reliable Daily Exercise:"})," Professional dog walkers on our platform aim to provide your pet with consistent exercise and mental stimulation, helping maintain their health and happiness even with your busy schedule."]}),(0,j.jsxs)(a.default,{style:as.paragraph,children:[(0,j.jsx)(a.default,{style:as.bold,children:"Local Area Knowledge:"})," Many dog walking professionals on our platform are familiar with the best routes, dog-friendly areas, and weather considerations specific to our beautiful mountain community. We recommend discussing local area familiarity with potential walkers."]}),(0,j.jsxs)(a.default,{style:as.paragraph,children:[(0,j.jsx)(a.default,{style:as.bold,children:"Flexible Scheduling:"})," Whether you need daily walks, occasional services, or emergency coverage, our network provides reliable dog walking when you need it most."]})]});return(0,j.jsx)(os,{seoConfig:es.dogWalker,mainHeading:"Professional Dog Walker Services in Colorado Springs",introContent:e,whyCrittrCoveContent:t,faqItems:[{question:"How much do dog walkers charge in Colorado Springs?",answer:"Estimated dog walking rates in Colorado Springs typically range from $20-40 per walk, as professionals set their own pricing based on duration, group size, and additional services. Most walks are 30-60 minutes and often include basic care and attention, though specific services vary by professional."},{question:"What areas of Colorado Springs do you serve?",answer:"The dog walking professionals on our platform serve all areas of Colorado Springs including downtown, Old Colorado City, Broadmoor, Security-Widefield, and surrounding neighborhoods. Check individual professional profiles for specific service areas."},{question:"Do dog walkers provide updates during walks?",answer:"Many professional dog walkers on our platform provide photo updates, GPS tracking, and walk reports detailing your dog's activity, bathroom breaks, and overall behavior during their exercise session. We recommend discussing reporting preferences with potential walkers."}],internalLinks:[{text:"Dog Boarding Colorado Springs",route:"DogBoardingColoradoSprings"},{text:"Dog Sitting Colorado Springs",route:"DogSittingColoradoSprings"},{text:"Pet Boarding Colorado Springs",route:"PetBoardingColoradoSprings"}]})},ss={introContent:{maxWidth:800},introText:{fontSize:18,color:m.theme.colors.textSecondary,lineHeight:28,marginBottom:16,textAlign:"center"},paragraph:{fontSize:16,color:m.theme.colors.textSecondary,lineHeight:26,marginBottom:16},bold:{fontWeight:"600",color:m.theme.colors.text}},ls=()=>{const e=(0,j.jsxs)(r.default,{style:ss.introContent,children:[(0,j.jsx)(a.default,{style:ss.introText,children:"Professional cat sitting services in Colorado Springs. Find trusted cat sitters who may provide in-home care, aiming to maintain your feline's routine and comfort while you're away."}),(0,j.jsx)(a.default,{style:ss.introText,children:"Experienced cat sitters on our platform often understand feline behavior and may provide personalized care including feeding, litter box maintenance, playtime, and companionship for your beloved cats."})]}),t=(0,j.jsxs)(r.default,{style:ss.contentSection,children:[(0,j.jsxs)(a.default,{style:ss.paragraph,children:[(0,j.jsx)(a.default,{style:ss.bold,children:"In-Home Comfort:"})," Cats thrive in familiar environments. Our cat sitters provide care in your home, reducing stress and maintaining your cat's established routines and territorial comfort."]}),(0,j.jsxs)(a.default,{style:ss.paragraph,children:[(0,j.jsx)(a.default,{style:ss.bold,children:"Feline Behavior Knowledge:"})," Many cat caregivers on our platform in Colorado Springs are familiar with cat behavior, body language, and health indicators. We recommend discussing each professional's cat experience to ensure they're comfortable with your pet's specific needs."]}),(0,j.jsxs)(a.default,{style:ss.paragraph,children:[(0,j.jsx)(a.default,{style:ss.bold,children:"Flexible Care Options:"})," Whether you need daily visits, overnight stays, or extended care, many cat caregivers on our platform can adapt to your cat's specific needs and your travel schedule. Discuss scheduling flexibility with potential professionals."]})]});return(0,j.jsx)(os,{seoConfig:es.catSitting,mainHeading:"Professional Cat Sitting Services in Colorado Springs",introContent:e,whyCrittrCoveContent:t,faqItems:[{question:"How much does cat sitting cost in Colorado Springs?",answer:"Estimated cat sitting rates in Colorado Springs range from $20-45 per visit, as professionals set their own pricing based on duration and services. Overnight stays typically cost $50-80 per night. Multiple cats may have additional fees."},{question:"What services are included in cat sitting?",answer:"Cat sitting services often include feeding, fresh water, litter box cleaning, playtime, and companionship. Many professionals also offer additional services like medication administration, plant watering, and mail collection. Since each professional creates their own service offerings, we recommend discussing your specific needs and confirming what's included before booking."},{question:"How often will the sitter visit my cat?",answer:"Visit frequency depends on your cat's needs. Most cats do well with daily 30-60 minute visits, but we can arrange multiple visits per day or overnight stays for cats requiring more attention or medical care."}],internalLinks:[{text:"Dog Sitting Colorado Springs",route:"DogSittingColoradoSprings"},{text:"Exotic Pet Care Colorado Springs",route:"ExoticPetCareColoradoSprings"},{text:"Pet Boarding Colorado Springs",route:"PetBoardingColoradoSprings"}]})},ds={introContent:{maxWidth:800},introText:{fontSize:18,color:m.theme.colors.textSecondary,lineHeight:28,marginBottom:16,textAlign:"center"},contentSection:{},paragraph:{fontSize:16,color:m.theme.colors.textSecondary,lineHeight:26,marginBottom:16},bold:{fontWeight:"600",color:m.theme.colors.text}},cs=()=>{const e=(0,j.jsxs)(r.default,{style:ds.introContent,children:[(0,j.jsx)(a.default,{style:ds.introText,children:"Looking for specialized exotic pet care in Colorado Springs? CrittrCove connects you with experienced professionals who may understand the unique needs of reptiles, birds, ferrets, and other exotic companions. Our network of trusted exotic pet sitters often provides expert care tailored to your pet's specific requirements."}),(0,j.jsx)(a.default,{style:ds.introText,children:"From temperature-controlled environments for reptiles to specialized diets for exotic birds, Colorado Springs exotic pet sitters on our platform often have the knowledge and experience to help keep your unique pets happy and healthy."})]}),t=(0,j.jsxs)(r.default,{style:ds.contentSection,children:[(0,j.jsxs)(a.default,{style:ds.paragraph,children:[(0,j.jsx)(a.default,{style:ds.bold,children:"Specialized Exotic Pet Expertise:"})," Unlike general pet sitting services, CrittrCove focuses on connecting you with professionals who have real experience caring for exotic animals. The professional network on our platform often includes reptile specialists, avian care experts, and small mammal enthusiasts who may have experience with the complex needs of non-traditional pets."]}),(0,j.jsxs)(a.default,{style:ds.paragraph,children:[(0,j.jsx)(a.default,{style:ds.bold,children:"Local Colorado Springs Knowledge:"})," Many exotic pet professionals on our platform are familiar with Colorado Springs' climate and how it affects exotic pets. Some know local exotic veterinarians and may be able to provide emergency care coordination specific to your area. We recommend verifying local knowledge with potential caregivers."]}),(0,j.jsxs)(a.default,{style:ds.paragraph,children:[(0,j.jsx)(a.default,{style:ds.bold,children:"No Platform Fees During Beta:"})," We're currently in beta testing, which means professionals collect payment directly from you (typically via Venmo, cash, or their preferred method) rather than through the app. This eliminates payment processor fees and platform charges, keeping exotic pet care more affordable."]}),(0,j.jsxs)(a.default,{style:ds.paragraph,children:[(0,j.jsx)(a.default,{style:ds.bold,children:"Ethical Care Standards:"})," The exotic pet professionals on our platform typically follow species-appropriate care guidelines and maintain proper habitat conditions. We prioritize connecting you with caregivers who put the welfare of your exotic pets above all else. As a marketplace, each professional sets their own care standards and service offerings, so we recommend thoroughly discussing care protocols during your consultation."]})]});return(0,j.jsx)(os,{seoConfig:es.exoticPetCare,mainHeading:"Expert Exotic Pet Care in Colorado Springs",introContent:e,whyCrittrCoveContent:t,faqItems:[{question:"What types of exotic pets do Colorado Springs sitters care for?",answer:"The exotic pet professionals on our platform in Colorado Springs specialize in a wide range of non-traditional pets including reptiles (snakes, lizards, geckos, bearded dragons), birds (parrots, cockatiels, canaries), small mammals (ferrets, chinchillas, sugar gliders), amphibians, and other unique companions. Each professional's profile lists their specific expertise and experience."},{question:"How much does exotic pet sitting cost in Colorado Springs?",answer:"Estimated exotic pet sitting rates in Colorado Springs typically range from $25-50 per visit, as professionals set their own pricing based on care complexity. Specialized care for reptiles with specific temperature/humidity needs or birds requiring medication may cost more. During our beta period, professionals collect payment directly (no platform fees)."},{question:"Do exotic pet sitters handle emergency situations?",answer:"Yes, the professional exotic pet caregivers on our platform typically have experience recognizing signs of distress in exotic animals. While each caregiver has their own level of expertise, pet owners provide specific emergency instructions and veterinary contacts during the initial consultation. Many caregivers in Colorado Springs have familiarity with local exotic veterinarians, but we recommend discussing emergency protocols with potential caregivers to ensure they're comfortable handling your pet's specific needs. It's important to thoroughly vet caregivers regarding their knowledge of emergency situations for your particular exotic pet."},{question:"How do I ensure my exotic pet's specific needs are met?",answer:"Before any sitting arrangement, you'll have a detailed conversation with your chosen professional to discuss your pet's specific requirements including diet, habitat maintenance, lighting schedules, temperature/humidity controls, and any medications. The professionals on our platform create customized care plans and provide daily updates with photos and observations."}],internalLinks:[{text:"Reptile Sitting Services",route:"ReptileSitterColoradoSprings"},{text:"Bird Boarding Colorado Springs",route:"BirdBoardingColoradoSprings"},{text:"Ferret Sitting Services",route:"FerretSitterColoradoSprings"},{text:"Dog Boarding Colorado Springs",route:"DogBoardingColoradoSprings"}],structuredData:{"@type":"PetService",name:"Exotic Pet Care Colorado Springs - CrittrCove",description:"Professional exotic pet care services in Colorado Springs specializing in reptiles, birds, ferrets and unique pets",serviceType:"Exotic Pet Care",areaServed:{"@type":"City",name:"Colorado Springs",containedInPlace:{"@type":"State",name:"Colorado"}},hasOfferCatalog:{"@type":"OfferCatalog",name:"Exotic Pet Services",itemListElement:[{"@type":"Offer",itemOffered:{"@type":"Service",name:"Reptile Care",description:"Specialized care for snakes, lizards, and other reptiles"}},{"@type":"Offer",itemOffered:{"@type":"Service",name:"Avian Care",description:"Expert bird care and boarding services"}},{"@type":"Offer",itemOffered:{"@type":"Service",name:"Small Exotic Mammal Care",description:"Care for ferrets, chinchillas, and other small exotic pets"}}]}}})},us={introContent:{maxWidth:800},introText:{fontSize:18,color:m.theme.colors.textSecondary,lineHeight:28,marginBottom:16,textAlign:"center"},paragraph:{fontSize:16,color:m.theme.colors.textSecondary,lineHeight:26,marginBottom:16},bold:{fontWeight:"600",color:m.theme.colors.text}},gs=()=>{const e=(0,j.jsxs)(r.default,{style:us.introContent,children:[(0,j.jsx)(a.default,{style:us.introText,children:"Specialized ferret sitting services in Colorado Springs. Connect with experienced ferret sitters who understand the unique needs of these playful, intelligent pets."}),(0,j.jsx)(a.default,{style:us.introText,children:"Ferret care specialists on our platform often provide proper supervision, playtime, feeding, and habitat maintenance to help keep your ferrets happy and healthy while you're away."})]}),t=(0,j.jsxs)(r.default,{style:us.contentSection,children:[(0,j.jsxs)(a.default,{style:us.paragraph,children:[(0,j.jsx)(a.default,{style:us.bold,children:"Ferret-Specific Knowledge:"})," Ferrets require specialized care including frequent feeding, secure play areas, and understanding of their unique behaviors. Professionals on our platform often have experience with ferret care requirements, but we recommend verifying each caregiver's specific ferret experience during your initial consultation."]}),(0,j.jsxs)(a.default,{style:us.paragraph,children:[(0,j.jsx)(a.default,{style:us.bold,children:"Safe Play Supervision:"})," Ferrets are curious and can get into trouble quickly. Many experienced professionals on our platform understand ferret behavior and can provide proper supervision during playtime, but always discuss safety protocols with potential caregivers."]}),(0,j.jsxs)(a.default,{style:us.paragraph,children:[(0,j.jsx)(a.default,{style:us.bold,children:"Health Monitoring:"})," Many ferret caregivers on our platform are familiar with signs of common ferret health issues, but we recommend discussing each professional's experience level and ensuring they're comfortable recognizing when immediate attention is needed."]})]});return(0,j.jsx)(os,{seoConfig:es.ferretSitter,mainHeading:"Professional Ferret Sitting in Colorado Springs",introContent:e,whyCrittrCoveContent:t,faqItems:[{question:"Do you have experience with ferret care?",answer:"Ferret caregivers on our platform in Colorado Springs often have experience with ferret behavior, dietary needs, and safety requirements. Many understand ferret-proofing, proper feeding schedules, and enrichment activities, but we recommend verifying each professional's specific ferret experience and comfort level during your consultation."},{question:"How much does ferret sitting cost?",answer:"Ferret sitting rates typically range from $25-50 per visit, depending on the number of ferrets and care complexity. Specialized exotic pet care may cost more than standard pet sitting due to specific requirements."},{question:"What's included in ferret care services?",answer:"Ferret sitting services often include feeding on proper schedules, supervised playtime, litter box cleaning, cage maintenance, and social interaction. Many professionals also offer health monitoring and emergency contact protocols. Since each professional sets their own service offerings, we recommend discussing specific care tasks and confirming what's included before booking."}],internalLinks:[{text:"Exotic Pet Care Colorado Springs",route:"ExoticPetCareColoradoSprings"},{text:"Reptile Sitter Colorado Springs",route:"ReptileSitterColoradoSprings"},{text:"Bird Boarding Colorado Springs",route:"BirdBoardingColoradoSprings"}]})},ms={introContent:{maxWidth:800},introText:{fontSize:18,color:m.theme.colors.textSecondary,lineHeight:28,marginBottom:16,textAlign:"center"},paragraph:{fontSize:16,color:m.theme.colors.textSecondary,lineHeight:26,marginBottom:16},bold:{fontWeight:"600",color:m.theme.colors.text}},hs=()=>{const e=(0,j.jsxs)(r.default,{style:ms.introContent,children:[(0,j.jsx)(a.default,{style:ms.introText,children:"Professional bird boarding and avian care services in Colorado Springs. Connect with experienced bird sitters who understand the complex needs of parrots, cockatiels, canaries, and other feathered companions."}),(0,j.jsx)(a.default,{style:ms.introText,children:"Our avian specialists provide a variety of services including proper diet mitigation, social interaction, and environmental enrichment to keep your birds healthy and stimulated during your absence."})]}),t=(0,j.jsxs)(r.default,{style:ms.contentSection,children:[(0,j.jsxs)(a.default,{style:ms.paragraph,children:[(0,j.jsx)(a.default,{style:ms.bold,children:"Avian Care Knowledge:"})," Birds require specialized knowledge of diet, social needs, and environmental factors. Many bird caregivers on our platform are familiar with species-specific requirements and behavioral patterns, but we recommend verifying each professional's bird experience."]}),(0,j.jsxs)(a.default,{style:ms.paragraph,children:[(0,j.jsx)(a.default,{style:ms.bold,children:"Social Interaction:"})," Many birds are highly social and need regular interaction to prevent stress and behavioral issues. Bird caregivers on our platform often understand the importance of providing appropriate socialization and mental stimulation, but discuss your bird's specific social needs with potential caregivers."]}),(0,j.jsxs)(a.default,{style:ms.paragraph,children:[(0,j.jsx)(a.default,{style:ms.bold,children:"Safe Environment:"})," Bird boarding requires secure, appropriate environments with proper ventilation, lighting, and safety measures. Our professionals ensure optimal conditions for your feathered friends."]})]});return(0,j.jsx)(os,{seoConfig:es.birdBoarding,mainHeading:"Professional Bird Boarding in Colorado Springs",introContent:e,whyCrittrCoveContent:t,faqItems:[{question:"What types of birds do you care for?",answer:"Bird boarding professionals on our platform in Colorado Springs often have experience with various species including parrots, cockatiels, canaries, finches, conures, and other pet birds. Each professional's profile lists their specific avian experience, so we recommend verifying their comfort level with your bird species."},{question:"How much does bird boarding cost?",answer:"Bird boarding rates range from $30-60 per day (estimated costs that are set by each individual professional), depending on the species, care complexity, and services required. Larger parrots or birds with special dietary needs may cost more than smaller birds."},{question:"Do bird sitters provide social interaction?",answer:"Many bird caregivers on our platform understand the importance of social interaction for pet birds. They often provide appropriate talking, training reinforcement, and companionship, but we recommend discussing your bird's specific social needs and verifying each professional's comfort level with bird interaction."}],internalLinks:[{text:"Exotic Pet Care Colorado Springs",route:"ExoticPetCareColoradoSprings"},{text:"Ferret Sitter Colorado Springs",route:"FerretSitterColoradoSprings"},{text:"Reptile Sitter Colorado Springs",route:"ReptileSitterColoradoSprings"}]})},fs={introContent:{maxWidth:800},introText:{fontSize:18,color:m.theme.colors.textSecondary,lineHeight:28,marginBottom:16,textAlign:"center"},paragraph:{fontSize:16,color:m.theme.colors.textSecondary,lineHeight:26,marginBottom:16},bold:{fontWeight:"600",color:m.theme.colors.text}},ps=()=>{const e=(0,j.jsxs)(r.default,{style:fs.introContent,children:[(0,j.jsx)(a.default,{style:fs.introText,children:"Professional horse sitting and equine care services throughout Colorado. Connect with experienced horse caretakers who provide reliable barn management and equine care."}),(0,j.jsx)(a.default,{style:fs.introText,children:"Our equine specialists handle feeding, turnout, stall cleaning, and basic health monitoring to keep your horses healthy and comfortable while you're away."})]}),t=(0,j.jsxs)(r.default,{style:fs.contentSection,children:[(0,j.jsxs)(a.default,{style:fs.paragraph,children:[(0,j.jsx)(a.default,{style:fs.bold,children:"Equine Experience:"})," Horse care requires specific knowledge of equine behavior, feeding schedules, and health monitoring. Many horse caregivers on our platform have hands-on experience with equine management, but we recommend verifying each professional's equine experience and comfort level."]}),(0,j.jsxs)(a.default,{style:fs.paragraph,children:[(0,j.jsx)(a.default,{style:fs.bold,children:"Reliable Barn Care:"})," From daily feeding and turnout to stall maintenance and water checks, our horse sitters ensure your equine companions receive consistent, quality care."]}),(0,j.jsxs)(a.default,{style:fs.paragraph,children:[(0,j.jsx)(a.default,{style:fs.bold,children:"Emergency Preparedness:"})," Many horse caregivers on our platform are familiar with recognizing signs of equine health issues and often maintain contact information for local veterinarians and farriers. We recommend discussing emergency protocols and verifying each professional's comfort level with equine health monitoring."]})]});return(0,j.jsx)(os,{seoConfig:es.horseSitting,mainHeading:"Professional Horse Sitting Services in Colorado",introContent:e,whyCrittrCoveContent:t,faqItems:[{question:"What areas of Colorado do you serve for horse sitting?",answer:"We provide horse sitting services throughout Colorado including Denver metro, Colorado Springs, Fort Collins, Boulder, and rural areas. Check with individual sitters for their specific service radius."},{question:"What's included in horse sitting services?",answer:"Horse care services often include feeding, hay and water provision, turnout, stall cleaning, basic health checks, and grooming if requested. Many professionals also offer additional services like exercise, medication administration, and blanket changes. Since each professional sets their own service offerings, we recommend discussing specific care requirements and confirming what's included before booking."},{question:"Do horse sitters have insurance?",answer:"We recommend all horse sitters carry appropriate liability insurance. Many of our equine professionals have experience working at boarding facilities and understand insurance requirements for horse care."}],internalLinks:[{text:"Exotic Pet Care Colorado Springs",route:"ExoticPetCareColoradoSprings"},{text:"Dog Boarding Colorado Springs",route:"DogBoardingColoradoSprings"},{text:"Pet Boarding Colorado Springs",route:"PetBoardingColoradoSprings"}]})},ys={introContent:{maxWidth:800},introText:{fontSize:18,color:m.theme.colors.textSecondary,lineHeight:28,marginBottom:16,textAlign:"center"},paragraph:{fontSize:16,color:m.theme.colors.textSecondary,lineHeight:26,marginBottom:16},bold:{fontWeight:"600",color:m.theme.colors.text}},bs=()=>{const e=(0,j.jsxs)(r.default,{style:ys.introContent,children:[(0,j.jsx)(a.default,{style:ys.introText,children:"Expert reptile sitting services in Colorado Springs. Connect with specialized reptile caretakers who understand the complex needs of snakes, lizards, geckos, and other cold-blooded companions."}),(0,j.jsx)(a.default,{style:ys.introText,children:"Our reptile specialists have different levels of experience and expertise including maintaining proper temperatures, humidity levels, feeding schedules, and habitat conditions to keep your scaly friends healthy and comfortable."})]}),t=(0,j.jsxs)(r.default,{style:ys.contentSection,children:[(0,j.jsxs)(a.default,{style:ys.paragraph,children:[(0,j.jsx)(a.default,{style:ys.bold,children:"Reptile Expertise:"})," Reptiles require precise environmental conditions and species-specific care. Many professionals on our platform have knowledge of heating, lighting, humidity, and feeding requirements for various reptile species, though expertise levels vary. We recommend discussing your specific reptile's needs with potential caregivers to ensure they have the appropriate experience."]}),(0,j.jsxs)(a.default,{style:ys.paragraph,children:[(0,j.jsx)(a.default,{style:ys.bold,children:"Temperature Management:"})," Proper temperature gradients are critical for reptile health. Reptile caregivers on our platform often have experience with monitoring heating systems, but each professional has different levels of expertise. It's important to verify that your chosen caregiver understands your specific setup and temperature requirements."]}),(0,j.jsxs)(a.default,{style:ys.paragraph,children:[(0,j.jsx)(a.default,{style:ys.bold,children:"Species-Specific Care:"})," From ball pythons to bearded dragons, each reptile species has unique requirements. The professionals on our platform have varying experience with different species, so we encourage you to thoroughly vet potential caregivers to ensure they're comfortable with your particular reptile's needs."]})]});return(0,j.jsx)(os,{seoConfig:es.reptileSitter,mainHeading:"Professional Reptile Sitting in Colorado Springs",introContent:e,whyCrittrCoveContent:t,faqItems:[{question:"What types of reptiles do you care for?",answer:"Reptile sitters on our platform in Colorado Springs often have experience with various species including snakes (ball pythons, corn snakes, boas), lizards (bearded dragons, geckos, iguanas), turtles, and other reptilian pets. We recommend verifying with your chosen professional about their specific experience with your reptile species."},{question:"How do you maintain proper temperatures?",answer:"Many reptile sitters on our platform have knowledge of monitoring heating systems, checking thermostats, and maintaining proper temperature gradients. However, expertise levels vary, so it's important to discuss your specific setup with potential caregivers to ensure they understand the importance of basking spots and cool areas for your reptile."},{question:"What about feeding live prey?",answer:"Some reptile sitters on our platform may be comfortable handling live feeding requirements including mice, crickets, and other prey items. We recommend discussing feeding protocols and schedules with your chosen professional to verify they can accommodate your reptile's specific dietary needs."}],internalLinks:[{text:"Exotic Pet Care Colorado Springs",route:"ExoticPetCareColoradoSprings"},{text:"Bird Boarding Colorado Springs",route:"BirdBoardingColoradoSprings"},{text:"Ferret Sitter Colorado Springs",route:"FerretSitterColoradoSprings"}]})},xs={introContent:{maxWidth:800},introText:{fontSize:18,color:m.theme.colors.textSecondary,lineHeight:28,marginBottom:16,textAlign:"center"},paragraph:{fontSize:16,color:m.theme.colors.textSecondary,lineHeight:26,marginBottom:16},bold:{fontWeight:"600",color:m.theme.colors.text}},vs=()=>{const e=(0,j.jsxs)(r.default,{style:xs.introContent,children:[(0,j.jsx)(a.default,{style:xs.introText,children:"Comprehensive pet boarding services in Colorado Springs for all types of pets. From dogs and cats to exotic animals, find trusted boarding professionals who welcome all companions."}),(0,j.jsx)(a.default,{style:xs.introText,children:"Our diverse network of pet boarding specialists provides overnight care, feeding, exercise, and companionship for pets of all shapes and sizes in the Colorado Springs area."})]}),t=(0,j.jsxs)(r.default,{style:xs.contentSection,children:[(0,j.jsxs)(a.default,{style:xs.paragraph,children:[(0,j.jsx)(a.default,{style:xs.bold,children:"All Pet Types Welcome:"})," Unlike facilities that only accept certain animals, the boarding professionals on our platform often have experience with dogs, cats, exotic pets, birds, reptiles, and other unique companions. We recommend verifying each professional's experience with your specific pet type."]}),(0,j.jsxs)(a.default,{style:xs.paragraph,children:[(0,j.jsx)(a.default,{style:xs.bold,children:"Home-Like Environment:"})," Many pet boarding professionals on our platform offer care in home environments rather than institutional settings, providing comfort and reducing stress for your pets. Discuss care location preferences with potential professionals."]}),(0,j.jsxs)(a.default,{style:xs.paragraph,children:[(0,j.jsx)(a.default,{style:xs.bold,children:"Flexible Duration:"})," Whether you need overnight boarding for a weekend or extended care for longer trips, many boarding professionals on our platform can accommodate various timeframes and schedules. Discuss scheduling needs with potential caregivers."]})]});return(0,j.jsx)(os,{seoConfig:es.petBoarding,mainHeading:"Pet Boarding Services in Colorado Springs - All Pets Welcome",introContent:e,whyCrittrCoveContent:t,faqItems:[{question:"What types of pets can be boarded?",answer:"The pet boarding professionals on our platform in Colorado Springs often have experience with dogs, cats, birds, reptiles, small mammals, and various exotic pets. Each boarding provider lists their specific experience and pet type specializations, so we recommend verifying their comfort level with your particular pet type."},{question:"How much does pet boarding cost in Colorado Springs?",answer:"Pet boarding costs vary by animal type and care requirements. Dogs typically range $35-75/night, cats $25-50/night, and exotic pets $30-60/night depending on specialized care needs. No platform fees during our beta period."},{question:"What's included in pet boarding services?",answer:"Pet boarding services often include feeding, exercise (when appropriate), companionship, and basic care. Many professionals also offer additional services like grooming, medication administration, and daily photo updates. Since each professional sets their own service packages, we recommend discussing your specific pet's needs and confirming what's included before booking."}],internalLinks:[{text:"Dog Boarding Colorado Springs",route:"DogBoardingColoradoSprings"},{text:"Cat Sitting Colorado Springs",route:"CatSittingColoradoSprings"},{text:"Exotic Pet Care Colorado Springs",route:"ExoticPetCareColoradoSprings"}]})},ws={introContent:{maxWidth:800},introText:{fontSize:18,color:m.theme.colors.textSecondary,lineHeight:28,marginBottom:16,textAlign:"center"},paragraph:{fontSize:16,color:m.theme.colors.textSecondary,lineHeight:26,marginBottom:16},bold:{fontWeight:"600",color:m.theme.colors.text}},Cs=()=>{const e=(0,j.jsxs)(r.default,{style:ws.introContent,children:[(0,j.jsx)(a.default,{style:ws.introText,children:"Professional dog sitting services in Colorado Springs. Find trusted dog sitters who provide in-home care and companionship for your canine friends while you're away."}),(0,j.jsx)(a.default,{style:ws.introText,children:"Our experienced dog sitters offer personalized care including feeding, walks, playtime, and companionship to keep your dog happy and comfortable in familiar surroundings."})]}),t=(0,j.jsxs)(r.default,{style:ws.contentSection,children:[(0,j.jsxs)(a.default,{style:ws.paragraph,children:[(0,j.jsx)(a.default,{style:ws.bold,children:"In-Home Comfort:"})," Dog sitting takes place in your home, allowing your pet to maintain their routine and stay in familiar surroundings, reducing stress and anxiety."]}),(0,j.jsxs)(a.default,{style:ws.paragraph,children:[(0,j.jsx)(a.default,{style:ws.bold,children:"Personalized Attention:"})," Unlike group boarding facilities, dog sitting provides one-on-one attention and care tailored to your dog's specific needs and personality."]}),(0,j.jsxs)(a.default,{style:ws.paragraph,children:[(0,j.jsx)(a.default,{style:ws.bold,children:"Flexible Scheduling:"})," Many dog caregivers on our platform can accommodate various schedules from daily visits to overnight stays, adapting to your travel plans and your dog's care requirements. Discuss scheduling flexibility with potential professionals."]})]});return(0,j.jsx)(os,{seoConfig:es.dogSitting,mainHeading:"Professional Dog Sitting Services in Colorado Springs",introContent:e,whyCrittrCoveContent:t,faqItems:[{question:"What's the difference between dog sitting and dog boarding?",answer:"Dog sitting typically takes place in your home with your dog maintaining their familiar routine, while boarding involves taking your dog to another location. Dog sitting often provides more personalized, one-on-one attention."},{question:"How much does dog sitting cost in Colorado Springs?",answer:"Dog sitting rates in Colorado Springs range from $25-60 per visit or $50-150 per overnight stay, depending on professional, duration, services included, and your dog's specific needs. Our beta platform has no booking fees."},{question:"What services are included with dog sitting?",answer:"Dog sitting services often include feeding, walks, playtime, companionship, and basic care. Many professionals also offer additional services like grooming, medication administration, plant watering, and mail collection. Since each professional creates their own service packages, we recommend discussing your specific needs and confirming what's included before booking."}],internalLinks:[{text:"Dog Boarding Colorado Springs",route:"DogBoardingColoradoSprings"},{text:"Dog Walker Colorado Springs",route:"DogWalkerColoradoSprings"},{text:"Cat Sitting Colorado Springs",route:"CatSittingColoradoSprings"}]})},Ss={sitemapContainer:{maxWidth:"800px",margin:"0 auto",padding:"20px",fontFamily:"Arial, sans-serif",lineHeight:"1.6",color:"#333"},title:{fontSize:"2.5rem",fontWeight:"bold",color:"#2c3e50",marginBottom:"20px",textAlign:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"#ffffff",padding:"30px",borderRadius:"10px",margin:"0 0 40px 0"},description:{fontSize:"1.1rem",color:"#6c757d",marginBottom:"40px",textAlign:"center",maxWidth:"600px",margin:"0 auto 40px auto"},linksContainer:{backgroundColor:"#ffffff",borderRadius:"10px",padding:"30px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginBottom:"30px"},sectionTitle:{fontSize:"1.5rem",fontWeight:"600",color:"#2c3e50",marginBottom:"20px",paddingBottom:"10px",borderBottom:"2px solid #e9ecef"},sectionDescription:{fontSize:"0.9rem",color:"#6c757d",marginBottom:"15px",fontStyle:"italic"},linksList:{listStyle:"none",padding:"0",margin:"0"},linkItem:{marginBottom:"15px",padding:"15px",backgroundColor:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef",transition:"all 0.3s ease"},link:{color:"#667eea",textDecoration:"none",fontSize:"16px",fontWeight:"500",display:"block",marginBottom:"5px"},urlPath:{color:"#6c757d",fontSize:"13px",fontFamily:"Courier New, monospace",display:"block"},footer:{textAlign:"center",padding:"20px",borderTop:"1px solid #e9ecef",marginTop:"40px"},footerText:{color:"#6c757d",fontSize:"14px"}},js=i.default.create({container:{flex:1,backgroundColor:"#f8f9fa"},contentContainer:{padding:20},header:{marginBottom:30,paddingVertical:30,paddingHorizontal:20,backgroundColor:"#667eea",borderRadius:10,alignItems:"center"},title:{fontSize:28,fontWeight:"bold",color:"#ffffff",marginBottom:15,textAlign:"center"},description:{fontSize:16,color:"#ffffff",textAlign:"center",opacity:.9,lineHeight:24},section:{backgroundColor:"#ffffff",borderRadius:10,padding:25,marginBottom:30},sectionTitle:{fontSize:20,fontWeight:"600",color:"#2c3e50",marginBottom:20,paddingBottom:10,borderBottomWidth:2,borderBottomColor:"#e9ecef"},linkItem:{padding:15,backgroundColor:"#f8f9fa",borderRadius:8,borderWidth:1,borderColor:"#e9ecef",marginBottom:10},linkTitle:{fontSize:16,fontWeight:"500",color:"#667eea",marginBottom:5},linkPath:{fontSize:13,color:"#6c757d",fontFamily:"monospace"},footer:{padding:20,alignItems:"center",borderTopWidth:1,borderTopColor:"#e9ecef",marginTop:20},footerText:{color:"#6c757d",fontSize:14,textAlign:"center"}}),Ts=()=>{const[e,t]=n.useState(!0),o=(0,b.useNavigation)();n.useEffect((()=>{if((0,U.debugLog)("MBA1001: SiteMap component mounted",{platform:"web",pathname:window.location.pathname}),"undefined"!==typeof document){document.title="CrittrCove Sitemap";let e=document.querySelector('meta[name="description"]');e||(e=document.createElement("meta"),e.name="description",document.head.appendChild(e)),e.content="Complete sitemap of CrittrCove - Find all pages including pet care services, dog boarding, cat sitting, and more across Colorado Springs."}const e=setTimeout((()=>{(0,U.debugLog)("MBA1001: SiteMap setting loading to false"),t(!1)}),100);return()=>{(0,U.debugLog)("MBA1001: SiteMap component unmounting"),clearTimeout(e)}}),[]),(0,b.useFocusEffect)(n.useCallback((()=>((0,U.debugLog)("MBA1001: SiteMap component focused",{platform:"web"}),()=>{(0,U.debugLog)("MBA1001: SiteMap component unfocused")})),[]));const i=[{url:"/",title:"Home"},{url:"/signin",title:"Sign In"},{url:"/signup",title:"Sign Up"},{url:"/SearchProfessionalsListing",title:"Search Professionals"},{url:"/contact-us",title:"Contact Us"},{url:"/privacy-policy",title:"Privacy Policy"},{url:"/terms-of-service",title:"Terms of Service"}],s=[{url:"/dog-boarding-colorado-springs",title:"Dog Boarding Colorado Springs"},{url:"/dog-walker-colorado-springs",title:"Dog Walker Colorado Springs"},{url:"/dog-sitting-colorado-springs",title:"Dog Sitting Colorado Springs"},{url:"/cat-sitting-colorado-springs",title:"Cat Sitting Colorado Springs"},{url:"/pet-boarding-colorado-springs",title:"Pet Boarding Colorado Springs"},{url:"/exotic-pet-care-colorado-springs",title:"Exotic Pet Care Colorado Springs"},{url:"/ferret-sitter-colorado-springs",title:"Ferret Sitter Colorado Springs"},{url:"/reptile-sitter-colorado-springs",title:"Reptile Sitter Colorado Springs"},{url:"/bird-boarding-colorado-springs",title:"Bird Boarding Colorado Springs"},{url:"/horse-sitting-colorado",title:"Horse Sitting Colorado"}],l=[{url:"/blog",title:"Blog"},{url:"/blog-post?postId=blog_1",title:"Blog Post 1"},{url:"/blog-post?postId=blog_2",title:"Blog Post 2"},{url:"/blog-post?postId=blog_3",title:"Blog Post 3"}],d=i.length+s.length+l.length;return e?((0,U.debugLog)("MBA1001: SiteMap showing loading state"),(0,j.jsx)(r.default,{style:js.container,children:(0,j.jsxs)(r.default,{style:js.contentContainer,children:[(0,j.jsx)(a.default,{style:js.title,children:"Site Map - CrittrCove"}),(0,j.jsx)(a.default,{style:js.description,children:"Loading site map..."})]})})):((0,U.debugLog)("MBA1001: SiteMap rendering full content with",{urlCount:d}),(0,j.jsx)(X.default,{style:js.container,contentContainerStyle:js.contentContainer,children:(0,j.jsxs)("div",{style:Ss.sitemapContainer,children:[(0,j.jsx)("h1",{style:Ss.title,children:"Site Map - CrittrCove"}),(0,j.jsx)("p",{style:Ss.description,children:"CrittrCove is a comprehensive pet care platform connecting pet owners with professional pet sitters, walkers, and caregivers across Colorado. Find reliable care for dogs, cats, exotic pets, horses, and more."}),(0,j.jsxs)("div",{style:Ss.linksContainer,children:[(0,j.jsxs)("h2",{style:Ss.sectionTitle,children:["Main Pages (",i.length,")"]}),(0,j.jsx)("p",{style:Ss.sectionDescription,children:"Core pages for user interaction and platform functionality"}),(0,j.jsx)("ul",{style:Ss.linksList,children:i.map(((e,t)=>(0,j.jsxs)("li",{style:Ss.linkItem,children:[(0,j.jsx)("a",{href:e.url,style:Ss.link,title:"Navigate to ".concat(e.title),children:e.title}),(0,j.jsx)("span",{style:Ss.urlPath,children:e.url})]},t)))})]}),(0,j.jsxs)("div",{style:Ss.linksContainer,children:[(0,j.jsxs)("h2",{style:Ss.sectionTitle,children:["SEO Pages (",s.length,")"]}),(0,j.jsx)("p",{style:Ss.sectionDescription,children:"Specialized pages for different pet care services in Colorado Springs"}),(0,j.jsx)("ul",{style:Ss.linksList,children:s.map(((e,t)=>(0,j.jsxs)("li",{style:Ss.linkItem,children:[(0,j.jsx)("a",{href:"#",style:Ss.link,title:"Navigate to ".concat(e.title),onClick:t=>{t.preventDefault(),(e=>{const t={"/dog-boarding-colorado-springs":"DogBoardingColoradoSprings","/dog-walker-colorado-springs":"DogWalkerColoradoSprings","/dog-sitting-colorado-springs":"DogSittingColoradoSprings","/cat-sitting-colorado-springs":"CatSittingColoradoSprings","/pet-boarding-colorado-springs":"PetBoardingColoradoSprings","/exotic-pet-care-colorado-springs":"ExoticPetCareColoradoSprings","/ferret-sitter-colorado-springs":"FerretSitterColoradoSprings","/reptile-sitter-colorado-springs":"ReptileSitterColoradoSprings","/bird-boarding-colorado-springs":"BirdBoardingColoradoSprings","/horse-sitting-colorado":"HorseSittingColorado"}[e];t&&o.navigate(t)})(e.url)},children:e.title}),(0,j.jsx)("span",{style:Ss.urlPath,children:e.url})]},t)))})]}),(0,j.jsxs)("div",{style:Ss.linksContainer,children:[(0,j.jsxs)("h2",{style:Ss.sectionTitle,children:["Blog Pages (",l.length,")"]}),(0,j.jsx)("p",{style:Ss.sectionDescription,children:"Educational content and blog posts about pet care"}),(0,j.jsx)("ul",{style:Ss.linksList,children:l.map(((e,t)=>(0,j.jsxs)("li",{style:Ss.linkItem,children:[(0,j.jsx)("a",{href:e.url,style:Ss.link,title:"Navigate to ".concat(e.title),children:e.title}),(0,j.jsx)("span",{style:Ss.urlPath,children:e.url})]},t)))})]}),(0,j.jsx)("footer",{style:Ss.footer,children:(0,j.jsxs)("p",{style:Ss.footerText,children:["Last updated: ",(new Date).toLocaleDateString()," | Total pages: ",d]})})]})}))},Bs=(e,t)=>{const o=e<=900,n=o?0:(t?60:250)+20;return i.default.create({container:{flex:1,backgroundColor:m.theme.colors.background,marginLeft:n,paddingRight:o?0:40},scrollContainer:{flexGrow:1,padding:20,justifyContent:"center",maxWidth:o?"100%":800,alignSelf:"center",width:"100%"},header:{alignItems:"center",marginBottom:30},title:{fontSize:24,fontWeight:"bold",color:m.theme.colors.error,textAlign:"center",marginTop:15},subtitle:{fontSize:16,color:m.theme.colors.error,textAlign:"center",marginTop:5,fontWeight:"600"},content:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:15,padding:25},confirmationText:{fontSize:18,color:m.theme.colors.text,textAlign:"center",marginBottom:25,lineHeight:24},warningContainer:{backgroundColor:"#fff3cd",borderRadius:10,padding:20,marginBottom:20,borderWidth:1,borderColor:"#ffeaa7"},warningTitle:{fontSize:16,fontWeight:"bold",color:"#856404",marginBottom:10},warningItem:{fontSize:14,color:"#856404",marginBottom:5,lineHeight:20},retentionInfo:{backgroundColor:m.theme.colors.surface,borderRadius:8,padding:15,marginBottom:30},retentionText:{fontSize:12,color:m.theme.colors.secondary,lineHeight:18,textAlign:"center"},buttonContainer:{flexDirection:"row",justifyContent:"space-between",gap:15},cancelButton:{flex:1,backgroundColor:m.theme.colors.surface,borderWidth:2,borderColor:m.theme.colors.border,padding:15,borderRadius:10,alignItems:"center"},cancelButtonText:{color:m.theme.colors.text,fontWeight:"600",fontSize:16},confirmButton:{flex:1,backgroundColor:m.theme.colors.error,padding:15,borderRadius:10,alignItems:"center"},confirmButtonText:{color:"white",fontWeight:"bold",fontSize:16},disabledButton:{opacity:.6},errorContainer:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:15,padding:25,alignItems:"center"},errorTitle:{fontSize:20,fontWeight:"bold",color:m.theme.colors.error,marginTop:10,marginBottom:15},errorMessage:{fontSize:16,color:m.theme.colors.text,textAlign:"center",marginBottom:25,lineHeight:22},backButton:{backgroundColor:m.theme.colors.primary,padding:15,borderRadius:10,minWidth:150,alignItems:"center"},backButtonText:{color:"white",fontWeight:"600",fontSize:16},successContainer:{backgroundColor:m.theme.colors.surfaceContrast,borderRadius:15,padding:25,alignItems:"center"},successTitle:{fontSize:24,fontWeight:"bold",color:"#4caf50",textAlign:"center",marginTop:15,marginBottom:10},successMessage:{fontSize:16,color:m.theme.colors.text,textAlign:"center",marginBottom:25,lineHeight:22},infoContainer:{backgroundColor:m.theme.colors.surface,borderRadius:10,padding:20,marginBottom:25,width:"100%"},infoTitle:{fontSize:16,fontWeight:"bold",color:m.theme.colors.text,marginBottom:10},infoItem:{fontSize:14,color:m.theme.colors.text,marginBottom:5,lineHeight:20},logoutMessage:{fontSize:14,color:m.theme.colors.secondary,textAlign:"center",fontStyle:"italic"}})},ks=({route:e,navigation:t})=>{const[o,i]=(0,n.useState)(!1),[s,l]=(0,n.useState)(!1),[d,c]=(0,n.useState)(null),[u,g]=(0,n.useState)(null),f=E(),{signOut:y,screenWidth:b,isCollapsed:w}=(0,n.useContext)(h.AuthContext),[C,T]=(0,n.useState)(b<=900);(0,n.useEffect)((()=>{T(b<=900)}),[b]),(0,n.useEffect)((()=>{let e=null;e=new URLSearchParams(window.location.search).get("token");e?g(e):c("Invalid confirmation link. The deletion token is missing.")}),[e.params]);const B=Bs(b,w);return s?(0,j.jsx)(r.default,{style:B.container,children:(0,j.jsx)(X.default,{contentContainerStyle:B.scrollContainer,children:(0,j.jsxs)(r.default,{style:B.successContainer,children:[(0,j.jsx)(S.default,{name:"check-circle",size:80,color:"#4caf50"}),(0,j.jsx)(a.default,{style:B.successTitle,children:"Account Deletion Confirmed"}),(0,j.jsx)(a.default,{style:B.successMessage,children:"Your CrittrCove account has been successfully deleted."}),(0,j.jsxs)(r.default,{style:B.infoContainer,children:[(0,j.jsx)(a.default,{style:B.infoTitle,children:"What happened:"}),(0,j.jsx)(a.default,{style:B.infoItem,children:"\u2022 Your profile and personal information have been anonymized"}),(0,j.jsx)(a.default,{style:B.infoItem,children:"\u2022 Any future bookings have been cancelled and other parties notified"}),(0,j.jsx)(a.default,{style:B.infoItem,children:'\u2022 Your name in existing conversations will show as "Deleted User"'}),(0,j.jsx)(a.default,{style:B.infoItem,children:"\u2022 Some data may be retained for legal compliance"})]}),(0,j.jsx)(a.default,{style:B.logoutMessage,children:"You will be logged out automatically in a few seconds."})]})})}):(0,j.jsx)(r.default,{style:B.container,children:(0,j.jsxs)(X.default,{contentContainerStyle:B.scrollContainer,children:[(0,j.jsxs)(r.default,{style:B.header,children:[(0,j.jsx)(S.default,{name:"alert-circle",size:60,color:m.theme.colors.error}),(0,j.jsx)(a.default,{style:B.title,children:"Confirm Account Deletion"}),(0,j.jsx)(a.default,{style:B.subtitle,children:"This action cannot be undone"})]}),d?(0,j.jsxs)(r.default,{style:B.errorContainer,children:[(0,j.jsx)(S.default,{name:"close-circle",size:40,color:m.theme.colors.error}),(0,j.jsx)(a.default,{style:B.errorTitle,children:"Error"}),(0,j.jsx)(a.default,{style:B.errorMessage,children:d}),(0,j.jsx)(v.default,{style:B.backButton,onPress:()=>t.navigate("Settings"),children:(0,j.jsx)(a.default,{style:B.backButtonText,children:"Go to Settings"})})]}):(0,j.jsxs)(r.default,{style:B.content,children:[(0,j.jsx)(a.default,{style:B.confirmationText,children:"You're about to permanently delete your CrittrCove account. Are you sure you want to proceed?"}),(0,j.jsxs)(r.default,{style:B.warningContainer,children:[(0,j.jsx)(a.default,{style:B.warningTitle,children:"\u26a0\ufe0f This will:"}),(0,j.jsx)(a.default,{style:B.warningItem,children:"\u2022 Remove your profile and personal information"}),(0,j.jsx)(a.default,{style:B.warningItem,children:"\u2022 Cancel all future bookings (other parties will be notified)"}),(0,j.jsx)(a.default,{style:B.warningItem,children:"\u2022 Anonymize your name in existing conversations"}),(0,j.jsx)(a.default,{style:B.warningItem,children:"\u2022 Process deletion within 60 days"})]}),(0,j.jsx)(r.default,{style:B.retentionInfo,children:(0,j.jsx)(a.default,{style:B.retentionText,children:"Some data may be retained for legal compliance (financial records, booking history) as outlined in our Terms of Service."})}),(0,j.jsxs)(r.default,{style:B.buttonContainer,children:[(0,j.jsx)(v.default,{style:B.cancelButton,onPress:()=>{t.navigate("Settings")},disabled:o,children:(0,j.jsx)(a.default,{style:B.cancelButtonText,children:"Cancel"})}),(0,j.jsx)(v.default,{style:[B.confirmButton,o&&B.disabledButton],onPress:async()=>{if(u){i(!0);try{await x.default.post("".concat(p.API_BASE_URL,"/api/users/v1/confirm-deletion/"),{token:u});l(!0),f({message:"Account deletion completed successfully.",type:"success",duration:3e3}),setTimeout((()=>{y(),t.reset({index:0,routes:[{name:"Home"}]})}),3e3)}catch(d){console.error("Error confirming account deletion:",d);let t="Failed to confirm account deletion.";d.response?.data?.error&&(t=d.response.data.error),c(t),f({message:t,type:"error",duration:5e3})}finally{i(!1)}}else c("No deletion token provided.")},disabled:o,children:o?(0,j.jsx)(A.default,{size:"small",color:"white"}):(0,j.jsx)(a.default,{style:B.confirmButtonText,children:"Delete My Account"})})]})]})]})})};o(18698);const As=(0,d.default)(),_s=((0,u.default)(),[{name:"Home",component:function({navigation:e}){const{colors:t}=(0,ne.useTheme)(),{screenWidth:a}=(0,n.useContext)(h.AuthContext),i=a<660,[s,l]=(0,n.useState)(!1),d=({data:e,renderItem:t,title:o,cardWidth:a=320,onTitlePress:i})=>{const s=n.useRef(null),[l,d]=(0,n.useState)(0),[c,u]=(0,n.useState)(!1),g=n.useRef(null);(0,n.useEffect)((()=>(c||(g.current=setInterval((()=>{if(s.current){const t=(l+1)%e.length;m(t)}}),3e3)),()=>{g.current&&clearInterval(g.current)})),[l,c,e.length]);const m=e=>{s.current&&(s.current.scrollTo({x:e*a,animated:!0}),d(e))},h=()=>{setTimeout((()=>{u(!1)}),1e3)};return(0,j.jsxs)(r.default,{style:We.section,children:[i?(0,j.jsx)(v.default,{onPress:i,children:(0,j.jsx)(oe.default,{style:[We.sectionTitle,{textDecorationLine:"underline"}],children:o})}):(0,j.jsx)(oe.default,{style:We.sectionTitle,children:o}),(0,j.jsxs)(r.default,{style:We.scrollContainer,children:[(0,j.jsx)(X.default,{ref:s,horizontal:!0,showsHorizontalScrollIndicator:!0,style:[We.scrollContainer,{WebkitOverflowScrolling:"touch"}],contentContainerStyle:We.scrollContent,onScroll:e=>{const t=e.nativeEvent.contentOffset.x,o=Math.round(t/a);d(o)},scrollEventThrottle:16,pagingEnabled:!1,onScrollBeginDrag:()=>{u(!0),g.current&&clearInterval(g.current)},onScrollEndDrag:h,onMomentumScrollEnd:h,children:e.map(((e,o)=>t(e,o)))}),(0,j.jsx)(r.default,{style:We.scrollIndicators,children:e.map(((e,t)=>(0,j.jsx)(v.default,{onPress:()=>(e=>{u(!0),m(e),setTimeout((()=>{u(!1)}),1e3)})(t),style:We.scrollIndicatorButton,children:(0,j.jsx)(r.default,{style:[We.scrollIndicator,l===t&&We.scrollIndicatorActive]})},t)))}),!1]})]})},c=({icon:e,title:t,description:o,color:n})=>{const a={container:{width:i?"90%":"45%",minWidth:i?"auto":300,maxWidth:500,padding:20,backgroundColor:"#fff",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,marginBottom:20,alignSelf:"center"},header:{flexDirection:"column",alignItems:"center",marginBottom:15},iconContainer:{width:60,height:60,borderRadius:30,backgroundColor:"".concat(m.theme.colors.primary,"15"),justifyContent:"center",alignItems:"center",marginBottom:15},title:{fontSize:20,fontWeight:"bold",color:m.theme.colors.text,fontFamily:m.theme.fonts.header.fontFamily,textAlign:"center",marginBottom:10},description:{fontSize:16,lineHeight:24,color:m.theme.colors.text,fontFamily:m.theme.fonts.regular.fontFamily,textAlign:"center"}};return(0,j.jsxs)(r.default,{style:a.container,children:[(0,j.jsxs)(r.default,{style:a.header,children:[(0,j.jsx)(r.default,{style:a.iconContainer,children:(0,j.jsx)(S.default,{name:e,size:32,color:n})}),(0,j.jsx)(oe.default,{style:a.title,children:t})]}),(0,j.jsx)(oe.default,{style:a.description,children:o})]})};return(0,j.jsxs)(X.default,{style:We.container,contentContainerStyle:We.contentContainer,showsVerticalScrollIndicator:!0,bounces:!1,overScrollMode:"never",children:[(0,j.jsxs)(r.default,{style:We.heroSection,children:[(0,j.jsx)(Q.default,{source:o(32571),style:We.heroImage,resizeMode:"cover"}),(0,j.jsxs)(r.default,{style:We.heroContent,children:[(0,j.jsx)(oe.default,{style:We.heroText,children:"Welcome to CrittrCove"}),(0,j.jsx)(v.default,{style:We.heroSignupButton,onPress:()=>(0,g.navigateToFrom)(e,"SignUp","Home"),children:(0,j.jsx)(oe.default,{style:We.heroSignupButtonText,children:"Sign Up Today"})})]})]}),(0,j.jsxs)(r.default,{style:We.serviceHighlightsSection,children:[(0,j.jsx)(oe.default,{style:We.mainServiceTitle,children:"Marketplace for Pet Owners and Care Professionals"}),(0,j.jsxs)(r.default,{style:[We.servicesGrid,{flexDirection:i?"column":"row",alignItems:i?"center":"flex-start"}],children:[(0,j.jsx)(c,{icon:"paw",title:"All Animals Welcome",description:"From everyday pets to exotic companions, CrittrCove is a marketplace where you can find independent professionals offerring care for a wide variety of animals.",color:m.theme.colors.mainColors.senary}),(0,j.jsx)(c,{icon:"calendar-clock",title:"Flexible Booking Options",description:"Book single visits, multiple days, or set up recurring services. Create subscription plans or schedule services months in advance.",color:m.theme.colors.mainColors.quinary}),(0,j.jsx)(c,{icon:"shield-check",title:"Verified Badges",description:"All professionals are allowed on the platform, and clients can see their verified badges to ensure they are who they say they are.",color:m.theme.colors.mainColors.main}),(0,j.jsx)(c,{icon:"tune-variant",title:"Customizable Services",description:"Professionals can create custom service packages and pricing plans tailored to your specific needs and preferences.",color:m.theme.colors.mainColors.quaternary})]})]}),(0,j.jsx)((()=>(0,j.jsxs)(r.default,{style:We.serviceLinksSection,children:[(0,j.jsx)(oe.default,{style:We.serviceLinksTitle,children:"Find Pet Care Services in Colorado Springs"}),(0,j.jsx)(oe.default,{style:We.serviceLinksSubtitle,children:"Connect with trusted professionals for all your pet care needs"}),(0,j.jsx)(r.default,{style:[We.serviceLinksGrid,{flexDirection:i?"column":"row",flexWrap:i?"nowrap":"wrap"}],children:[{title:"Dog Boarding",description:"Overnight care for your dog in Colorado Springs",route:"DogBoardingColoradoSprings"},{title:"Exotic Pet Care",description:"Specialized care for reptiles, birds, and unique pets",route:"ExoticPetCareColoradoSprings"},{title:"Cat Sitting",description:"In-home care for your feline friends",route:"CatSittingColoradoSprings"},{title:"Dog Walking",description:"Professional dog walking services",route:"DogWalkerColoradoSprings"},{title:"Pet Boarding",description:"Boarding for all types of pets",route:"PetBoardingColoradoSprings"},{title:"Bird Boarding",description:"Specialized avian care services",route:"BirdBoardingColoradoSprings"}].map(((t,o)=>(0,j.jsxs)(v.default,{style:[We.serviceLinkCard,{width:i?"90%":"31%",marginBottom:15,marginRight:i?0:"1.5%"}],onPress:()=>(0,g.navigateToFrom)(e,t.route,"Home"),children:[(0,j.jsx)(oe.default,{style:We.serviceLinkTitle,children:t.title}),(0,j.jsx)(oe.default,{style:We.serviceLinkDescription,children:t.description}),(0,j.jsx)(r.default,{style:We.serviceLinkArrow,children:(0,j.jsx)(S.default,{name:"arrow-right",size:16,color:m.theme.colors.primary})})]},o)))}),(0,j.jsx)(v.default,{style:We.viewAllServicesButton,onPress:()=>(0,g.navigateToFrom)(e,"SearchProfessionalsListing","Home"),children:(0,j.jsx)(oe.default,{style:We.viewAllServicesText,children:"View All Services"})})]})),{}),(0,j.jsx)((()=>{const[t,o]=(0,n.useState)("owners"),a=["#515d6c","#516a6c","#516C61","#6A6C51"],i={flexDirection:"row",marginBottom:20,alignItems:"flex-start",width:"100%"},s={flex:1,marginLeft:5};return(0,j.jsxs)(r.default,{style:We.featuresSection,children:[(0,j.jsx)(oe.default,{style:We.sectionTitle,children:"How It Works"}),(0,j.jsxs)(r.default,{style:We.toggleContainer,children:[(0,j.jsx)(v.default,{style:[We.toggleButton,"owners"===t&&We.toggleButtonActive],onPress:()=>o("owners"),children:(0,j.jsx)(oe.default,{style:[We.toggleButtonText,"owners"===t&&We.toggleButtonTextActive],children:"For Pet Owners"})}),(0,j.jsx)(v.default,{style:[We.toggleButton,"sitters"===t&&We.toggleButtonActive],onPress:()=>o("sitters"),children:(0,j.jsx)(oe.default,{style:[We.toggleButtonText,"sitters"===t&&We.toggleButtonTextActive],children:"For Pet Professionals"})})]}),(0,j.jsxs)(r.default,{style:We.featuresContainer,children:["owners"===t&&(0,j.jsxs)(r.default,{style:We.featureColumn,children:[(0,j.jsx)(oe.default,{style:We.columnTitle,children:"For Pet Owners"}),(0,j.jsxs)(r.default,{style:We.featuresList,children:[(0,j.jsxs)(r.default,{style:i,children:[(0,j.jsx)(r.default,{style:[We.featureIconCircle,{backgroundColor:a[0]}],children:(0,j.jsx)(le.default,{name:"person-running",size:24,color:"white"})}),(0,j.jsxs)(r.default,{style:s,children:[(0,j.jsx)(oe.default,{style:We.featureTitle,children:"Complete Your Profile"}),(0,j.jsx)(oe.default,{style:We.featureText,children:"Submit details about you and your requirements."})]})]}),(0,j.jsxs)(r.default,{style:i,children:[(0,j.jsx)(r.default,{style:[We.featureIconCircle,{backgroundColor:a[1]}],children:(0,j.jsx)(S.default,{name:"horse-human",size:24,color:"white"})}),(0,j.jsxs)(r.default,{style:s,children:[(0,j.jsx)(oe.default,{style:We.featureTitle,children:"Complete Pet Profile"}),(0,j.jsx)(oe.default,{style:We.featureText,children:"Submit details about your pet and sitting requirements."})]})]}),(0,j.jsxs)(r.default,{style:i,children:[(0,j.jsx)(r.default,{style:[We.featureIconCircle,{backgroundColor:a[2]}],children:(0,j.jsx)(S.default,{name:"professional-hexagon",size:24,color:"white"})}),(0,j.jsxs)(r.default,{style:s,children:[(0,j.jsx)(oe.default,{style:We.featureTitle,children:"Search for Pro's"}),(0,j.jsx)(oe.default,{style:We.featureText,children:"You can use our marketplace to find the best pro for your desired service."})]})]}),(0,j.jsxs)(r.default,{style:i,children:[(0,j.jsx)(r.default,{style:[We.featureIconCircle,{backgroundColor:a[3]}],children:(0,j.jsx)(ae.default,{name:"calendar-check",size:24,color:"white"})}),(0,j.jsxs)(r.default,{style:s,children:[(0,j.jsx)(oe.default,{style:We.featureTitle,children:"Confirm Your Booking"}),(0,j.jsx)(oe.default,{style:We.featureText,children:"Coordinate directly with your professional to finalize details."})]})]})]}),(0,j.jsx)(r.default,{style:We.buttonContainer,children:(0,j.jsx)(v.default,{style:We.actionButton,onPress:()=>(0,g.navigateToFrom)(e,"SignUp","Home"),children:(0,j.jsx)(oe.default,{style:We.buttonText,children:"Sign up Today!"})})})]}),"sitters"===t&&(0,j.jsxs)(r.default,{style:We.featureColumn,children:[(0,j.jsx)(oe.default,{style:We.columnTitle,children:"For Pet Professionals"}),(0,j.jsxs)(r.default,{style:We.featuresList,children:[(0,j.jsxs)(r.default,{style:i,children:[(0,j.jsx)(r.default,{style:[We.featureIconCircle,{backgroundColor:a[0]}],children:(0,j.jsx)(re.default,{name:"sign-in",size:24,color:"white"})}),(0,j.jsxs)(r.default,{style:s,children:[(0,j.jsx)(oe.default,{style:We.featureTitle,children:"Apply to Join Pro Community"}),(0,j.jsx)(oe.default,{style:We.featureText,children:"Submit your specialties, documents, bio, and availability to begin."})]})]}),(0,j.jsxs)(r.default,{style:i,children:[(0,j.jsx)(r.default,{style:[We.featureIconCircle,{backgroundColor:a[1]}],children:(0,j.jsx)(S.default,{name:"plus-circle",size:24,color:"white"})}),(0,j.jsxs)(r.default,{style:s,children:[(0,j.jsx)(oe.default,{style:We.featureTitle,children:"Create Services"}),(0,j.jsx)(oe.default,{style:We.featureText,children:"Create services to offer to pet owners."})]})]}),(0,j.jsxs)(r.default,{style:i,children:[(0,j.jsx)(r.default,{style:[We.featureIconCircle,{backgroundColor:a[2]}],children:(0,j.jsx)(le.default,{name:"handshake-simple",size:24,color:"white"})}),(0,j.jsxs)(r.default,{style:s,children:[(0,j.jsx)(oe.default,{style:We.featureTitle,children:"Get Matched with Owners"}),(0,j.jsx)(oe.default,{style:We.featureText,children:"Pet owners in your area will reach out to you for yourservices."})]})]}),(0,j.jsxs)(r.default,{style:i,children:[(0,j.jsx)(r.default,{style:[We.featureIconCircle,{backgroundColor:a[3]}],children:(0,j.jsx)(de.default,{name:"auto-graph",size:24,color:"white"})}),(0,j.jsxs)(r.default,{style:s,children:[(0,j.jsx)(oe.default,{style:We.featureTitle,children:"Grow Your Business"}),(0,j.jsx)(oe.default,{style:We.featureText,children:"Manage bookings and get support as you build your pet service business."})]})]})]}),(0,j.jsx)(r.default,{style:We.buttonContainer,children:(0,j.jsx)(v.default,{style:We.actionButton,onPress:()=>(0,g.navigateToFrom)(e,"SignUp","Home"),children:(0,j.jsx)(oe.default,{style:We.buttonText,children:"Become a Professional"})})})]})]})]})}),{}),(0,j.jsx)((()=>(0,j.jsx)(d,{data:Fe,renderItem:(e,t)=>(0,j.jsxs)(r.default,{style:We.reviewCard,children:[(0,j.jsx)(oe.default,{style:We.reviewText,children:e.text}),(0,j.jsxs)(r.default,{style:We.reviewAuthorContainer,children:[(0,j.jsx)(Ee,{source:e.image,style:We.reviewerImage}),(0,j.jsxs)(r.default,{children:[(0,j.jsx)(oe.default,{style:We.reviewAuthorName,children:e.author}),(0,j.jsx)(oe.default,{style:We.reviewAuthorTitle,children:"Owner Review"}),(0,j.jsx)(r.default,{style:We.starsContainer,children:[1,2,3,4,5].map(((e,t)=>(0,j.jsx)(S.default,{name:"star",size:16,color:m.theme.colors.primary,style:We.starIcon},t)))})]})]})]},t),title:"Kind Words From Users"})),{}),(0,j.jsx)((()=>(0,j.jsx)(d,{data:Le,renderItem:(t,o)=>(0,j.jsx)(v.default,{style:[We.blogCard,{marginRight:o===Le.length-1?0:10}],onPress:()=>(0,g.navigateToFrom)(e,"BlogPost","Home",{postId:t.id}),children:(0,j.jsxs)(r.default,{style:We.authorContainer,children:[t.author.profilePicture&&(0,j.jsx)(Q.default,{source:"string"===typeof t.author.profilePicture?{uri:t.author.profilePicture}:t.author.profilePicture,style:We.authorImage,onError:e=>{console.log("Image load error:",e)}}),(0,j.jsxs)(r.default,{style:We.blogContent,children:[(0,j.jsx)(oe.default,{style:[We.title,{color:m.theme.colors.primary}],numberOfLines:2,children:t.title}),(0,j.jsxs)(r.default,{style:We.authorInfo,children:[(0,j.jsx)(oe.default,{style:[We.authorName,{color:m.theme.colors.secondary}],children:t.author.name}),(0,j.jsx)(oe.default,{style:We.dot,children:" \u2022 "}),(0,j.jsx)(oe.default,{style:We.readTime,children:t.readTime})]}),(0,j.jsxs)(oe.default,{style:We.preview,numberOfLines:3,children:[t.content.slice(0,100),"..."]}),(0,j.jsx)(r.default,{style:We.tags,children:t.tags.slice(0,2).map(((e,t)=>(0,j.jsx)(r.default,{style:[We.tag,{backgroundColor:m.theme.colors.primary+"20"}],children:(0,j.jsx)(oe.default,{style:[We.tagText,{color:m.theme.colors.primary}],children:e})},t)))}),(0,j.jsxs)(r.default,{style:We.stats,children:[(0,j.jsxs)(r.default,{style:We.stat,children:[(0,j.jsx)(S.default,{name:"heart-outline",size:16,color:m.theme.colors.secondary}),(0,j.jsx)(oe.default,{style:We.statText,children:t.likes})]}),(0,j.jsxs)(r.default,{style:We.stat,children:[(0,j.jsx)(S.default,{name:"comment-outline",size:16,color:m.theme.colors.secondary}),(0,j.jsx)(oe.default,{style:We.statText,children:t.comments})]}),(0,j.jsxs)(r.default,{style:We.stat,children:[(0,j.jsx)(S.default,{name:"share-outline",size:16,color:m.theme.colors.secondary}),(0,j.jsx)(oe.default,{style:We.statText,children:t.shares})]})]})]})]})},t.id),title:"Blog",cardWidth:320,onTitlePress:()=>(0,g.navigateToFrom)(e,"Blog","Home")})),{}),(0,j.jsx)(se,{}),(0,j.jsx)((()=>{const[e,t]=(0,n.useState)(""),[o,a]=(0,n.useState)(""),[i,s]=(0,n.useState)(""),[l,d]=(0,n.useState)(!1),[c,u]=(0,n.useState)(!1),g=Re?Re("mkgobpro"):[null,null],[h,f]=g,p=h&&h.succeeded;if(c||p)return(0,j.jsx)(r.default,{style:We.contactSection,children:(0,j.jsxs)(r.default,{style:We.contactContainer,children:[(0,j.jsx)(oe.default,{style:[We.sectionTitle,{color:m.theme.colors.primary}],children:"Thanks for reaching out!"}),(0,j.jsx)(oe.default,{style:We.successMessage,children:"We'll get back to you soon."})]})});const y=h?h.errors:null,b=l||h&&h.submitting;return(0,j.jsx)(r.default,{style:We.contactSection,children:(0,j.jsxs)(r.default,{style:We.contactContainer,children:[(0,j.jsx)(oe.default,{style:We.sectionTitle,children:"Contact Us"}),(0,j.jsx)(te.default,{placeholder:"Your Name",style:We.input,value:e,onChangeText:t,name:"name"}),De&&(0,j.jsx)(De,{prefix:"Name",field:"name",errors:y}),(0,j.jsx)(te.default,{placeholder:"Your Email",style:We.input,value:o,onChangeText:a,keyboardType:"email-address",name:"email",autoCapitalize:"none"}),De&&(0,j.jsx)(De,{prefix:"Email",field:"email",errors:y}),(0,j.jsx)(te.default,{placeholder:"Your Message",style:[We.input,We.messageInput],value:i,onChangeText:s,multiline:!0,name:"message"}),De&&(0,j.jsx)(De,{prefix:"Message",field:"message",errors:y}),(0,j.jsx)(r.default,{style:We.buttonContainer,children:(0,j.jsx)(v.default,{style:[We.actionButton,b&&We.disabledButton],onPress:async n=>{if(n.preventDefault(),d(!0),f){const n={name:e,email:o,message:i};await f(n),h&&h.succeeded&&(t(""),a(""),s(""),u(!0))}else{const n="Contact from ".concat(e),r="Name: ".concat(e,"\nEmail: ").concat(o,"\n\nMessage:\n").concat(i),l="mailto:support@crittrcove.com?subject=".concat(encodeURIComponent(n),"&body=").concat(encodeURIComponent(r));try{await ee.default.openURL(l),t(""),a(""),s(""),u(!0)}catch(zs){console.log("Error opening mail app:",zs),u(!0)}}d(!1)},disabled:b,children:(0,j.jsx)(oe.default,{style:We.buttonText,children:b?"Sending...":"Send"})})})]})})}),{}),(0,j.jsxs)(r.default,{style:We.footer,children:[(0,j.jsxs)(r.default,{style:We.socialIconsRow,children:[(0,j.jsx)(v.default,{style:We.socialIcon,onPress:()=>ee.default.openURL("https://www.instagram.com/crittrcove"),children:(0,j.jsx)(re.default,{name:"instagram",size:24,color:"white"})}),(0,j.jsx)(v.default,{style:We.socialIcon,onPress:()=>ee.default.openURL("https://discord.gg/ZX3sj6w6"),children:(0,j.jsx)(ae.default,{name:"discord",size:24,color:"white"})})]}),(0,j.jsxs)(r.default,{style:We.footerLinksRow,children:[(0,j.jsx)(oe.default,{style:We.footerLink,onPress:()=>(0,g.navigateToFrom)(e,"PrivacyPolicy","Home"),children:"Privacy Policy"}),(0,j.jsx)(oe.default,{style:We.footerLink,onPress:()=>(0,g.navigateToFrom)(e,"TermsOfService","Home"),children:"Terms of Service"}),(0,j.jsx)(v.default,{onPress:()=>(0,g.navigateToFrom)(e,"SiteMap","Home"),children:(0,j.jsx)(oe.default,{style:We.footerLink,children:"Site Map"})})]})]})]})}},{name:"MyProfile",component:Oo},{name:"SignIn",component:function(){const[e,t]=(0,n.useState)(""),[o,i]=(0,n.useState)(""),[s,l]=(0,n.useState)(""),[d,c]=(0,n.useState)(""),[u,f]=(0,n.useState)(!1),[y,w]=(0,n.useState)(""),[C,T]=(0,n.useState)(!1),[B,k]=(0,n.useState)(!1),_=(0,b.useNavigation)(),{signIn:I,is_prototype:M,is_DEBUG:L}=(0,n.useContext)(h.AuthContext),R=(0,b.useRoute)(),D=async()=>{if((()=>{let t=!0;const n=Ze(e.trim());l(n.message),n.isValid||(t=!1);const r=Qe(o);return c(r.message),r.isValid||(t=!1),t})()){f(!0);try{(0,h.debugLog)("MBA67890 Starting login process"),(0,h.debugLog)("MBA67890 API Base URL:",p.API_BASE_URL),(0,h.debugLog)("MBA67890 Login request details:",{url:"".concat(p.API_BASE_URL,"/api/token/"),method:"POST",data:{email:e.trim().toLowerCase(),password:"***"}}),(0,h.debugLog)("MBA67890 Attempting to authenticate with backend");const n=Ke(e,"email"),r=Ke(o,"password");(0,h.debugLog)("MBA9876: Login attempt with sanitized inputs",{originalEmail:e,sanitizedEmail:n,passwordChanged:o!==r});const a=x.default.create({baseURL:p.API_BASE_URL,headers:{"Content-Type":"application/json"}}),i=await a.post("/api/token/",{email:n.toLowerCase(),password:r}),{access:s,refresh:l}=i.data;(0,h.debugLog)("MBA67890 Authentication successful, received tokens"),await I(s,l);try{let e="UTC";try{e=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(zs){(0,h.debugLog)("MBA9876: Error detecting timezone",zs)}await(0,bt.updateTimeSettings)(e,!1),(0,h.debugLog)("MBA9876: Time settings updated successfully")}catch(t){(0,h.debugLog)("MBA9876: Error updating time settings (non-critical)",t)}const d=R.params?.from;d?(0,g.navigateToFrom)(_,d):_.navigate("Dashboard")}catch(zs){(0,h.debugLog)("MBA9876: Login error:",zs.response?.data||zs.message);let t="Login failed. Please check your credentials.";if(zs.response){const o=zs.response.data;o&&("string"===typeof o?t=o:o.detail?t=o.detail:o.error&&(t=o.error))}w(t),l("Invalid email or password"),c("Invalid email or password")}finally{f(!1)}}};(0,n.useEffect)((()=>{if("undefined"!==typeof document){const e=e=>{"Enter"===e.key&&D()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}}),[e,o]);const z=e=>{"Enter"===e.nativeEvent.key&&D()};return(0,n.useEffect)((()=>{{const e=N.default.getCurrentRoute().path;if((0,h.debugLog)("MBA5555 SignIn screen - Current URL path:",e),e.includes("/invite/")){const t=e.split("/"),o=t.findIndex((e=>"invite"===e));if(-1!==o&&t.length>o+1){const e=t[o+1];(0,h.debugLog)("MBA5555 SignIn detected invite token, redirecting to SignUp:",e),_.navigate("SignUp",{token:e})}}}}),[]),(0,j.jsx)(r.default,{style:Vo.container,children:(0,j.jsxs)(r.default,{style:Vo.card,children:[(0,j.jsx)(a.default,{style:Vo.title,children:"Log in"}),M&&(0,j.jsx)(a.default,{style:Vo.prototypeWarning,children:"Prototype Mode: You can sign in with anything for email and password"}),(0,j.jsxs)(r.default,{style:Vo.createAccountContainer,children:[(0,j.jsx)(a.default,{style:Vo.createAccountText,children:"Need a CrittrCove account?"}),(0,j.jsx)(v.default,{onPress:()=>_.navigate("SignUp"),children:(0,j.jsx)(a.default,{style:Vo.createAccountLink,children:"Create an account"})})]}),(0,j.jsxs)(r.default,{style:Vo.inputLabelContainer,children:[(0,j.jsx)(a.default,{style:Vo.inputLabel,children:"Email"}),(0,j.jsx)(te.default,{style:[Vo.input,s?Vo.errorInput:null],value:e,onChangeText:e=>{(0,h.debugLog)("MBA7777: Email input change:",e);const o=Ke(e,"email"),n=e.length>0?(e.length-o.length)/e.length*100:0;n>20&&e.length>5&&(0,h.debugLog)("MBA7777: Potentially malicious email input detected in SignIn:",{original:e,sanitized:o,removalPercentage:n}),t(o),l("")},keyboardType:"email-address",autoCapitalize:"none",onKeyPress:z}),s?(0,j.jsx)(a.default,{style:Vo.errorText,children:s}):null]}),(0,j.jsxs)(r.default,{style:Vo.inputLabelContainer,children:[(0,j.jsxs)(r.default,{style:Vo.passwordLabelContainer,children:[(0,j.jsx)(a.default,{style:Vo.inputLabel,children:"Password"}),(0,j.jsx)(v.default,{onPress:()=>{T(!C)},children:(0,j.jsx)(a.default,{style:Vo.showHideText,children:C?"Hide":"Show"})})]}),(0,j.jsx)(te.default,{style:[Vo.input,d?Vo.errorInput:null],secureTextEntry:!C,value:o,onChangeText:e=>{(0,h.debugLog)("MBA7777: Password input change:",e);const t=Ke(e,"password"),o=e.length>0?(e.length-t.length)/e.length*100:0;o>50&&e.length>8&&(0,h.debugLog)("MBA7777: Potentially malicious password input detected in SignIn:",{original:e,sanitized:t,removalPercentage:o}),i(t),c("")},onKeyPress:z}),d?(0,j.jsx)(a.default,{style:Vo.errorText,children:d}):null]}),(0,j.jsxs)(r.default,{style:Vo.rememberMeContainer,children:[(0,j.jsx)(v.default,{style:Vo.checkbox,onPress:()=>k(!B),children:B&&(0,j.jsx)(r.default,{style:Vo.checkboxInner,children:(0,j.jsx)(S.default,{name:"check",size:14,color:m.theme.colors.whiteText})})}),(0,j.jsx)(a.default,{style:Vo.rememberMeText,children:"Keep me logged in"})]}),(0,j.jsx)(v.default,{style:Vo.loginButton,onPress:D,children:(0,j.jsx)(a.default,{style:Vo.loginButtonText,children:"Log in"})}),u&&(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.primary}),y?(0,j.jsx)(a.default,{style:Vo.message,children:y}):null,(0,j.jsx)(v.default,{onPress:()=>_.navigate("ResetPassword"),style:Vo.forgotPasswordContainer,children:(0,j.jsx)(a.default,{style:Vo.link,children:"Forgot Password?"})})]})})}},{name:"SignUp",component:Go},{name:"Invite",component:Go},{name:"ResetPassword",component:function(){const[e,t]=(0,n.useState)(""),[o,i]=(0,n.useState)(""),[s,l]=(0,n.useState)(!1),[d,c]=(0,n.useState)(""),u=(0,b.useNavigation)(),{screenWidth:g,isCollapsed:f,isSignedIn:y}=(0,n.useContext)(h.AuthContext),w=Ko(g,f,y);return(0,j.jsx)(r.default,{style:w.container,children:(0,j.jsx)(He.default,{style:w.safeArea,children:(0,j.jsxs)(r.default,{style:w.content,children:[y&&(0,j.jsxs)(v.default,{onPress:()=>u.navigate("ChangePassword"),style:w.backButton,children:[(0,j.jsx)(S.default,{name:"arrow-left",size:24,color:m.theme.colors.text}),(0,j.jsx)(a.default,{style:w.backText,children:"Reset Password"})]}),(0,j.jsxs)(r.default,{style:w.card,children:[(0,j.jsx)(a.default,{style:w.title,children:"Reset Password"}),(0,j.jsx)(te.default,{style:[w.input,o&&w.inputError],placeholder:"Email",value:e,onChangeText:e=>{const o=Ke(e,"email"),n=e.length>0?(e.length-o.length)/e.length*100:0;n>20&&e.length>5?(0,h.debugLog)("MBA1234: Potentially malicious email input detected in ResetPassword:",{original:e,sanitized:o,removalPercentage:n}):(t(o),i(""),c(""))},keyboardType:"email-address",autoCapitalize:"none",placeholderTextColor:m.theme.colors.placeHolderText}),o?(0,j.jsx)(a.default,{style:w.errorText,children:o}):null,(0,j.jsx)(No,{title:"Reset Password",onPress:async()=>{const o=Ze(e);if(i(o.message),o.isValid){l(!0),c("");try{const o=Ke(e,"email");(0,h.debugLog)("MBA1234: Password reset request for sanitized email:",{originalEmail:e,sanitizedEmail:o});200===(await x.default.post("".concat(p.API_BASE_URL,"/api/users/v1/reset-password/"),{email:o.toLowerCase()})).status&&(c("If an account with this email exists, you will receive a password reset link shortly."),t(""))}catch(zs){(0,h.debugLog)("MBA1234: Error during password reset:",zs);let t="Error: Unable to process password reset request.";zs.response&&zs.response.data&&("string"===typeof zs.response.data?t=zs.response.data:zs.response.data.error?t=zs.response.data.error:zs.response.data.detail&&(t=zs.response.data.detail)),c(t)}finally{l(!1)}}},disabled:s,style:w.button}),s&&(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.primary,style:w.loader}),d?(0,j.jsx)(a.default,{style:[w.message,d.includes("Error")&&w.errorMessage],children:d}):null]})]})})})}},{name:"ResetPasswordConfirm",component:function({route:e}){const{uid:t,token:o}=e.params,[i,s]=(0,n.useState)(""),[l,d]=(0,n.useState)(""),[c,u]=(0,n.useState)(!1),[h,f]=(0,n.useState)(""),y=(0,b.useNavigation)();return(0,j.jsxs)(r.default,{style:Xo.container,children:[(0,j.jsx)(a.default,{style:Xo.title,children:"Reset Password"}),(0,j.jsx)(te.default,{style:Xo.input,placeholder:"New Password",value:i,onChangeText:s,secureTextEntry:!0}),(0,j.jsx)(te.default,{style:Xo.input,placeholder:"Confirm Password",value:l,onChangeText:d,secureTextEntry:!0}),(0,j.jsx)(No,{title:"Reset Password",onPress:async()=>{if(i===l){u(!0);try{await x.default.post("".concat(p.API_BASE_URL,"/api/users/v1/reset-password-confirm/").concat(t,"/").concat(o,"/"),{new_password:i});f("Your password has been reset."),setTimeout((()=>{(0,g.navigateToFrom)(y,"SignIn","ResetPasswordConfirm")}),2e3)}catch(zs){f("Failed to reset password. Please try again later.")}finally{u(!1)}}else f("Passwords do not match.")}}),c&&(0,j.jsx)(A.default,{size:"large",color:m.theme.colors.primary}),h?(0,j.jsx)(a.default,{style:Xo.message,children:h}):null]})}},{name:"SearchProfessionalsListing",component:_i},{name:"OwnerHistory",component:Qn},{name:"MessageHistory",component:ga},{name:"Dashboard",component:mn},{name:"BecomeProfessional",component:hn},{name:"MoreScreen",component:xn},{name:"Owners",component:Ra},{name:"AvailabilitySettings",component:Gn},{name:"Settings",component:ha},{name:"PrivacyPolicy",component:pa},{name:"ProfessionalSettings",component:ba},{name:"TermsOfService",component:va},{name:"HelpFAQ",component:Ca},{name:"ContactUs",component:Ba},{name:"ProfessionalProfile",component:Va},{name:"MyContracts",component:ii},{name:"ChangePassword",component:di},{name:"ConfirmAccountDeletion",component:ks},{name:"MyBookings",component:Mi},{name:"ServiceManager",component:zi},{name:"Blog",component:Fi},{name:"BlogPost",component:Wi},{name:"Waitlist",component:Yi},{name:"TestToast",component:$i},{name:"Connections",component:Qi},{name:"DogBoardingColoradoSprings",component:rs},{name:"DogWalkerColoradoSprings",component:is},{name:"CatSittingColoradoSprings",component:ls},{name:"ExoticPetCareColoradoSprings",component:cs},{name:"FerretSitterColoradoSprings",component:gs},{name:"BirdBoardingColoradoSprings",component:hs},{name:"HorseSittingColorado",component:ps},{name:"ReptileSitterColoradoSprings",component:bs},{name:"PetBoardingColoradoSprings",component:vs},{name:"DogSittingColoradoSprings",component:Cs},{name:"SiteMap",component:Ts}]),Is=e=>({enabled:!0,prefixes:["https://staging.crittrcove.com","http://staging.crittrcove.com","".concat(p.API_BASE_URL)],getInitialURL:async()=>{const t=window.location.href,o=window.location.pathname;(0,h.debugLog)("MBAo34invid3w LINKING: Checking initial URL for auth protection:",{url:t,pathname:o});const n=["/Dashboard","/dashboard","/MyProfile","/my-profile","/MessageHistory","/message-history","/OwnerHistory","/owner-history","/BecomeProfessional","/become-professional","/MoreScreen","/more-screen","/Owners","/owners","/AvailabilitySettings","/availability-settings","/Settings","/settings","/ProfessionalSettings","/professional-settings","/ProfessionalProfile","/professional-profile","/MyContracts","/my-contracts","/ChangePassword","/change-password","/ConfirmAccountDeletion","/confirm-account-deletion","/MyBookings","/my-bookings","/ServiceManager","/service-manager","/TestToast","/test-toast","/Connections","/connections"].some((e=>o.startsWith(e)||o===e));if((0,h.debugLog)("MBAo34invid3w LINKING: Path protection check:",{pathname:o,isProtectedPath:n,authContextExists:!!e,authContextInitialized:e?.isInitialized,authContextSignedIn:e?.isSignedIn}),n){let n=0;for(;(!e||!e.isInitialized)&&n<50;)(0,h.debugLog)("MBAo34invid3w LINKING: Waiting for auth context...",n),await new Promise((e=>setTimeout(e,100))),n++;if(e&&!e.isSignedIn){(0,h.debugLog)("MBAo34invid3w LINKING: Protected path accessed without auth, redirecting to signin");const e=t.split(o)[0];return"".concat(e,"/signin")}(0,h.debugLog)("MBAo34invid3w LINKING: Auth context available, user signed in or path not protected")}return(0,h.debugLog)("MBAo34invid3w LINKING: Allowing access to URL:",t),t},config:{screens:{Home:"/",MyProfile:"my-profile",SignIn:"signin",SignUp:{path:"signup/:token?",parse:{token:e=>e||null}},Invite:{path:"invite/:token",exact:!0,parse:{token:e=>e},stringify:{token:e=>e}},ResetPassword:"reset-password",ResetPasswordConfirm:"reset-password/:uid/:token",SearchProfessionalsListing:"SearchProfessionalsListing",OwnerHistory:"owner-history",MessageHistory:{path:"message-history",parse:{messageId:e=>e||null,senderName:e=>e||"Unknown User"}},Dashboard:"Dashboard",BecomeProfessional:"become-professional",More:"more",Owners:"owners",AvailabilitySettings:"availability-settings",Settings:"settings",PrivacyPolicy:"privacy-policy",ProfessionalSettings:"professional-settings",TermsOfService:"terms-of-service",HelpFAQ:"help-faq",ContactUs:"contact-us",ProfessionalProfile:{path:"professional-profile",parse:{professional:e=>{}}},MyContracts:"my-contracts",ChangePassword:"change-password",ConfirmAccountDeletion:"confirm-account-deletion",MyBookings:"my-bookings",ServiceManager:"service-manager",Blog:"blog",BlogPost:"blog-post",Waitlist:"waitlist",TestToast:"test-toast",Connections:"connections",DogBoardingColoradoSprings:"dog-boarding-colorado-springs",DogWalkerColoradoSprings:"dog-walker-colorado-springs",CatSittingColoradoSprings:"cat-sitting-colorado-springs",ExoticPetCareColoradoSprings:"exotic-pet-care-colorado-springs",FerretSitterColoradoSprings:"ferret-sitter-colorado-springs",BirdBoardingColoradoSprings:"bird-boarding-colorado-springs",HorseSittingColorado:"horse-sitting-colorado",ReptileSitterColoradoSprings:"reptile-sitter-colorado-springs",PetBoardingColoradoSprings:"pet-boarding-colorado-springs",DogSittingColoradoSprings:"dog-sitting-colorado-springs",SiteMap:"site-map"}}}),Ms=(0,b.createNavigationContainerRef)();function Ls(e,t){Ms.isReady()&&Ms.navigate(e,t)}function Rs(){const e=(0,n.useContext)(h.AuthContext),{checkAuthStatus:t,is_DEBUG:o,isInitialized:i,isSignedIn:d,userRole:u}=e,[p,y]=(0,n.useState)(null),[b,x]=(0,n.useState)(!0),[v,w]=(0,n.useState)(!0),[C,S]=(0,n.useState)(null);(0,n.useEffect)((()=>{{const e=$();(0,h.debugLog)("MBA9999: Pre-rendering initialized",e)}}),[]),(0,n.useEffect)((()=>{{const t=N.default.getCurrentRoute().path;if(e.debugLog&&e.debugLog("MBA6666 App - Current URL path:",t),t.includes("/invite/")){const o=t.split("/"),n=o.findIndex((e=>"invite"===e));if(-1!==n&&o.length>n+1){const t=o[n+1];e.debugLog&&e.debugLog("MBA6666 Found invitation token in URL:",t),S(t)}}}}),[]),(0,n.useEffect)((()=>{(async()=>{if(i)try{let t="Home";if((0,h.debugLog)("MBAo34invid3w App initialization starting:",{inviteToken:!!C,isSignedIn:d,userRole:u,platform:"web"}),C)e.debugLog&&e.debugLog("MBAo34invid3w Setting initial route to SignUp with token:",C),t="SignUp";else if(d)t="Dashboard",e.debugLog&&e.debugLog("MBAo34invid3w User authenticated, setting route to:",t,"for role:",u);else{const o=window.location.pathname,n=[],r=["/dog-boarding-colorado-springs","/dog-boarding-colorado-springs/","/dog-walker-colorado-springs","/dog-walker-colorado-springs/","/dog-sitting-colorado-springs","/dog-sitting-colorado-springs/","/cat-sitting-colorado-springs","/cat-sitting-colorado-springs/","/pet-boarding-colorado-springs","/pet-boarding-colorado-springs/","/exotic-pet-care-colorado-springs","/exotic-pet-care-colorado-springs/","/ferret-sitter-colorado-springs","/ferret-sitter-colorado-springs/","/reptile-sitter-colorado-springs","/reptile-sitter-colorado-springs/","/bird-boarding-colorado-springs","/bird-boarding-colorado-springs/","/horse-sitting-colorado","/horse-sitting-colorado/"],a=["/Dashboard","/dashboard","/MyProfile","/my-profile","/MessageHistory","/message-history","/OwnerHistory","/owner-history","/BecomeProfessional","/become-professional","/More","/more","/Owners","/owners","/AvailabilitySettings","/availability-settings","/Settings","/settings","/ProfessionalSettings","/professional-settings","/ProfessionalProfile","/professional-profile","/MyContracts","/my-contracts","/ChangePassword","/change-password","/ConfirmAccountDeletion","/confirm-account-deletion","/MyBookings","/my-bookings","/ServiceManager","/service-manager","/TestToast","/test-toast","/Connections","/connections"].some((e=>o.startsWith(e)||o===e)),i=n.some((e=>o.startsWith(e)||o===e)),s=r.some((e=>o.startsWith(e)||o===e));(0,h.debugLog)("MBAo34invid3w App initialization: Web route check:",{currentPath:o,isOnProtectedPath:a,isOnSEOPage:i,isOnKnownSEOPath:s,isSignedIn:d,platform:"web"}),a?((0,h.debugLog)("MBAo34invid3w Web: User not authenticated but on protected path, redirecting to SignIn"),t="SignIn"):i?((0,h.debugLog)("MBAo34invid3w Web: User on SEO page, letting React Navigation handle routing"),t=null):s?((0,h.debugLog)("MBAo34invid3w Web: User on known SEO page, letting React Navigation handle routing"),t=null):(t="Home",e.debugLog&&e.debugLog("MBAo34invid3w User not authenticated, setting route to Home"))}null!==t?(y(t),(0,h.debugLog)("MBAo34invid3w Final initial route set to:",t)):(0,h.debugLog)("MBAo34invid3w No initial route set - letting React Navigation handle URL routing")}catch(zs){console.error("Error initializing app:",zs),y(C?"SignUp":"Home")}finally{x(!1),(0,h.debugLog)("MBAo34invid3w App initialization completed, loading set to false")}else(0,h.debugLog)("MBAo34invid3w App initialization: AuthContext not yet initialized")})()}),[C,i,d,u]),(0,n.useEffect)((()=>{if(!i||b)return;const e=setTimeout((()=>{const e=window.location.pathname,t=["/Dashboard","/dashboard","/MyProfile","/my-profile","/MessageHistory","/message-history","/OwnerHistory","/owner-history","/BecomeProfessional","/become-professional","/More","/more","/Owners","/owners","/AvailabilitySettings","/availability-settings","/Settings","/settings","/ProfessionalSettings","/professional-settings","/ProfessionalProfile","/professional-profile","/MyContracts","/my-contracts","/ChangePassword","/change-password","/ConfirmAccountDeletion","/confirm-account-deletion","/MyBookings","/my-bookings","/ServiceManager","/service-manager","/TestToast","/test-toast","/Connections","/connections"].some((t=>e.startsWith(t)||e===t));(0,h.debugLog)("MBAo34invid3w Route guard check:",{currentPath:e,isOnProtectedPath:t,isSignedIn:d,isInitialized:i,isLoading:b,platform:"web"}),t&&!d&&((0,h.debugLog)("MBAo34invid3w Route guard: Redirecting unauthenticated user from protected route"),window.location.href="/signin")}),100);return()=>clearTimeout(e)}),[i,d,b]),(0,n.useEffect)((()=>{0}),[p,b]);const T=["/dog-boarding-colorado-springs","/dog-boarding-colorado-springs/","/dog-walker-colorado-springs","/dog-walker-colorado-springs/","/dog-sitting-colorado-springs","/dog-sitting-colorado-springs/","/cat-sitting-colorado-springs","/cat-sitting-colorado-springs/","/pet-boarding-colorado-springs","/pet-boarding-colorado-springs/","/exotic-pet-care-colorado-springs","/exotic-pet-care-colorado-springs/","/ferret-sitter-colorado-springs","/ferret-sitter-colorado-springs/","/reptile-sitter-colorado-springs","/reptile-sitter-colorado-springs/","/bird-boarding-colorado-springs","/bird-boarding-colorado-springs/","/horse-sitting-colorado","/horse-sitting-colorado/"].some((e=>window.location.pathname.startsWith(e)||window.location.pathname===e));if(!i||b||!p&&!T)return(0,j.jsxs)(r.default,{style:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:m.theme.colors.background},children:[(0,j.jsx)(H.default,{size:"large",color:m.theme.colors.primary}),(0,j.jsx)(a.default,{style:{marginTop:16,color:m.theme.colors.text,fontSize:16},children:"Loading..."})]});return(0,j.jsx)(l.default,{ref:Ms,linking:Is(e),onStateChange:async e=>{if(e?.routes?.length>0){const t=e.routes[e.routes.length-1].name;{const e=window.location.pathname;K(t,e)}}if(e?.routes?.length>0){const t=e.routes[e.routes.length-1].name;(0,h.debugLog)("MBAo34invid3w Navigation state change:",{routeName:t,currentPath:window.location.pathname,isInitialized:i,isSignedIn:d,platform:"web"});const o=["Dashboard","MyProfile","MessageHistory","OwnerHistory","BecomeProfessional","More","Owners","AvailabilitySettings","Settings","ProfessionalSettings","ProfessionalProfile","MyContracts","ChangePassword","MyBookings","ServiceManager","TestToast","Connections"].includes(t);(0,h.debugLog)("MBAo34invid3w Navigation protection check:",{routeName:t,isProtectedRoute:o,isInitialized:i,isSignedIn:d,shouldRedirect:o&&i&&!d&&"SignIn"!==t}),o&&i&&!d&&"SignIn"!==t&&((0,h.debugLog)("MBAo34invid3w Web: Protected route accessed without authentication, redirecting to signin"),Ms.current&&Ms.current.navigate("SignIn"))}},children:(0,j.jsx)(f.MessageNotificationProvider,{children:(0,j.jsx)(D,{children:(0,j.jsx)(s.default,{theme:m.theme,children:(0,j.jsx)(W,{children:(0,j.jsx)(As.Navigator,{initialRouteName:p,screenOptions:Object.assign({headerShown:!0,header:({navigation:e})=>(0,j.jsx)(g.default,{navigation:e})},c.SlideFromRightIOS,{presentation:"card",animation:"slide_from_right"}),children:_s.map((e=>(0,j.jsx)(As.Screen,{name:e.name,component:e.component,options:{headerShown:!0,animation:"slide_from_right"}},e.name)))})})})})})})}i.default.create({container:{flex:1,display:"flex",flexDirection:"column",height:"100%"},warningBanner:{backgroundColor:"#ffebee",padding:12,borderBottomWidth:1,borderBottomColor:"#ef5350",width:"100%",flexShrink:0},warningContent:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:10,maxWidth:1200,marginHorizontal:"auto",width:"100%"},warningText:{color:"#c62828",textAlign:"center",fontSize:15,flexShrink:1,flex:1,marginHorizontal:15},waitlistButton:{backgroundColor:"#ef5350",paddingHorizontal:15,paddingVertical:8,borderRadius:20,marginLeft:"auto"},waitlistButtonText:{color:"white",fontSize:14,fontWeight:"600"},closeButton:{width:24,height:24,justifyContent:"center",alignItems:"center",marginRight:5},closeButtonText:{color:"#c62828",fontSize:18,fontWeight:"600"}});function Ds(){const[e,t]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{Z(),(async()=>{t(!0)})()}),[]),(0,j.jsx)(h.AuthProvider,{children:(0,j.jsx)(Rs,{})})}},50294:(e,t,o)=>{"use strict";o.r(t),o.d(t,{acceptInvitation:()=>O,addPet:()=>T,approveBooking:()=>u,changePassword:()=>S,compressImage:()=>ae,createBookingFromDraft:()=>V,createConversation:()=>K,createDraftFromBooking:()=>G,createService:()=>_,deleteInvitation:()=>N,deletePet:()=>A,deleteService:()=>I,fixPetOwner:()=>k,getBookingAvailablePets:()=>d,getBookingAvailableServices:()=>l,getBookingDetails:()=>g,getBookingDraftDatesAndTimes:()=>Y,getClientDashboard:()=>oe,getClientPets:()=>ne,getConnectionProfile:()=>D,getConversationMessages:()=>Q,getConversations:()=>X,getIncompleteBookings:()=>ee,getInvitationDetails:()=>E,getInvitations:()=>F,getProfessionalDashboard:()=>te,getProfessionalServices:()=>s,getProfessionalServicesDetailed:()=>$,getTimeSettings:()=>b,getUnreadMessageCount:()=>Z,getUserConnections:()=>R,getUserName:()=>v,getUserReviews:()=>me,inviteClient:()=>z,markBookingCompleted:()=>ce,markNoreplyAsNotSpam:()=>c,requestBookingChanges:()=>m,resendInvitation:()=>H,searchProfessionals:()=>J,sendImageMessage:()=>de,sendReferral:()=>P,sendTextMessage:()=>ue,submitBookingReview:()=>ge,unarchiveService:()=>M,updateBookingDraftMultipleDays:()=>p,updateBookingDraftPetsAndServices:()=>h,updateBookingDraftRates:()=>U,updateBookingDraftRecurring:()=>y,updateBookingDraftTimeAndDate:()=>f,updateDraftNotesFromPro:()=>q,updatePet:()=>B,updateProfileInfo:()=>C,updateService:()=>L,updateTimeSettings:()=>x,uploadAndSendImageMessage:()=>le,uploadMessageImage:()=>re,uploadProfilePicture:()=>j,userProfile:()=>w,verifyInvitation:()=>W});var n=o(77109),r=o(64900),a=o(38432),i=o(32160);const s=async()=>{try{(0,a.debugLog)("MBA7890: Fetching professional services");return(await n.default.get("".concat(r.API_BASE_URL,"/api/services/v1/professional/services/"))).data}catch(e){throw(0,a.debugLog)("MBA7890: Error fetching professional services:",e),(0,a.debugLog)("MBA7890: Error details:",e.response?.data||e.message),e}},l=async e=>{try{return(await n.default.get("".concat(r.API_BASE_URL,"/api/booking_drafts/v1/").concat(e,"/available_services/"))).data}catch(t){throw(0,a.debugLog)("MBA12345 Error fetching available services:",t),t}},d=async e=>{try{return(await n.default.get("".concat(r.API_BASE_URL,"/api/booking_drafts/v1/").concat(e,"/available_pets/"))).data}catch(t){throw(0,a.debugLog)("MBA12345 Error fetching available pets:",t),t}},c=async()=>{try{return(await n.default.post("".concat(r.API_BASE_URL,"/api/clients/v1/mark-noreply-as-not-spam/"))).data}catch(e){throw(0,a.debugLog)("MBA12345 Error marking noreply as not spam:",e),e}},u=async(e,t=!1)=>{try{return(await n.default.post("".concat(r.API_BASE_URL,"/api/bookings/v1/").concat(e,"/approve/"),{client_agreed_tos:t})).data}catch(o){throw(0,a.debugLog)("Error approving booking:",o),o}},g=async e=>{try{(0,a.debugLog)("MBA88899","Fetching booking details for ID:",e);const t=await n.default.get("".concat(r.API_BASE_URL,"/api/bookings/v1/").concat(e,"/details/"));return(0,a.debugLog)("MBA88899","Booking details fetched successfully"),t.data}catch(t){throw(0,a.debugLog)("MBA88899","Error fetching booking details:",t.response?.data||t.message),t}},m=async(e,t)=>{try{(0,a.debugLog)("MBA88899 Requesting changes for booking ID:",e),(0,a.debugLog)("MBA88899 Change request message:",t);const o=await n.default.post("".concat(r.API_BASE_URL,"/api/bookings/v1/").concat(e,"/request-changes/"),{message:t});return(0,a.debugLog)("MBA88899 Change request submitted successfully"),o.data}catch(o){throw(0,a.debugLog)("MBA88899 Error requesting booking changes:",o),o}},h=async(e,t)=>{try{const o=await n.default.patch("".concat(r.API_BASE_URL,"/api/booking_drafts/v1/").concat(e,"/update_pets_and_services/"),t);return(0,a.debugLog)("MBA12345 Draft update response:",o.data),o.data}catch(o){throw(0,a.debugLog)("MBA12345 Error updating booking draft:",o),o}},f=async(e,t,o,i,s)=>{try{(0,a.debugLog)("MBA5asdt3f4321 - Updating booking draft time and date:",{draftId:e,startDate:t,endDate:o,startTime:i,endTime:s});const l=await n.default.post("".concat(r.API_BASE_URL,"/api/booking_drafts/v1/update-time-and-date/").concat(e,"/"),{start_date:t,end_date:o,start_time:i,end_time:s});return(0,a.debugLog)("MBA5asdt3f4321 - Booking draft time and date update response:",l.data),l.data}catch(l){throw(0,a.debugLog)("MBA5asdt3f4321 Error updating booking draft time and date:",l),l}},p=async(e,t,o)=>{try{const s=o?.timezone||"US/Mountain";(0,a.debugLog)("MBA8800: Updating booking draft multiple days:",{draftId:e,data:t,userTimezone:s});const l=t.dates.map((e=>{let o,n,r,l,d=!1;if(e.date&&e.start_time&&e.end_time)return(0,a.debugLog)("MBA8800: Using provided occurrence data format",e),{date:e.date,startTime:e.start_time,endDate:e.end_date||e.date,endTime:e.end_time,is_overnight:e.is_overnight||!1};if(e.date&&e.startTime&&e.endTime)return(0,a.debugLog)("MBA8800: Using provided date and times",e),{date:e.date,startTime:e.startTime,endDate:e.endDate||e.date,endTime:e.endTime,is_overnight:e.is_overnight||!1};if(!(e instanceof Date))throw(0,a.debugLog)("MBA8800: Unexpected date format",e),new Error("Unexpected date format");{o=(0,i.formatDateForAPI)(e);let s=t.times;const c=e.toISOString().split("T")[0];t.times[c]&&t.times.hasIndividualTimes&&(s=t.times[c]),n="string"===typeof s.startTime?s.startTime:void 0!==s.startTime?.hours?"".concat(String(s.startTime.hours).padStart(2,"0"),":").concat(String(s.startTime.minutes||0).padStart(2,"0")):"09:00",r="string"===typeof s.endTime?s.endTime:void 0!==s.endTime?.hours?"".concat(String(s.endTime.hours).padStart(2,"0"),":").concat(String(s.endTime.minutes||0).padStart(2,"0")):"17:00",(0,a.debugLog)("MBA8800: Formatted times for date:",c,{startTimeStr:n,endTimeStr:r});const u="00:00"===r,g=parseInt(r.split(":")[0],10)<parseInt(n.split(":")[0],10)||parseInt(r.split(":")[0],10)===parseInt(n.split(":")[0],10)&&parseInt(r.split(":")[1],10)<parseInt(n.split(":")[1],10),m=u||g,h=m?new Date(e.getTime()+864e5):new Date(e);l=(0,i.formatDateForAPI)(h),(0,a.debugLog)("MBA8800: End date calculation in API.js:",{needsNextDayDate:m,isMidnightEnd:u,isTimeBeforeStart:g,startTimeStr:n,endTimeStr:r,originalDate:o,calculatedEndDate:l}),d=s.isOvernightForced||!1}const{date:c,time:u}=(0,i.convertToUTC)(o,n,s),{date:g,time:m}=(0,i.convertToUTC)(l||o,r,s);return{date:c,startTime:u,endDate:g,endTime:m,is_overnight:d}}));(0,a.debugLog)("MBA8800: Converted UTC dates:",l);const d=await n.default.post("".concat(r.API_BASE_URL,"/api/booking_drafts/v1/update-multiple-days/").concat(e,"/"),{dates:l});return(0,a.debugLog)("MBA8800: Booking draft multiple days update response:",d.data),d.data}catch(s){throw(0,a.debugLog)("MBA8800: Error updating booking draft multiple days:",s),s}},y=async(e,t)=>{try{(0,a.debugLog)("MBA5asdt3f4321 - Updating booking draft recurring dates:",{draftId:e,recurringData:t});const o=await n.default.post("".concat(r.API_BASE_URL,"/api/booking_drafts/v1/update-recurring/").concat(e,"/"),t);return(0,a.debugLog)("MBA5asdt3f4321 - Booking draft recurring update response:",o.data),o.data}catch(o){throw(0,a.debugLog)("MBA5asdt3f4321 Error updating booking draft recurring dates:",o),o}},b=async()=>{try{return(await n.default.get("".concat(r.API_BASE_URL,"/api/users/v1/time-settings/"))).data}catch(e){throw(0,a.debugLog)("MBA12345 Error fetching time settings",e),e}},x=async e=>{try{const t="object"===typeof e?e:{timezone:e};(0,a.debugLog)("MBA12345 Sending time settings update",t);return(await n.default.post("".concat(r.API_BASE_URL,"/api/users/v1/update-time-settings/"),t)).data}catch(t){throw(0,a.debugLog)("MBA12345 Error updating time settings",t),t}},v=async()=>{try{return(await n.default.get("".concat(r.API_BASE_URL,"/api/users/v1/get-name/"))).data}catch(e){throw(0,a.debugLog)("MBA12345 Error fetching user name",e),e}},w=async()=>{try{(0,a.debugLog)("MBA12345","Fetching user profile data");const e=await n.default.get("".concat(r.API_BASE_URL,"/api/users/v1/profile/"));return(0,a.debugLog)("MBA12345","User profile data fetched successfully:",{name:e.data.name,email:e.data.email,address:e.data.address}),e.data}catch(e){throw(0,a.debugLog)("MBA12345","Error in userProfile:",e),e}},C=async e=>{try{(0,a.debugLog)("MBA76543","Updating profile info with data:",e);const t=e instanceof FormData;(0,a.debugLog)("MBA76543","Making ".concat(t?"FormData":"JSON"," request to update profile"));const o={method:"patch",url:"".concat(r.API_BASE_URL,"/api/users/v1/update-profile/"),data:e};t||(o.headers={"Content-Type":"application/json"});const i=await(0,n.default)(o);return(0,a.debugLog)("MBA76543","Profile updated successfully with response:",i.data),i.data}catch(t){throw(0,a.debugLog)("MBA76543","Error updating profile info:",t),t}},S=async(e,t)=>{try{(0,a.debugLog)("MBA1234","Initiating password change request");const o=await n.default.post("".concat(r.API_BASE_URL,"/api/users/v1/change-password/"),{current_password:e,new_password:t});return(0,a.debugLog)("MBA1234","Password change successful"),o.data}catch(o){throw(0,a.debugLog)("MBA1234","Error changing password:",o.response?.data||o.message),o}},j=async e=>{try{if((0,a.debugLog)("MBA3oin4f084","Starting profile picture upload"),!(e instanceof FormData))throw new Error("uploadProfilePicture requires FormData");let t=!1;for(let n of e.entries())if("profile_picture"===n[0]){t=!0,(0,a.debugLog)("MBA3oin4f084","FormData contains profile_picture: ".concat(typeof n[1]));break}if(!t)throw new Error("FormData does not contain profile_picture");const o=await(0,n.default)({method:"post",url:"".concat(r.API_BASE_URL,"/api/users/v1/upload-profile-picture/"),data:e,headers:{Accept:"application/json"},timeout:3e4});return(0,a.debugLog)("MBA3oin4f084","Profile picture upload successful with response:",o.data),o.data}catch(t){throw(0,a.debugLog)("MBA3oin4f084","Error uploading profile picture:",t),t.response&&(0,a.debugLog)("MBA3oin4f084","Server error response:",t.response),t}},T=async e=>{try{(0,a.debugLog)("MBA789","Adding new pet with data:",e);const t=await n.default.post("".concat(r.API_BASE_URL,"/api/pets/v1/add-pet/"),e);return(0,a.debugLog)("MBA789","Pet added successfully:",t.data),t.data}catch(t){throw(0,a.debugLog)("MBA789","Error adding pet:",t),t}},B=async(e,t)=>{try{(0,a.debugLog)("MBA789","Updating pet with ID:",e,"and data:",t);const o=await n.default.patch("".concat(r.API_BASE_URL,"/api/pets/v1/").concat(e,"/"),t);return(0,a.debugLog)("MBA789","Pet updated successfully:",o.data),o.data}catch(o){throw(0,a.debugLog)("MBA789","Error updating pet:",o),o}},k=async e=>{try{(0,a.debugLog)("MBA789","Fixing owner for pet with ID:",e);const t=await n.default.post("".concat(r.API_BASE_URL,"/api/pets/v1/").concat(e,"/fix-owner/"),{});return(0,a.debugLog)("MBA789","Pet owner fixed successfully:",t.data),t.data}catch(t){throw(0,a.debugLog)("MBA789","Error fixing pet owner:",t),t}},A=async e=>{try{(0,a.debugLog)("MBA789","Deleting pet with ID:",e);const t=await n.default.delete("".concat(r.API_BASE_URL,"/api/pets/v1/").concat(e,"/"));return(0,a.debugLog)("MBA789","Pet deleted successfully:",t.data),t.data}catch(t){throw(0,a.debugLog)("MBA789","Error deleting pet:",t),t}},_=async e=>{try{(0,a.debugLog)("MBA54321","Creating new service - sending data to backend:",e);let t={};e.animal_types&&Array.isArray(e.animal_types)?e.animal_types.forEach((e=>{"object"===typeof e&&e.name&&e.category?t[e.name]=e.category:"string"===typeof e&&(t[e]="Other")})):e.animal_types&&"object"===typeof e.animal_types?t=e.animal_types:e.animal_type?t[e.animal_type]="Other":t.Other="Other";const o=(e.additional_rates||[]).map((e=>Object.assign({},e,{rate:String(e.rate)}))),i=Object.assign({},e,{base_rate:String(e.base_rate),additional_animal_rate:String(e.additional_animal_rate||0),holiday_rate:String(e.holiday_rate||0),animal_types:t,additional_rates:o});(0,a.debugLog)("MBA54321","Sending additional rates to backend:",i.additional_rates);const s=await n.default.post("".concat(r.API_BASE_URL,"/api/services/v1/create/"),i);return(0,a.debugLog)("MBA54321","Service created successfully - backend response:",s.data),s.data}catch(t){throw(0,a.debugLog)("MBA54321","Error creating service:",t),(0,a.debugLog)("MBA54321","Error response data:",t.response?.data),t}},I=async e=>{try{(0,a.debugLog)("MBA7890: Deleting service with ID:",e);const t=await n.default.delete("".concat(r.API_BASE_URL,"/api/services/v1/delete/").concat(e,"/"));return(0,a.debugLog)("MBA7890: Service deleted successfully - backend response:",t.data),t.data}catch(t){throw(0,a.debugLog)("MBA7890: Error deleting service:",t),(0,a.debugLog)("MBA7890: Error response data:",t.response?.data),t}},M=async e=>{try{(0,a.debugLog)("MBA7890: Unarchiving service with ID:",e);const t=await n.default.patch("".concat(r.API_BASE_URL,"/api/services/v1/unarchive/").concat(e,"/"));return(0,a.debugLog)("MBA7890: Service unarchived successfully - backend response:",t.data),t.data}catch(t){throw(0,a.debugLog)("MBA7890: Error unarchiving service:",t),(0,a.debugLog)("MBA7890: Error response data:",t.response?.data),t}},L=async e=>{try{(0,a.debugLog)("API updateService","Updating service with data:",e);const t=await n.default.patch("".concat(r.API_BASE_URL,"/api/services/v1/update/").concat(e.service_id,"/"),e);return(0,a.debugLog)("API updateService Response:",t.data),t.data}catch(t){throw(0,a.debugLog)("API updateService Error:",t.response?.data||t.message),t}},R=async(e=1)=>{try{(0,a.debugLog)("MBA4321 Fetching client connections, page:",e);const t=await n.default.get("".concat(r.API_BASE_URL,"/api/bookings/v1/connections/"),{params:{page:e}});return(0,a.debugLog)("MBA4321 Connections response:",t.data),t.data}catch(t){throw(0,a.debugLog)("MBA4321 Error fetching connections:",t),(0,a.debugLog)("MBA4321 Error details:",t.response?.data||t.message),t}},D=async(e,t="client")=>{try{(0,a.debugLog)("MBA4321 Fetching connection profile:",{userId:e,type:t});const o=await n.default.get("".concat(r.API_BASE_URL,"/api/connections/v1/profile/").concat(e,"/"),{params:{type:t}});return(0,a.debugLog)("MBA4321 Connection profile response:",o.data),o.data}catch(o){throw(0,a.debugLog)("MBA4321 Error fetching connection profile:",o),(0,a.debugLog)("MBA4321 Error details:",o.response?.data||o.message),o}},z=async(e="email",t=null)=>{try{(0,a.debugLog)("MBA4321 Inviting client:",{type:e,email:t});const o=await n.default.post("".concat(r.API_BASE_URL,"/api/users/v1/invitations/"),{type:e,email:t,is_professional_invite:!0});return(0,a.debugLog)("MBA4321 Invite client response:",o.data),o.data}catch(o){throw(0,a.debugLog)("MBA4321 Error inviting client:",o),(0,a.debugLog)("MBA4321 Error details:",o.response?.data||o.message),o}},P=async(e="email",t=null,o)=>{try{(0,a.debugLog)("MBA4321 Sending referral:",{type:e,email:t,referralType:o});const i=await n.default.post("".concat(r.API_BASE_URL,"/api/users/v1/invitations/"),{type:e,email:t,is_professional_invite:!1,referral_type:o});return(0,a.debugLog)("MBA4321 Send referral response:",i.data),i.data}catch(i){throw(0,a.debugLog)("MBA4321 Error sending referral:",i),(0,a.debugLog)("MBA4321 Error details:",i.response?.data||i.message),i}},F=async(e="all")=>{try{(0,a.debugLog)("MBA4321 Getting invitations:",{type:e});const t=await n.default.get("".concat(r.API_BASE_URL,"/api/users/v1/invitations/?type=").concat(e));return(0,a.debugLog)("MBA4321 Get invitations response:",t.data),t.data}catch(t){throw(0,a.debugLog)("MBA4321 Error getting invitations:",t),(0,a.debugLog)("MBA4321 Error details:",t.response?.data||t.message),t}},E=async e=>{try{(0,a.debugLog)("MBA4321 Getting invitation details:",{token:e});const t=await n.default.get("".concat(r.API_BASE_URL,"/api/users/v1/invitations/").concat(e,"/"));return(0,a.debugLog)("MBA4321 Get invitation details response:",t.data),t.data}catch(t){throw(0,a.debugLog)("MBA4321 Error getting invitation details:",t),(0,a.debugLog)("MBA4321 Error details:",t.response?.data||t.message),t}},W=async e=>{try{(0,a.debugLog)("MBA4321 Verifying invitation:",{token:e}),(0,a.debugLog)("MBA4321 Verification endpoint:","".concat(r.API_BASE_URL,"/api/users/v1/invitations/").concat(e,"/verify/"));const t=await n.default.get("".concat(r.API_BASE_URL,"/api/users/v1/invitations/").concat(e,"/verify/"));return(0,a.debugLog)("MBA4321 Verify invitation response:",t.data),t.data}catch(t){throw(0,a.debugLog)("MBA4321 Error verifying invitation:",t),(0,a.debugLog)("MBA4321 Error details:",t.response?.data||t.message),t}},O=async e=>{try{(0,a.debugLog)("MBAnb23ou4bf954 Accepting invitation with token:",e);const t=await n.default.post("".concat(r.API_BASE_URL,"/api/users/v1/invitations/").concat(e,"/accept/"),{},{headers:{"Content-Type":"application/json"}});return(0,a.debugLog)("MBAnb23ou4bf954 Invitation accepted successfully:",t.data),t.data}catch(t){if((0,a.debugLog)("MBAnb23ou4bf954 Error accepting invitation:",t.message),t.response&&((0,a.debugLog)("MBAnb23ou4bf954 Error status:",t.response.status),(0,a.debugLog)("MBAnb23ou4bf954 Error data:",t.response.data),400===t.response.status&&"Invitation has already been used"===t.response.data?.error))return(0,a.debugLog)("MBAnb23ou4bf954 Invitation was already accepted (likely during registration), treating as success"),{success:!0,already_accepted:!0,message:"Invitation was already accepted"};throw 401===t.response?.status?t.message="You must be logged in to accept this invitation":t.response?.data?.error&&(t.message=t.response.data.error),t}},N=async e=>{try{return(0,a.debugLog)("MBA4321 Deleting invitation:",{token:e}),await n.default.delete("".concat(r.API_BASE_URL,"/api/users/v1/invitations/").concat(e,"/")),(0,a.debugLog)("MBA4321 Delete invitation success"),!0}catch(t){throw(0,a.debugLog)("MBA4321 Error deleting invitation:",t),(0,a.debugLog)("MBA4321 Error details:",t.response?.data||t.message),t}},H=async e=>{try{(0,a.debugLog)("MBA4321 Resending invitation:",{token:e});const t=await n.default.post("".concat(r.API_BASE_URL,"/api/users/v1/invitations/").concat(e,"/resend/"));return(0,a.debugLog)("MBA4321 Resend invitation response:",t.data),t.data}catch(t){throw(0,a.debugLog)("MBA4321 Error resending invitation:",t),(0,a.debugLog)("MBA4321 Error details:",t.response?.data||t.message),t}},U=async(e,t)=>{try{(0,a.debugLog)("MBA98765 - Updating booking draft rates:",{draftId:e,occurrences:t});const o=await n.default.post("".concat(r.API_BASE_URL,"/api/booking_drafts/v1/update-rates/").concat(e,"/"),{occurrences:t});return(0,a.debugLog)("MBA98765 - Booking draft rates update response:",o.data),o.data}catch(o){throw(0,a.debugLog)("MBA98765 Error updating booking draft rates:",o),o}},V=async(e,t=!1)=>{try{(0,a.debugLog)("MBA66777 - Creating booking from draft:",{conversationId:e,termsOfServiceAgreedByPro:t});const o=await n.default.post("".concat(r.API_BASE_URL,"/api/bookings/v1/create-from-draft/"),{conversation_id:e,terms_of_service_agreed_by_pro:t});return(0,a.debugLog)("MBA66777 - Booking created from draft:",o.data),o.data}catch(o){throw(0,a.debugLog)("MBA66777 Error creating booking from draft:",o),o}},q=async(e,t)=>{try{(0,a.debugLog)("MBA88888 - Updating draft notes from pro:",{conversationId:e,notesFromPro:t});const o=await n.default.post("".concat(r.API_BASE_URL,"/api/booking_drafts/v1/update-notes-from-pro/"),{conversation_id:e,notes_from_pro:t});return(0,a.debugLog)("MBA88888 - Draft notes updated successfully:",o.data),o.data}catch(o){throw(0,a.debugLog)("MBA88888 Error updating draft notes:",o),o}},Y=async e=>{try{(0,a.debugLog)("MBA9876: Fetching booking draft dates and times:",e);const t=await n.default.get("".concat(r.API_BASE_URL,"/api/booking_drafts/v1/").concat(e,"/dates_and_times/"));return(0,a.debugLog)("MBA9876: Draft dates and times fetched successfully"),t.data}catch(t){throw(0,a.debugLog)("MBA9876: Error fetching booking draft dates and times:",t),t}},G=async e=>{try{(0,a.debugLog)("MBA6428: Creating draft from booking:",{bookingId:e});const t=await n.default.post("".concat(r.API_BASE_URL,"/api/booking_drafts/v1/create-from-booking/").concat(e,"/"),{});return(0,a.debugLog)("MBA6428: Draft created successfully:",t.data),t.data}catch(t){if((0,a.debugLog)("MBA6428: Error creating draft from booking:",t),t.response?.data)return{error:!0,status:t.response.status,message:t.response.data.error||"Failed to create draft from booking",data:t.response.data};throw t}},J=async(e={})=>{try{(0,a.debugLog)("MBA9999","Searching professionals with params:",e);const t=await n.default.post("".concat(r.API_BASE_URL,"/api/professionals/v1/search/"),e);return(0,a.debugLog)("MBA9999","Professional search completed successfully"),t.data}catch(t){throw(0,a.debugLog)("MBA9999","Error searching professionals:",t.response?.data||t.message),t}},$=async e=>{try{(0,a.debugLog)("MBA9999","Getting detailed services for professional:",e);const t=await n.default.get("".concat(r.API_BASE_URL,"/api/professionals/v1/services/").concat(e,"/"));return(0,a.debugLog)("MBA9999","Professional services fetched successfully"),t.data}catch(t){throw(0,a.debugLog)("MBA9999","Error fetching professional services:",t.response?.data||t.message),t}},K=async e=>{try{(0,a.debugLog)("MBA3456","Creating conversation with professional:",e);const t=await n.default.post("".concat(r.API_BASE_URL,"/api/conversations/v1/create/"),{professional_id:e});return(0,a.debugLog)("MBA3456","Conversation created successfully:",t.data),t.data}catch(t){throw(0,a.debugLog)("MBA3456","Error creating conversation:",t.response?.data||t.message),t}},Z=async()=>{try{(0,a.debugLog)("MBA4321: Fetching unread message count");const e=await n.default.get("".concat(r.API_BASE_URL,"/api/messages/v1/unread-count/"));return(0,a.debugLog)("MBA4321: Unread count fetched:",e.data),e.data}catch(e){throw(0,a.debugLog)("MBA4321: Error with unread message count:",e.message),e}},X=async()=>{try{(0,a.debugLog)("MBA3210: Fetching conversations with online status data");const e=await n.default.get("".concat(r.API_BASE_URL,"/api/conversations/v1/"));return(0,a.debugLog)("MBA3210: Fetched ".concat(e.data?.length||0," conversations with online status data")),e.data}catch(e){throw(0,a.debugLog)("MBA3210: Error fetching conversations:",e),e}},Q=async(e,t=1)=>{if(!e||"undefined"===e||"null"===e)throw(0,a.debugLog)("MBA4321: No conversation ID provided"),new Error("No conversation ID provided");try{(0,a.debugLog)("MBA4321: Fetching messages for conversation:",e,"page:",t);const o=await n.default.get("".concat(r.API_BASE_URL,"/api/messages/v1/conversation/").concat(e,"/"),{params:{page:t}});return(0,a.debugLog)("MBA4321: Messages fetched successfully:",o.data),o.data}catch(o){throw(0,a.debugLog)("MBA4321: Error fetching messages:",o),o}},ee=async e=>{if(!e||"undefined"===e||"null"===e)throw(0,a.debugLog)("MBA5678: No conversation ID provided"),new Error("No conversation ID provided");try{(0,a.debugLog)("MBA5678: Fetching incomplete bookings for conversation:",e);const t=await n.default.get("".concat(r.API_BASE_URL,"/api/messages/v1/conversation/").concat(e,"/incomplete-bookings/"));return(0,a.debugLog)("MBA5678: Incomplete bookings fetched successfully:",t.data),t.data}catch(t){throw(0,a.debugLog)("MBA5678: Error fetching incomplete bookings:",t),t}},te=async()=>{try{(0,a.debugLog)("MBA5677: Fetching professional dashboard data");const e=await n.default.get("".concat(r.API_BASE_URL,"/api/professionals/v1/dashboard/"));return(0,a.debugLog)("MBA5677: Professional dashboard data fetched successfully:",e.data),e.data}catch(e){throw(0,a.debugLog)("MBA5677: Error fetching professional dashboard data:",e),e}},oe=async()=>{try{(0,a.debugLog)("MBA5677: Fetching client dashboard data");const e=await n.default.get("".concat(r.API_BASE_URL,"/api/clients/v1/dashboard/"));return(0,a.debugLog)("MBA5677: Client dashboard data fetched successfully:",e.data),e.data}catch(e){throw(0,a.debugLog)("MBA5677: Error fetching client dashboard data:",e),e}},ne=async e=>{try{if((0,a.debugLog)("MBA3456","Fetching client pets for conversation:",e),!e)throw(0,a.debugLog)("MBA3456","Error: No conversation_id provided to getClientPets"),new Error("No conversation_id provided");const t=await n.default.get("".concat(r.API_BASE_URL,"/api/clients/v1/get-pets/"),{params:{conversation_id:e}});return(0,a.debugLog)("MBA3456","Client pets fetched successfully:",t.data),t.data}catch(t){throw(0,a.debugLog)("MBA3456","Error fetching client pets:",t.response?.data||t.message),t}},re=async(e,t)=>{try{(0,a.debugLog)("MBA5678: Uploading message image for conversation:",e);const o=new FormData;if(o.append("conversation_id",e),"string"===typeof t){(0,a.debugLog)("MBA5678: Image data is a string, sending as base64");const o=await n.default.post("".concat(r.API_BASE_URL,"/api/messages/v1/upload_image/"),{conversation_id:e,image_data:t});return(0,a.debugLog)("MBA5678: Image uploaded successfully:",o.data),o.data}{(0,a.debugLog)("MBA5678: Image data is a File/Blob, sending as multipart/form-data"),o.append("image_file",t);const e=await n.default.post("".concat(r.API_BASE_URL,"/api/messages/v1/upload_image/"),o,{headers:{"Content-Type":"multipart/form-data"}});return(0,a.debugLog)("MBA5678: Image uploaded successfully:",e.data),e.data}}catch(o){throw(0,a.debugLog)("MBA5678: Error uploading message image:",o),o}},ae=async(e,t=1024,o=.7)=>{try{return(0,a.debugLog)("MBA5511: Attempting to compress image:",{uriType:typeof e,isBase64:"string"===typeof e&&e.startsWith("data:image"),platform:"web"}),"string"===typeof e&&e.startsWith("data:image")?se(e,t,o):ie(e,t,o)}catch(n){return(0,a.debugLog)("MBA5511: Error compressing image:",n),e}},ie=(e,t,o)=>new Promise(((n,r)=>{if("undefined"===typeof document||"undefined"===typeof Image)return(0,a.debugLog)("MBA5511: Web APIs not available, returning original image"),void n(e);const i=new Image;i.crossOrigin="Anonymous",i.src=e,i.onload=()=>{try{let r=i.width,s=i.height;if((r>3e3||s>3e3)&&(t=Math.min(t,600),o=Math.min(o,.4),(0,a.debugLog)("MBA5511: Extra compression applied for very large image",{originalWidth:r,originalHeight:s,newMaxWidth:t,newQuality:o})),r>t){const e=t/r;r=t,s*=e}if(r<t&&r*s<25e4)return(0,a.debugLog)("MBA5511: Image already small enough, skipping compression"),void n(e);const l=document.createElement("canvas");l.width=r,l.height=s;const d=l.getContext("2d");if(i.width>2*r){const e=document.createElement("canvas"),t=e.getContext("2d"),o=Math.min(i.width,2*r),n=o/i.width*i.height;e.width=o,e.height=n,t.drawImage(i,0,0,o,n),d.drawImage(e,0,0,r,s)}else d.drawImage(i,0,0,r,s);const c=l.toDataURL("image/jpeg",o);(0,a.debugLog)("MBA5511: Image compressed successfully",{originalDimensions:"".concat(i.width,"x").concat(i.height),newDimensions:"".concat(r,"x").concat(s),quality:o,sizeReduction:e.length>0?(100*(1-c.length/e.length)).toFixed(2)+"%":"unknown"}),n(c)}catch(r){(0,a.debugLog)("MBA5511: Error in canvas compression:",r),n(e)}},i.onerror=t=>{(0,a.debugLog)("MBA5511: Image loading error:",t),n(e)}})),se=(e,t,o)=>new Promise(((n,r)=>{if("undefined"===typeof document||"undefined"===typeof Image)return(0,a.debugLog)("MBA5511: Web APIs not available, returning original base64"),void n(e);const i=new Image;i.src=e,i.onload=()=>{try{let r=i.width,s=i.height;if((r>3e3||s>3e3)&&(t=Math.min(t,600),o=Math.min(o,.4),(0,a.debugLog)("MBA5511: Extra compression applied for very large image",{originalWidth:r,originalHeight:s,newMaxWidth:t,newQuality:o})),r>t){const e=t/r;r=t,s*=e}if(r<t&&r*s<25e4)return(0,a.debugLog)("MBA5511: Base64 image already small enough, skipping compression"),void n(e);const l=document.createElement("canvas");l.width=r,l.height=s;const d=l.getContext("2d");if(i.width>2*r){const e=document.createElement("canvas"),t=e.getContext("2d"),o=Math.min(i.width,2*r),n=o/i.width*i.height;e.width=o,e.height=n,t.drawImage(i,0,0,o,n),d.drawImage(e,0,0,r,s)}else d.drawImage(i,0,0,r,s);const c=l.toDataURL("image/jpeg",o);(0,a.debugLog)("MBA5511: Base64 image compressed successfully",{originalDimensions:"".concat(i.width,"x").concat(i.height),newDimensions:"".concat(r,"x").concat(s),quality:o,sizeReduction:e.length>0?(100*(1-c.length/e.length)).toFixed(2)+"%":"unknown"}),n(c)}catch(r){(0,a.debugLog)("MBA5511: Error in canvas compression:",r),n(e)}},i.onerror=t=>{(0,a.debugLog)("MBA5511: Base64 image loading error:",t),n(e)}})),le=async(e,t,o="")=>{try{if((0,a.debugLog)("MBA5511: Uploading and sending image message directly:",{conversationId:e,imageCount:t.length,hasCaption:!!o?.trim().length}),!t||0===t.length)throw new Error("No images provided for upload");const i=t.reduce(((e,t)=>t.base64?e+.75*t.base64.length:t.size?e+t.size:e+1e6),0);let s=1024,l=.7;i>4194304?(s=800,l=.5):i>2097152&&(s=1024,l=.6),(0,a.debugLog)("MBA5511: Compression settings:",{totalEstimatedSizeMB:(i/1048576).toFixed(2)+"MB",maxWidth:s,quality:l});const d=await Promise.all(t.map((async e=>{let t;return t=e.base64?"data:image/jpeg;base64,".concat(e.base64):e.uri?e.uri:e,await ae(t,s,l)})));(0,a.debugLog)("MBA5511: Images compressed and ready for upload",{imageCount:d.length});const c=await n.default.post("".concat(r.API_BASE_URL,"/api/messages/v1/upload_and_send/"),{conversation_id:e,content:o||"",images:d});(0,a.debugLog)("MBA5511: Image message uploaded and sent successfully:",{messageId:c.data.message_id,imageCount:t.length,hasCaption:!!o});return{message_id:c.data.message_id,content:o||"",sent_by_other_user:!1,timestamp:(new Date).toISOString(),type_of_message:"image_message",status:"sent",is_clickable:!1,image_urls:c.data.image_urls||[],metadata:{image_urls:c.data.image_urls||[]}}}catch(i){throw(0,a.debugLog)("MBA5511: Error uploading and sending image message:",i),i}},de=async(e,t,o="")=>le(e,t,o),ce=async e=>{try{(0,a.debugLog)("MBA8675309: Marking booking as completed:",e);const t=await n.default.post("".concat(r.API_BASE_URL,"/api/bookings/v1/").concat(e,"/mark_completed/"),{});return(0,a.debugLog)("MBA8675309: Booking marked as completed successfully"),t.data}catch(t){throw(0,a.debugLog)("MBA8675309: Error marking booking as completed:",t),(0,a.debugLog)("MBA8675309: Error details:",t.response?.data||t.message),t}},ue=async(e,t)=>{try{(0,a.debugLog)("MBA5511: Sending text message:",{conversationId:e,contentLength:t?.length||0});const o=await n.default.post("".concat(r.API_BASE_URL,"/api/messages/v1/send_norm_message/"),{conversation_id:e,content:t.trim()});return(0,a.debugLog)("MBA5511: Text message sent successfully"),o.data}catch(o){throw(0,a.debugLog)("MBA5511: Error sending text message:",o),(0,a.debugLog)("MBA5511: Error details:",o.response?.data||o.message),o}},ge=async e=>{try{(0,a.debugLog)("MBA8675309: Submitting booking review:",e);const t=await n.default.post("".concat(r.API_BASE_URL,"/api/bookings/v1/").concat(e.bookingId,"/review/"),{rating:e.rating,review_text:e.reviewText,is_professional_review:e.isProfessional,conversation_id:e.conversationId});return(0,a.debugLog)("MBA8675309: Review submitted successfully:",t.data),t.data}catch(t){throw(0,a.debugLog)("MBA8675309: Error submitting review:",t),(0,a.debugLog)("MBA8675309: Error details:",t.response?.data||t.message),t}},me=async(e=null,t=null,o=!1)=>{try{if((0,a.debugLog)("MBA387c439h","Fetching user reviews for conversation:",e,"isProfessional:",o),!e&&((0,a.debugLog)("MBA387c439h","No conversation_id provided to getUserReviews"),!t))throw new Error("No conversation_id or professional_id provided");const i=await n.default.get("".concat(r.API_BASE_URL,"/api/reviews/v1/get-user-reviews/"),{params:{conversation_id:e,professional_id:t,is_professional:o?1:0}});return(0,a.debugLog)("MBA387c439h","User reviews fetched successfully:",i.data),i.data}catch(i){throw(0,a.debugLog)("MBA387c439h","Error fetching user reviews:",i.response?.data||i.message),i}}},45010:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>_,handleBack:()=>C,navigateToFrom:()=>S});var n=o(36665),r=o(73929),a=o(6283),i=o(75675),s=o(15648),l=o(26725),d=(o(4701),o(40484)),c=o(7869),u=o(6541),g=o(38432),m=o(59742),h=(o(91087),o(16204)),f=o(8179),p=o(29483),y=o(95463),b=o(87744),x=o(15843),v=o(43538),w=o(60397);const C=async e=>{try{const t=await(0,g.getStorage)("previousRoute"),o=await(0,g.getStorage)("currentRoute");if(t&&t!==o){(0,g.debugLog)("MBA6789: handleBack - navigating to previous route",{from:o,to:t});const n=v.default.goBack(e);return n&&await(0,g.setStorage)("currentRoute",t),n}return"Dashboard"!==o&&((0,g.debugLog)("MBA6789: handleBack - no previous route, going to Dashboard",{from:o}),v.default.navigateTo(e,"Dashboard"),await(0,g.setStorage)("currentRoute","Dashboard"),!0)}catch(t){return(0,g.debugLog)("MBA6789: handleBack - error",t),!1}},S=async(e,t,o,n={})=>{try{const r=await(0,g.getStorage)("currentRoute");if(await(0,g.setStorage)("previousRoute",r),"MyProfile"===t){const e=await(0,g.getStorage)("MyProfileActiveTab");e&&(n.initialTab=e)}const a=v.default.getCurrentRoute(e);if(a.name===t&&r===t||(0,g.debugLog)("MBAuieo2o34nf navigateToFrom - current route check",{currentRouteName:a.name,currentPath:a.path,navigatingTo:t}),a.name===t&&r!==t)return await(0,g.setStorage)("currentRoute",t),void(0,g.debugLog)("MBAuieo2o34nf navigateToFrom - only updating state, already at route",{toLocation:t,currentRouteName:a.name});v.default.navigateTo(e,t,n),await(0,g.setStorage)("currentRoute",t),r!==t&&(0,g.debugLog)("MBAuieo2o34nf navigateToFrom - navigation complete",{from:o,to:t,params:n,previousRoute:r,newCurrentRoute:t,currentPath:a.path})}catch(r){(0,g.debugLog)("MBAuieo2o34nf navigateToFrom - error",r)}},j=()=>{try{return(0,f.useRoute)()||{name:"",params:{},key:""}}catch(e){return{name:"",params:{},key:""}}},T={code:'function anonymous(){const{size,color,line1TranslateY,line1Rotation}=this.__closure;return{width:size,height:3,backgroundColor:color,marginVertical:2,borderRadius:1.5,transform:[{translateY:line1TranslateY.value},{rotate:line1Rotation.value+"deg"}]};}'},B={code:"function anonymous(){const{size,color,line2Opacity}=this.__closure;return{width:size,height:3,backgroundColor:color,marginVertical:2,borderRadius:1.5,opacity:line2Opacity.value};}"},k={code:'function anonymous(){const{size,color,line3TranslateY,line3Rotation}=this.__closure;return{width:size,height:3,backgroundColor:color,marginVertical:2,borderRadius:1.5,transform:[{translateY:line3TranslateY.value},{rotate:line3Rotation.value+"deg"}]};}'},A=({propState:e,descriptors:t,propNavigation:i,shouldRender:C=!0})=>{const A=(0,f.useNavigation)(),_=j(),M=i||A,[L,R]=(0,n.useState)(!1),[D,z]=(0,n.useState)(l.default.get("window").width<900),[P,F]=(0,n.useState)(!1),[E,W]=(0,n.useState)(""),[O,N]=(0,n.useState)(3),{colors:H}=(0,h.useTheme)(),{isSignedIn:U,is_DEBUG:V,userRole:q,isCollapsed:Y,setIsCollapsed:G,switchRole:J,screenWidth:$,signOut:K,isApprovedProfessional:Z}=(0,n.useContext)(g.AuthContext),X=(0,n.useRef)(0);(0,n.useEffect)((()=>{X.current+=1}));const{hasUnreadMessages:Q,unreadCount:ee,ownerUnreadCount:te,professionalUnreadCount:oe,getCurrentRoleUnreadCount:ne,getOtherRoleUnreadCount:re,hasCurrentRoleUnreadMessages:ae,resetNotifications:ie,updateRoute:se}=(0,n.useContext)(m.default);(0,n.useEffect)((()=>{(0,g.debugLog)("MBA3uiobv59u: Navigation received notification update:",{hasUnreadMessages:Q,unreadCount:ee,ownerUnreadCount:te,professionalUnreadCount:oe,userRole:q,currentRoute:E})}),[Q,ee,te,oe,q]);const le=(0,p.useSharedValue)(0),de=(0,p.useSharedValue)(1),ce=(0,p.useSharedValue)(0),ue=(0,p.useSharedValue)(0),ge=(0,p.useSharedValue)(0),me=e?.routes?.[e?.index],he=_,fe=me?.name||he?.name||"",pe=me?.params?.selectedConversation||he?.params?.selectedConversation,ye="MessageHistory"===fe;(0,n.useEffect)((()=>{we(P)}),[P]);const be=(0,n.useRef)({routeName:fe,isInMessageHistory:ye,selectedConversation:pe,screenWidth:$});(be.current.routeName!==fe||be.current.isInMessageHistory!==ye||be.current.selectedConversation!==pe||be.current.screenWidth!==$)&&(be.current={routeName:fe,isInMessageHistory:ye,selectedConversation:pe,screenWidth:$},(0,g.debugLog)("MBAo3hi4g4v: Navigation render conditions",{routeName:fe,isInMessageHistory:ye,selectedConversation:pe,screenWidth:$,platform:"web",route:JSON.stringify(_?.params||e?.routes?.[e?.index]?.params),stateSource:e?"props":"hook",navSource:i?"props":"hook"})),(0,n.useEffect)((()=>{V&&(0,g.debugLog)("MBA98386196v Navigation State Update:",{isSignedIn:U,userRole:q,isApprovedProfessional:Z,currentRoute:E})}),[U,q,Z,E,V]),(0,n.useEffect)((()=>{Q&&(0,g.debugLog)("MBA2o3uihf48hv: Navigation notification state changed",{hasUnreadMessages:Q,unreadCount:ee,currentRoute:E,isInMessageHistory:"MessageHistory"===E,selectedConversationId:window.selectedConversationId})}),[Q,ee,E]),(0,n.useEffect)((()=>{const e=l.default.addEventListener("change",(()=>{z(l.default.get("window").width<900)}));return()=>{e?.remove()}}),[]);const xe=()=>{if("MessageHistory"===E){const e=window.selectedConversationId;e&&((0,g.debugLog)("MBA2o3uihf48hv: Checking if notifications need reset for selected conversation",{selectedConvId:e,currentRoute:E,hasUnreadMessages:Q,unreadCount:ee}),(Q||ee>0)&&ie&&ie(E,e))}};(0,n.useEffect)((()=>{window.selectedConversationId&&xe()}),[E,Q]),(0,n.useEffect)((()=>{if((0,g.debugLog)("MBA2o3uihf48hv: Navigation notification state update",{unreadCount:ee,hasUnreadMessages:Q,currentRoute:E,userRole:q,onMessagesScreen:"MessageHistory"===E,selectedConversationId:window.selectedConversationId}),(Q&&0===ee||!Q&&ee>0)&&(0,g.debugLog)("MBA2o3uihf48hv: \u26a0\ufe0f Inconsistent notification state detected",{hasUnreadMessages:Q,unreadCount:ee,userRole:q}),"undefined"!==typeof window.sessionStorage)try{const e="unreadCount_".concat(q);window.sessionStorage.setItem(e,ee.toString()),(0,g.debugLog)("MBA2o3uihf48hv: Stored unread count for role",{role:q,count:ee})}catch(e){}"MessageHistory"===E&&window.selectedConversationId&&ee>0&&xe()}),[ee,Q,E,q]),(0,n.useEffect)((()=>{const e=async()=>{try{const e=v.default.getCurrentRoute(M,_),t=e.name;if(t!==E&&(0,g.debugLog)("MBA2o3uihf48hv: Route check",{urlRoute:t,currentRoute:E,path:e.path}),t&&t!==E){if(W(t),await(0,g.setStorage)("currentRoute",t),se&&se(t),"MessageHistory"===t&&Q){const e=v.default.isWeb()?window.selectedConversationId:null;(0,g.debugLog)("MBA2o3uihf48hv: Navigation checking for selected conversation ID",{selectedConvId:e,hasUnreadMessages:Q,route:t}),ie&&ie(t,e)}return void(0,g.debugLog)("MBA2o3uihf48hv: Updated current route",{urlRoute:t,oldRoute:E,hasUnreadMessages:Q,unreadCount:ee})}const o=await(0,g.getStorage)("currentRoute");if(V&&o!==E&&(0,g.debugLog)("MBA98386196v Current Route Updated:",o),o&&o!==E){if(W(o),se&&se(o),"MessageHistory"===o&&Q){const e=v.default.isWeb()?window.selectedConversationId:null;(0,g.debugLog)("MBA2o3uihf48hv: Navigation checking for selected conversation ID from storage",{selectedConvId:e,hasUnreadMessages:Q,route:o}),ie&&ie(o,e)}(0,g.debugLog)("MBA2o3uihf48hv: Updated current route from storage",{route:o,oldRoute:E,hasUnreadMessages:Q,unreadCount:ee})}}catch(e){console.error("Error updating current route:",e)}};e();let t=()=>{};M&&"function"===typeof M.addListener?t=M.addListener("state",e):(0,g.debugLog)("MBA4477: Warning - navigation.addListener not available",{navigationExists:!!M,addListenerExists:M&&"function"===typeof M.addListener});const o=v.default.addNavigationListener(((t,o)=>{(0,g.debugLog)("MBA4477: Detected navigation change, updating route",{routeName:t.name,path:t.path}),e()}));let n;if(v.default.isWeb()){let t=E;n=setInterval((()=>{const o=v.default.getCurrentRoute(M,_).name;o!==t&&o!==E&&(t=o,e())}),5e3)}return()=>{"function"===typeof t&&t(),o(),n&&clearInterval(n)}}),[M,ie,se,Q,E,_]);const ve=({size:e=28,color:t=u.theme.colors.text})=>{const o=(0,y.useAnimatedStyle)(function(){const o=()=>({width:e,height:3,backgroundColor:t,marginVertical:2,borderRadius:1.5,transform:[{translateY:ue.value},{rotate:"".concat(le.value,"deg")}]});return o.__closure={size:e,color:t,line1TranslateY:ue,line1Rotation:le},o.__workletHash=1130445313934,o.__initData=T,o}()),n=(0,y.useAnimatedStyle)(function(){const o=()=>({width:e,height:3,backgroundColor:t,marginVertical:2,borderRadius:1.5,opacity:de.value});return o.__closure={size:e,color:t,line2Opacity:de},o.__workletHash=238094918771,o.__initData=B,o}()),a=(0,y.useAnimatedStyle)(function(){const o=()=>({width:e,height:3,backgroundColor:t,marginVertical:2,borderRadius:1.5,transform:[{translateY:ge.value},{rotate:"".concat(ce.value,"deg")}]});return o.__closure={size:e,color:t,line3TranslateY:ge,line3Rotation:ce},o.__workletHash=7555450561358,o.__initData=k,o}());return(0,w.jsxs)(r.default,{style:{alignItems:"center",justifyContent:"center"},children:[(0,w.jsx)(b.AnimatedView,{style:o}),(0,w.jsx)(b.AnimatedView,{style:n}),(0,w.jsx)(b.AnimatedView,{style:a})]})},we=e=>{const t=300;(0,g.debugLog)("MBA4477: Animating hamburger menu",{toX:e,isMenuOpen:P}),e?(le.value=(0,x.withTiming)(45,{duration:t}),de.value=(0,x.withTiming)(0,{duration:t}),ce.value=(0,x.withTiming)(-45,{duration:t}),ue.value=(0,x.withTiming)(7,{duration:t}),ge.value=(0,x.withTiming)(-7,{duration:t})):(le.value=(0,x.withTiming)(0,{duration:t}),de.value=(0,x.withTiming)(1,{duration:t}),ce.value=(0,x.withTiming)(0,{duration:t}),ue.value=(0,x.withTiming)(0,{duration:t}),ge.value=(0,x.withTiming)(0,{duration:t}))},Ce=()=>R(!1),Se=()=>F(!P),je=(e,t={})=>{(0,g.debugLog)("MBA4477: Navigation handling",{route:e,currentRoute:E,params:t}),(e!==E||t.source)&&(F(!1),Ce(),S(M,e,E,t))},Te=async e=>{e!==q&&await J(e)},Be=async()=>{F(!1),Ce(),await K()},ke=()=>{let e=[];const t=ne(),o=ae();return(0,g.debugLog)("MBA3uiobv59u: Rendering mobile menu items:",{currentRoleCount:t,hasCurrentRoleUnread:o,userRole:q}),e=U?"professional"===q?[{icon:"view-dashboard-outline",label:"Dashboard",route:"Dashboard"},{icon:"message-text-outline",label:"Messages",route:"MessageHistory",notification:o,count:t},{icon:"briefcase-outline",label:"Services",route:"ServiceManager"},{icon:"account-group-outline",label:"Connections",route:"Connections"},{icon:"account-outline",label:"Profile",route:"MyProfile"},{icon:"email-outline",label:"Contact Us",route:"ContactUs"},{icon:"logout",label:"Logout",route:"logout",action:Be}]:[{icon:"view-dashboard-outline",label:"Dashboard",route:"Dashboard"},{icon:"message-text-outline",label:"Messages",route:"MessageHistory",notification:o,count:t},{icon:"magnify",label:"Search Pros",route:"SearchProfessionalsListing"},{icon:"account-group-outline",label:"Become Professional",route:"ContactUs",params:{source:"becomeProfessional"}},{icon:"account-outline",label:"Profile",route:"MyProfile"},{icon:"email-outline",label:"Contact Us",route:"ContactUs"},{icon:"logout",label:"Logout",route:"logout",action:Be}]:[{icon:"login",label:"Sign In",route:"SignIn"},{icon:"account-plus-outline",label:"Sign Up",route:"SignUp"},{icon:"magnify",label:"Search Pros",route:"SearchProfessionalsListing"}],(0,w.jsxs)(w.Fragment,{children:[U&&Z&&(0,w.jsxs)(r.default,{style:I.mobileRoleToggleContainer,children:[(0,w.jsx)(a.default,{style:I.mobileRoleToggleTitle,children:"Your Role"}),(0,w.jsxs)(r.default,{style:I.mobileRoleButtonsContainer,children:[(0,w.jsxs)(s.default,{style:[I.mobileRoleButton,"petOwner"===q&&I.mobileRoleButtonActive],onPress:()=>"owner"!==q&&Te("owner"),children:[(0,w.jsx)(a.default,{style:[I.mobileRoleButtonText,"petOwner"===q&&I.mobileRoleButtonTextActive],children:"Owner"}),"petOwner"!==q&&te>0&&(0,w.jsx)(r.default,{style:[I.roleNotificationBadge,{top:-8,right:-8}],children:(0,w.jsx)(a.default,{style:I.roleNotificationText,children:te})})]}),(0,w.jsxs)(s.default,{style:[I.mobileRoleButton,"professional"===q&&I.mobileRoleButtonActive],onPress:()=>"professional"!==q&&Te("professional"),children:[(0,w.jsx)(a.default,{style:[I.mobileRoleButtonText,"professional"===q&&I.mobileRoleButtonTextActive],children:"Professional"}),"professional"!==q&&oe>0&&(0,w.jsx)(r.default,{style:[I.roleNotificationBadge,{top:-8,right:-8}],children:(0,w.jsx)(a.default,{style:I.roleNotificationText,children:oe})})]})]})]}),e.map(((e,o)=>(0,w.jsxs)(s.default,{style:[I.mobileMenuItem,"logout"===e.route&&I.mobileLogoutItem],onPress:()=>{F(!1),e.action?e.action():je(e.route,e.params)},children:[(0,w.jsx)(c.default,{name:e.icon,size:24,color:"logout"===e.route?"#F26969":u.theme.colors.text}),(0,w.jsx)(a.default,{style:[I.mobileMenuItemText,"logout"===e.route&&I.mobileLogoutText],children:e.label}),"MessageHistory"===e.route&&t>0&&(0,w.jsx)(r.default,{style:I.mobileMessageNotificationBadge,children:(0,w.jsx)(a.default,{style:I.mobileMessageNotificationText,children:t})})]},o)))]})};return C?(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)(w.Fragment,{children:[!D&&U&&(0,w.jsx)(r.default,{style:I.navContainer,children:(()=>{const e=Y?72:250,{menuItems:t,logoutItem:n}=(()=>{let e=[],t=null;const o=ne(),n=ae();return(0,g.debugLog)("MBA3uiobv59u: Rendering menu items with notification state:",{hasUnreadMessages:Q,unreadCount:ee,ownerUnreadCount:te,professionalUnreadCount:oe,currentRoleCount:o,hasCurrentRoleUnread:n,userRole:q,currentRoute:E}),U?"professional"===q?(e=[{icon:"view-dashboard-outline",label:"Dashboard",route:"Dashboard"},{icon:"message-text-outline",label:"Messages",route:"MessageHistory",notification:n},{icon:"briefcase-outline",label:"Services",route:"ServiceManager"},{icon:"account-group-outline",label:"Connections",route:"Connections"},{icon:"account-outline",label:"Profile",route:"MyProfile"},{icon:"email-outline",label:"Contact Us",route:"ContactUs"}],t={icon:"logout",label:"Logout",route:"logout",action:Be}):(e=[{icon:"view-dashboard-outline",label:"Dashboard",route:"Dashboard"},{icon:"message-text-outline",label:"Messages",route:"MessageHistory",notification:n},{icon:"magnify",label:"Search Pros",route:"SearchProfessionalsListing"},{icon:"account-group-outline",label:"Become Professional",route:"ContactUs",params:{source:"becomeProfessional"}},{icon:"account-outline",label:"Profile",route:"MyProfile"},{icon:"email-outline",label:"Contact Us",route:"ContactUs"}],t={icon:"logout",label:"Logout",route:"logout",action:Be}):e=[{icon:"login",label:"Sign In",route:"SignIn"},{icon:"account-plus-outline",label:"Sign Up",route:"SignUp"},{icon:"magnify",label:"Search Pros",route:"SearchProfessionalsListing"}],{menuItems:e.map(((e,t)=>(0,w.jsxs)(s.default,{style:[I.sidebarItem,E===e.route&&I.activeItem],onPress:()=>e.action?e.action():je(e.route,e.params),children:[(0,w.jsx)(c.default,{name:e.icon,size:24,color:E===e.route?u.theme.colors.primary:u.theme.colors.text}),(0,w.jsx)(a.default,{style:[I.sidebarItemText,{color:E===e.route?u.theme.colors.primary:u.theme.colors.text,marginLeft:Y?0:12,display:Y?"none":"flex"}],children:e.label}),"MessageHistory"===e.route&&o>0&&(0,w.jsx)(r.default,{style:I.messageNotificationBadge,children:(0,w.jsx)(a.default,{style:I.messageNotificationText,children:o})})]},t))),logoutItem:t}})();return(0,w.jsxs)(r.default,{style:[I.sidebarContainer,{width:e}],children:[(0,w.jsx)(r.default,{style:I.sidebarLogoContainer,children:(0,w.jsx)(s.default,{style:I.logoButton,onPress:()=>je("Home"),children:(0,w.jsx)(d.default,{source:o(14082),style:[I.sidebarLogo,{width:Y?40:120,tintColor:u.theme.colors.primary}]})})}),(0,w.jsx)(s.default,{style:I.collapseButton,onPress:()=>G(!Y),children:(0,w.jsx)(c.default,{name:Y?"chevron-right":"chevron-left",size:24,color:u.theme.colors.text})}),(0,w.jsxs)(r.default,{style:I.menuItemsContainer,children:[U&&Z&&(0,w.jsxs)(r.default,{style:I.roleToggleContainer,children:[!Y&&(0,w.jsx)(a.default,{style:I.roleToggleTitle,children:"Your Role"}),(0,w.jsxs)(r.default,{style:I.roleButtonsContainer,children:[(0,w.jsxs)(s.default,{style:[I.roleButton,"petOwner"===q&&I.roleButtonActive],onPress:()=>Te("petOwner"),children:[(0,w.jsx)(a.default,{style:[I.roleButtonText,"petOwner"===q&&I.roleButtonTextActive,Y&&I.roleButtonTextCollapsed],children:Y?"O":"Owner"}),"petOwner"!==q&&te>0&&(0,w.jsx)(r.default,{style:[I.roleNotificationBadge,{top:-8,right:-8}],children:(0,w.jsx)(a.default,{style:I.roleNotificationText,children:te})})]}),(0,w.jsxs)(s.default,{style:[I.roleButton,"professional"===q&&I.roleButtonActive],onPress:()=>Te("professional"),children:[(0,w.jsx)(a.default,{style:[I.roleButtonText,"professional"===q&&I.roleButtonTextActive,Y&&I.roleButtonTextCollapsed],children:Y?"P":"Professional"}),"professional"!==q&&oe>0&&(0,w.jsx)(r.default,{style:[I.roleNotificationBadge,{top:-8,right:-8}],children:(0,w.jsx)(a.default,{style:I.roleNotificationText,children:oe})})]})]})]}),t]}),U&&n&&(0,w.jsx)(r.default,{style:I.logoutButtonContainer,children:(0,w.jsxs)(s.default,{style:I.sidebarItem,onPress:n.action,children:[(0,w.jsx)(c.default,{name:n.icon,size:24,color:"#F26969"}),(0,w.jsx)(a.default,{style:[I.sidebarItemText,{color:"#F26969",marginLeft:Y?0:12,display:Y?"none":"flex"}],children:n.label})]})})]})})()}),!D&&!U&&(0,w.jsxs)(r.default,{style:I.signedOutHeaderWeb,children:[(0,w.jsx)(s.default,{onPress:()=>je("Home"),children:(0,w.jsx)(d.default,{source:o(14082),style:[I.webLogo,{tintColor:u.theme.colors.primary}]})}),(0,w.jsx)(r.default,{style:I.mobileRightContent,children:(0,w.jsx)(s.default,{style:I.hamburgerMenuContainer,onPress:Se,children:(0,w.jsx)(ve,{size:24,color:u.theme.colors.text})})})]}),D&&(0,w.jsxs)(r.default,{style:[I.mobileHeader,{backgroundColor:u.theme.colors.surfaceContrast}],children:[(0,w.jsxs)(r.default,{style:I.mobileHeaderContent,children:[(0,w.jsx)(s.default,{onPress:()=>je("Home"),children:(0,w.jsx)(d.default,{source:o(14082),style:[I.mobileLogo,{width:120,height:40,tintColor:u.theme.colors.primary}]})}),(0,w.jsx)(r.default,{style:I.mobileRightContent,children:(0,w.jsxs)(s.default,{style:I.hamburgerMenuContainer,onPress:Se,children:[(0,w.jsx)(ve,{size:24,color:u.theme.colors.text}),U&&ee>0&&(0,w.jsx)(r.default,{style:I.hamburgerNotificationBadge,children:(0,w.jsx)(a.default,{style:I.hamburgerNotificationText,children:ee})})]})})]}),P&&(0,w.jsx)(r.default,{style:I.mobileMenu,children:ke()})]}),P&&!D&&!U&&(0,w.jsx)(r.default,{style:[I.mobileMenu,I.webDesktopMenu],children:ke()})]})}):null};function _(e){const{state:t,descriptors:o,navigation:r}=e,a=j(),[i,s]=(0,n.useState)(!0),{screenWidth:l}=(0,n.useContext)(g.AuthContext),d=t?.routes?.[t?.index],c=d?.name||a?.name||"",u=d?.params?.selectedConversation||a?.params?.selectedConversation,m="MessageHistory"===c;(0,n.useEffect)((()=>{if(m&&u&&l<=900){const e="undefined"!==typeof performance&&performance.navigation&&performance.navigation.type===performance.navigation.TYPE_RELOAD;(0,g.debugLog)("MBAo3hi4g4v: Page load check",{isPageReload:e||"API not available",hasURLParams:!!u,shouldCheckMessageState:i}),i&&s(!1)}}),[m,u,l,i]);const h=null!==u&&void 0!==u&&""!==u&&"null"!==u,f=!1;let p=!1;return p=m&&h&&l<=900&&!i,(0,g.debugLog)("MBAo3hi4g4v: Navigation visibility check",{routeName:c,selectedConversation:u,isMobilePlatform:f,platformOS:"web",shouldHideNavigation:p,isInMessageHistory:m,hasSelectedConversation:h,shouldCheckMessageState:i}),(0,w.jsx)(A,{propState:t,descriptors:o,propNavigation:r,shouldRender:!p})}const I=i.default.create({container:{display:"flex",backgroundColor:u.theme.colors.primary},content:{flex:1},header:{backgroundColor:u.theme.colors.primary},titleContainer:{justifyContent:"center"},titleContainer2:{flex:1,justifyContent:"center",flexDirection:"row",justifyContent:"flex-start"},title:{textAlign:"left",marginLeft:u.theme.spacing.medium,fontSize:u.theme.fontSizes.large,color:u.theme.colors.text,fontWeight:"bold",fontFamily:u.theme.fonts.header.fontFamily},desktopNav:{flexDirection:"row",justifyContent:"flex-end",alignItems:"center"},navItem:{marginHorizontal:u.theme.spacing.medium,fontSize:u.theme.fontSizes.medium,color:u.theme.colors.text,cursor:"pointer",fontFamily:u.theme.fonts.regular.fontFamily,fontWeight:"600"},customNavBar:{flexDirection:"row",justifyContent:"space-around",alignItems:"center",backgroundColor:u.theme.colors.primary,position:"absolute",bottom:0,left:0,right:0,paddingVertical:10,borderTopWidth:1,borderTopColor:u.theme.colors.border},navButton:{alignItems:"center",justifyContent:"center",height:60,paddingHorizontal:5},navText:{color:u.theme.colors.whiteText,fontSize:u.theme.fontSizes.small,marginTop:5,textAlign:"center",fontFamily:u.theme.fonts.regular.fontFamily,fontWeight:"600"},webNavItem:{marginHorizontal:u.theme.spacing.medium},webNavText:{fontSize:u.theme.fontSizes.medium,color:u.theme.colors.whiteText,fontFamily:u.theme.fonts.regular.fontFamily,fontWeight:"600"},navLinkContainer:{flexDirection:"row",alignItems:"center",marginHorizontal:6},sidebarContainer:{height:"100%",minHeight:"100vh",backgroundColor:u.theme.colors.surfaceContrast,borderRightWidth:0,position:"fixed",left:0,top:0,bottom:0,zIndex:1e3,display:"flex",flexDirection:"column",transition:"width 0.3s ease",borderTopRightRadius:24,borderBottomRightRadius:24},sidebarLogoContainer:{padding:16,borderBottomWidth:3,borderBottomColor:u.theme.colors.surface,alignItems:"center",backgroundColor:u.theme.colors.surfaceContrast},logoButton:{alignItems:"center"},sidebarLogo:{height:50,resizeMode:"contain"},collapseButton:{position:"absolute",right:-16,top:"50%",transform:[{translateY:-20}],width:32,height:40,backgroundColor:u.theme.colors.surfaceContrast,borderWidth:0,borderRadius:8,justifyContent:"center",alignItems:"center",zIndex:1001},menuItemsContainer:{flex:1,padding:16,backgroundColor:u.theme.colors.surfaceContrast},sidebarItem:{flexDirection:"row",alignItems:"center",padding:12,marginBottom:8,borderRadius:8,backgroundColor:"transparent",cursor:"pointer"},sidebarItemText:{marginLeft:12,fontSize:u.theme.fontSizes.medium,fontFamily:u.theme.fonts.regular.fontFamily,fontWeight:"500"},logoutButton:{width:"100%",padding:16,flexDirection:"row",alignItems:"center",borderTopWidth:0,backgroundColor:u.theme.colors.surfaceContrast,borderBottomRightRadius:24},logoutText:{marginLeft:12,fontSize:u.theme.fontSizes.medium,color:"#F26969",fontFamily:u.theme.fonts.regular.fontFamily,fontWeight:"500"},headerRight:{flexDirection:"row",alignItems:"center",gap:16,marginRight:16},notificationButton:{position:"relative",padding:8},notificationBadge:{position:"absolute",top:4,right:4,backgroundColor:u.theme.colors.error,borderRadius:10,minWidth:20,height:20,justifyContent:"center",alignItems:"center"},notificationCount:{color:u.theme.colors.whiteText,fontSize:12,fontWeight:"bold"},profileButton:{borderRadius:20,overflow:"hidden"},menuContent:{marginTop:45},mobileHeader:{width:"100%",paddingVertical:10,paddingHorizontal:20,borderBottomWidth:1,borderBottomColor:"rgba(255,255,255,0.1)",position:"relative"},mobileHeaderContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%"},mobileLogo:{resizeMode:"contain"},mobileRightContent:{flexDirection:"row",alignItems:"center",gap:15},mobileMenu:{position:"absolute",top:"100%",right:0,backgroundColor:u.theme.colors.surface,borderRadius:8,padding:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5,zIndex:1e3,marginRight:20,minWidth:250},mobileMenuItem:{flexDirection:"row",alignItems:"center",padding:12,borderRadius:8},mobileMenuItemText:{marginLeft:12,fontSize:16,color:u.theme.colors.text,fontFamily:u.theme.fonts.regular.fontFamily},profileContainer:{width:44,height:44,borderRadius:22,overflow:"hidden",justifyContent:"center",alignItems:"center"},iconButton:{padding:8,position:"relative"},notificationText:{color:u.theme.colors.whiteText,fontSize:12,fontWeight:"bold"},navContainer:{position:"fixed",top:0,left:0,bottom:0,zIndex:1e3,backgroundColor:u.theme.colors.surface,borderRightWidth:1,borderRightColor:u.theme.colors.border},activeItem:{backgroundColor:"#F0F9E5"},logoutItem:{marginTop:16,borderTopWidth:1,borderTopColor:u.theme.colors.border,paddingTop:16},roleToggleContainer:{padding:12,marginBottom:16,borderRadius:8,backgroundColor:"#F0F9E5"},roleToggleTitle:{fontSize:u.theme.fontSizes.medium,color:u.theme.colors.text,fontFamily:u.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:8},roleButtonsContainer:{flexDirection:"row",gap:8},roleButton:{flex:1,padding:8,borderRadius:6,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:u.theme.colors.primary,cursor:"pointer"},roleButtonDisabled:{opacity:.5,borderColor:u.theme.colors.border,cursor:"not-allowed"},roleButtonText:{fontSize:u.theme.fontSizes.small,fontFamily:u.theme.fonts.regular.fontFamily,color:u.theme.colors.primary},roleButtonTextDisabled:{color:u.theme.colors.border},roleButtonActive:{backgroundColor:u.theme.colors.primary},roleButtonTextActive:{color:u.theme.colors.surface},mobileRoleToggleContainer:{padding:16,marginBottom:8,borderBottomWidth:1,borderBottomColor:u.theme.colors.border},mobileRoleToggleTitle:{fontSize:u.theme.fontSizes.medium,color:u.theme.colors.text,fontFamily:u.theme.fonts.regular.fontFamily,fontWeight:"600",marginBottom:8},mobileRoleButtonsContainer:{flexDirection:"row",gap:8},mobileRoleButton:{flex:1,padding:8,borderRadius:6,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:u.theme.colors.primary},mobileRoleButtonDisabled:{opacity:.5,borderColor:u.theme.colors.border},mobileRoleButtonText:{fontSize:u.theme.fontSizes.small,fontFamily:u.theme.fonts.regular.fontFamily,color:u.theme.colors.primary},mobileRoleButtonTextDisabled:{color:u.theme.colors.border},mobileRoleButtonActive:{backgroundColor:u.theme.colors.primary},mobileRoleButtonTextActive:{color:u.theme.colors.surface},mobileLogoutItem:{borderTopWidth:1,borderTopColor:u.theme.colors.border,marginTop:8},mobileLogoutText:{color:"#F26969"},messageNotificationDot:{position:"absolute",top:"50%",right:-2,width:10,height:10,borderRadius:5,backgroundColor:u.theme.colors.error,borderWidth:1,borderColor:u.theme.colors.surface,transform:[{translateY:-5}]},mobileMessageNotificationDot:{position:"absolute",top:"50%",right:-2,width:8,height:8,borderRadius:4,backgroundColor:u.theme.colors.error,borderWidth:1,borderColor:u.theme.colors.surfaceContrast,transform:[{translateY:-4}]},messageNotificationBadge:{position:"absolute",top:"50%",right:-12,minWidth:22,height:22,borderRadius:11,backgroundColor:u.theme.colors.error,borderWidth:1,borderColor:u.theme.colors.surface,justifyContent:"center",alignItems:"center",paddingHorizontal:3,transform:[{translateY:-11}]},messageNotificationText:{color:"white",fontSize:12,fontWeight:"bold"},mobileMessageNotificationBadge:{position:"absolute",top:"50%",right:-10,minWidth:20,height:20,borderRadius:10,marginRight:10,backgroundColor:u.theme.colors.error,borderWidth:1,borderColor:u.theme.colors.surfaceContrast,justifyContent:"center",alignItems:"center",paddingHorizontal:3,transform:[{translateY:-10}]},mobileMessageNotificationText:{color:"white",fontSize:11,fontWeight:"bold"},roleNotificationIndicator:{position:"absolute",width:8,height:8,borderRadius:4,backgroundColor:u.theme.colors.error,borderWidth:1,borderColor:u.theme.colors.surface,zIndex:1,top:"50%",right:-4,transform:[{translateY:-4}]},roleNotificationBadge:{position:"absolute",minWidth:18,height:18,borderRadius:9,backgroundColor:u.theme.colors.error,borderWidth:1,borderColor:u.theme.colors.surface,justifyContent:"center",alignItems:"center",paddingHorizontal:3,zIndex:10,top:"50%",right:-9,transform:[{translateY:-9}]},roleNotificationText:{color:"white",fontSize:10,fontWeight:"bold"},hamburgerMenuContainer:{width:28,height:28,justifyContent:"center",alignItems:"center",position:"relative"},signedOutOptions:{flexDirection:"row",gap:8},signedOutButton:{padding:8,borderRadius:6,borderWidth:1,borderColor:u.theme.colors.primary},signedOutButtonText:{fontSize:u.theme.fontSizes.small,fontFamily:u.theme.fonts.regular.fontFamily,color:u.theme.colors.primary},signInButton:{backgroundColor:u.theme.colors.primary},signedOutHeaderWeb:{height:70,width:"100%",backgroundColor:u.theme.colors.surfaceContrast,flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingHorizontal:20,borderBottomWidth:1,borderBottomColor:u.theme.colors.border},webLogo:{height:40,width:120,resizeMode:"contain"},signedOutNavButtons:{flexDirection:"row",alignItems:"center",gap:24},webSignInButton:{backgroundColor:u.theme.colors.primary,paddingVertical:8,paddingHorizontal:16,borderRadius:8},webSignInText:{color:u.theme.colors.surface},webDesktopMenu:{position:"absolute",right:0,top:70,width:250},logoutButtonContainer:{paddingHorizontal:16,paddingVertical:16,borderTopWidth:1,borderTopColor:u.theme.colors.border,backgroundColor:u.theme.colors.surfaceContrast,borderBottomRightRadius:24},hamburgerNotificationBadge:{position:"absolute",top:-8,right:-8,minWidth:18,height:18,borderRadius:9,backgroundColor:u.theme.colors.error,borderWidth:1,borderColor:u.theme.colors.surface,justifyContent:"center",alignItems:"center",paddingHorizontal:3,zIndex:10},hamburgerNotificationText:{color:"white",fontSize:10,fontWeight:"bold"}})},64900:(e,t,o)=>{"use strict";o.r(t),o.d(t,{API_BASE_URL:()=>i,MEDIA_URL:()=>s,getMediaUrl:()=>l});var n=o(94070);(0,n.debugLog)("MBA1234: Environment Variables Loaded",{NODE_ENV:"production",STAGING_API_BASE_URL_ANDROID:"https://staging-ec2.crittrcove.com",STAGING_API_BASE_URL_IOS:"https://staging-ec2.crittrcove.com",STAGING_API_BASE_URL_WEB:"https://staging-ec2.crittrcove.com",PRODUCTION_API_BASE_URL_ANDROID:"https://api.crittrcove.com",PRODUCTION_API_BASE_URL_IOS:"https://api.crittrcove.com",PRODUCTION_API_BASE_URL_WEB:"https://api.crittrcove.com",DEV_API_BASE_URL_ANDROID:"http://10.0.2.2:8000",DEV_API_BASE_URL_IOS:"http://127.0.0.1:8000",DEV_API_BASE_URL_WEB:"http://10.0.0.169:8000",STAGING_MEDIA_URL:"https://staging-crittrcove-media.s3.amazonaws.com",PRODUCTION_MEDIA_URL:"https://crittrcove-prod-media.s3.amazonaws.com",platform:"web"});const r=!1,a=!1;let i,s;(0,n.debugLog)("MBA1234: Environment Configuration",{NODE_ENV:"production",isDevelopment:r,isStaging:a,isProduction:!0,platform:"web"}),i="https://api.crittrcove.com",s="https://crittrcove-prod-media.s3.amazonaws.com",(0,n.debugLog)("MBA1234: Selected API Base URL",{API_BASE_URL:i}),(0,n.debugLog)("MBA1234: Selected Media URL",{MEDIA_URL:s});const l=e=>e?e.startsWith("http")?e:"".concat(s).concat(e):null},38432:(e,t,o)=>{"use strict";o.r(t),o.d(t,{AuthContext:()=>x,AuthProvider:()=>j,IsProduction:()=>S,SCREEN_HEIGHT:()=>h,SCREEN_WIDTH:()=>m,debugLog:()=>y,getStorage:()=>v,setDebugEnabled:()=>p,setStorage:()=>w});var n=o(36665),r=o(91087),a=o(77109),i=o(64900),s=o(26725),l=o(36322),d=o(45010),c=o(50294),u=o(43538),g=o(60397);const m=s.default.get("window").width,h=s.default.get("window").height;let f=!1;const p=e=>{f=e},y=(e,...t)=>{f&&!e.includes("MBA3210")&&(t.length>0?console.log("".concat(e,":"),...t):console.log("".concat(e)))};class b{constructor(){this.accessToken=null,this.refreshToken=null,this.isRefreshing=!1,this.refreshSubscribers=[],this.tokenExpiryTime=null,this.lastValidation=null,this.authStateCallbacks=new Set,this.isSigningOut=!1,this.lastTokenCheck=0,this.TOKEN_REFRESH_THRESHOLD=1e4,this.TOKEN_PREEMPTIVE_REFRESH=3e3,this.VALIDATION_CACHE_TIME=3e4}onAuthStateChange(e){return this.authStateCallbacks.add(e),()=>this.authStateCallbacks.delete(e)}notifyAuthStateChange(e){y("MBA1111 Notifying auth state change:",e),this.authStateCallbacks.forEach((t=>{try{t(e)}catch(o){console.error("MBA1111 Error in auth state callback:",o)}}))}parseJwt(e){try{if(!e||"string"!==typeof e)return y("MBA1111 parseJwt: Invalid token provided"),null;const t=e.split(".");if(3!==t.length)return y("MBA1111 parseJwt: Token does not have 3 parts"),null;const o=t[1];if(!o)return y("MBA1111 parseJwt: No payload part found"),null;let n=o.replace(/-/g,"+").replace(/_/g,"/");const r=n.length%4;let a;return r&&(n+="=".repeat(4-r)),a=atob(n),JSON.parse(a)}catch(t){return console.error("MBA1111 Error parsing JWT:",t),y("MBA1111 parseJwt error details:",{tokenLength:e?e.length:0,tokenStart:e?e.substring(0,50):"null",errorMessage:t.message,errorStack:t.stack}),null}}getTimeUntilExpiry(e){const t=this.parseJwt(e);if(!t||!t.exp)return 0;const o=1e3*t.exp;return this.tokenExpiryTime=o,o-Date.now()}shouldRefreshToken(e){if(!e)return!1;const t=this.getTimeUntilExpiry(e),o=t<this.TOKEN_REFRESH_THRESHOLD&&t>0;return o&&y("MBA1111 Token should be refreshed - expires in ".concat(Math.round(t/1e3)," seconds")),o}async refreshTokens(){y("MBA1111 refreshTokens called");try{if(this.isRefreshing)return y("MBA1111 Token refresh already in progress, subscribing"),new Promise(((e,t)=>{this.refreshSubscribers.push({resolve:e,reject:t}),setTimeout((()=>{const o=this.refreshSubscribers.findIndex((t=>t.resolve===e));-1!==o&&(this.refreshSubscribers.splice(o,1),t(new Error("Token refresh timeout")))}),1e4)}));if(this.isRefreshing=!0,this.refreshSubscribers=[],!this.refreshToken)throw new Error("No refresh token available");if(this.getTimeUntilExpiry(this.refreshToken)<=0)throw y("MBA1111 Refresh token is expired, cannot refresh"),new Error("Refresh token expired");const e=Date.now();y("MBA1111 Making refresh token request to backend");const t=await fetch("".concat(i.API_BASE_URL,"/api/token/refresh/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:this.refreshToken})});if(!t.ok){const e=await t.json().catch((()=>({})));throw y("MBA1111 Token refresh failed with status:",t.status,e),new Error("Token refresh failed: ".concat(t.status))}const o=await t.json(),{access:n,refresh:r}=o;if(!n)throw new Error("No access token in refresh response");this.accessToken=n,r&&(y("MBA1111 New refresh token received, updating stored refresh token"),this.refreshToken=r,await w("refreshToken",r)),await w("userToken",n);const a=Date.now()-e;return y("MBA1111 Token refresh successful in ".concat(a,"ms")),this.refreshSubscribers.forEach((({resolve:e})=>{try{e(n)}catch(t){y("MBA1111 Error resolving refresh subscriber:",t)}})),n}catch(e){throw y("MBA1111 Token refresh failed:",e),this.refreshSubscribers.forEach((({reject:t})=>{try{t(e)}catch(o){y("MBA1111 Error rejecting refresh subscriber:",o)}})),await this.clearTokens(),e}finally{this.isRefreshing=!1,this.refreshSubscribers=[],y("MBA1111 Token refresh process completed")}}async getAccessToken(){if(this.isSigningOut)return y("MBA1111 getAccessToken: signing out, returning null"),null;if(this.accessToken){this.getTimeUntilExpiry(this.accessToken)<=0&&(y("MBA1111 getAccessToken: current token is expired, clearing it"),this.accessToken=null)}if(!this.accessToken&&this.refreshToken){y("MBA1111 getAccessToken: no access token but have refresh token, attempting refresh");try{await this.refreshTokens()}catch(e){return y("MBA1111 getAccessToken: failed to refresh token:",e),null}}if(this.accessToken&&this.shouldRefreshToken(this.accessToken)){if(this.getTimeUntilExpiry(this.accessToken)>0){y("MBA1111 getAccessToken: token needs refresh but still valid, attempting refresh");try{await this.refreshTokens()}catch(e){return y("MBA1111 getAccessToken: failed to refresh token:",e),this.getTimeUntilExpiry(this.accessToken)>0?(y("MBA1111 getAccessToken: refresh failed but token still valid, returning current token"),this.accessToken):null}}}if(this.accessToken){return this.getTimeUntilExpiry(this.accessToken)>0?this.accessToken:(y("MBA1111 getAccessToken: token is expired, returning null"),this.accessToken=null,null)}return y("MBA1111 getAccessToken: returning null, no token available"),null}async validateToken(e){const t=Date.now();if(this.lastValidation&&t-this.lastValidation<this.VALIDATION_CACHE_TIME){y("MBA1111 Using cached token validation");return this.getTimeUntilExpiry(e)>0}y("MBA1111 Performing server-side token validation");try{const o=await a.default.post("".concat(i.API_BASE_URL,"/api/token/verify/"),{token:e});return this.lastValidation=t,200===o.status}catch(o){return y("MBA1111 Token validation failed:",o.response?.status),!1}}async clearTokens(){try{localStorage.removeItem("userToken"),localStorage.removeItem("refreshToken"),this.accessToken=null,this.refreshToken=null}catch(e){console.error("MBA2ounf4f Error clearing tokens:",e)}}async setTokens(e,t){try{this.accessToken=e,this.refreshToken=t,localStorage.setItem("userToken",e),localStorage.setItem("refreshToken",t)}catch(o){throw console.error("MBA1111 Error setting tokens:",o),o}}isValidJWT(e){if(!e||"string"!==typeof e)return!1;const t=e.split(".");return 3===t.length&&t.every((e=>e&&e.length>0))}async initialize(){y("MBA2ounf4f Starting AuthService.initialize()");try{let t,o;if(y("MBA2ounf4f Attempting to get stored tokens"),t=await v("userToken"),o=await v("refreshToken"),!t||!o){const e=this.accessToken,n=this.refreshToken;e&&!t&&(y("MBA2ounf4f BRAVE RECOVERY: Restoring accessToken from memory to localStorage"),localStorage.setItem("userToken",e),t=e),n&&!o&&(y("MBA2ounf4f BRAVE RECOVERY: Restoring refreshToken from memory to localStorage"),localStorage.setItem("refreshToken",n),o=n)}if(y("MBA2ounf4f Raw tokens retrieved:",{accessTokenExists:!!t,refreshTokenExists:!!o,accessTokenLength:t?t.length:0,refreshTokenLength:o?o.length:0,accessTokenStart:t?t.substring(0,20)+"...":"null",refreshTokenStart:o?o.substring(0,20)+"...":"null"}),t&&!this.isValidJWT(t)&&(y("MBA2ounf4f Invalid access token found, clearing it",{tokenLength:t.length,tokenStart:t.substring(0,20)}),t=null,await w("userToken","")),o&&!this.isValidJWT(o)&&(y("MBA2ounf4f Invalid refresh token found, clearing it",{tokenLength:o.length,tokenStart:o.substring(0,20)}),o=null,await w("refreshToken","")),this.accessToken=t,this.refreshToken=o,y("MBA2ounf4f Tokens retrieved and validated:",{hasAccessToken:!!this.accessToken,hasRefreshToken:!!this.refreshToken}),this.accessToken&&this.shouldRefreshToken(this.accessToken)){y("MBA2ounf4f Token needs refresh during init");try{await this.refreshTokens()}catch(e){y("MBA2ounf4f Failed to refresh token during init:",e)}}return{hasAccessToken:!!this.accessToken,hasRefreshToken:!!this.refreshToken}}catch(t){return console.error("MBA2ounf4f Error in AuthService.initialize():",t),{hasAccessToken:!1,hasRefreshToken:!1}}}forceSignOut(e){this.isSigningOut||(y("MBA1111 Force sign out triggered. Reason: ".concat(e)),this.isSigningOut=!0,this.notifyAuthStateChange({type:"FORCE_SIGN_OUT",reason:e,timestamp:(new Date).toISOString()}))}}const x=(0,n.createContext)(),v=async e=>{try{if("userToken"===e||"refreshToken"===e){return localStorage.getItem(e)}try{const t=sessionStorage.getItem(e);if(t)return t}catch(t){y("MBAo34invid3w getStorage sessionStorage error, falling back to localStorage:",{key:e,error:t.message})}return localStorage.getItem(e)}catch(o){return console.error("MBA2ounf4f Error getting from storage:",o),null}},w=async(e,t)=>{try{y("MBAo34invid3w setStorage called:",{key:e,hasValue:!!t,valueLength:t?t.length:0,platform:"web"}),"userToken"===e||"refreshToken"===e?(localStorage.setItem(e,t),y("MBAo34invid3w setStorage web localStorage (auth) completed:",{key:e})):(sessionStorage.setItem(e,t),y("MBAo34invid3w setStorage web sessionStorage (non-auth) completed:",{key:e}))}catch(o){console.error("MBA2ounf4f Error setting storage:",o)}},C=!1,S=()=>C,j=({children:e})=>{const t=(0,n.useRef)(new b),m=(0,n.useRef)(!1),h=(0,n.useRef)(null),[f,p]=(0,n.useState)(!1),[w,S]=(0,n.useState)(null),[j,T]=(0,n.useState)(!1),[B,k]=(0,n.useState)(!0),[A,_]=(0,n.useState)(!1),[I,M]=(0,n.useState)(s.default.get("window").width),[L,R]=(0,n.useState)(""),[D,z]=(0,n.useState)(""),[P,F]=(0,n.useState)(!1),[E,W]=(0,n.useState)({timezone:"UTC",timezone_abbrev:"UTC",use_military_time:!1}),[O,N]=(0,n.useState)(!1),[H,U]=(0,n.useState)(!0);(0,n.useEffect)((()=>{}),[f,B]);const V=async(e="user_action")=>{y("MBAo34invid3w signOut called with reason:",e);try{if(t.current.isSigningOut)return void y("MBAo34invid3w Sign out already in progress, skipping");t.current.isSigningOut=!0,(e.includes("validation")||e.includes("expired")||e.includes("no_valid"))&&(y("MBAo34invid3w Immediate state update for auth failure"),p(!1),k(!1)),h.current&&(clearTimeout(h.current),h.current=null);try{(await Promise.resolve().then(o.bind(o,65688))).default.disconnect(),y("MBAo34invid3w WebSocket disconnected during signOut")}catch(n){y("MBAo34invid3w Error disconnecting websocket:",n)}y("MBAo34invid3w Clearing tokens and storage during signOut"),await t.current.clearTokens(),await r.default.multiRemove(["userRole","isApprovedProfessional"]),y("MBAo34invid3w Clearing web storage during signOut"),localStorage.removeItem("userToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("userRole"),localStorage.removeItem("isApprovedProfessional"),localStorage.removeItem("currentProfessional"),sessionStorage.removeItem("userRole"),sessionStorage.removeItem("isApprovedProfessional"),sessionStorage.removeItem("currentProfessional"),sessionStorage.setItem("explicitSignOut","true"),y("MBAo34invid3w Web storage cleared during signOut - auth tokens from localStorage, user data from both"),y("MBAo34invid3w Storage cleared during sign out"),p(!1),R(""),z(""),S(null),T(!1),W({timezone:"UTC",timezone_abbrev:"UTC",use_military_time:!1}),t.current.accessToken=null,t.current.refreshToken=null,y("MBAo34invid3w Auth state reset during signOut");const a=()=>{try{y("MBAo34invid3w Navigating to SignIn screen due to:",e),window.location?(window.location.href="/signin",y("MBAo34invid3w Web redirect to /signin successful")):(0,l.navigate)("SignIn")}catch(t){console.error("MBA1111 Navigation error during signOut:",t);try{u.default.redirectToSignIn(null)}catch(o){console.error("MBA1111 Platform navigation fallback also failed:",o)}}};e.includes("validation")||e.includes("expired")||e.includes("no_valid")||e.includes("server_validation")?(y("MBAo34invid3w Immediate navigation for auth failure"),a()):setTimeout(a,0),y("MBAo34invid3w Sign out completed successfully")}catch(n){y("MBAo34invid3w Error during sign out:",n),p(!1),k(!1);try{(0,l.navigate)("SignIn")}catch(a){console.error("MBA1111 Failed to navigate after signOut error:",a)}}finally{t.current.isSigningOut=!1}};(0,n.useEffect)((()=>t.current.onAuthStateChange((e=>{y("MBA1111 Auth state change received:",e),"FORCE_SIGN_OUT"===e.type&&(t.current.isSigningOut=!1,V(e.reason))}))),[]),(0,n.useEffect)((()=>{y("MBA1111 Setting up consolidated axios interceptors");let e=0,o=0;const n=a.default.interceptors.request.use((async e=>{if(O)y("MBA1111 Prototype mode - skipping token for: ".concat(e.method?.toUpperCase()," ").concat(e.url));else{if(e.url.includes("/api/users/v1/invitations/")&&e.url.includes("/verify/"))return y("MBAnb23ou4bf954 Skipping auth for invite verification endpoint: ".concat(e.url)),e;try{const o=await t.current.getAccessToken();if(o)e.headers.Authorization="Bearer ".concat(o),e.url.includes("/api/users/v1/invitations/")&&e.url.includes("/accept/")&&y("MBAnb23ou4bf954 Added auth token for invitation acceptance: ".concat(e.url));else if(y("MBAnb23ou4bf954 No token available for request: ".concat(e.method?.toUpperCase()," ").concat(e.url)),e.url.includes("/api/users/v1/invitations/")&&e.url.includes("/accept/")){y("MBAnb23ou4bf954 ERROR: Invitation acceptance requires authentication but no token available: ".concat(e.url));const t=new Error("Authentication required for invitation acceptance");throw t.name="NoTokenError",t}}catch(o){throw console.error("MBA1111 Error getting access token for request:",o),y("MBA9999 Token error for request: ".concat(e.method?.toUpperCase()," ").concat(e.url),o),f&&o.message&&(o.message.includes("No authentication token")||o.message.includes("expired")||o.message.includes("invalid"))&&(y("MBA9999 Auth service error while UI shows signed in - potential state inconsistency"),setTimeout((()=>{V("auth_service_error_while_signed_in")}),0)),o}}return e}),(e=>(y("MBA1111 Request interceptor error:",e),Promise.reject(e)))),r=a.default.interceptors.response.use((t=>(Date.now()-o>6e4&&(e=0),t)),(async n=>{const r=n.config;if(y("MBA1111 Response error: ".concat(n.response?.status," ").concat(n.config?.method?.toUpperCase()," ").concat(n.config?.url)),"NoTokenError"===n.name||"AbortError"===n.name)return Promise.reject(n);if(401===n.response?.status&&r&&!r._retry){const s=Date.now();if(s-o>6e4&&(e=0),e++,o=s,y("MBA2ounf4f 401 error detected (".concat(e,"/").concat(3,"), attempting token refresh"),{url:r.url,method:r.method}),e>=3)return y("MBA2ounf4f Circuit breaker triggered: Too many consecutive 401 errors, forcing sign out"),t.current.forceSignOut("too_many_auth_failures"),Promise.reject(n);r._retry=!0;try{const e=r.url?.includes("/api/core/log-auth-event/"),o=r.url?.includes("/api/messages/"),i=r.url?.includes("/api/conversations/");if(o||i)throw y("MBA9999 Skipping token refresh for message/conversation call during auth issues to prevent loops"),new Error("Auth failed for protected call");if(e)throw y("MBA1111 Auth logging call failed, not retrying to prevent loops"),n;{y("MBA1111 Attempting token refresh for failed request");const e=t.current.refreshTokens(),o=new Promise(((e,t)=>setTimeout((()=>t(new Error("Token refresh timeout"))),8e3)));await Promise.race([e,o]);const n=await t.current.getAccessToken();if(n)return r.headers.Authorization="Bearer ".concat(n),y("MBA1111 Retrying request with new token"),(0,a.default)(r);throw y("MBA1111 No new token available after refresh"),new Error("No token available after refresh")}}catch(i){throw y("MBA1111 Token refresh failed:",i),(i.message.includes("timeout")||e>=2)&&(y("MBA9999 Token refresh timeout or repeated failure, forcing sign out"),t.current.forceSignOut("token_refresh_failed")),n}}return y("MBA2ounf4f Axios response interceptor error:",{status:n.response?.status,url:n.config?.url,method:n.config?.method,message:n.message,isNetworkError:!n.response,errorCode:n.code,isBackendDown:"ECONNREFUSED"===n.code||"ERR_NETWORK"===n.code}),Promise.reject(n)}));return()=>{a.default.interceptors.request.eject(n),a.default.interceptors.response.eject(r)}}),[O]),(0,n.useEffect)((()=>{if(!f||O)return;let e=null;const o=()=>{y("MBAo34invid3w Window focus event triggered"),e&&clearTimeout(e),e=setTimeout((async()=>{if(y("MBAo34invid3w Window regained focus, checking token"),t.current&&!t.current.isSigningOut){const o=t.current.accessToken;if(o&&t.current.shouldRefreshToken(o)){y("MBAo34invid3w Token needs refresh on focus");try{await t.current.refreshTokens(),y("MBAo34invid3w Token refresh on focus successful")}catch(e){y("MBAo34invid3w Error refreshing token on focus:",e)}}else y("MBAo34invid3w Token does not need refresh on focus")}else y("MBAo34invid3w Auth service not available or signing out during focus check")}),500)},n=e=>{if(e.storageArea===sessionStorage){if(y("MBAo34invid3w SessionStorage change detected:",{key:e.key,newValue:e.newValue,oldValue:e.oldValue,url:e.url}),null===e.key&&null===e.newValue){y("MBAo34invid3w SessionStorage clear detected - checking if localStorage was affected");const e=localStorage.getItem("userToken"),o=localStorage.getItem("refreshToken");return y("MBAo34invid3w localStorage check after sessionStorage clear:",{hasUserToken:!!e,hasRefreshToken:!!o}),void(e||o||!f||(y("MBAo34invid3w BRAVE BROWSER ISSUE: sessionStorage.clear() affected localStorage - attempting recovery"),t.current.accessToken&&(localStorage.setItem("userToken",t.current.accessToken),y("MBAo34invid3w Restored userToken to localStorage from memory")),t.current.refreshToken&&(localStorage.setItem("refreshToken",t.current.refreshToken),y("MBAo34invid3w Restored refreshToken to localStorage from memory"))))}if(("userToken"===e.key||"refreshToken"===e.key)&&null===e.newValue)return void y("MBAo34invid3w Auth token removed from sessionStorage - ignoring as tokens are in localStorage")}};return"undefined"!==typeof document&&(y("MBAo34invid3w Setting up focus and storage event listeners for web"),window.addEventListener("focus",o),window.addEventListener("storage",n),document.addEventListener("visibilitychange",(()=>{y("MBAo34invid3w Visibility change event:",document.visibilityState),"visible"===document.visibilityState&&o()}))),()=>{e&&clearTimeout(e),"undefined"!==typeof document&&(window.removeEventListener("focus",o),window.removeEventListener("storage",n),document.removeEventListener("visibilitychange",o))}}),[f,O]),(0,n.useEffect)((()=>{let e;return e=setTimeout((async()=>{if(!m.current){await new Promise((e=>setTimeout(e,50)));try{y("MBAo34invid3w Initializing auth state");const{hasAccessToken:o,hasRefreshToken:n}=await t.current.initialize();if(y("MBAo34invid3w Auth initialization result:",{hasAccessToken:o,hasRefreshToken:n}),o||n){y("MBAo34invid3w Found stored tokens, validating...");let o=await v("userToken"),n=await v("refreshToken");y("MBAo34invid3w Retrieved stored tokens:",{hasAccessToken:!!o,hasRefreshToken:!!n,accessTokenLength:o?o.length:0,refreshTokenLength:n?n.length:0});let r=!1;if(o){const e=t.current.getTimeUntilExpiry(o);y("MBAo34invid3w Access token expiry check:",{timeUntilExpirySeconds:Math.round(e/1e3),isExpired:e<=0}),e>0?(y("MBAo34invid3w Access token is still valid"),r=!0):y("MBAo34invid3w Access token is expired")}if(!r&&n){const o=t.current.getTimeUntilExpiry(n);if(y("MBAo34invid3w Refresh token expiry check:",{timeUntilExpirySeconds:Math.round(o/1e3),isExpired:o<=0}),o>0){y("MBAo34invid3w Refresh token is valid, attempting token refresh");try{await t.current.refreshTokens(),r=!0,y("MBAo34invid3w Token refresh successful during initialization")}catch(e){y("MBAo34invid3w Token refresh failed during initialization:",e),r=!1}}else y("MBAo34invid3w Refresh token is also expired")}if(r){const o=await t.current.getAccessToken();if(o)try{const n=await t.current.validateToken(o);if(y("MBAo34invid3w Server-side token validation result:",n),n){y("MBAo34invid3w Token validated successfully, setting up user session"),p(!0),await q();const t=await Y(o);let n=null;try{n=await v("userRole")}catch(e){console.error("MBA1111 Error getting stored role:",e)}const r=!n||"professional"!==n&&"petOwner"!==n?t.suggestedRole:n;y("MBAo34invid3w Role selection:",{storedRole:n,suggestedRole:t.suggestedRole,finalRole:r,isApprovedProfessional:t.isApprovedProfessional}),S(r),T(t.isApprovedProfessional),await G(),y("MBAo34invid3w User session restored successfully")}else y("MBAo34invid3w Server-side token validation failed, signing out"),await V("server_validation_failed")}catch(e){y("MBAo34invid3w Error during token validation, signing out:",e),await V("validation_error")}else y("MBAo34invid3w Could not retrieve access token, signing out"),await V("no_access_token")}else y("MBAo34invid3w No valid tokens found, signing out"),await V("no_valid_tokens")}else y("MBAo34invid3w No tokens found during initialization - user needs to sign in"),p(!1),y("MBAo34invid3w Set isSignedIn to false due to no tokens")}catch(e){console.error("MBA1111 Error initializing auth state:",e),await V("initialization_error")}finally{k(!1),y("MBAo34invid3w Auth initialization completed, loading set to false"),m.current=!0,_(!0)}}}),10),()=>{e&&clearTimeout(e)}}),[]);const q=async()=>{try{y("MBA1111 Fetching user name");const e=await(0,c.getUserName)();y("MBA1111 User name response:",e),R(e.first_name),z(e.name)}catch(e){console.error("MBA1111 Error fetching user name:",e.response?e.response.data:e.message),R(""),z("")}},Y=async e=>{try{const t=await a.default.get("".concat(i.API_BASE_URL,"/api/professional-status/v1/"),{headers:{Authorization:"Bearer ".concat(e)}});y("MBA1111 Professional status response:",t.data);const{is_approved:o}=t.data;return T(o),localStorage.setItem("isApprovedProfessional",String(o)),{isApprovedProfessional:o,suggestedRole:o?"professional":"petOwner"}}catch(t){return console.error("MBA1111 Error getting professional status:",t.response?.data||t),{isApprovedProfessional:!1,suggestedRole:"petOwner"}}},G=async()=>{if(!O)try{const e=await(0,c.getTimeSettings)();W(e),y("MBA1111 Time settings response:",e)}catch(e){console.error("MBA1111 Error fetching time settings:",e.response?e.response.data:e.message)}};(0,n.useEffect)((()=>{const e=s.default.addEventListener("change",(({window:e})=>{M(e.width)}));return()=>{e?.remove&&e.remove()}}),[]),(0,n.useEffect)((()=>{if(B||O)return;const e=async()=>{try{const o=localStorage.getItem("userToken"),n=localStorage.getItem("refreshToken"),r=sessionStorage.getItem("userToken"),a=sessionStorage.getItem("refreshToken"),i=!!await v("userToken")||!!await v("refreshToken"),s=!!t.current.accessToken||!!t.current.refreshToken;if(y("MBAo34invid3w State consistency check:",{isSignedIn:f,hasStoredTokens:i,hasMemoryTokens:s,localStorageUserToken:!!o,localStorageRefreshToken:!!n,sessionStorageUserToken:!!r,sessionStorageRefreshToken:!!a,isSigningOut:t.current.isSigningOut,platform:"web"}),f&&!i&&!s&&!t.current.isSigningOut)return o||n?(y("MBAo34invid3w POTENTIAL SESSIONSTORAGE ISSUE: localStorage has tokens but getStorage() failed - checking..."),o&&(t.current.accessToken=o),n&&(t.current.refreshToken=n),void y("MBAo34invid3w Restored tokens from localStorage directly - continuing session")):t.current.accessToken?(y("MBAo34invid3w BRAVE BROWSER RECOVERY: Attempting to restore tokens from memory"),localStorage.setItem("userToken",t.current.accessToken),t.current.refreshToken&&localStorage.setItem("refreshToken",t.current.refreshToken),void y("MBAo34invid3w BRAVE BROWSER RECOVERY: Tokens restored from memory to localStorage")):(y("MBAo34invid3w CRITICAL STATE INCONSISTENCY: UI shows signed in but no tokens exist - immediate redirect"),void await V("state_inconsistency_no_tokens"));if(f&&(i||s)&&!t.current.isSigningOut){const o=await v("userToken");if(o){const n=t.current.getTimeUntilExpiry(o);if(y("MBAo34invid3w Token expiry check in consistency:",{timeUntilExpirySeconds:Math.round(n/1e3),isExpired:n<=0}),n<=0){y("MBAo34invid3w CRITICAL STATE INCONSISTENCY: UI shows signed in but token is expired");const o=await v("refreshToken");if(!o)return y("MBAo34invid3w No refresh token available, signing out"),void await V("state_inconsistency_no_refresh_token");{const n=t.current.getTimeUntilExpiry(o);if(y("MBAo34invid3w Refresh token expiry check in consistency:",{timeUntilExpirySeconds:Math.round(n/1e3),isExpired:n<=0}),n<=0)return y("MBAo34invid3w Refresh token also expired - forcing sign out"),void await V("state_inconsistency_all_tokens_expired");y("MBAo34invid3w Attempting emergency token refresh");try{await t.current.refreshTokens(),y("MBAo34invid3w Emergency token refresh successful")}catch(e){return y("MBAo34invid3w Emergency token refresh failed, signing out"),void await V("state_inconsistency_refresh_failed")}}}}}if(!f&&(i||s)&&!t.current.isSigningOut){y("MBAo34invid3w STATE INCONSISTENCY DETECTED: UI shows signed out but tokens exist");try{const e=await t.current.getAccessToken();if(e){const o=await t.current.validateToken(e);if(y("MBAo34invid3w Token validation for session restoration:",o),o){y("MBAo34invid3w Restoring session with valid tokens"),p(!0),await q();const t=await Y(e);return S(t.suggestedRole),void T(t.isApprovedProfessional)}}}catch(e){y("MBAo34invid3w Failed to restore session:",e)}await V("state_inconsistency_invalid_tokens")}}catch(e){y("MBAo34invid3w Error in state consistency check:",e),f&&(y("MBAo34invid3w Error during consistency check while signed in - signing out for safety"),await V("state_consistency_check_error"))}},o=setTimeout(e,1e3),n=setInterval(e,15e3);return()=>{clearTimeout(o),clearInterval(n)}}),[f,B,O]),(0,n.useEffect)((()=>{if(!f||O)return;const e=setInterval((async()=>{try{const o=await t.current.getAccessToken();if(o){const n=t.current.getTimeUntilExpiry(o),r=t.current.shouldRefreshToken(o);if(y("MBAo34invid3w Token monitor check:",{timeUntilExpirySeconds:Math.round(n/1e3),shouldRefresh:r,isRefreshing:t.current.isRefreshing,platform:"web"}),n<0&&y("MBAo34invid3w TOKEN EXPIRED DETECTED in monitor"),r&&!t.current.isRefreshing){y("MBAo34invid3w Token monitor triggering proactive refresh");try{await t.current.refreshTokens(),y("MBAo34invid3w Proactive token refresh completed successfully")}catch(e){y("MBAo34invid3w Proactive token refresh failed:",e)}}{const e=localStorage.getItem("userToken"),n=localStorage.getItem("refreshToken");!e&&o&&(y("MBAo34invid3w BRAVE SAFEGUARD: Token missing from localStorage, restoring"),localStorage.setItem("userToken",o)),!n&&t.current.refreshToken&&(y("MBAo34invid3w BRAVE SAFEGUARD: Refresh token missing from localStorage, restoring"),localStorage.setItem("refreshToken",t.current.refreshToken))}}else y("MBAo34invid3w Token monitor: No token available")}catch(e){y("MBAo34invid3w Error in token monitor:",e)}}),2e3);return()=>clearInterval(e)}),[f,O]);return(0,g.jsx)(x.Provider,{value:{isSignedIn:f,userRole:w,isApprovedProfessional:j,loading:B,isInitialized:A,screenWidth:I,firstName:L,name:D,is_prototype:O,is_DEBUG:H,is_PRODUCTION:C,timeSettings:E,isCollapsed:P,setIsCollapsed:F,signIn:async(e,o,n)=>{try{y("MBA1111 Starting sign in process"),t.current.isSigningOut=!1,await t.current.setTokens(e,o),p(!0),await q();try{const e=await(0,c.getTimeSettings)();W(e),y("MBA1111 Time settings fetched during sign in:",e)}catch(r){console.error("MBA1111 Error fetching time settings during sign in:",r)}const a=await Y(e),i=a.suggestedRole;return S(i),T(a.isApprovedProfessional),localStorage.setItem("userRole",i),y("MBA1111 Sign in successful:",{initialRole:i,isApprovedProfessional:a.isApprovedProfessional}),n&&setTimeout((()=>{(0,d.navigateToFrom)(n,"Dashboard","SignIn")}),0),{userRole:i,isApprovedProfessional:a.isApprovedProfessional}}catch(a){throw y("MBA1111 Sign in error:",a),console.error("MBA1111 Error during sign in:",a),a}},signOut:V,switchRole:async e=>{if(j){y("MBA1111 Switching role, current role:",w);const o="professional"===w?"petOwner":"professional";S(o);try{localStorage.setItem("userRole",o);const t=e?.getCurrentRoute?.()?.name;"petOwner"===o&&"Connections"===t&&(y("MBA1111 Navigating to Dashboard from Connections when switching to pet owner"),(0,l.navigate)("Dashboard")),y("MBA1111 Role switched to:",o)}catch(t){console.error("MBA1111 Error updating role in storage:",t)}}else console.log("MBA1111 User is not an approved professional, cannot switch roles")},setIsDebug:U,setIsPrototype:N,checkAuthStatus:async()=>{try{const e=await t.current.getAccessToken();if(!e)return{isAuthenticated:!1};return await t.current.validateToken(e)?(y("MBA1111 checkAuthStatus",{isAuthenticated:!0,userRole:w,isApprovedProfessional:j}),{isAuthenticated:!0,userRole:w,isApprovedProfessional:j}):(await V("auth_status_check_failed"),{isAuthenticated:!1})}catch(e){return console.error("MBA1111 Error checking auth status:",e),{isAuthenticated:!1}}},fetchTimeSettings:G,debugTokenStatus:()=>{const e=t.current.accessToken;if(!e)return void y("MBA1111 No access token available");const o=t.current.getTimeUntilExpiry(e),n=o<=0,r=t.current.shouldRefreshToken(e);y("MBA1111 Token status:",{hasToken:!!e,timeUntilExpirySeconds:Math.round(o/1e3),isExpired:n,shouldRefresh:r,isRefreshing:t.current.isRefreshing,isSigningOut:t.current.isSigningOut})}},children:e})}},59742:(e,t,o)=>{"use strict";o.r(t),o.d(t,{MessageNotificationContext:()=>l,MessageNotificationProvider:()=>d,default:()=>c});var n=o(36665),r=o(38432),a=o(50294),i=o(65688),s=o(60397);const l=(0,n.createContext)(),d=({children:e})=>{const{isSignedIn:t,userRole:o}=(0,n.useContext)(r.AuthContext),[d,c]=(0,n.useState)(!1),[u,g]=(0,n.useState)(0),[m,h]=(0,n.useState)(0),[f,p]=(0,n.useState)(0),[y,b]=(0,n.useState)({}),[x,v]=(0,n.useState)(""),[w,C]=(0,n.useState)(null),[S,j]=(0,n.useState)(!1),[T,B]=(0,n.useState)(!1),[k,A]=(0,n.useState)(0),_=(0,n.useRef)(!1),I=(0,n.useRef)(!1),M=(0,n.useRef)(null),L=(0,n.useRef)(null),R=(0,n.useRef)(!1),D=(0,n.useRef)(0),z=(0,n.useRef)(!1),P=((0,n.useRef)(!1),(0,n.useRef)(0)),F=(0,n.useRef)(0),E=(0,n.useRef)(0),W=(0,n.useRef)(null),O=(0,n.useRef)(!1),N=(0,n.useRef)(null),H=(0,n.useRef)(0),U=(0,n.useRef)(null),V=async(e=!1)=>{try{if(I.current)return(0,r.debugLog)("MBA4321: Skipping unread check - another check is already in progress"),d;const t=(new Error).stack;if((0,r.debugLog)("MBA4321: checkUnreadMessages called from:\n".concat(t)),I.current=!0,e)return(0,r.debugLog)("MBA432wihe21: Forced API call for unread messages"),await Y();const o=i.default&&i.default.isWebSocketConnected();return(0,r.debugLog)("MBA4321: WebSocket connected: ".concat(o)),o&&R.current?((0,r.debugLog)("MBA4321: WebSocket is connected and data received, using current state"),I.current=!1,d):O.current?((0,r.debugLog)("MBA4321: Using existing state, we already made an initial API call"),I.current=!1,d):((0,r.debugLog)("MBA4321: First check on page load, implementing progressive WebSocket wait"),N.current&&clearTimeout(N.current),await q())}catch(t){return(0,r.debugLog)("MBA4321: Error in checkUnreadMessages:",t),I.current=!1,d}},q=async()=>(P.current=0,O.current?new Promise((e=>{const t=()=>{const o=i.default&&i.default.isWebSocketConnected();return R.current?((0,r.debugLog)("MBA4321: WebSocket data received during wait, using current state"),I.current=!1,void e(d)):(P.current++,(0,r.debugLog)("MBA4321: WebSocket wait attempt ".concat(P.current,"/").concat(12,", connected: ").concat(o)),o&&((0,r.debugLog)("MBA4321: WebSocket is connected, sending heartbeat request"),i.default.send("heartbeat",{timestamp:Date.now()}),E.current=Date.now()),P.current>=12?((0,r.debugLog)("MBA432wihe21: Max WebSocket wait attempts reached, falling back to API"),void Y().then((t=>e(t)))):void(N.current=setTimeout(t,5e3)))};t()})):((0,r.debugLog)("MBA432wihe21: Fresh page load - making initial API call to get accurate unread count"),await Y())),Y=async()=>{(0,r.debugLog)("MBA432wihe21: makeApiCall called, checking if necessary");const e=Date.now();if(e-H.current<6e4&&R.current&&z.current)return(0,r.debugLog)("MBA432wihe21: Skipping API call - checked recently and connection is healthy"),d;(0,r.debugLog)("MBA432wihe21: Making API call for unread messages");try{const t=await(0,a.getUnreadMessageCount)(),n=t.unread_count||0,i=t.conversation_counts||{};(0,r.debugLog)("MBA432wihe21: Unread message count from API:",n);let s=0,l=0;t.conversation_role_map?(s=t.owner_unread_count||0,l=t.professional_unread_count||0,(0,r.debugLog)("MBA432wihe21: Got role-specific counts from API",{ownerCount:s,proCount:l})):("petOwner"===o?s=n:l=n,(0,r.debugLog)("MBA432wihe21: Inferred role-specific counts",{userRole:o,ownerCount:s,proCount:l,totalCount:n})),C({unread_count:n,conversation_counts:i,owner_unread_count:s,professional_unread_count:l,timestamp:e}),g(n),h(s),p(l);return c(("petOwner"===o?s:l)>0),b(i),A(e),D.current=e,H.current=e,_.current=!0,O.current=!0,R.current=!0,I.current=!1,n>0}catch(t){return(0,r.debugLog)("MBA432wihe21: Error in API call:",t),I.current=!1,d}},G=e=>{if((0,r.debugLog)("MBA3uiobv59u: onNewMessage called with data:",e),e&&e.sent_by_other_user){const t=e.conversation_id;if("MessageHistory"===x&&t&&String(t)===String(window.selectedConversationId))return void(0,r.debugLog)("MBA3uiobv59u: User is viewing this conversation, not creating notification");const n=e.message_role||e.conversation_role;let a="petOwner"===n||"owner"===n,i="professional"===n;if(a||i||(e.recipient_role?(a="petOwner"===e.recipient_role||"owner"===e.recipient_role,i="professional"===e.recipient_role):e.sender_type&&(a="professional"===e.sender_type,i="petOwner"===e.sender_type||"owner"===e.sender_type)),(0,r.debugLog)("MBA3uiobv59u: Message role information:",{conversationId:t,messageRole:n,isForOwnerRole:a,isForProfessionalRole:i,currentUserRole:o,recipientRole:e.recipient_role,senderType:e.sender_type}),g((e=>{const t=e+1;return(0,r.debugLog)("MBA3uiobv59u: Total unread count: ".concat(e," \u2192 ").concat(t)),t})),c(!0),(0,r.debugLog)("MBA3uiobv59u: Setting hasUnreadMessages=true for all new messages"),a||i)a?h((e=>{const t=e+1;return(0,r.debugLog)("MBA3uiobv59u: Owner unread count: ".concat(e," \u2192 ").concat(t)),t})):i&&p((e=>{const t=e+1;return(0,r.debugLog)("MBA3uiobv59u: Professional unread count: ".concat(e," \u2192 ").concat(t)),t}));else{(0,r.debugLog)("MBA3uiobv59u: Message role still ambiguous, logging all available message data"),(0,r.debugLog)("MBA3uiobv59u: FULL MESSAGE DATA:",JSON.stringify(e,null,2));const t=!0===e.is_professional;(0,r.debugLog)("MBA3uiobv59u: User professional status in conversation:",{is_professional:e.is_professional,userIsProfessionalInConversation:t}),"boolean"===typeof e.is_professional?t?p((e=>{const t=e+1;return(0,r.debugLog)("MBA3uiobv59u: Professional unread count (from is_professional): ".concat(e," \u2192 ").concat(t)),t})):h((e=>{const t=e+1;return(0,r.debugLog)("MBA3uiobv59u: Owner unread count (from is_professional): ".concat(e," \u2192 ").concat(t)),t})):(p((e=>{const t=e+1;return(0,r.debugLog)("MBA3uiobv59u: Professional unread count (fallback): ".concat(e," \u2192 ").concat(t)),t})),h((e=>{const t=e+1;return(0,r.debugLog)("MBA3uiobv59u: Owner unread count (fallback): ".concat(e," \u2192 ").concat(t)),t})),(0,r.debugLog)("MBA3uiobv59u: WARNING: Updated both counts because is_professional is missing")),(0,r.debugLog)("MBA3uiobv59u: Current state for reference:",{userRole:o,hasUnreadMessages:d,unreadCount:u,ownerUnreadCount:m,professionalUnreadCount:f,conversationId:e.conversation_id,is_professional:e.is_professional})}t&&b((e=>{const o=e[t]||0,n=o+1;return(0,r.debugLog)("MBA3uiobv59u: Conversation ".concat(t," count: ").concat(o," \u2192 ").concat(n)),Object.assign({},e,{[t]:n})}))}};(0,n.useEffect)((()=>{window.selectedConversationId=null}),[]);const J=async e=>{if((0,r.debugLog)("MBA2o3uihf48hv: Marking conversation as read:",{conversationId:e,hasUnreadMessages:d,totalUnreadCount:u,ownerUnreadCount:m,professionalUnreadCount:f,userRole:o,conversationUnreadCount:y[e]||0,allConversationCounts:JSON.stringify(y)}),window.selectedConversationId=e,e&&y[e]){const t=y[e]||0;(0,r.debugLog)("MBA2o3uihf48hv: Found unread messages to clear",{conversationId:e,previousCount:t,currentTotalUnread:u});const n=Math.max(0,u-t);(0,r.debugLog)("MBA2o3uihf48hv: DIRECTLY updating total unread count from ".concat(u," to ").concat(n)),g(n),0===n&&((0,r.debugLog)("MBA2o3uihf48hv: No more unread messages, setting hasUnreadMessages to false"),c(!1));const a=Object.assign({},y);delete a[e],b(a);let i=m,s=f;if("petOwner"===o?(i=Math.max(0,m-t),(0,r.debugLog)("MBA2o3uihf48hv: Updating owner unread count: ".concat(m," \u2192 ").concat(i)),h(i)):"professional"===o&&(s=Math.max(0,f-t),(0,r.debugLog)("MBA2o3uihf48hv: Updating professional unread count: ".concat(f," \u2192 ").concat(s)),p(s)),w){const a=Object.assign({},w.conversation_counts);delete a[e],(0,r.debugLog)("MBA2o3uihf48hv: Updated role-specific counts after marking as read",{userRole:o,previousOwnerCount:m,previousProCount:f,newOwnerCount:i,newProCount:s,conversationId:e,conversationCount:t}),C({unread_count:n,conversation_counts:a,owner_unread_count:i,professional_unread_count:s,timestamp:Date.now()})}const l="petOwner"===o?i>0:s>0;if(c(l),(0,r.debugLog)("MBA2o3uihf48hv: After marking conversation ".concat(e," as read:"),{userRole:o,currentRoleHasUnread:l,newOwnerCount:i,newProCount:s,hasUnreadMessages:l,conversationsRemaining:Object.keys(a).length}),Object.keys(a).length>0){const e=Object.keys(a).map((e=>"".concat(e,":").concat(a[e]))).join(", ");(0,r.debugLog)("MBA2o3uihf48hv: Remaining unread conversations: ".concat(e))}else(0,r.debugLog)("MBA2o3uihf48hv: No remaining unread conversations")}else(0,r.debugLog)("MBA2o3uihf48hv: No unread messages found for this conversation",{conversationId:e,conversationCounts:JSON.stringify(y)});(0,r.debugLog)("MBA2o3uihf48hv: Updated unread state after marking conversation as read")};(0,n.useEffect)((()=>((async()=>{if(t)try{const e=await(0,r.getStorage)("userToken");if(!e)return void(0,r.debugLog)("MBA4321: No token available for WebSocket connection");(0,r.debugLog)("MBA4321: Initializing WebSocket connection"),i.default.init(e),B(!0),P.current=0,setTimeout((()=>{(0,r.debugLog)("MBA432wihe21: Forcing initial API check on page load to get accurate count"),Y()}),500)}catch(e){(0,r.debugLog)("MBA4321: Error initializing WebSocket:",e)}else T&&((0,r.debugLog)("MBA4321: User signed out, force disconnecting WebSocket"),i.default.disconnect(!0),B(!1),M.current&&(clearInterval(M.current),M.current=null),N.current&&(clearTimeout(N.current),N.current=null),W.current&&(clearTimeout(W.current),W.current=null),P.current=0,setWebsocketDataReceivedRef(!1),z.current=!1,O.current=!1)})(),()=>{M.current&&((0,r.debugLog)("MBA4321: Cleaning up WebSocket reconnect interval"),clearInterval(M.current),M.current=null),L.current&&(clearTimeout(L.current),L.current=null),N.current&&(clearTimeout(N.current),N.current=null),W.current&&(clearTimeout(W.current),W.current=null)})),[t]),(0,n.useEffect)((()=>{if(!t||!T)return;(0,r.debugLog)("MBA3uiobv59u: Setting up WebSocket message handlers");const e=i.default.registerHandler("new_message",(e=>{(0,r.debugLog)("MBA3uiobv59u: New message notification received:",e),(0,r.debugLog)("MBA3uiobv59u: Current notification state BEFORE update:",{hasUnreadMessages:d,unreadCount:u,ownerUnreadCount:m,professionalUnreadCount:f,userRole:o}),z.current=!0,F.current=Date.now(),R.current=!0,G(e),setTimeout((()=>{(0,r.debugLog)("MBA3uiobv59u: Notification state AFTER update:",{hasUnreadMessages:d,unreadCount:u,ownerUnreadCount:m,professionalUnreadCount:f,userRole:o})}),100)}),"new-message-context"),n=i.default.registerHandler("message",(e=>{(0,r.debugLog)("MBA4321: Message notification received via WebSocket:",e),z.current=!0,F.current=Date.now(),R.current=!0,G(e)}),"notification-context"),a=i.default.registerHandler("unread_update",(e=>{(0,r.debugLog)("MBA4321: Unread update received via WebSocket:",e),F.current=Date.now(),z.current=!0,e&&"undefined"!==typeof e.unread_count&&(g(e.unread_count),c(e.unread_count>0),b(e.conversation_counts||{}),C({unread_count:e.unread_count,conversation_counts:e.conversation_counts||{},timestamp:Date.now()}),A(Date.now()),R.current=!0,_.current=!0)}),"unread-update-context"),s=i.default.registerHandler("heartbeat_ack",(e=>{(0,r.debugLog)("MBA4321: Heartbeat acknowledgment received"),F.current=Date.now(),z.current=!0,R.current=!0}),"heartbeat-context"),l=i.default.registerHandler("connection",(e=>{(0,r.debugLog)("MBA4321: WebSocket connection event:",e),"connected"===e.status?(F.current=Date.now(),z.current=!0):e.forced&&(R.current=!1,z.current=!1,(0,r.debugLog)("MBA4321: Connection forcibly closed, resetting WebSocket data flag")),"connected"!==e.status||_.current||setTimeout((()=>{R.current||((0,r.debugLog)("MBA432wihe21: in connection handler"),V(!0))}),1e3)}),"connection-context");return()=>{(0,r.debugLog)("MBA4321: Cleaning up WebSocket handlers"),n(),e(),a(),l(),s()}}),[t,T]),(0,n.useEffect)((()=>{if(!t)return;const e=()=>{if("undefined"!==typeof document&&"visible"===document.visibilityState){(0,r.debugLog)("MBA4321: Tab became visible, ensuring WebSocket connection");const e=i.default&&i.default.isWebSocketConnected();if((0,r.debugLog)("MBA4321: WebSocket connection status on visibility change: ".concat(e?"Connected":"Disconnected")),e)return(0,r.debugLog)("MBA4321: WebSocket is already connected, no reconnection needed"),i.default.send("heartbeat",{timestamp:Date.now()}),E.current=Date.now(),R.current=!0,void(z.current=!0);if(i.default&&"function"===typeof i.default.reconnectIfNeeded){(0,r.debugLog)("MBA4321: WebSocket not connected, attempting reconnection"),i.default.reconnectIfNeeded(),P.current=0;const e=()=>i.default&&i.default.isWebSocketConnected()||R.current?((0,r.debugLog)("MBA4321: WebSocket reconnected successfully, stopping retry process"),void(N.current&&(clearTimeout(N.current),N.current=null))):(P.current++,(0,r.debugLog)("MBA4321: WebSocket reconnection attempt ".concat(P.current,"/").concat(12)),P.current>=12?((0,r.debugLog)("MBA432wihe21: Max retries reached, fall back to API"),void((e=!1)=>{L.current&&clearTimeout(L.current),L.current=setTimeout((()=>{V(e),L.current=null}),300)})(!0)):void(N.current=setTimeout(e,5e3)));setTimeout(e,1e3)}}};return"undefined"!==typeof document&&document.addEventListener("visibilitychange",e),()=>{"undefined"!==typeof document&&document.removeEventListener("visibilitychange",e),N.current&&(clearTimeout(N.current),N.current=null),W.current&&(clearTimeout(W.current),W.current=null)}}),[t]),(0,n.useEffect)((()=>{if(!t)return c(!1),g(0),b({}),R.current=!1,O.current=!1,void(N.current&&(clearTimeout(N.current),N.current=null));if(!O.current){(0,r.debugLog)("MBA4321: Ensuring we get fresh unread count on page load/sign-in");const e=setTimeout((()=>{O.current||((0,r.debugLog)("MBA432wihe21: Making initial API call to get fresh unread count"),Y())}),1e3);return()=>clearTimeout(e)}return()=>{}}),[t]),(0,n.useEffect)((()=>{(0,r.debugLog)("MBA3uiobv59u: Notification state changed:",{hasUnreadMessages:d,unreadCount:u,ownerUnreadCount:m,professionalUnreadCount:f,userRole:o})}),[d,u,m,f,o]),(0,n.useEffect)((()=>{if(o!==U.current){(0,r.debugLog)("MBA3uiobv59u: User role changed in MessageNotificationContext:",{from:U.current,to:o});U.current;U.current=o,"petOwner"===o?(c(m>0),(0,r.debugLog)("MBA3uiobv59u: Updated hasUnreadMessages for pet owner role:",{ownerUnreadCount:m,hasUnreadMessages:m>0})):"professional"===o&&(c(f>0),(0,r.debugLog)("MBA3uiobv59u: Updated hasUnreadMessages for professional role:",{professionalUnreadCount:f,hasUnreadMessages:f>0})),o&&setTimeout((()=>{V(!0)}),50)}}),[o,m,f]);const $={hasUnreadMessages:d,unreadCount:u,ownerUnreadCount:m,professionalUnreadCount:f,conversationCounts:y,currentRoute:x,getConversationUnreadCount:e=>{if(!e)return 0;const t=y[e]||0;return t>0&&(0,r.debugLog)("MBA2o3uihf48hv: getConversationUnreadCount for ".concat(e),{conversationId:e,count:t,allCounts:JSON.stringify(y),totalUnreadCount:u,hasUnreadMessages:d}),t},checkUnreadMessages:V,markConversationAsRead:J,resetNotifications:(e,t)=>{if(e&&e!==x&&v(e),(0,r.debugLog)("MBA2o3uihf48hv: resetNotifications called",{routeName:e,conversationId:t,currentRoute:x,hasUnreadMessages:d,unreadCount:u,conversationCountsSize:Object.keys(y).length}),t)return(0,r.debugLog)("MBA2o3uihf48hv: Resetting notifications for specific conversation: ".concat(t)),void J(t);"RESET_ALL"===e&&((0,r.debugLog)("MBA2o3uihf48hv: Explicitly resetting ALL message notifications"),c(!1),g(0),b({}))},updateRoute:e=>{e&&e!==x&&v(e)},getCurrentRoleUnreadCount:()=>{const e="petOwner"===o?m:f;return(0,r.debugLog)("MBA3uiobv59u: getCurrentRoleUnreadCount called:",{userRole:o,ownerUnreadCount:m,professionalUnreadCount:f,returned:e}),e},getOtherRoleUnreadCount:()=>{const e="petOwner"===o?f:m;return(0,r.debugLog)("MBA3uiobv59u: getOtherRoleUnreadCount called:",{userRole:o,ownerUnreadCount:m,professionalUnreadCount:f,returned:e}),e},hasCurrentRoleUnreadMessages:()=>{const e="petOwner"===o?m>0:f>0;return(0,r.debugLog)("MBA3uiobv59u: hasCurrentRoleUnreadMessages called:",{userRole:o,ownerUnreadCount:m,professionalUnreadCount:f,returned:e}),e}};return(0,s.jsx)(l.Provider,{value:$,children:e})},c=l},25882:(e,t,o)=>{"use strict";o.r(t),o.d(t,{fontFamilies:()=>r,fontWeights:()=>a,loadFonts:()=>n});const n=async()=>{try{return!0}catch(e){return console.warn("Error in font loading process:",e),!1}},r={regular:"PlayfairDisplay",medium:"PlayfairDisplay-Medium",header:"Futura"},a={regular:"400",medium:"500",semiBold:"600",bold:"700",header:"700"}},6541:(e,t,o)=>{"use strict";o.r(t),o.d(t,{theme:()=>a});var n=o(16204),r=o(25882);const a=Object.assign({},n.DefaultTheme,{fonts:Object.assign({},n.DefaultTheme.fonts,{regular:{fontFamily:r.fontFamilies.regular,fontWeight:r.fontWeights.regular},medium:{fontFamily:r.fontFamilies.medium,fontWeight:r.fontWeights.medium},header:{fontFamily:r.fontFamilies.header,fontWeight:r.fontWeights.header}}),colors:Object.assign({},n.DefaultTheme.colors,{mainColors:{main:"#6A6C51",secondary:"#5D6C51",tertiary:"#516C53",quaternary:"#516C61",quinary:"#516A6C",senary:"#515D6C"},proDashboard:{main:"#F0F9E5",secondary:"#E7F3F8",tertiary:"#FEF0DA",quaternary:"#E1E2DB"},mybookings:{main:"#FFF7ED",secondary:"#EA580E",tertiary:"#6A6C51",ownerName:"#4B4C3B",metaText:"#959885",confirmedBg:"#E8E9E2",confirmedText:"#898974",completedBg:"#F5F5F4",completedText:"#898983",searchBar:"rgb(183, 183, 183)"},primary:"#6A6C51",secondary:"#516C61",warning:"#FFA726",background:"#f6f6f6",backgroundContrast:"#F6F3FC",calendarColor:"#A99E6B",calendarColorYellowBrown:"#8A8C6D",text:"black",whiteText:"white",placeHolderText:"#A9A9A9",accent:"#03dac4",error:"#B00020",warning:"#FFA726",info:"#29B6F6",surface:"#F9FAFB",surfaceContrast:"#FFFFFF",border:"rgb(183, 183, 183)",bgColorModern:"rgb(239, 239, 239)",modernBorder:"#E0E0E0",inputBackground:"#f6f6f6",receivedMessage:"#e7eae6",danger:"#A52A2A"}),fontSizes:{small:12,smallMedium:14,medium:16,mediumLarge:18,large:20,largeLarge:24,extraLarge:26},spacing:{small:8,medium:16,large:24}})},94070:(e,t,o)=>{"use strict";o.r(t),o.d(t,{debugLog:()=>n});const n=(e,t)=>{false}},15175:()=>{},43538:(e,t,o)=>{"use strict";o.r(t),o.d(t,{addNavigationListener:()=>m,default:()=>b,getCurrentRoute:()=>a,getURLHash:()=>u,getURLParams:()=>i,getUserAgent:()=>p,goBack:()=>s,isMobile:()=>f,isWeb:()=>h,navigateTo:()=>l,redirectToSignIn:()=>y,replaceRoute:()=>d,setURLHash:()=>g,updateURLParams:()=>c});var n=o(95991),r=o(94070);const a=(e=null,t=null)=>{if(!window.location)return t?{name:t.name||"home",path:"/".concat(t.name||"home"),params:t.params||{},href:"app://".concat(t.name||"home")}:{name:"Home",path:"/home",params:{},href:"app://home"};try{const e=window.location.pathname,t=e.split("/").filter(Boolean);return{name:t.length>0?t[t.length-1]:"Home",path:e,params:i(),href:window.location.href}}catch(o){return(0,r.debugLog)("MBA9999: Error accessing window.location:",o),{name:"Home",path:"/",params:{},href:"web://error"}}},i=()=>{{const e=new URLSearchParams(window.location.search),t={};for(const[o,n]of e.entries())t[o]=n;return t}},s=e=>{if(!e)return(0,r.debugLog)("MBA9999: goBack called without navigation object"),!1;try{return window.history.length>1?(window.history.back(),!0):e.canGoBack()?(e.goBack(),!0):(e.navigate("Dashboard"),!0)}catch(t){return(0,r.debugLog)("MBA9999: Error in goBack:",t),!1}},l=(e,t,o={})=>{if(e)try{e.navigate(t,o)}catch(n){(0,r.debugLog)("MBA9999: Error in navigateTo:",n)}else(0,r.debugLog)("MBA9999: navigateTo called without navigation object")},d=(e,t,o={})=>{if(e)try{if(window.location)try{const e=new URL(window.location.href);e.pathname="/".concat(t.toLowerCase()),Object.keys(o).forEach((t=>{null!==o[t]&&void 0!==o[t]&&e.searchParams.set(t,o[t])})),window.history.replaceState({},"",e.toString())}catch(n){(0,r.debugLog)("MBA9999: Error in replaceRoute web logic:",n)}e.replace(t,o)}catch(n){(0,r.debugLog)("MBA9999: Error in replaceRoute:",n)}else(0,r.debugLog)("MBA9999: replaceRoute called without navigation object")},c=(e={},t=!0)=>{if(window.location)try{const o=new URL(window.location.href);Object.keys(e).forEach((t=>{null!==e[t]&&void 0!==e[t]?o.searchParams.set(t,e[t]):o.searchParams.delete(t)})),t?window.history.replaceState({},"",o.toString()):window.history.pushState({},"",o.toString())}catch(o){(0,r.debugLog)("MBA9999: Error in updateURLParams:",o)}},u=()=>window.location.hash.substring(1),g=e=>{window.location.hash=e?"#".concat(e):""},m=e=>{{const t=t=>{const o=a();e(o,t)};return window.addEventListener("popstate",t),()=>{window.removeEventListener("popstate",t)}}},h=()=>!0,f=()=>!1,p=()=>"undefined"!==typeof navigator?navigator.userAgent:"React Native ".concat("web"," ").concat(n.default.Version||"unknown"),y=e=>{if(window.location)try{window.location.hash?window.location.hash="#/signin":window.location.href="/signin"}catch(t){(0,r.debugLog)("MBA9999: Error in web redirectToSignIn:",t)}else e&&e.navigate("SignIn")},b={getCurrentRoute:a,getURLParams:i,goBack:s,navigateTo:l,replaceRoute:d,updateURLParams:c,getURLHash:u,setURLHash:g,addNavigationListener:m,isWeb:h,isMobile:f,getUserAgent:p,redirectToSignIn:y}},32160:(e,t,o)=>{"use strict";o.r(t),o.d(t,{FORMAT_TYPES:()=>x,checkDSTChange:()=>f,convertDateTimeFromUTC:()=>m,convertTo12Hour:()=>u,convertTo24Hour:()=>c,convertToUTC:()=>g,formatDate:()=>d,formatDateForAPI:()=>y,formatDateTimeRangeFromUTC:()=>w,formatFromUTC:()=>v,formatOccurrenceFromUTC:()=>p,formatTimeForAPI:()=>b,getFormattedTimes:()=>h,parseOccurrencesForBookingSteps:()=>S});var n=o(32724),r=o(9307),a=o(72302),i=o.n(a),s=o(38432),l=o(5977);const d=e=>{if(!e)return"";(0,s.debugLog)("MBA5677: Formatting date input",e);try{const t=(0,l.parseISO)(e);if(!isNaN(t.getTime())){const e=t.toLocaleString("default",{month:"short"}),o=t.getDate();return(0,s.debugLog)("MBA5677: Parsed as ISO date",{parsedDate:t,month:e,day:o}),"".concat(e," ").concat(o)}const o=(0,n.parse)(e,"yyyy-MM-dd",new Date);if(!isNaN(o.getTime())){const e=o.toLocaleString("default",{month:"short"}),t=o.getDate();return(0,s.debugLog)("MBA5677: Parsed with date-fns",{date:o,month:e,day:t}),"".concat(e," ").concat(t)}const r=i()(e);if(r.isValid()){const e=r.format("MMM D");return(0,s.debugLog)("MBA5677: Parsed with moment",{momentDate:r,formatted:e}),e}return(0,s.debugLog)("MBA5677: Failed to parse date",e),e}catch(t){return(0,s.debugLog)("MBA5677: Error formatting date",{dateString:e,error:t}),e}},c=e=>{if(!e.includes(" "))return e;const[t,o]=e.split(" ");let[n,r]=t.split(":");return n=parseInt(n,10),"PM"===o&&n<12?n+=12:"AM"===o&&12===n&&(n=0),"".concat(n.toString().padStart(2,"0"),":").concat(r)},u=e=>{if(e.includes(" "))return e;const[t,o]=e.split(":"),n=parseInt(t,10);let r=n>=12?"PM":"AM",a=n%12;return a=0===a?12:a,"".concat(a,":").concat(o," ").concat(r)},g=(e,t,o)=>{try{(0,s.debugLog)("MBA12345: Converting to UTC - Input:",{date:e,time:t,fromTimezone:o});const n=i().tz("".concat(e," ").concat(t),o),r=n.utc(),a=r.format("YYYY-MM-DD"),l=r.format("HH:mm");return(0,s.debugLog)("MBA12345: UTC conversion result:",{input:{date:e,time:t,fromTimezone:o},output:{utcDate:a,utcTime:l,originalMoment:n.format(),utcMoment:r.format()}}),{date:a,time:l}}catch(n){return(0,s.debugLog)("MBA12345: Error converting to UTC:",n),{date:e,time:t}}},m=(e,t,o,n=!1)=>{try{if((0,s.debugLog)("MBA5677: Converting UTC to local:",{date:e,time:t,timezone:o,useMilitaryTime:n}),!e||!t)return(0,s.debugLog)("MBA5677: Invalid input for conversion",{date:e,time:t}),{date:e,time:t};let a=null;try{let o=t;t.includes(".")&&(o=t.split(".")[0]);const n="".concat(e,"T").concat(o).concat(o.includes("Z")?"":"Z");(0,s.debugLog)("MBA5677: Trying ISO string format",n),a=new Date(n),isNaN(a.getTime())?((0,s.debugLog)("MBA5677: ISO format parsing failed"),a=null):(0,s.debugLog)("MBA5677: ISO format parsing succeeded")}catch(r){(0,s.debugLog)("MBA5677: Error in ISO format parsing",r)}if(!a)try{(0,s.debugLog)("MBA5677: Trying date-fns parsing");const o="".concat(e," ").concat(t);a=i().utc(o).toDate(),isNaN(a.getTime())?((0,s.debugLog)("MBA5677: date-fns parsing failed"),a=null):(0,s.debugLog)("MBA5677: date-fns parsing succeeded")}catch(r){(0,s.debugLog)("MBA5677: Error in date-fns parsing",r)}if(!a)try{(0,s.debugLog)("MBA5677: Trying manual parsing");const[o,n,r]=e.split("-").map(Number);let i=0,l=0;if(t.includes(":")){const e=t.split(":");i=parseInt(e[0],10),l=parseInt(e[1],10)}a=new Date(Date.UTC(o,n-1,r,i,l)),isNaN(a.getTime())?((0,s.debugLog)("MBA5677: Manual parsing failed"),a=null):(0,s.debugLog)("MBA5677: Manual parsing succeeded")}catch(r){(0,s.debugLog)("MBA5677: Error in manual parsing",r)}if(!a)return(0,s.debugLog)("MBA5677: All parsing strategies failed, returning original"),{date:e,time:t};(0,s.debugLog)("MBA5677: Valid UTC Date created:",a.toISOString());const l=i().utc(a),d=l.tz(o||"UTC"),c=d.format("YYYY-MM-DD"),u=d.format(n?"HH:mm":"h:mm A");return(0,s.debugLog)("MBA5677: Date conversion result:",{input:{date:e,time:t,timezone:o},utc:a.toISOString(),utcMoment:l.format(),localMoment:d.format(),output:{date:c,time:u}}),{date:c,time:u}}catch(a){return(0,s.debugLog)("MBA5677: Error in convertDateTimeFromUTC:",a,{date:e,time:t,timezone:o}),{date:e,time:t}}},h=(e,t,o,n,a)=>{try{console.log("MBA134njo0vh032 getFormattedTimes input:",{startDate:e,startTime:t,endDate:o,endTime:n,timezone:a});const[i,s,l]=e.split("-").map(Number),[d,c]=t.split(":").map(Number),[u,g,m]=o.split("-").map(Number),[h,f]=n.split(":").map(Number);console.log("MBA134njo0vh032 Parsed components:",{start:{year:i,month:s,day:l,hours:d,minutes:c},end:{year:u,month:g,day:m,hours:h,minutes:f}});const p="".concat(i,"-").concat(String(s).padStart(2,"0"),"-").concat(String(l).padStart(2,"0"),"T").concat(String(d).padStart(2,"0"),":").concat(String(c).padStart(2,"0"),":00"),y="".concat(u,"-").concat(String(g).padStart(2,"0"),"-").concat(String(m).padStart(2,"0"),"T").concat(String(h).padStart(2,"0"),":").concat(String(f).padStart(2,"0"),":00");console.log("MBA134njo0vh032 Created date strings:",{startDateStr:p,endDateStr:y,timezone:a});const b=(0,r.formatInTimeZone)(p,a,"MMM dd, yyyy (h:mm a)"),x=(0,r.formatInTimeZone)(y,a,"MMM dd, yyyy (h:mm a)");console.log("MBA134njo0vh032 Formatted dates:",{formatted_start:b,formatted_end:x});const v=new Date(p),w=new Date(y)-v,C=Math.floor(w/864e5),S=w%864e5,j=Math.floor(S/36e5);let T="";return C>0?(T+="".concat(C," day").concat(C>1?"s":""),j>0&&(T+=", ".concat(j," hour").concat(j>1?"s":""))):j>0&&(T+="".concat(j," hour").concat(j>1?"s":"")),console.log("MBA134njo0vh032 Final formatted output:",{formatted_start:b,formatted_end:x,duration:T,timezone:a.split("/")[1]||a}),{formatted_start:b,formatted_end:x,duration:T||"0 hours",timezone:a.split("/")[1]||a}}catch(i){throw console.error("Error in getFormattedTimes:",i),i}},f=(e,t,o,n,a)=>{try{const[i,s,l]=e.split("-").map(Number),[d,u]=c(t).split(":").map(Number),[g,m,h]=o.split("-").map(Number),[f,p]=c(n).split(":").map(Number),y=new Date(i,s-1,l,d,u),b=new Date(g,m-1,h,f,p),x=(0,r.fromZonedTime)((0,r.toZonedTime)(y,a)),v=(0,r.fromZonedTime)((0,r.toZonedTime)(b,a)),w=(0,r.toZonedTime)(x,a),C=(0,r.toZonedTime)(v,a);return w.getTimezoneOffset()!==C.getTimezoneOffset()}catch(i){throw console.error("Error in checkDSTChange:",i),i}},p=(e,t)=>{try{const o=t&&t.includes("/")?t:"US/Mountain";console.log("MBA134njo0vh03 Formatting occurrence from UTC:",{occurrence:e,userTimezone:t,fullTimezone:o});const n=m(e.start_date,e.start_time,o),r=m(e.end_date,e.end_time,o);console.log("MBA134njo0vh03 Local start:",n),console.log("MBA134njo0vh03 Local end:",r),console.log("MBA134njo0vh03 Full timezone:",o);const a=h(n.date,n.time,r.date,r.time,o);console.log("MBA134njo0vh03 Formatted times from getFormattedTimes:",a);const i=f(n.date,n.time,r.date,r.time,o),s=t.includes("/")?t.split("/")[1]:t;return Object.assign({},e,{formatted_start:a.formatted_start,formatted_end:a.formatted_end,duration:a.duration,timezone:s,dst_message:i?"Elapsed time may be different than expected due to Daylight Savings Time.":""})}catch(o){return console.error("Error in formatOccurrenceFromUTC:",o),Object.assign({},e,{formatted_start:e.start_date,formatted_end:e.end_date,duration:"Unknown",timezone:t.includes("/")?t.split("/")[1]:t,dst_message:""})}},y=e=>{if(!e)return null;let t;(0,s.debugLog)("MBA12345 formatDateForAPI input:",e,typeof e);try{if("string"===typeof e&&/^\d{4}-\d{2}-\d{2}$/.test(e))return(0,s.debugLog)("MBA12345 formatDateForAPI: already in YYYY-MM-DD format:",e),e;if("object"===typeof e&&e.date&&e.startTime&&e.endTime)return(0,s.debugLog)("MBA12345 formatDateForAPI: extracting date from date item:",e.date),e.date;if(e instanceof Date?(t=e,(0,s.debugLog)("MBA12345 formatDateForAPI: using Date object")):(t=new Date(e),(0,s.debugLog)("MBA12345 formatDateForAPI: created Date from input:",t)),isNaN(t.getTime()))throw(0,s.debugLog)("MBA12345 formatDateForAPI: invalid date:",e),new Error("Invalid date format");const o=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),a="".concat(o,"-").concat(n,"-").concat(r);return(0,s.debugLog)("MBA12345 formatDateForAPI result:",a),a}catch(o){throw(0,s.debugLog)("MBA12345 formatDateForAPI error:",o,"for input:",e),o}},b=e=>{if(!e)return(0,s.debugLog)("MBA12345 formatTimeForAPI received null/undefined time:",e),null;let t,o;if((0,s.debugLog)("MBA12345 formatTimeForAPI input:",e),"object"===typeof e&&void 0!==e.hours)t=e.hours,o=e.minutes,(0,s.debugLog)("MBA12345 formatTimeForAPI processing time object:",{hours:t,minutes:o});else{if("string"!==typeof e)throw(0,s.debugLog)("MBA12345 formatTimeForAPI invalid time format:",typeof e),new Error("Invalid time format");[t,o]=e.split(":").map(Number),(0,s.debugLog)("MBA12345 formatTimeForAPI processing time string:",{hours:t,minutes:o})}if(t=parseInt(t),o=parseInt(o),isNaN(t)||isNaN(o))throw(0,s.debugLog)("MBA12345 formatTimeForAPI invalid time values:",{hours:t,minutes:o}),new Error("Invalid time values");const n="".concat(String(t).padStart(2,"0"),":").concat(String(o).padStart(2,"0"));return(0,s.debugLog)("MBA12345 formatTimeForAPI result:",n),n},x={SHORT_DATE:"SHORT_DATE",MEDIUM_DATE:"MEDIUM_DATE",LONG_DATE:"LONG_DATE",TIME_ONLY:"TIME_ONLY",TIME_ONLY_24H:"TIME_ONLY_24H",DATE_TIME:"DATE_TIME",DATE_TIME_WITH_TZ:"DATE_TIME_WITH_TZ",DATE_RANGE:"DATE_RANGE",DATE_TIME_RANGE:"DATE_TIME_RANGE"},v=(e,t=null,o,n=x.MEDIUM_DATE)=>{try{if(!e)return console.error("MBA134njo0vh02c23 Error in formatFromUTC: dateStr is required"),"";const r=o||"US/Mountain",a=i().utc("".concat(e,"T").concat(t||"00:00",":00Z"));if(!a.isValid())return console.error("MBA134njo0vh02c23 Error in formatFromUTC: Invalid UTC moment created"),"";const s=a.tz(r);if(!s.isValid())return console.error("MBA134njo0vh02c23 Error in formatFromUTC: Invalid local moment created"),"";const l=s.zoneAbbr();switch(n){case x.SHORT_DATE:return s.format("MMM D");case x.MEDIUM_DATE:return s.format("MMM D, YYYY");case x.LONG_DATE:return s.format("MMMM D, YYYY");case x.TIME_ONLY:return s.format("h:mm A");case x.TIME_ONLY_24H:return s.format("HH:mm");case x.DATE_TIME:return s.format("MMM D, YYYY 'at' h:mm A");case x.DATE_TIME_WITH_TZ:return"".concat(s.format("MMM D, YYYY 'at' h:mm A")," ").concat(l);default:return s.format("MMM D, YYYY")}}catch(r){return console.error("MBA134njo0vh02c23 Error in formatFromUTC:",r),""}},w=({startDate:e,startTime:t,endDate:o,endTime:n,userTimezone:r,includeTimes:a=!0,includeTimezone:l=!0})=>{try{if(a){const a=i().utc("".concat(e,"T").concat(t,":00Z")),s=i().utc("".concat(o,"T").concat(n,":00Z")),d=a.tz(r),c=s.tz(r),u=d.zoneAbbr(),g=d.format("MMM D, YYYY h:mm A"),m=c.format("MMM D, YYYY h:mm A"),h=l?"".concat(g," ").concat(u):g,f=l?"".concat(m," ").concat(u):m;return"".concat(h," - ").concat(f)}{const t=i().utc("".concat(e,"T00:00:00Z")).tz(r),n=i().utc("".concat(o,"T00:00:00Z")).tz(r);return"".concat(t.format("MMM D, YYYY")," - ").concat(n.format("MMM D, YYYY"))}}catch(d){return(0,s.debugLog)("MBA134njo: Error in formatDateTimeRangeFromUTC:",d),""}};function C(e,t,o="US/Mountain"){try{const n=o||"US/Mountain",r="".concat(e,"T").concat(t,":00Z"),a=i().utc(r).tz(n),l=a.hours(),d=a.minutes();if(isNaN(l)||isNaN(d))throw(0,s.debugLog)("MBA2j3kbr9hve4: Invalid hours or minutes from moment conversion:",{hours:l,minutes:d}),new Error("Invalid time values from moment conversion");const c=a.format("YYYY-MM-DD"),u=c!==e;return(0,s.debugLog)("MBA2j3kbr9hve4: Time conversion details:",{utc:{date:e,time:t,fullDateTime:r},local:{date:c,time:"".concat(l,":").concat(d),fullDateTime:a.format(),dateChanged:u},timezone:n}),{hours:l,minutes:d,adjustedDate:u?c:null}}catch(n){(0,s.debugLog)("MBA2j3kbr9hve4: Error converting time from UTC:",n);try{const[e,o]=t.split(":").map(Number);return{hours:isNaN(e)?0:e,minutes:isNaN(o)?0:o,adjustedDate:null}}catch(r){return(0,s.debugLog)("MBA2j3kbr9hve4: Error parsing fallback time:",r),{hours:9,minutes:0,adjustedDate:null}}}}const S=(e,t="US/Mountain")=>{if((0,s.debugLog)("MBA2j3kbr9hve4: Parsing occurrences for booking steps:",e),!e||!Array.isArray(e)||0===e.length)return(0,s.debugLog)("MBA2j3kbr9hve4: No occurrences to parse"),{dates:[],dateRange:null,individualTimes:{},defaultTimes:{startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0}}};const o=new Set,n={},r=[...e].sort(((e,t)=>new Date(e.start_date)-new Date(t.start_date)));(0,s.debugLog)("MBA2j3kbr9hve4: Sorted occurrences:",r);const a=t||"US/Mountain";r.forEach((e=>{const{start_date:t,end_date:r,start_time:i,end_time:l}=e;if(!t||!i||!l)return void(0,s.debugLog)("MBA2j3kbr9hve4: Invalid occurrence data, missing required fields:",e);const d=C(t,i,a),c=C(r||t,l,a),u=d.adjustedDate||t,g=c.adjustedDate||r||t;(0,s.debugLog)("MBA2j3kbr9hve4: Converted times with date adjustments:",{utc:{startDate:t,startTime:i,endDate:r||t,endTime:l},local:{startDate:u,startTime:d,endDate:g,endTime:c}}),o.add(u),g!==u&&o.add(g),void 0!==d.hours&&void 0!==d.minutes&&void 0!==c.hours&&void 0!==c.minutes?n[u]={startTime:{hours:d.hours,minutes:d.minutes},endTime:{hours:c.hours,minutes:c.minutes},isOvernightForced:u!==g}:(0,s.debugLog)("MBA2j3kbr9hve4: Invalid time conversion result, skipping occurrence:",{localStartTime:d,localEndTime:c,occurrence:e})}));const i=Array.from(o).map((e=>{const[t,o,n]=e.split("-").map(Number);return new Date(t,o-1,n)}));(0,s.debugLog)("MBA2j3kbr9hve4: Parsed dates after timezone adjustment:",i.map((e=>e.toISOString().split("T")[0])));let l=null;if(i.length>0){const e=[...i].sort(((e,t)=>e-t));l={startDate:e[0],endDate:e[e.length-1]},(0,s.debugLog)("MBA2j3kbr9hve4: Created date range after timezone adjustment:",{startDate:l.startDate.toISOString().split("T")[0],endDate:l.endDate.toISOString().split("T")[0]})}let d={startTime:{hours:9,minutes:0},endTime:{hours:17,minutes:0}};if(Object.keys(n).length>0){const e=Object.keys(n)[0],t=n[e];t&&t.startTime&&t.endTime&&"number"===typeof t.startTime.hours&&"number"===typeof t.startTime.minutes&&"number"===typeof t.endTime.hours&&"number"===typeof t.endTime.minutes?d={startTime:t.startTime,endTime:t.endTime}:(0,s.debugLog)("MBA2j3kbr9hve4: Invalid first time object, using fallback defaults:",t)}const c={dates:i,dateRange:l,individualTimes:n,defaultTimes:d,allTimesAreTheSame:Object.keys(n).length<=1||Object.values(n).every((e=>e.startTime.hours===d.startTime.hours&&e.startTime.minutes===d.startTime.minutes&&e.endTime.hours===d.endTime.hours&&e.endTime.minutes===d.endTime.minutes))};return(0,s.debugLog)("MBA2j3kbr9hve4: Parsed result with timezone adjustments:",c),c}},65688:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>a});var n=o(64900),r=o(94070);const a=new class{constructor(){this.socket=null,this.isConnected=!1,this.token=null,this.connectionAttempts=0,this.maxConnectionAttempts=5,this.heartbeatInterval=null,this.disconnectTimeout=null,this.messageHandlers=new Map,this.connectionId=null,this.wsUrl=n.API_BASE_URL.replace("http://","ws://").replace("https://","wss://"),this._reconnectTimeout=null,this.forceDisconnect=!1,this._hasVisibilityListener=!1,(0,r.debugLog)("MBA4321: WebSocketManager initialized, wsUrl is "+this.wsUrl)}init(e){e?this.token===e&&this.isConnected&&this.socket&&this.socket.readyState===WebSocket.OPEN?(0,r.debugLog)("MBA4321: WebSocket already connected with this token"):(this.token&&this.token!==e&&((0,r.debugLog)("MBA4321: Token changed, force disconnecting before reconnecting"),this.disconnect(!0)),this.token=e,this.forceDisconnect=!1,!this.socket||this.socket.readyState!==WebSocket.CLOSING&&this.socket.readyState!==WebSocket.CLOSED||((0,r.debugLog)("MBA4321: Closing existing non-functional socket"),this.disconnect(!1)),this.connect(),this.resetDisconnectTimeout(),this.setupVisibilityListener()):(0,r.debugLog)("MBA4321: Cannot initialize WebSocket without a valid token")}setupVisibilityListener(){if("undefined"===typeof document)return;if(this._hasVisibilityListener)return;(0,r.debugLog)("MBA4321: Setting up visibility change listener");const e=()=>{"undefined"!==typeof document&&"visible"===document.visibilityState&&((0,r.debugLog)("MBA4321: Document became visible, checking WebSocket connection"),this.token&&!this.forceDisconnect&&this.reconnectIfNeeded())};"undefined"!==typeof document&&(document.addEventListener("visibilitychange",e),this._hasVisibilityListener=!0,window.addEventListener("beforeunload",(()=>{(0,r.debugLog)("MBA4321: Page unloading, connection may persist for session restore")})))}connect(){if(!this.token)return(0,r.debugLog)("MBA4321: Cannot connect WebSocket without a valid token"),!1;if(this.isConnected&&this.socket&&this.socket.readyState===WebSocket.OPEN)return(0,r.debugLog)("MBA4321: WebSocket already connected and open"),!0;if(this.socket&&this.socket.readyState===WebSocket.CONNECTING)return(0,r.debugLog)("MBA4321: WebSocket already connecting, skipping duplicate connect"),!0;if(this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null),this.connectionAttempts>=this.maxConnectionAttempts)return setTimeout((()=>{this.connectionAttempts=0,this.connect()}),6e4),!1;try{this.connectionAttempts++;const e="".concat(this.wsUrl,"/ws/messages/?token=").concat(this.token);return this.socket=new WebSocket(e),this.socket.onopen=this.handleOpen.bind(this),this.socket.onclose=this.handleClose.bind(this),this.socket.onmessage=this.handleMessage.bind(this),this.socket.onerror=this.handleError.bind(this),!0}catch(e){return this.scheduleReconnect(),!1}}handleOpen(e){this.isConnected=!0,this.connectionAttempts=0,this.startHeartbeat(),this.notifyHandlers("connection",{status:"connected",timestamp:(new Date).toISOString()}),setTimeout((()=>{this.isConnected&&this.send("heartbeat")}),500)}handleClose(e){if(!this.isConnected&&!this.socket)return;const t=this.isConnected;this.isConnected=!1,this.socket=null,this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null),t&&this.notifyHandlers("disconnection",{code:e.code,reason:e.reason,timestamp:(new Date).toISOString()}),this.scheduleReconnect()}handleMessage(e){try{const t=JSON.parse(e.data);if("heartbeat_ack"===t.type)return;this.notifyHandlers(t.type,t.data||{}),this.notifyHandlers("all",{type:t.type,data:t.data||{}})}catch(t){(0,r.debugLog)("MBA4321: [MY CONNECTION] Error handling WebSocket message: ".concat(t.message))}}handleError(e){(0,r.debugLog)("MBA4321: [MY CONNECTION] WebSocket error: ".concat(e.message||"Unknown error")),this.notifyHandlers("error",{error:e.message||"Unknown error",timestamp:(new Date).toISOString()}),this.scheduleReconnect()}send(e,t={}){if(!this.isConnected||!this.socket)return!1;try{const o=JSON.stringify({type:e,data:t,timestamp:Date.now()});return this.socket.send(o),!0}catch(o){return(0,r.debugLog)("MBA4321: [MY CONNECTION] Error sending message through connection: ".concat(o.message)),!1}}scheduleReconnect(){if(this._reconnectTimeout)return void(0,r.debugLog)("MBA4321: Reconnect already scheduled, skipping duplicate");const e=Math.min(1e3*Math.pow(2,this.connectionAttempts-1),3e4);this._reconnectTimeout=setTimeout((()=>{this._reconnectTimeout=null,this.isConnected||this.connect()}),e)}startHeartbeat(){this.heartbeatInterval&&clearInterval(this.heartbeatInterval),this.heartbeatInterval=setInterval((()=>{this.isConnected?(this.send("heartbeat",{timestamp:Date.now()}),(0,r.debugLog)("MBA4321: Heartbeat sent")):((0,r.debugLog)("MBA4321: Skipping heartbeat, not connected"),clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}),3e4),(0,r.debugLog)("MBA4321: Heartbeat mechanism started")}disconnect(e=!1){this.forceDisconnect=e;const t=!e,o=t?this.token:null;if(this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null),this.disconnectTimeout&&(clearTimeout(this.disconnectTimeout),this.disconnectTimeout=null),this.socket)try{this.socket.onopen=null,this.socket.onclose=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.close(),this.socket=null}catch(n){(0,r.debugLog)("MBA4321: [MY CONNECTION] Error closing WebSocket: ".concat(n.message))}return this.isConnected=!1,t&&o&&(this.token=o),this.notifyHandlers("connection",{status:"disconnected",forced:e,timestamp:(new Date).toISOString()}),!0}resetDisconnectTimeout(){this.disconnectTimeout&&clearTimeout(this.disconnectTimeout),this.disconnectTimeout=setTimeout((()=>{(0,r.debugLog)("MBA4321: Disconnecting due to inactivity"),this.disconnect()}),6e5)}isWebSocketConnected(){return this.isConnected&&this.socket&&this.socket.readyState===WebSocket.OPEN}registerHandler(e,t,o){return this.messageHandlers.has(e)||this.messageHandlers.set(e,new Map),this.messageHandlers.get(e).set(o,t),(0,r.debugLog)("MBA4321: Registered handler ".concat(o," for ").concat(e," messages")),()=>this.unregisterHandler(e,o)}unregisterHandler(e,t){this.messageHandlers.has(e)&&(this.messageHandlers.get(e).delete(t),(0,r.debugLog)("MBA4321: Unregistered handler ".concat(t," for ").concat(e," messages")))}notifyHandlers(e,t){if(this.messageHandlers.has(e)){this.messageHandlers.get(e).forEach(((o,n)=>{try{o(t)}catch(a){(0,r.debugLog)("MBA4321: Error in ".concat(e," handler ").concat(n,": ").concat(a.message))}}))}if("all"!==e&&this.messageHandlers.has("all")){this.messageHandlers.get("all").forEach(((o,n)=>{try{o({type:e,data:t})}catch(a){(0,r.debugLog)("MBA4321: Error in global handler ".concat(n,": ").concat(a.message))}}))}}markMessagesAsRead(e,t){return!(!Array.isArray(t)||0===t.length)&&this.send("mark_read",{conversation_id:e,message_ids:t})}reconnectIfNeeded(){if(!this.token||this.forceDisconnect)return(0,r.debugLog)("MBA4321: [MY CONNECTION] Cannot reconnect - ".concat(this.token?"force disconnected":"no token")),!1;if(!this.isConnected||!this.socket||this.socket&&(this.socket.readyState===WebSocket.CLOSED||this.socket.readyState===WebSocket.CLOSING)){if(this.forceDisconnect=!1,this.socket)try{this.socket.onclose=null,this.socket.close(),this.socket=null}catch(e){(0,r.debugLog)("MBA4321: [MY CONNECTION] Error closing existing socket: ".concat(e.message))}return this.isConnected=!1,setTimeout((()=>{this.connect()}),100),!0}return this.isConnected&&this.socket&&this.socket.readyState===WebSocket.OPEN&&(this.send("heartbeat"),this.resetDisconnectTimeout()),!1}}},18698:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>n});const n={}},35358:(e,t,o)=>{var n={"./af":17582,"./af.js":17582,"./ar":93042,"./ar-dz":54265,"./ar-dz.js":54265,"./ar-kw":92553,"./ar-kw.js":92553,"./ar-ly":85352,"./ar-ly.js":85352,"./ar-ma":67097,"./ar-ma.js":67097,"./ar-ps":76150,"./ar-ps.js":76150,"./ar-sa":84427,"./ar-sa.js":84427,"./ar-tn":7221,"./ar-tn.js":7221,"./ar.js":93042,"./az":60458,"./az.js":60458,"./be":17596,"./be.js":17596,"./bg":93830,"./bg.js":93830,"./bm":27044,"./bm.js":27044,"./bn":58573,"./bn-bd":13296,"./bn-bd.js":13296,"./bn.js":58573,"./bo":25614,"./bo.js":25614,"./br":62041,"./br.js":62041,"./bs":91786,"./bs.js":91786,"./ca":75833,"./ca.js":75833,"./cs":52711,"./cs.js":52711,"./cv":71036,"./cv.js":71036,"./cy":84977,"./cy.js":84977,"./da":8770,"./da.js":8770,"./de":67342,"./de-at":81566,"./de-at.js":81566,"./de-ch":87544,"./de-ch.js":87544,"./de.js":67342,"./dv":82875,"./dv.js":82875,"./el":78536,"./el.js":78536,"./en-au":38617,"./en-au.js":38617,"./en-ca":79227,"./en-ca.js":79227,"./en-gb":59754,"./en-gb.js":59754,"./en-ie":37217,"./en-ie.js":37217,"./en-il":85418,"./en-il.js":85418,"./en-in":80800,"./en-in.js":80800,"./en-nz":67299,"./en-nz.js":67299,"./en-sg":76305,"./en-sg.js":76305,"./eo":8673,"./eo.js":8673,"./es":71301,"./es-do":3187,"./es-do.js":3187,"./es-mx":48223,"./es-mx.js":48223,"./es-us":37634,"./es-us.js":37634,"./es.js":71301,"./et":4976,"./et.js":4976,"./eu":11847,"./eu.js":11847,"./fa":74372,"./fa.js":74372,"./fi":41628,"./fi.js":41628,"./fil":56802,"./fil.js":56802,"./fo":42874,"./fo.js":42874,"./fr":9853,"./fr-ca":87170,"./fr-ca.js":87170,"./fr-ch":22825,"./fr-ch.js":22825,"./fr.js":9853,"./fy":68876,"./fy.js":68876,"./ga":93533,"./ga.js":93533,"./gd":82770,"./gd.js":82770,"./gl":98602,"./gl.js":98602,"./gom-deva":63059,"./gom-deva.js":63059,"./gom-latn":48212,"./gom-latn.js":48212,"./gu":23409,"./gu.js":23409,"./he":17210,"./he.js":17210,"./hi":4750,"./hi.js":4750,"./hr":51315,"./hr.js":51315,"./hu":47626,"./hu.js":47626,"./hy-am":91317,"./hy-am.js":91317,"./id":26892,"./id.js":26892,"./is":97577,"./is.js":97577,"./it":57628,"./it-ch":3046,"./it-ch.js":3046,"./it.js":57628,"./ja":92504,"./ja.js":92504,"./jv":25917,"./jv.js":25917,"./ka":64513,"./ka.js":64513,"./kk":94935,"./kk.js":94935,"./km":96661,"./km.js":96661,"./kn":89964,"./kn.js":89964,"./ko":98067,"./ko.js":98067,"./ku":61165,"./ku-kmr":85158,"./ku-kmr.js":85158,"./ku.js":61165,"./ky":11177,"./ky.js":11177,"./lb":2967,"./lb.js":2967,"./lo":81972,"./lo.js":81972,"./lt":58469,"./lt.js":58469,"./lv":33155,"./lv.js":33155,"./me":87935,"./me.js":87935,"./mi":74483,"./mi.js":74483,"./mk":32501,"./mk.js":32501,"./ml":73120,"./ml.js":73120,"./mn":20266,"./mn.js":20266,"./mr":19406,"./mr.js":19406,"./ms":80109,"./ms-my":90864,"./ms-my.js":90864,"./ms.js":80109,"./mt":22904,"./mt.js":22904,"./my":44067,"./my.js":44067,"./nb":21301,"./nb.js":21301,"./ne":81152,"./ne.js":81152,"./nl":76735,"./nl-be":97761,"./nl-be.js":97761,"./nl.js":76735,"./nn":37569,"./nn.js":37569,"./oc-lnc":20833,"./oc-lnc.js":20833,"./pa-in":3044,"./pa-in.js":3044,"./pl":34249,"./pl.js":34249,"./pt":87585,"./pt-br":26826,"./pt-br.js":26826,"./pt.js":87585,"./ro":62526,"./ro.js":62526,"./ru":62204,"./ru.js":62204,"./sd":43270,"./sd.js":43270,"./se":61541,"./se.js":61541,"./si":71921,"./si.js":71921,"./sk":49935,"./sk.js":49935,"./sl":46254,"./sl.js":46254,"./sq":59897,"./sq.js":59897,"./sr":42496,"./sr-cyrl":11135,"./sr-cyrl.js":11135,"./sr.js":42496,"./ss":32215,"./ss.js":32215,"./sv":84716,"./sv.js":84716,"./sw":50803,"./sw.js":50803,"./ta":31538,"./ta.js":31538,"./te":2302,"./te.js":2302,"./tet":25280,"./tet.js":25280,"./tg":14100,"./tg.js":14100,"./th":95385,"./th.js":95385,"./tk":736,"./tk.js":736,"./tl-ph":79726,"./tl-ph.js":79726,"./tlh":41873,"./tlh.js":41873,"./tr":36463,"./tr.js":36463,"./tzl":27491,"./tzl.js":27491,"./tzm":29500,"./tzm-latn":80196,"./tzm-latn.js":80196,"./tzm.js":29500,"./ug-cn":91287,"./ug-cn.js":91287,"./uk":35341,"./uk.js":35341,"./ur":36246,"./ur.js":36246,"./uz":55550,"./uz-latn":77254,"./uz-latn.js":77254,"./uz.js":55550,"./vi":78796,"./vi.js":78796,"./x-pseudo":22736,"./x-pseudo.js":22736,"./yo":28621,"./yo.js":28621,"./zh-cn":67601,"./zh-cn.js":67601,"./zh-hk":39053,"./zh-hk.js":39053,"./zh-mo":71248,"./zh-mo.js":71248,"./zh-tw":74725,"./zh-tw.js":74725};function r(e){var t=a(e);return o(t)}function a(e){if(!o.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=a,e.exports=r,r.id=35358},58162:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/ZEGN_USER.ab7ee48e98c0856bd407.jpeg"},65460:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/default-pet-image.3b5628b61ce454d19bca.png"},4456:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/default-profile.0695878757dbc86fae81.png"},32571:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/hero-image.424f8a0cb7b1986d78c3.jpg"},14082:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/logo.761085745bd386bf07cb.png"},81029:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user1.7a2574d2f5544235a6c5.png"},24289:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user10.55bbb564f3b12d6a736e.png"},53198:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user2.2356c55dbde8d97f60f2.png"},52695:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user3.ceef543650ca617d5e9e.png"},30552:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user4.58378ed25cf9bc79aeb4.png"},51681:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user5.6e041c0f826063afc158.png"},10602:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user6.943d36e020756a238d35.png"},26163:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user7.1431674f298a9f88bd16.png"},244:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user8.fb62e9c497f7a3d39de8.png"},21373:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/user9.fdb12560d3f0a8511959.png"}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var a=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(a.exports,a,a.exports,o),a.loaded=!0,a.exports}o.m=e,(()=>{var e=[];o.O=(t,n,r,a)=>{if(!n){var i=1/0;for(c=0;c<e.length;c++){for(var[n,r,a]=e[c],s=!0,l=0;l<n.length;l++)(!1&a||i>=a)&&Object.keys(o.O).every((e=>o.O[e](n[l])))?n.splice(l--,1):(s=!1,a<i&&(i=a));if(s){e.splice(c--,1);var d=r();void 0!==d&&(t=d)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,r,a]}})(),o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),o.p="/",(()=>{var e={792:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var r,a,[i,s,l]=n,d=0;if(i.some((t=>0!==e[t]))){for(r in s)o.o(s,r)&&(o.m[r]=s[r]);if(l)var c=l(o)}for(t&&t(n);d<i.length;d++)a=i[d],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(c)},n=self.webpackChunkweb=self.webpackChunkweb||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=o.O(void 0,[481],(()=>o(55819)));n=o.O(n)})();
//# sourceMappingURL=main.c81cf04a.js.map